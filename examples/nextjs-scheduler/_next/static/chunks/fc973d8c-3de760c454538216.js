(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[476],{1083:function(e,t,r){var n=r(4850);!function(e){"use strict";var t,r,i,o,s,a,l,u,d,c,h,m,p,f,g,T,y,v,S,b,E,I,N,_,O,k,D,A,P,w,C,x,R,F,L,M,B,J,V,U,j,$,q,G,Y,K,z,W,H,X,Z,Q,ee,et,er,en,ei,eo,es,ea,el,eu,ed,ec,eh,em,ep,ef,eg,eT,ey,ev=Object.defineProperty,__defNormalProp=(e,t,r)=>t in e?ev(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__publicField=(e,t,r)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,r),r);function assert(e,t){if(!e)throw Error(t)}function assertInt32(e){if("number"!=typeof e)throw Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw Error("invalid int 32: "+e)}function assertUInt32(e){if("number"!=typeof e)throw Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw Error("invalid uint 32: "+e)}function assertFloat32(e){if("number"!=typeof e)throw Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw Error("invalid float 32: "+e)}(t=q||(q={}))[t.Canceled=1]="Canceled",t[t.Unknown=2]="Unknown",t[t.InvalidArgument=3]="InvalidArgument",t[t.DeadlineExceeded=4]="DeadlineExceeded",t[t.NotFound=5]="NotFound",t[t.AlreadyExists=6]="AlreadyExists",t[t.PermissionDenied=7]="PermissionDenied",t[t.ResourceExhausted=8]="ResourceExhausted",t[t.FailedPrecondition=9]="FailedPrecondition",t[t.Aborted=10]="Aborted",t[t.OutOfRange=11]="OutOfRange",t[t.Unimplemented=12]="Unimplemented",t[t.Internal=13]="Internal",t[t.Unavailable=14]="Unavailable",t[t.DataLoss=15]="DataLoss",t[t.Unauthenticated=16]="Unauthenticated";let eS=Symbol("@bufbuild/protobuf/enum-type");function getEnumType(e){let t=e[eS];return assert(t,"missing enum type on enum object"),t}function setEnumType(e,t,r,n){e[eS]=makeEnumType(t,r.map(t=>({no:t.no,name:t.name,localName:e[t.no]})))}function makeEnumType(e,t,r){let n=Object.create(null),i=Object.create(null),o=[];for(let e of t){let t=normalizeEnumValue(e);o.push(t),n[e.name]=t,i[e.no]=t}return{typeName:e,values:o,findName:e=>n[e],findNumber:e=>i[e]}}function makeEnum(e,t,r){let n={};for(let e of t){let t=normalizeEnumValue(e);n[t.localName]=t.no,n[t.no]=t.localName}return setEnumType(n,e,t),n}function normalizeEnumValue(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}let Message=class Message{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){let r=this.getType(),n=r.runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){let r=this.getType(),n=r.runtime.json,i=n.makeReadOptions(t);return n.readMessage(r,e,i,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(e){throw Error(`cannot decode ${this.getType().typeName} from JSON: ${e instanceof Error?e.message:String(e)}`)}return this.fromJson(r,t)}toBinary(e){let t=this.getType(),r=t.runtime.bin,n=r.makeWriteOptions(e),i=n.writerFactory();return r.writeMessage(this,i,n),i.finish()}toJson(e){let t=this.getType(),r=t.runtime.json,n=r.makeWriteOptions(e);return r.writeMessage(this,n)}toJsonString(e){var t;let r=this.toJson(e);return JSON.stringify(r,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}};function makeProtoRuntime(e,t,r,n){return{syntax:e,json:t,bin:r,util:n,makeMessageType(e,t,r){return function(e,t,r,n){var i;let o=null!==(i=null==n?void 0:n.localName)&&void 0!==i?i:t.substring(t.lastIndexOf(".")+1),s={[o]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[o];return Object.setPrototypeOf(s.prototype,new Message),Object.assign(s,{runtime:e,typeName:t,fields:e.util.newFieldList(r),fromBinary:(e,t)=>new s().fromBinary(e,t),fromJson:(e,t)=>new s().fromJson(e,t),fromJsonString:(e,t)=>new s().fromJsonString(e,t),equals:(t,r)=>e.util.equals(s,t,r)}),s}(this,e,t,r)},makeEnum,makeEnumType,getEnumType}}function varint64read(){let e=0,t=0;for(let r=0;r<28;r+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<r,(128&n)==0)return this.assertBounds(),[e,t]}let r=this.buf[this.pos++];if(e|=(15&r)<<28,t=(112&r)>>4,(128&r)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<r,(128&n)==0)return this.assertBounds(),[e,t]}throw Error("invalid varint")}function varint64write(e,t,r){for(let n=0;n<28;n+=7){let i=e>>>n,o=!(i>>>7==0&&0==t),s=(o?128|i:i)&255;if(r.push(s),!o)return}let n=e>>>28&15|(7&t)<<4,i=t>>3!=0;if(r.push((i?128|n:n)&255),i){for(let e=3;e<31;e+=7){let n=t>>>e,i=n>>>7!=0,o=(i?128|n:n)&255;if(r.push(o),!i)return}r.push(t>>>31&1)}}function int64FromString(e){let t="-"===e[0];t&&(e=e.slice(1));let r=0,n=0;function add1e6digit(t,i){let o=Number(e.slice(t,i));n*=1e6,(r=1e6*r+o)>=4294967296&&(n+=r/4294967296|0,r%=4294967296)}return add1e6digit(-24,-18),add1e6digit(-18,-12),add1e6digit(-12,-6),add1e6digit(-6),t?negate(r,n):newBits(r,n)}function uInt64ToString(e,t){if({lo:e,hi:t}={lo:e>>>0,hi:t>>>0},t<=2097151)return String(4294967296*t+e);let r=16777215&e,n=(e>>>24|t<<8)&16777215,i=t>>16&65535,o=r+6777216*n+6710656*i,s=n+8147497*i,a=2*i;return o>=1e7&&(s+=Math.floor(o/1e7),o%=1e7),s>=1e7&&(a+=Math.floor(s/1e7),s%=1e7),a.toString()+decimalFrom1e7WithLeadingZeros(s)+decimalFrom1e7WithLeadingZeros(o)}function newBits(e,t){return{lo:0|e,hi:0|t}}function negate(e,t){return t=~t,e?e=~e+1:t+=1,newBits(e,t)}(r=G||(G={}))[r.DOUBLE=1]="DOUBLE",r[r.FLOAT=2]="FLOAT",r[r.INT64=3]="INT64",r[r.UINT64=4]="UINT64",r[r.INT32=5]="INT32",r[r.FIXED64=6]="FIXED64",r[r.FIXED32=7]="FIXED32",r[r.BOOL=8]="BOOL",r[r.STRING=9]="STRING",r[r.BYTES=12]="BYTES",r[r.UINT32=13]="UINT32",r[r.SFIXED32=15]="SFIXED32",r[r.SFIXED64=16]="SFIXED64",r[r.SINT32=17]="SINT32",r[r.SINT64=18]="SINT64",(i=Y||(Y={}))[i.BIGINT=0]="BIGINT",i[i.STRING=1]="STRING";let decimalFrom1e7WithLeadingZeros=e=>{let t=String(e);return"0000000".slice(t.length)+t};function varint32write(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let r=0;r<9;r++)t.push(127&e|128),e>>=7;t.push(1)}}function varint32read(){let e=this.buf[this.pos++],t=127&e;if((128&e)==0||(t|=(127&(e=this.buf[this.pos++]))<<7,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<14,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<21,(128&e)==0))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(let t=5;(128&e)!=0&&t<10;t++)e=this.buf[this.pos++];if((128&e)!=0)throw Error("invalid varint");return this.assertBounds(),t>>>0}let eb=function(){let e=new DataView(new ArrayBuffer(8)),t="function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof n||"object"!=typeof n.env||"1"!==n.env.BUF_BIGINT_DISABLE);if(t){let t=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),n=BigInt("0"),i=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){let n="bigint"==typeof e?e:BigInt(e);if(n>r||n<t)throw Error(`int64 invalid: ${e}`);return n},uParse(e){let t="bigint"==typeof e?e:BigInt(e);if(t>i||t<n)throw Error(`uint64 invalid: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigInt64(0,!0)),uDec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigUint64(0,!0))}}let assertInt64String=e=>assert(/^-?[0-9]+$/.test(e),`int64 invalid: ${e}`),assertUInt64String=e=>assert(/^[0-9]+$/.test(e),`uint64 invalid: ${e}`);return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),assertInt64String(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),assertUInt64String(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),assertInt64String(e),int64FromString(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),assertUInt64String(e),int64FromString(e)),dec:(e,t)=>(function(e,t){let r=newBits(e,t),n=2147483648&r.hi;n&&(r=negate(r.lo,r.hi));let i=uInt64ToString(r.lo,r.hi);return n?"-"+i:i})(e,t),uDec:(e,t)=>uInt64ToString(e,t)}}();(o=K||(K={}))[o.Varint=0]="Varint",o[o.Bit64=1]="Bit64",o[o.LengthDelimited=2]="LengthDelimited",o[o.StartGroup=3]="StartGroup",o[o.EndGroup=4]="EndGroup",o[o.Bit32=5]="Bit32";let BinaryWriter=class BinaryWriter{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),r=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],r),r+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(assertUInt32(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return assertInt32(e),varint32write(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){assertFloat32(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){assertUInt32(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){assertInt32(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return assertInt32(e),varint32write(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),n=eb.enc(e);return r.setInt32(0,n.lo,!0),r.setInt32(4,n.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),n=eb.uEnc(e);return r.setInt32(0,n.lo,!0),r.setInt32(4,n.hi,!0),this.raw(t)}int64(e){let t=eb.enc(e);return varint64write(t.lo,t.hi,this.buf),this}sint64(e){let t=eb.enc(e),r=t.hi>>31;return varint64write(t.lo<<1^r,(t.hi<<1|t.lo>>>31)^r,this.buf),this}uint64(e){let t=eb.uEnc(e);return varint64write(t.lo,t.hi,this.buf),this}};let BinaryReader=class BinaryReader{constructor(e,t){this.varint64=varint64read,this.uint32=varint32read,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=7&e;if(t<=0||r<0||r>5)throw Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e){let t=this.pos;switch(e){case K.Varint:for(;128&this.buf[this.pos++];);break;case K.Bit64:this.pos+=4;case K.Bit32:this.pos+=4;break;case K.LengthDelimited:let r=this.uint32();this.pos+=r;break;case K.StartGroup:let n;for(;(n=this.tag()[1])!==K.EndGroup;)this.skip(n);break;default:throw Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return eb.dec(...this.varint64())}uint64(){return eb.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(1&e);return e=(e>>>1|(1&t)<<31)^r,t=t>>>1^r,eb.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return eb.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return eb.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}};function wrapField(e,t){return t instanceof Message||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}let eE={"google.protobuf.DoubleValue":G.DOUBLE,"google.protobuf.FloatValue":G.FLOAT,"google.protobuf.Int64Value":G.INT64,"google.protobuf.UInt64Value":G.UINT64,"google.protobuf.Int32Value":G.INT32,"google.protobuf.UInt32Value":G.UINT32,"google.protobuf.BoolValue":G.BOOL,"google.protobuf.StringValue":G.STRING,"google.protobuf.BytesValue":G.BYTES};function scalarEquals(e,t,r){if(t===r)return!0;if(e==G.BYTES){if(!(t instanceof Uint8Array)||!(r instanceof Uint8Array)||t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==r[e])return!1;return!0}switch(e){case G.UINT64:case G.FIXED64:case G.INT64:case G.SFIXED64:case G.SINT64:return t==r}return!1}function scalarDefaultValue(e,t){switch(e){case G.BOOL:return!1;case G.UINT64:case G.FIXED64:case G.INT64:case G.SFIXED64:case G.SINT64:return 0==t?eb.zero:"0";case G.DOUBLE:case G.FLOAT:return 0;case G.BYTES:return new Uint8Array(0);case G.STRING:return"";default:return 0}}function scalarTypeInfo(e,t){let r=void 0===t,n=K.Varint,i=0===t;switch(e){case G.STRING:i=r||!t.length,n=K.LengthDelimited;break;case G.BOOL:i=!1===t;break;case G.DOUBLE:n=K.Bit64;break;case G.FLOAT:n=K.Bit32;break;case G.INT64:case G.UINT64:i=r||0==t;break;case G.FIXED64:i=r||0==t,n=K.Bit64;break;case G.BYTES:i=r||!t.byteLength,n=K.LengthDelimited;break;case G.FIXED32:case G.SFIXED32:n=K.Bit32;break;case G.SFIXED64:i=r||0==t,n=K.Bit64;break;case G.SINT64:i=r||0==t}let o=G[e].toLowerCase();return[n,o,r||i]}let eI=Symbol("@bufbuild/protobuf/unknown-fields"),eN={readUnknownFields:!0,readerFactory:e=>new BinaryReader(e)},e_={writeUnknownFields:!0,writerFactory:()=>new BinaryWriter};function makeReadOptions$1(e){return e?Object.assign(Object.assign({},eN),e):eN}function makeWriteOptions$1(e){return e?Object.assign(Object.assign({},e_),e):e_}function makeBinaryFormatCommon(){return{makeReadOptions:makeReadOptions$1,makeWriteOptions:makeWriteOptions$1,listUnknownFields(e){var t;return null!==(t=e[eI])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[eI]},writeUnknownFields(e,t){let r=e[eI];if(r)for(let e of r)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,r,n){Array.isArray(e[eI])||(e[eI]=[]),e[eI].push({no:t,wireType:r,data:n})},readMessage(e,t,r,n,i){let o,s;let a=e.getType(),l=i?t.len:t.pos+r;for(;t.pos<l&&([o,s]=t.tag(),s!=K.EndGroup);){let r=a.fields.find(o);if(!r){let r=t.skip(s);n.readUnknownFields&&this.onUnknownField(e,o,s,r);continue}let i=e,l=r.repeated,u=r.localName;switch(r.oneof&&((i=i[r.oneof.localName]).case!=u&&delete i.value,i.case=u,u="value"),r.kind){case"scalar":case"enum":let d="enum"==r.kind?G.INT32:r.T,c=readScalar$1;if("scalar"==r.kind&&r.L>0&&(c=readScalarLTString),l){let e=i[u];if(s==K.LengthDelimited&&d!=G.STRING&&d!=G.BYTES){let r=t.uint32()+t.pos;for(;t.pos<r;)e.push(c(t,d))}else e.push(c(t,d))}else i[u]=c(t,d);break;case"message":let h=r.T;l?i[u].push(readMessageField(t,new h,n,r)):i[u]instanceof Message?readMessageField(t,i[u],n,r):(i[u]=readMessageField(t,new h,n,r),!h.fieldWrapper||r.oneof||r.repeated||(i[u]=h.fieldWrapper.unwrapField(i[u])));break;case"map":let[m,p]=function(e,t,r){let n,i;let o=t.uint32(),s=t.pos+o;for(;t.pos<s;){let[o]=t.tag();switch(o){case 1:n=readScalar$1(t,e.K);break;case 2:switch(e.V.kind){case"scalar":i=readScalar$1(t,e.V.T);break;case"enum":i=t.int32();break;case"message":i=readMessageField(t,new e.V.T,r,void 0)}}}if(void 0===n){let t=scalarDefaultValue(e.K,Y.BIGINT);n=e.K==G.BOOL?t.toString():t}if("string"!=typeof n&&"number"!=typeof n&&(n=n.toString()),void 0===i)switch(e.V.kind){case"scalar":i=scalarDefaultValue(e.V.T,Y.BIGINT);break;case"enum":i=0;break;case"message":i=new e.V.T}return[n,i]}(r,t,n);i[u][m]=p}}if(i&&(s!=K.EndGroup||o!==r))throw Error("invalid end group tag")}}}function readMessageField(e,t,r,n){let i=t.getType().runtime.bin,o=null==n?void 0:n.delimited;return i.readMessage(t,e,o?null==n?void 0:n.no:e.uint32(),r,o),t}function readScalarLTString(e,t){let r=readScalar$1(e,t);return"bigint"==typeof r?r.toString():r}function readScalar$1(e,t){switch(t){case G.STRING:return e.string();case G.BOOL:return e.bool();case G.DOUBLE:return e.double();case G.FLOAT:return e.float();case G.INT32:return e.int32();case G.INT64:return e.int64();case G.UINT64:return e.uint64();case G.FIXED64:return e.fixed64();case G.BYTES:return e.bytes();case G.FIXED32:return e.fixed32();case G.SFIXED32:return e.sfixed32();case G.SFIXED64:return e.sfixed64();case G.SINT64:return e.sint64();case G.UINT32:return e.uint32();case G.SINT32:return e.sint32()}}function writeMapEntry(e,t,r,n,i){e.tag(r.no,K.LengthDelimited),e.fork();let o=n;switch(r.K){case G.INT32:case G.FIXED32:case G.UINT32:case G.SFIXED32:case G.SINT32:o=Number.parseInt(n);break;case G.BOOL:assert("true"==n||"false"==n),o="true"==n}switch(writeScalar$1(e,r.K,1,o,!0),r.V.kind){case"scalar":writeScalar$1(e,r.V.T,2,i,!0);break;case"enum":writeScalar$1(e,G.INT32,2,i,!0);break;case"message":e.tag(2,K.LengthDelimited).bytes(i.toBinary(t))}e.join()}function writeMessageField(e,t,r,n){if(void 0!==n){let i=wrapField(r.T,n);(null==r?void 0:r.delimited)?e.tag(r.no,K.StartGroup).raw(i.toBinary(t)).tag(r.no,K.EndGroup):e.tag(r.no,K.LengthDelimited).bytes(i.toBinary(t))}}function writeScalar$1(e,t,r,n,i){let[o,s,a]=scalarTypeInfo(t,n);(!a||i)&&e.tag(r,o)[s](n)}function writePacked(e,t,r,n){if(!n.length)return;e.tag(r,K.LengthDelimited).fork();let[,i]=scalarTypeInfo(t);for(let t=0;t<n.length;t++)e[i](n[t]);e.join()}let eO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),ek=[];for(let e=0;e<eO.length;e++)ek[eO[e].charCodeAt(0)]=e;ek["-".charCodeAt(0)]=eO.indexOf("+"),ek["_".charCodeAt(0)]=eO.indexOf("/");let eD={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let r=new Uint8Array(t),n=0,i=0,o,s=0;for(let t=0;t<e.length;t++){if(void 0===(o=ek[e.charCodeAt(t)]))switch(e[t]){case"=":i=0;case"\n":case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=o,i=1;break;case 1:r[n++]=s<<2|(48&o)>>4,s=o,i=2;break;case 2:r[n++]=(15&s)<<4|(60&o)>>2,s=o,i=3;break;case 3:r[n++]=(3&s)<<6|o,i=0}}if(1==i)throw Error("invalid base64 string.");return r.subarray(0,n)},enc(e){let t="",r=0,n,i=0;for(let o=0;o<e.length;o++)switch(n=e[o],r){case 0:t+=eO[n>>2],i=(3&n)<<4,r=1;break;case 1:t+=eO[i|n>>4],i=(15&n)<<2,r=2;break;case 2:t+=eO[i|n>>6]+eO[63&n],r=0}return r&&(t+=eO[i]+"=",1==r&&(t+="=")),t}},eA={ignoreUnknownFields:!1},eP={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function makeReadOptions(e){return e?Object.assign(Object.assign({},eA),e):eA}function makeWriteOptions(e){return e?Object.assign(Object.assign({},eP),e):eP}function makeJsonFormatCommon(e){let t=e(writeEnum,writeScalar);return{makeReadOptions,makeWriteOptions,readMessage(e,t,r,n){if(null==t||Array.isArray(t)||"object"!=typeof t)throw Error(`cannot decode message ${e.typeName} from JSON: ${this.debug(t)}`);n=null!=n?n:new e;let i={};for(let[o,s]of Object.entries(t)){let t=e.fields.findJsonName(o);if(!t){if(!r.ignoreUnknownFields)throw Error(`cannot decode message ${e.typeName} from JSON: key "${o}" is unknown`);continue}let a=t.localName,l=n;if(t.oneof){if(null===s&&"scalar"==t.kind)continue;let r=i[t.oneof.localName];if(r)throw Error(`cannot decode message ${e.typeName} from JSON: multiple keys for oneof "${t.oneof.name}" present: "${r}", "${o}"`);i[t.oneof.localName]=o,l=l[t.oneof.localName]={case:a},a="value"}if(t.repeated){if(null===s)continue;if(!Array.isArray(s))throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`);let n=l[a];for(let i of s){let o;if(null===i)throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(i)}`);switch(t.kind){case"message":o=t.T.fromJson(i,r);break;case"enum":if(void 0===(o=readEnum(t.T,i,r.ignoreUnknownFields)))continue;break;case"scalar":try{o=readScalar(t.T,i,t.L)}catch(n){let r=`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(i)}`;throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),Error(r)}}n.push(o)}}else if("map"==t.kind){if(null===s)continue;if(Array.isArray(s)||"object"!=typeof s)throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`);let n=l[a];for(let[i,o]of Object.entries(s)){let a;if(null===o)throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: map value null`);switch(t.V.kind){case"message":a=t.V.T.fromJson(o,r);break;case"enum":if(void 0===(a=readEnum(t.V.T,o,r.ignoreUnknownFields)))continue;break;case"scalar":try{a=readScalar(t.V.T,o,Y.BIGINT)}catch(n){let r=`cannot decode map value for field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`;throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),Error(r)}}try{n[readScalar(t.K,t.K==G.BOOL?"true"==i||"false"!=i&&i:i,Y.BIGINT).toString()]=a}catch(n){let r=`cannot decode map key for field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`;throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),Error(r)}}}else switch(t.kind){case"message":let u=t.T;if(null===s&&"google.protobuf.Value"!=u.typeName){if(t.oneof)throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: null is invalid for oneof field "${o}"`);continue}l[a]instanceof Message?l[a].fromJson(s,r):(l[a]=u.fromJson(s,r),u.fieldWrapper&&!t.oneof&&(l[a]=u.fieldWrapper.unwrapField(l[a])));break;case"enum":let d=readEnum(t.T,s,r.ignoreUnknownFields);void 0!==d&&(l[a]=d);break;case"scalar":try{l[a]=readScalar(t.T,s,t.L)}catch(n){let r=`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`;throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),Error(r)}}}return n},writeMessage(e,r){let n;let i=e.getType(),o={};try{for(let s of i.fields.byMember()){let i;if("oneof"==s.kind){let o=e[s.localName];if(void 0===o.value)continue;if(!(n=s.findField(o.case)))throw"oneof case not found: "+o.case;i=t(n,o.value,r)}else n=s,i=t(n,e[n.localName],r);void 0!==i&&(o[r.useProtoFieldName?n.name:n.jsonName]=i)}}catch(r){let e=n?`cannot encode field ${i.typeName}.${n.name} to JSON`:`cannot encode message ${i.typeName} to JSON`,t=r instanceof Error?r.message:String(r);throw Error(e+(t.length>0?`: ${t}`:""))}return o},readScalar,writeScalar,debug:debugJsonValue}}function debugJsonValue(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":`"${e.split('"').join('\\"')}"`;default:return String(e)}}function readScalar(e,t,r){switch(e){case G.DOUBLE:case G.FLOAT:if(null===t)return 0;if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t||"string"==typeof t&&t.trim().length!==t.length||"string"!=typeof t&&"number"!=typeof t)break;let n=Number(t);if(Number.isNaN(n)||!Number.isFinite(n))break;return e==G.FLOAT&&assertFloat32(n),n;case G.INT32:case G.FIXED32:case G.SFIXED32:case G.SINT32:case G.UINT32:let i;if(null===t)return 0;if("number"==typeof t?i=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(i=Number(t)),void 0===i)break;return e==G.UINT32?assertUInt32(i):assertInt32(i),i;case G.INT64:case G.SFIXED64:case G.SINT64:if(null===t)return eb.zero;if("number"!=typeof t&&"string"!=typeof t)break;let o=eb.parse(t);return r?o.toString():o;case G.FIXED64:case G.UINT64:if(null===t)return eb.zero;if("number"!=typeof t&&"string"!=typeof t)break;let s=eb.uParse(t);return r?s.toString():s;case G.BOOL:if(null===t)return!1;if("boolean"!=typeof t)break;return t;case G.STRING:if(null===t)return"";if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw Error("invalid UTF8")}return t;case G.BYTES:if(null===t||""===t)return new Uint8Array(0);if("string"!=typeof t)break;return eD.dec(t)}throw Error()}function readEnum(e,t,r){if(null===t)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":let n=e.findName(t);if(n||r)return null==n?void 0:n.no}throw Error(`cannot decode enum ${e.typeName} from JSON: ${debugJsonValue(t)}`)}function writeEnum(e,t,r,n){var i;if(void 0===t)return t;if(0===t&&!r)return;if(n)return t;if("google.protobuf.NullValue"==e.typeName)return null;let o=e.findNumber(t);return null!==(i=null==o?void 0:o.name)&&void 0!==i?i:t}function writeScalar(e,t,r){if(void 0!==t)switch(e){case G.INT32:case G.SFIXED32:case G.SINT32:case G.FIXED32:case G.UINT32:return assert("number"==typeof t),0!=t||r?t:void 0;case G.FLOAT:case G.DOUBLE:if(assert("number"==typeof t),Number.isNaN(t))return"NaN";if(t===Number.POSITIVE_INFINITY)return"Infinity";if(t===Number.NEGATIVE_INFINITY)return"-Infinity";return 0!==t||r?t:void 0;case G.STRING:return assert("string"==typeof t),t.length>0||r?t:void 0;case G.BOOL:return assert("boolean"==typeof t),t||r?t:void 0;case G.UINT64:case G.FIXED64:case G.INT64:case G.SFIXED64:case G.SINT64:return assert("bigint"==typeof t||"string"==typeof t||"number"==typeof t),r||0!=t?t.toString(10):void 0;case G.BYTES:return assert(t instanceof Uint8Array),r||t.byteLength>0?eD.enc(t):void 0}}function makeUtilCommon(){return{setEnumType,initPartial(e,t){if(void 0===e)return;let r=t.getType();for(let n of r.fields.byMember()){let r=n.localName;if(void 0!==e[r])switch(n.kind){case"oneof":let i=e[r].case;if(void 0===i)continue;let o=n.findField(i),s=e[r].value;!o||"message"!=o.kind||s instanceof o.T?o&&"scalar"===o.kind&&o.T===G.BYTES&&(s=toU8Arr(s)):s=new o.T(s),t[r]={case:i,value:s};break;case"scalar":case"enum":let a=e[r];n.T===G.BYTES&&(a=n.repeated?a.map(toU8Arr):toU8Arr(a)),t[r]=a;break;case"map":switch(n.V.kind){case"scalar":case"enum":if(n.V.T===G.BYTES)for(let[n,i]of Object.entries(e[r]))t[r][n]=toU8Arr(i);else Object.assign(t[r],e[r]);break;case"message":let l=n.V.T;for(let n of Object.keys(e[r])){let i=e[r][n];l.fieldWrapper||(i=new l(i)),t[r][n]=i}}break;case"message":let u=n.T;if(n.repeated)t[r]=e[r].map(e=>e instanceof u?e:new u(e));else if(void 0!==e[r]){let n=e[r];u.fieldWrapper?"google.protobuf.BytesValue"===u.typeName?t[r]=toU8Arr(n):t[r]=n:t[r]=n instanceof u?n:new u(n)}}}},equals:(e,t,r)=>t===r||!!t&&!!r&&e.fields.byMember().every(e=>{let n=t[e.localName],i=r[e.localName];if(e.repeated){if(n.length!==i.length)return!1;switch(e.kind){case"message":return n.every((t,r)=>e.T.equals(t,i[r]));case"scalar":return n.every((t,r)=>scalarEquals(e.T,t,i[r]));case"enum":return n.every((e,t)=>scalarEquals(G.INT32,e,i[t]))}throw Error(`repeated cannot contain ${e.kind}`)}switch(e.kind){case"message":return e.T.equals(n,i);case"enum":return scalarEquals(G.INT32,n,i);case"scalar":return scalarEquals(e.T,n,i);case"oneof":if(n.case!==i.case)return!1;let o=e.findField(n.case);if(void 0===o)return!0;switch(o.kind){case"message":return o.T.equals(n.value,i.value);case"enum":return scalarEquals(G.INT32,n.value,i.value);case"scalar":return scalarEquals(o.T,n.value,i.value)}throw Error(`oneof cannot contain ${o.kind}`);case"map":let s=Object.keys(n).concat(Object.keys(i));switch(e.V.kind){case"message":let a=e.V.T;return s.every(e=>a.equals(n[e],i[e]));case"enum":return s.every(e=>scalarEquals(G.INT32,n[e],i[e]));case"scalar":let l=e.V.T;return s.every(e=>scalarEquals(l,n[e],i[e]))}}}),clone(e){let t=e.getType(),r=new t;for(let n of t.fields.byMember()){let t;let i=e[n.localName];if(n.repeated)t=i.map(cloneSingularField);else if("map"==n.kind)for(let[e,o]of(t=r[n.localName],Object.entries(i)))t[e]=cloneSingularField(o);else if("oneof"==n.kind){let e=n.findField(i.case);t=e?{case:i.case,value:cloneSingularField(i.value)}:{case:void 0}}else t=cloneSingularField(i);r[n.localName]=t}return r}}}function cloneSingularField(e){if(void 0===e)return e;if(e instanceof Message)return e.clone();if(e instanceof Uint8Array){let t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function toU8Arr(e){return e instanceof Uint8Array?e:new Uint8Array(e)}let InternalFieldList=class InternalFieldList{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){let e={};for(let t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){let e={};for(let t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){let e;this.members=[];let t=this.members;for(let r of this.list())r.oneof?r.oneof!==e&&(e=r.oneof,t.push(e)):t.push(r)}return this.members}};function localName(e){switch(e.kind){case"field":return localFieldName(e.name,void 0!==e.oneof);case"oneof":var t;return localFieldName(e.name,!1);case"enum":case"message":case"service":{let t=e.file.proto.package,r=void 0===t?0:t.length+1,n=e.typeName.substring(r).replace(/\./g,"_");return safeObjectProperty(safeIdentifier(n))}case"enum_value":{let t=e.parent.sharedPrefix;if(void 0===t)return e.name;let r=e.name.substring(t.length);return safeObjectProperty(r)}case"rpc":{let t=e.name;if(0==t.length)return t;return safeObjectProperty(t=t[0].toLowerCase()+t.substring(1))}}}function localFieldName(e,t){let r=protoCamelCase(e);return t?r:safeObjectProperty(safeMessageProperty(r))}let ew=protoCamelCase;function protoCamelCase(e){let t=!1,r=[];for(let n=0;n<e.length;n++){let i=e.charAt(n);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),r.push(i)}}return r.join("")}let eC=new Set(["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","enum","implements","interface","let","package","private","protected","public","static","Object","bigint","number","boolean","string","object","globalThis","Uint8Array","Partial"]),ex=new Set(["constructor","toString","toJSON","valueOf"]),eR=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),fallback=e=>`${e}$`,safeMessageProperty=e=>eR.has(e)?fallback(e):e,safeObjectProperty=e=>ex.has(e)?fallback(e):e,safeIdentifier=e=>eC.has(e)?fallback(e):e;let InternalOneofInfo=class InternalOneofInfo{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=localFieldName(e,!1)}addField(e){assert(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}};let eF=makeProtoRuntime("proto3",makeJsonFormatCommon((e,t)=>function(r,n,i){if("map"==r.kind){let o={};switch(r.V.kind){case"scalar":for(let[e,i]of Object.entries(n)){let n=t(r.V.T,i,!0);assert(void 0!==n),o[e.toString()]=n}break;case"message":for(let[e,t]of Object.entries(n))o[e.toString()]=t.toJson(i);break;case"enum":let s=r.V.T;for(let[t,r]of Object.entries(n)){assert(void 0===r||"number"==typeof r);let n=e(s,r,!0,i.enumAsInteger);assert(void 0!==n),o[t.toString()]=n}}return i.emitDefaultValues||Object.keys(o).length>0?o:void 0}if(r.repeated){let o=[];switch(r.kind){case"scalar":for(let e=0;e<n.length;e++)o.push(t(r.T,n[e],!0));break;case"enum":for(let t=0;t<n.length;t++)o.push(e(r.T,n[t],!0,i.enumAsInteger));break;case"message":for(let e=0;e<n.length;e++)o.push(wrapField(r.T,n[e]).toJson(i))}return i.emitDefaultValues||o.length>0?o:void 0}switch(r.kind){case"scalar":return t(r.T,n,!!r.oneof||r.opt||i.emitDefaultValues);case"enum":return e(r.T,n,!!r.oneof||r.opt||i.emitDefaultValues,i.enumAsInteger);case"message":return void 0!==n?wrapField(r.T,n).toJson(i):void 0}}),Object.assign(Object.assign({},makeBinaryFormatCommon()),{writeMessage(e,t,r){let n=e.getType();for(let i of n.fields.byNumber()){let n,o=i.repeated,s=i.localName;if(i.oneof){let t=e[i.oneof.localName];if(t.case!==s)continue;n=t.value}else n=e[s];switch(i.kind){case"scalar":case"enum":let a="enum"==i.kind?G.INT32:i.T;if(o){if(i.packed)writePacked(t,a,i.no,n);else for(let e of n)writeScalar$1(t,a,i.no,e,!0)}else void 0!==n&&writeScalar$1(t,a,i.no,n,!!i.oneof||i.opt);break;case"message":if(o)for(let e of n)writeMessageField(t,r,i,e);else writeMessageField(t,r,i,n);break;case"map":for(let[e,o]of Object.entries(n))writeMapEntry(t,r,i,e,o)}}return r.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),Object.assign(Object.assign({},makeUtilCommon()),{newFieldList:e=>new InternalFieldList(e,normalizeFieldInfosProto3),initFields(e){for(let t of e.getType().fields.byMember()){if(t.opt)continue;let r=t.localName;if(t.repeated){e[r]=[];continue}switch(t.kind){case"oneof":e[r]={case:void 0};break;case"enum":e[r]=0;break;case"map":e[r]={};break;case"scalar":e[r]=scalarDefaultValue(t.T,t.L)}}}}));function normalizeFieldInfosProto3(e){var t,r,n,i;let o;let s=[];for(let a of"function"==typeof e?e():e){if(a.localName=localFieldName(a.name,void 0!==a.oneof),a.jsonName=null!==(t=a.jsonName)&&void 0!==t?t:ew(a.name),a.repeated=null!==(r=a.repeated)&&void 0!==r&&r,"scalar"==a.kind&&(a.L=null!==(n=a.L)&&void 0!==n?n:Y.BIGINT),void 0!==a.oneof){let e="string"==typeof a.oneof?a.oneof:a.oneof.name;o&&o.name==e||(o=new InternalOneofInfo(e)),a.oneof=o,o.addField(a)}"message"==a.kind&&(a.delimited=!1),a.packed=null!==(i=a.packed)&&void 0!==i?i:"enum"==a.kind||"scalar"==a.kind&&a.T!=G.BYTES&&a.T!=G.STRING,s.push(a)}return s}let eL=makeProtoRuntime("proto2",makeJsonFormatCommon((e,t)=>function(r,n,i){if("map"==r.kind){let o={};switch(r.V.kind){case"scalar":for(let[e,i]of Object.entries(n)){let n=t(r.V.T,i,!0);assert(void 0!==n),o[e.toString()]=n}break;case"message":for(let[e,t]of Object.entries(n))o[e.toString()]=t.toJson(i);break;case"enum":let s=r.V.T;for(let[t,r]of Object.entries(n)){assert(void 0===r||"number"==typeof r);let n=e(s,r,!0,i.enumAsInteger);assert(void 0!==n),o[t.toString()]=n}}return i.emitDefaultValues||Object.keys(o).length>0?o:void 0}if(r.repeated){let o=[];switch(r.kind){case"scalar":for(let e=0;e<n.length;e++)o.push(t(r.T,n[e],!0));break;case"enum":for(let t=0;t<n.length;t++)o.push(e(r.T,n[t],!0,i.enumAsInteger));break;case"message":for(let e=0;e<n.length;e++)o.push(n[e].toJson(i))}return i.emitDefaultValues||o.length>0?o:void 0}if(void 0===n){if(!r.oneof&&!r.opt)throw"required field not set";return}switch(r.kind){case"scalar":return t(r.T,n,!0);case"enum":return e(r.T,n,!0,i.enumAsInteger);case"message":return wrapField(r.T,n).toJson(i)}}),Object.assign(Object.assign({},makeBinaryFormatCommon()),{writeMessage(e,t,r){let n;let i=e.getType();try{for(n of i.fields.byNumber()){let o,s=n.repeated,a=n.localName;if(n.oneof){let t=e[n.oneof.localName];if(t.case!==a)continue;o=t.value}else if(o=e[a],void 0===o&&!n.oneof&&!n.opt)throw Error(`cannot encode field ${i.typeName}.${n.name} to binary: required field not set`);switch(n.kind){case"scalar":case"enum":let l="enum"==n.kind?G.INT32:n.T;if(s){if(n.packed)writePacked(t,l,n.no,o);else for(let e of o)writeScalar$1(t,l,n.no,e,!0)}else void 0!==o&&writeScalar$1(t,l,n.no,o,!0);break;case"message":if(s)for(let e of o)writeMessageField(t,r,n,e);else writeMessageField(t,r,n,o);break;case"map":for(let[e,i]of Object.entries(o))writeMapEntry(t,r,n,e,i)}}}catch(r){let e=n?`cannot encode field ${i.typeName}.${null==n?void 0:n.name} to binary`:`cannot encode message ${i.typeName} to binary`,t=r instanceof Error?r.message:String(r);throw Error(e+(t.length>0?`: ${t}`:""))}return r.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),Object.assign(Object.assign({},makeUtilCommon()),{newFieldList:e=>new InternalFieldList(e,normalizeFieldInfosProto2),initFields(e){for(let t of e.getType().fields.byMember()){let r=t.localName;if(t.repeated){e[r]=[];continue}switch(t.kind){case"oneof":e[r]={case:void 0};break;case"map":e[r]={}}}}}));function normalizeFieldInfosProto2(e){var t,r,n,i,o;let s;let a=[];for(let l of"function"==typeof e?e():e){if(l.localName=localFieldName(l.name,void 0!==l.oneof),l.jsonName=null!==(t=l.jsonName)&&void 0!==t?t:ew(l.name),l.repeated=null!==(r=l.repeated)&&void 0!==r&&r,"scalar"==l.kind&&(l.L=null!==(n=l.L)&&void 0!==n?n:Y.BIGINT),void 0!==l.oneof){let e="string"==typeof l.oneof?l.oneof:l.oneof.name;s&&s.name==e||(s=new InternalOneofInfo(e)),l.oneof=s,s.addField(l)}"message"==l.kind&&(l.delimited=null!==(i=l.delimited)&&void 0!==i&&i),l.packed=null!==(o=l.packed)&&void 0!==o&&o,a.push(l)}return a}let eM={NaN:Number.NaN,POSITIVE_INFINITY:Number.POSITIVE_INFINITY,NEGATIVE_INFINITY:Number.NEGATIVE_INFINITY};var eB=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},eJ=globalThis&&globalThis.__await||function(e){return this instanceof eJ?(this.v=e,this):new eJ(e)},eV=globalThis&&globalThis.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},verb("next"),verb("throw"),verb("return",function(e){return function(t){return Promise.resolve(t).then(e,reject)}}),n[Symbol.asyncIterator]=function(){return this},n;function verb(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||resume(e,t)})},t&&(n[e]=t(n[e])))}function resume(e,t){try{var r;(r=i[e](t)).value instanceof eJ?Promise.resolve(r.value.v).then(fulfill,reject):settle(o[0][2],r)}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}};let eU={enc(e,t){let r=makeBinaryFormatCommon().makeWriteOptions(t);return r.writerFactory().bytes(e.toBinary(r)).finish()},dec(e,t,r){let n=makeBinaryFormatCommon().makeReadOptions(r);return e.fromBinary(n.readerFactory(t).bytes(),n)},decStream(e,t){return eV(this,arguments,function*(){var r,n,i,o;let s=new Uint8Array(0);try{for(var a,l=!0,u=eB(t);!(r=(a=yield eJ(u.next())).done);l=!0)for(o=a.value,l=!1,s=function(e,t){let r=new Uint8Array(e.byteLength+t.byteLength);return r.set(e),r.set(t,e.length),r}(s,o);;){let t=eU.peekSize(s);if(t.eof||t.offset+t.size>s.byteLength)break;yield yield eJ(eU.dec(e,s)),s=s.subarray(t.offset+t.size)}}catch(e){n={error:e}}finally{try{!l&&!r&&(i=u.return)&&(yield eJ(i.call(u)))}finally{if(n)throw n.error}}if(s.byteLength>0)throw Error("incomplete data")})},peekSize(e){let t={eof:!0,size:null,offset:null};for(let r=0;r<10;r++){if(r>e.byteLength)return t;if((128&e[r])==0){let r;let n=new BinaryReader(e);try{r=n.uint32()}catch(e){if(e instanceof RangeError)return t;throw e}return{eof:!1,size:r,offset:n.pos}}}throw Error("invalid varint")}},ej="@bufbuild/protobuf";(s=z||(z={}))[s.Unary=0]="Unary",s[s.ServerStreaming=1]="ServerStreaming",s[s.ClientStreaming=2]="ClientStreaming",s[s.BiDiStreaming=3]="BiDiStreaming",(a=W||(W={}))[a.NoSideEffects=1]="NoSideEffects",a[a.Idempotent=2]="Idempotent",(l=H||(H={}))[l.EDITION_UNKNOWN=0]="EDITION_UNKNOWN",l[l.EDITION_PROTO2=998]="EDITION_PROTO2",l[l.EDITION_PROTO3=999]="EDITION_PROTO3",l[l.EDITION_2023=1e3]="EDITION_2023",l[l.EDITION_1_TEST_ONLY=1]="EDITION_1_TEST_ONLY",l[l.EDITION_2_TEST_ONLY=2]="EDITION_2_TEST_ONLY",l[l.EDITION_99997_TEST_ONLY=99997]="EDITION_99997_TEST_ONLY",l[l.EDITION_99998_TEST_ONLY=99998]="EDITION_99998_TEST_ONLY",l[l.EDITION_99999_TEST_ONLY=99999]="EDITION_99999_TEST_ONLY",eL.util.setEnumType(H,"google.protobuf.Edition",[{no:0,name:"EDITION_UNKNOWN"},{no:998,name:"EDITION_PROTO2"},{no:999,name:"EDITION_PROTO3"},{no:1e3,name:"EDITION_2023"},{no:1,name:"EDITION_1_TEST_ONLY"},{no:2,name:"EDITION_2_TEST_ONLY"},{no:99997,name:"EDITION_99997_TEST_ONLY"},{no:99998,name:"EDITION_99998_TEST_ONLY"},{no:99999,name:"EDITION_99999_TEST_ONLY"}]);let FileDescriptorSet=class FileDescriptorSet extends Message{constructor(e){super(),this.file=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new FileDescriptorSet().fromBinary(e,t)}static fromJson(e,t){return new FileDescriptorSet().fromJson(e,t)}static fromJsonString(e,t){return new FileDescriptorSet().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FileDescriptorSet,e,t)}};FileDescriptorSet.runtime=eL,FileDescriptorSet.typeName="google.protobuf.FileDescriptorSet",FileDescriptorSet.fields=eL.util.newFieldList(()=>[{no:1,name:"file",kind:"message",T:FileDescriptorProto,repeated:!0}]);let FileDescriptorProto=class FileDescriptorProto extends Message{constructor(e){super(),this.dependency=[],this.publicDependency=[],this.weakDependency=[],this.messageType=[],this.enumType=[],this.service=[],this.extension=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new FileDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new FileDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new FileDescriptorProto().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FileDescriptorProto,e,t)}};FileDescriptorProto.runtime=eL,FileDescriptorProto.typeName="google.protobuf.FileDescriptorProto",FileDescriptorProto.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"package",kind:"scalar",T:9,opt:!0},{no:3,name:"dependency",kind:"scalar",T:9,repeated:!0},{no:10,name:"public_dependency",kind:"scalar",T:5,repeated:!0},{no:11,name:"weak_dependency",kind:"scalar",T:5,repeated:!0},{no:4,name:"message_type",kind:"message",T:DescriptorProto,repeated:!0},{no:5,name:"enum_type",kind:"message",T:EnumDescriptorProto,repeated:!0},{no:6,name:"service",kind:"message",T:ServiceDescriptorProto,repeated:!0},{no:7,name:"extension",kind:"message",T:FieldDescriptorProto,repeated:!0},{no:8,name:"options",kind:"message",T:FileOptions,opt:!0},{no:9,name:"source_code_info",kind:"message",T:SourceCodeInfo,opt:!0},{no:12,name:"syntax",kind:"scalar",T:9,opt:!0},{no:14,name:"edition",kind:"enum",T:eL.getEnumType(H),opt:!0}]);let DescriptorProto=class DescriptorProto extends Message{constructor(e){super(),this.field=[],this.extension=[],this.nestedType=[],this.enumType=[],this.extensionRange=[],this.oneofDecl=[],this.reservedRange=[],this.reservedName=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new DescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new DescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new DescriptorProto().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(DescriptorProto,e,t)}};DescriptorProto.runtime=eL,DescriptorProto.typeName="google.protobuf.DescriptorProto",DescriptorProto.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"field",kind:"message",T:FieldDescriptorProto,repeated:!0},{no:6,name:"extension",kind:"message",T:FieldDescriptorProto,repeated:!0},{no:3,name:"nested_type",kind:"message",T:DescriptorProto,repeated:!0},{no:4,name:"enum_type",kind:"message",T:EnumDescriptorProto,repeated:!0},{no:5,name:"extension_range",kind:"message",T:DescriptorProto_ExtensionRange,repeated:!0},{no:8,name:"oneof_decl",kind:"message",T:OneofDescriptorProto,repeated:!0},{no:7,name:"options",kind:"message",T:MessageOptions,opt:!0},{no:9,name:"reserved_range",kind:"message",T:DescriptorProto_ReservedRange,repeated:!0},{no:10,name:"reserved_name",kind:"scalar",T:9,repeated:!0}]);let DescriptorProto_ExtensionRange=class DescriptorProto_ExtensionRange extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new DescriptorProto_ExtensionRange().fromBinary(e,t)}static fromJson(e,t){return new DescriptorProto_ExtensionRange().fromJson(e,t)}static fromJsonString(e,t){return new DescriptorProto_ExtensionRange().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(DescriptorProto_ExtensionRange,e,t)}};DescriptorProto_ExtensionRange.runtime=eL,DescriptorProto_ExtensionRange.typeName="google.protobuf.DescriptorProto.ExtensionRange",DescriptorProto_ExtensionRange.fields=eL.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0},{no:3,name:"options",kind:"message",T:ExtensionRangeOptions,opt:!0}]);let DescriptorProto_ReservedRange=class DescriptorProto_ReservedRange extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new DescriptorProto_ReservedRange().fromBinary(e,t)}static fromJson(e,t){return new DescriptorProto_ReservedRange().fromJson(e,t)}static fromJsonString(e,t){return new DescriptorProto_ReservedRange().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(DescriptorProto_ReservedRange,e,t)}};DescriptorProto_ReservedRange.runtime=eL,DescriptorProto_ReservedRange.typeName="google.protobuf.DescriptorProto.ReservedRange",DescriptorProto_ReservedRange.fields=eL.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0}]);let ExtensionRangeOptions=class ExtensionRangeOptions extends Message{constructor(e){super(),this.uninterpretedOption=[],this.declaration=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new ExtensionRangeOptions().fromBinary(e,t)}static fromJson(e,t){return new ExtensionRangeOptions().fromJson(e,t)}static fromJsonString(e,t){return new ExtensionRangeOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(ExtensionRangeOptions,e,t)}};ExtensionRangeOptions.runtime=eL,ExtensionRangeOptions.typeName="google.protobuf.ExtensionRangeOptions",ExtensionRangeOptions.fields=eL.util.newFieldList(()=>[{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0},{no:2,name:"declaration",kind:"message",T:ExtensionRangeOptions_Declaration,repeated:!0},{no:50,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:3,name:"verification",kind:"enum",T:eL.getEnumType(X),opt:!0,default:X.UNVERIFIED}]),(u=X||(X={}))[u.DECLARATION=0]="DECLARATION",u[u.UNVERIFIED=1]="UNVERIFIED",eL.util.setEnumType(X,"google.protobuf.ExtensionRangeOptions.VerificationState",[{no:0,name:"DECLARATION"},{no:1,name:"UNVERIFIED"}]);let ExtensionRangeOptions_Declaration=class ExtensionRangeOptions_Declaration extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new ExtensionRangeOptions_Declaration().fromBinary(e,t)}static fromJson(e,t){return new ExtensionRangeOptions_Declaration().fromJson(e,t)}static fromJsonString(e,t){return new ExtensionRangeOptions_Declaration().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(ExtensionRangeOptions_Declaration,e,t)}};ExtensionRangeOptions_Declaration.runtime=eL,ExtensionRangeOptions_Declaration.typeName="google.protobuf.ExtensionRangeOptions.Declaration",ExtensionRangeOptions_Declaration.fields=eL.util.newFieldList(()=>[{no:1,name:"number",kind:"scalar",T:5,opt:!0},{no:2,name:"full_name",kind:"scalar",T:9,opt:!0},{no:3,name:"type",kind:"scalar",T:9,opt:!0},{no:5,name:"reserved",kind:"scalar",T:8,opt:!0},{no:6,name:"repeated",kind:"scalar",T:8,opt:!0}]);let FieldDescriptorProto=class FieldDescriptorProto extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new FieldDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new FieldDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new FieldDescriptorProto().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FieldDescriptorProto,e,t)}};FieldDescriptorProto.runtime=eL,FieldDescriptorProto.typeName="google.protobuf.FieldDescriptorProto",FieldDescriptorProto.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:3,name:"number",kind:"scalar",T:5,opt:!0},{no:4,name:"label",kind:"enum",T:eL.getEnumType(Q),opt:!0},{no:5,name:"type",kind:"enum",T:eL.getEnumType(Z),opt:!0},{no:6,name:"type_name",kind:"scalar",T:9,opt:!0},{no:2,name:"extendee",kind:"scalar",T:9,opt:!0},{no:7,name:"default_value",kind:"scalar",T:9,opt:!0},{no:9,name:"oneof_index",kind:"scalar",T:5,opt:!0},{no:10,name:"json_name",kind:"scalar",T:9,opt:!0},{no:8,name:"options",kind:"message",T:FieldOptions,opt:!0},{no:17,name:"proto3_optional",kind:"scalar",T:8,opt:!0}]),(d=Z||(Z={}))[d.DOUBLE=1]="DOUBLE",d[d.FLOAT=2]="FLOAT",d[d.INT64=3]="INT64",d[d.UINT64=4]="UINT64",d[d.INT32=5]="INT32",d[d.FIXED64=6]="FIXED64",d[d.FIXED32=7]="FIXED32",d[d.BOOL=8]="BOOL",d[d.STRING=9]="STRING",d[d.GROUP=10]="GROUP",d[d.MESSAGE=11]="MESSAGE",d[d.BYTES=12]="BYTES",d[d.UINT32=13]="UINT32",d[d.ENUM=14]="ENUM",d[d.SFIXED32=15]="SFIXED32",d[d.SFIXED64=16]="SFIXED64",d[d.SINT32=17]="SINT32",d[d.SINT64=18]="SINT64",eL.util.setEnumType(Z,"google.protobuf.FieldDescriptorProto.Type",[{no:1,name:"TYPE_DOUBLE"},{no:2,name:"TYPE_FLOAT"},{no:3,name:"TYPE_INT64"},{no:4,name:"TYPE_UINT64"},{no:5,name:"TYPE_INT32"},{no:6,name:"TYPE_FIXED64"},{no:7,name:"TYPE_FIXED32"},{no:8,name:"TYPE_BOOL"},{no:9,name:"TYPE_STRING"},{no:10,name:"TYPE_GROUP"},{no:11,name:"TYPE_MESSAGE"},{no:12,name:"TYPE_BYTES"},{no:13,name:"TYPE_UINT32"},{no:14,name:"TYPE_ENUM"},{no:15,name:"TYPE_SFIXED32"},{no:16,name:"TYPE_SFIXED64"},{no:17,name:"TYPE_SINT32"},{no:18,name:"TYPE_SINT64"}]),(c=Q||(Q={}))[c.OPTIONAL=1]="OPTIONAL",c[c.REPEATED=3]="REPEATED",c[c.REQUIRED=2]="REQUIRED",eL.util.setEnumType(Q,"google.protobuf.FieldDescriptorProto.Label",[{no:1,name:"LABEL_OPTIONAL"},{no:3,name:"LABEL_REPEATED"},{no:2,name:"LABEL_REQUIRED"}]);let OneofDescriptorProto=class OneofDescriptorProto extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new OneofDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new OneofDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new OneofDescriptorProto().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(OneofDescriptorProto,e,t)}};OneofDescriptorProto.runtime=eL,OneofDescriptorProto.typeName="google.protobuf.OneofDescriptorProto",OneofDescriptorProto.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"options",kind:"message",T:OneofOptions,opt:!0}]);let EnumDescriptorProto=class EnumDescriptorProto extends Message{constructor(e){super(),this.value=[],this.reservedRange=[],this.reservedName=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new EnumDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new EnumDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new EnumDescriptorProto().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(EnumDescriptorProto,e,t)}};EnumDescriptorProto.runtime=eL,EnumDescriptorProto.typeName="google.protobuf.EnumDescriptorProto",EnumDescriptorProto.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"value",kind:"message",T:EnumValueDescriptorProto,repeated:!0},{no:3,name:"options",kind:"message",T:EnumOptions,opt:!0},{no:4,name:"reserved_range",kind:"message",T:EnumDescriptorProto_EnumReservedRange,repeated:!0},{no:5,name:"reserved_name",kind:"scalar",T:9,repeated:!0}]);let EnumDescriptorProto_EnumReservedRange=class EnumDescriptorProto_EnumReservedRange extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new EnumDescriptorProto_EnumReservedRange().fromBinary(e,t)}static fromJson(e,t){return new EnumDescriptorProto_EnumReservedRange().fromJson(e,t)}static fromJsonString(e,t){return new EnumDescriptorProto_EnumReservedRange().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(EnumDescriptorProto_EnumReservedRange,e,t)}};EnumDescriptorProto_EnumReservedRange.runtime=eL,EnumDescriptorProto_EnumReservedRange.typeName="google.protobuf.EnumDescriptorProto.EnumReservedRange",EnumDescriptorProto_EnumReservedRange.fields=eL.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0}]);let EnumValueDescriptorProto=class EnumValueDescriptorProto extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new EnumValueDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new EnumValueDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new EnumValueDescriptorProto().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(EnumValueDescriptorProto,e,t)}};EnumValueDescriptorProto.runtime=eL,EnumValueDescriptorProto.typeName="google.protobuf.EnumValueDescriptorProto",EnumValueDescriptorProto.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"number",kind:"scalar",T:5,opt:!0},{no:3,name:"options",kind:"message",T:EnumValueOptions,opt:!0}]);let ServiceDescriptorProto=class ServiceDescriptorProto extends Message{constructor(e){super(),this.method=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new ServiceDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new ServiceDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new ServiceDescriptorProto().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(ServiceDescriptorProto,e,t)}};ServiceDescriptorProto.runtime=eL,ServiceDescriptorProto.typeName="google.protobuf.ServiceDescriptorProto",ServiceDescriptorProto.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"method",kind:"message",T:MethodDescriptorProto,repeated:!0},{no:3,name:"options",kind:"message",T:ServiceOptions,opt:!0}]);let MethodDescriptorProto=class MethodDescriptorProto extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new MethodDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new MethodDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new MethodDescriptorProto().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(MethodDescriptorProto,e,t)}};MethodDescriptorProto.runtime=eL,MethodDescriptorProto.typeName="google.protobuf.MethodDescriptorProto",MethodDescriptorProto.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"input_type",kind:"scalar",T:9,opt:!0},{no:3,name:"output_type",kind:"scalar",T:9,opt:!0},{no:4,name:"options",kind:"message",T:MethodOptions,opt:!0},{no:5,name:"client_streaming",kind:"scalar",T:8,opt:!0,default:!1},{no:6,name:"server_streaming",kind:"scalar",T:8,opt:!0,default:!1}]);let FileOptions=class FileOptions extends Message{constructor(e){super(),this.uninterpretedOption=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new FileOptions().fromBinary(e,t)}static fromJson(e,t){return new FileOptions().fromJson(e,t)}static fromJsonString(e,t){return new FileOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FileOptions,e,t)}};FileOptions.runtime=eL,FileOptions.typeName="google.protobuf.FileOptions",FileOptions.fields=eL.util.newFieldList(()=>[{no:1,name:"java_package",kind:"scalar",T:9,opt:!0},{no:8,name:"java_outer_classname",kind:"scalar",T:9,opt:!0},{no:10,name:"java_multiple_files",kind:"scalar",T:8,opt:!0,default:!1},{no:20,name:"java_generate_equals_and_hash",kind:"scalar",T:8,opt:!0},{no:27,name:"java_string_check_utf8",kind:"scalar",T:8,opt:!0,default:!1},{no:9,name:"optimize_for",kind:"enum",T:eL.getEnumType(ee),opt:!0,default:ee.SPEED},{no:11,name:"go_package",kind:"scalar",T:9,opt:!0},{no:16,name:"cc_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:17,name:"java_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:18,name:"py_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:42,name:"php_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:23,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:31,name:"cc_enable_arenas",kind:"scalar",T:8,opt:!0,default:!0},{no:36,name:"objc_class_prefix",kind:"scalar",T:9,opt:!0},{no:37,name:"csharp_namespace",kind:"scalar",T:9,opt:!0},{no:39,name:"swift_prefix",kind:"scalar",T:9,opt:!0},{no:40,name:"php_class_prefix",kind:"scalar",T:9,opt:!0},{no:41,name:"php_namespace",kind:"scalar",T:9,opt:!0},{no:44,name:"php_metadata_namespace",kind:"scalar",T:9,opt:!0},{no:45,name:"ruby_package",kind:"scalar",T:9,opt:!0},{no:50,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]),(h=ee||(ee={}))[h.SPEED=1]="SPEED",h[h.CODE_SIZE=2]="CODE_SIZE",h[h.LITE_RUNTIME=3]="LITE_RUNTIME",eL.util.setEnumType(ee,"google.protobuf.FileOptions.OptimizeMode",[{no:1,name:"SPEED"},{no:2,name:"CODE_SIZE"},{no:3,name:"LITE_RUNTIME"}]);let MessageOptions=class MessageOptions extends Message{constructor(e){super(),this.uninterpretedOption=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new MessageOptions().fromBinary(e,t)}static fromJson(e,t){return new MessageOptions().fromJson(e,t)}static fromJsonString(e,t){return new MessageOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(MessageOptions,e,t)}};MessageOptions.runtime=eL,MessageOptions.typeName="google.protobuf.MessageOptions",MessageOptions.fields=eL.util.newFieldList(()=>[{no:1,name:"message_set_wire_format",kind:"scalar",T:8,opt:!0,default:!1},{no:2,name:"no_standard_descriptor_accessor",kind:"scalar",T:8,opt:!0,default:!1},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:7,name:"map_entry",kind:"scalar",T:8,opt:!0},{no:11,name:"deprecated_legacy_json_field_conflicts",kind:"scalar",T:8,opt:!0},{no:12,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let FieldOptions=class FieldOptions extends Message{constructor(e){super(),this.targets=[],this.editionDefaults=[],this.uninterpretedOption=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new FieldOptions().fromBinary(e,t)}static fromJson(e,t){return new FieldOptions().fromJson(e,t)}static fromJsonString(e,t){return new FieldOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FieldOptions,e,t)}};FieldOptions.runtime=eL,FieldOptions.typeName="google.protobuf.FieldOptions",FieldOptions.fields=eL.util.newFieldList(()=>[{no:1,name:"ctype",kind:"enum",T:eL.getEnumType(et),opt:!0,default:et.STRING},{no:2,name:"packed",kind:"scalar",T:8,opt:!0},{no:6,name:"jstype",kind:"enum",T:eL.getEnumType(er),opt:!0,default:er.JS_NORMAL},{no:5,name:"lazy",kind:"scalar",T:8,opt:!0,default:!1},{no:15,name:"unverified_lazy",kind:"scalar",T:8,opt:!0,default:!1},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:10,name:"weak",kind:"scalar",T:8,opt:!0,default:!1},{no:16,name:"debug_redact",kind:"scalar",T:8,opt:!0,default:!1},{no:17,name:"retention",kind:"enum",T:eL.getEnumType(en),opt:!0},{no:19,name:"targets",kind:"enum",T:eL.getEnumType(ei),repeated:!0},{no:20,name:"edition_defaults",kind:"message",T:FieldOptions_EditionDefault,repeated:!0},{no:21,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]),(m=et||(et={}))[m.STRING=0]="STRING",m[m.CORD=1]="CORD",m[m.STRING_PIECE=2]="STRING_PIECE",eL.util.setEnumType(et,"google.protobuf.FieldOptions.CType",[{no:0,name:"STRING"},{no:1,name:"CORD"},{no:2,name:"STRING_PIECE"}]),(p=er||(er={}))[p.JS_NORMAL=0]="JS_NORMAL",p[p.JS_STRING=1]="JS_STRING",p[p.JS_NUMBER=2]="JS_NUMBER",eL.util.setEnumType(er,"google.protobuf.FieldOptions.JSType",[{no:0,name:"JS_NORMAL"},{no:1,name:"JS_STRING"},{no:2,name:"JS_NUMBER"}]),(f=en||(en={}))[f.RETENTION_UNKNOWN=0]="RETENTION_UNKNOWN",f[f.RETENTION_RUNTIME=1]="RETENTION_RUNTIME",f[f.RETENTION_SOURCE=2]="RETENTION_SOURCE",eL.util.setEnumType(en,"google.protobuf.FieldOptions.OptionRetention",[{no:0,name:"RETENTION_UNKNOWN"},{no:1,name:"RETENTION_RUNTIME"},{no:2,name:"RETENTION_SOURCE"}]),(g=ei||(ei={}))[g.TARGET_TYPE_UNKNOWN=0]="TARGET_TYPE_UNKNOWN",g[g.TARGET_TYPE_FILE=1]="TARGET_TYPE_FILE",g[g.TARGET_TYPE_EXTENSION_RANGE=2]="TARGET_TYPE_EXTENSION_RANGE",g[g.TARGET_TYPE_MESSAGE=3]="TARGET_TYPE_MESSAGE",g[g.TARGET_TYPE_FIELD=4]="TARGET_TYPE_FIELD",g[g.TARGET_TYPE_ONEOF=5]="TARGET_TYPE_ONEOF",g[g.TARGET_TYPE_ENUM=6]="TARGET_TYPE_ENUM",g[g.TARGET_TYPE_ENUM_ENTRY=7]="TARGET_TYPE_ENUM_ENTRY",g[g.TARGET_TYPE_SERVICE=8]="TARGET_TYPE_SERVICE",g[g.TARGET_TYPE_METHOD=9]="TARGET_TYPE_METHOD",eL.util.setEnumType(ei,"google.protobuf.FieldOptions.OptionTargetType",[{no:0,name:"TARGET_TYPE_UNKNOWN"},{no:1,name:"TARGET_TYPE_FILE"},{no:2,name:"TARGET_TYPE_EXTENSION_RANGE"},{no:3,name:"TARGET_TYPE_MESSAGE"},{no:4,name:"TARGET_TYPE_FIELD"},{no:5,name:"TARGET_TYPE_ONEOF"},{no:6,name:"TARGET_TYPE_ENUM"},{no:7,name:"TARGET_TYPE_ENUM_ENTRY"},{no:8,name:"TARGET_TYPE_SERVICE"},{no:9,name:"TARGET_TYPE_METHOD"}]);let FieldOptions_EditionDefault=class FieldOptions_EditionDefault extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new FieldOptions_EditionDefault().fromBinary(e,t)}static fromJson(e,t){return new FieldOptions_EditionDefault().fromJson(e,t)}static fromJsonString(e,t){return new FieldOptions_EditionDefault().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FieldOptions_EditionDefault,e,t)}};FieldOptions_EditionDefault.runtime=eL,FieldOptions_EditionDefault.typeName="google.protobuf.FieldOptions.EditionDefault",FieldOptions_EditionDefault.fields=eL.util.newFieldList(()=>[{no:3,name:"edition",kind:"enum",T:eL.getEnumType(H),opt:!0},{no:2,name:"value",kind:"scalar",T:9,opt:!0}]);let OneofOptions=class OneofOptions extends Message{constructor(e){super(),this.uninterpretedOption=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new OneofOptions().fromBinary(e,t)}static fromJson(e,t){return new OneofOptions().fromJson(e,t)}static fromJsonString(e,t){return new OneofOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(OneofOptions,e,t)}};OneofOptions.runtime=eL,OneofOptions.typeName="google.protobuf.OneofOptions",OneofOptions.fields=eL.util.newFieldList(()=>[{no:1,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let EnumOptions=class EnumOptions extends Message{constructor(e){super(),this.uninterpretedOption=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new EnumOptions().fromBinary(e,t)}static fromJson(e,t){return new EnumOptions().fromJson(e,t)}static fromJsonString(e,t){return new EnumOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(EnumOptions,e,t)}};EnumOptions.runtime=eL,EnumOptions.typeName="google.protobuf.EnumOptions",EnumOptions.fields=eL.util.newFieldList(()=>[{no:2,name:"allow_alias",kind:"scalar",T:8,opt:!0},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:6,name:"deprecated_legacy_json_field_conflicts",kind:"scalar",T:8,opt:!0},{no:7,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let EnumValueOptions=class EnumValueOptions extends Message{constructor(e){super(),this.uninterpretedOption=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new EnumValueOptions().fromBinary(e,t)}static fromJson(e,t){return new EnumValueOptions().fromJson(e,t)}static fromJsonString(e,t){return new EnumValueOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(EnumValueOptions,e,t)}};EnumValueOptions.runtime=eL,EnumValueOptions.typeName="google.protobuf.EnumValueOptions",EnumValueOptions.fields=eL.util.newFieldList(()=>[{no:1,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:2,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:3,name:"debug_redact",kind:"scalar",T:8,opt:!0,default:!1},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let ServiceOptions=class ServiceOptions extends Message{constructor(e){super(),this.uninterpretedOption=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new ServiceOptions().fromBinary(e,t)}static fromJson(e,t){return new ServiceOptions().fromJson(e,t)}static fromJsonString(e,t){return new ServiceOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(ServiceOptions,e,t)}};ServiceOptions.runtime=eL,ServiceOptions.typeName="google.protobuf.ServiceOptions",ServiceOptions.fields=eL.util.newFieldList(()=>[{no:34,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:33,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let MethodOptions=class MethodOptions extends Message{constructor(e){super(),this.uninterpretedOption=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new MethodOptions().fromBinary(e,t)}static fromJson(e,t){return new MethodOptions().fromJson(e,t)}static fromJsonString(e,t){return new MethodOptions().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(MethodOptions,e,t)}};MethodOptions.runtime=eL,MethodOptions.typeName="google.protobuf.MethodOptions",MethodOptions.fields=eL.util.newFieldList(()=>[{no:33,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:34,name:"idempotency_level",kind:"enum",T:eL.getEnumType(eo),opt:!0,default:eo.IDEMPOTENCY_UNKNOWN},{no:35,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]),(T=eo||(eo={}))[T.IDEMPOTENCY_UNKNOWN=0]="IDEMPOTENCY_UNKNOWN",T[T.NO_SIDE_EFFECTS=1]="NO_SIDE_EFFECTS",T[T.IDEMPOTENT=2]="IDEMPOTENT",eL.util.setEnumType(eo,"google.protobuf.MethodOptions.IdempotencyLevel",[{no:0,name:"IDEMPOTENCY_UNKNOWN"},{no:1,name:"NO_SIDE_EFFECTS"},{no:2,name:"IDEMPOTENT"}]);let UninterpretedOption=class UninterpretedOption extends Message{constructor(e){super(),this.name=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new UninterpretedOption().fromBinary(e,t)}static fromJson(e,t){return new UninterpretedOption().fromJson(e,t)}static fromJsonString(e,t){return new UninterpretedOption().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(UninterpretedOption,e,t)}};UninterpretedOption.runtime=eL,UninterpretedOption.typeName="google.protobuf.UninterpretedOption",UninterpretedOption.fields=eL.util.newFieldList(()=>[{no:2,name:"name",kind:"message",T:UninterpretedOption_NamePart,repeated:!0},{no:3,name:"identifier_value",kind:"scalar",T:9,opt:!0},{no:4,name:"positive_int_value",kind:"scalar",T:4,opt:!0},{no:5,name:"negative_int_value",kind:"scalar",T:3,opt:!0},{no:6,name:"double_value",kind:"scalar",T:1,opt:!0},{no:7,name:"string_value",kind:"scalar",T:12,opt:!0},{no:8,name:"aggregate_value",kind:"scalar",T:9,opt:!0}]);let UninterpretedOption_NamePart=class UninterpretedOption_NamePart extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new UninterpretedOption_NamePart().fromBinary(e,t)}static fromJson(e,t){return new UninterpretedOption_NamePart().fromJson(e,t)}static fromJsonString(e,t){return new UninterpretedOption_NamePart().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(UninterpretedOption_NamePart,e,t)}};UninterpretedOption_NamePart.runtime=eL,UninterpretedOption_NamePart.typeName="google.protobuf.UninterpretedOption.NamePart",UninterpretedOption_NamePart.fields=eL.util.newFieldList(()=>[{no:1,name:"name_part",kind:"scalar",T:9},{no:2,name:"is_extension",kind:"scalar",T:8}]);let FeatureSet=class FeatureSet extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new FeatureSet().fromBinary(e,t)}static fromJson(e,t){return new FeatureSet().fromJson(e,t)}static fromJsonString(e,t){return new FeatureSet().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FeatureSet,e,t)}};FeatureSet.runtime=eL,FeatureSet.typeName="google.protobuf.FeatureSet",FeatureSet.fields=eL.util.newFieldList(()=>[{no:1,name:"field_presence",kind:"enum",T:eL.getEnumType(es),opt:!0},{no:2,name:"enum_type",kind:"enum",T:eL.getEnumType(ea),opt:!0},{no:3,name:"repeated_field_encoding",kind:"enum",T:eL.getEnumType(el),opt:!0},{no:4,name:"utf8_validation",kind:"enum",T:eL.getEnumType(eu),opt:!0},{no:5,name:"message_encoding",kind:"enum",T:eL.getEnumType(ed),opt:!0},{no:6,name:"json_format",kind:"enum",T:eL.getEnumType(ec),opt:!0}]),(y=es||(es={}))[y.FIELD_PRESENCE_UNKNOWN=0]="FIELD_PRESENCE_UNKNOWN",y[y.EXPLICIT=1]="EXPLICIT",y[y.IMPLICIT=2]="IMPLICIT",y[y.LEGACY_REQUIRED=3]="LEGACY_REQUIRED",eL.util.setEnumType(es,"google.protobuf.FeatureSet.FieldPresence",[{no:0,name:"FIELD_PRESENCE_UNKNOWN"},{no:1,name:"EXPLICIT"},{no:2,name:"IMPLICIT"},{no:3,name:"LEGACY_REQUIRED"}]),(v=ea||(ea={}))[v.ENUM_TYPE_UNKNOWN=0]="ENUM_TYPE_UNKNOWN",v[v.OPEN=1]="OPEN",v[v.CLOSED=2]="CLOSED",eL.util.setEnumType(ea,"google.protobuf.FeatureSet.EnumType",[{no:0,name:"ENUM_TYPE_UNKNOWN"},{no:1,name:"OPEN"},{no:2,name:"CLOSED"}]),(S=el||(el={}))[S.REPEATED_FIELD_ENCODING_UNKNOWN=0]="REPEATED_FIELD_ENCODING_UNKNOWN",S[S.PACKED=1]="PACKED",S[S.EXPANDED=2]="EXPANDED",eL.util.setEnumType(el,"google.protobuf.FeatureSet.RepeatedFieldEncoding",[{no:0,name:"REPEATED_FIELD_ENCODING_UNKNOWN"},{no:1,name:"PACKED"},{no:2,name:"EXPANDED"}]),(b=eu||(eu={}))[b.UTF8_VALIDATION_UNKNOWN=0]="UTF8_VALIDATION_UNKNOWN",b[b.NONE=1]="NONE",b[b.VERIFY=2]="VERIFY",eL.util.setEnumType(eu,"google.protobuf.FeatureSet.Utf8Validation",[{no:0,name:"UTF8_VALIDATION_UNKNOWN"},{no:1,name:"NONE"},{no:2,name:"VERIFY"}]),(E=ed||(ed={}))[E.MESSAGE_ENCODING_UNKNOWN=0]="MESSAGE_ENCODING_UNKNOWN",E[E.LENGTH_PREFIXED=1]="LENGTH_PREFIXED",E[E.DELIMITED=2]="DELIMITED",eL.util.setEnumType(ed,"google.protobuf.FeatureSet.MessageEncoding",[{no:0,name:"MESSAGE_ENCODING_UNKNOWN"},{no:1,name:"LENGTH_PREFIXED"},{no:2,name:"DELIMITED"}]),(I=ec||(ec={}))[I.JSON_FORMAT_UNKNOWN=0]="JSON_FORMAT_UNKNOWN",I[I.ALLOW=1]="ALLOW",I[I.LEGACY_BEST_EFFORT=2]="LEGACY_BEST_EFFORT",eL.util.setEnumType(ec,"google.protobuf.FeatureSet.JsonFormat",[{no:0,name:"JSON_FORMAT_UNKNOWN"},{no:1,name:"ALLOW"},{no:2,name:"LEGACY_BEST_EFFORT"}]);let FeatureSetDefaults=class FeatureSetDefaults extends Message{constructor(e){super(),this.defaults=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new FeatureSetDefaults().fromBinary(e,t)}static fromJson(e,t){return new FeatureSetDefaults().fromJson(e,t)}static fromJsonString(e,t){return new FeatureSetDefaults().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FeatureSetDefaults,e,t)}};FeatureSetDefaults.runtime=eL,FeatureSetDefaults.typeName="google.protobuf.FeatureSetDefaults",FeatureSetDefaults.fields=eL.util.newFieldList(()=>[{no:1,name:"defaults",kind:"message",T:FeatureSetDefaults_FeatureSetEditionDefault,repeated:!0},{no:4,name:"minimum_edition",kind:"enum",T:eL.getEnumType(H),opt:!0},{no:5,name:"maximum_edition",kind:"enum",T:eL.getEnumType(H),opt:!0}]);let FeatureSetDefaults_FeatureSetEditionDefault=class FeatureSetDefaults_FeatureSetEditionDefault extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new FeatureSetDefaults_FeatureSetEditionDefault().fromBinary(e,t)}static fromJson(e,t){return new FeatureSetDefaults_FeatureSetEditionDefault().fromJson(e,t)}static fromJsonString(e,t){return new FeatureSetDefaults_FeatureSetEditionDefault().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(FeatureSetDefaults_FeatureSetEditionDefault,e,t)}};FeatureSetDefaults_FeatureSetEditionDefault.runtime=eL,FeatureSetDefaults_FeatureSetEditionDefault.typeName="google.protobuf.FeatureSetDefaults.FeatureSetEditionDefault",FeatureSetDefaults_FeatureSetEditionDefault.fields=eL.util.newFieldList(()=>[{no:3,name:"edition",kind:"enum",T:eL.getEnumType(H),opt:!0},{no:2,name:"features",kind:"message",T:FeatureSet,opt:!0}]);let SourceCodeInfo=class SourceCodeInfo extends Message{constructor(e){super(),this.location=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new SourceCodeInfo().fromBinary(e,t)}static fromJson(e,t){return new SourceCodeInfo().fromJson(e,t)}static fromJsonString(e,t){return new SourceCodeInfo().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(SourceCodeInfo,e,t)}};SourceCodeInfo.runtime=eL,SourceCodeInfo.typeName="google.protobuf.SourceCodeInfo",SourceCodeInfo.fields=eL.util.newFieldList(()=>[{no:1,name:"location",kind:"message",T:SourceCodeInfo_Location,repeated:!0}]);let SourceCodeInfo_Location=class SourceCodeInfo_Location extends Message{constructor(e){super(),this.path=[],this.span=[],this.leadingDetachedComments=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new SourceCodeInfo_Location().fromBinary(e,t)}static fromJson(e,t){return new SourceCodeInfo_Location().fromJson(e,t)}static fromJsonString(e,t){return new SourceCodeInfo_Location().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(SourceCodeInfo_Location,e,t)}};SourceCodeInfo_Location.runtime=eL,SourceCodeInfo_Location.typeName="google.protobuf.SourceCodeInfo.Location",SourceCodeInfo_Location.fields=eL.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:5,repeated:!0,packed:!0},{no:2,name:"span",kind:"scalar",T:5,repeated:!0,packed:!0},{no:3,name:"leading_comments",kind:"scalar",T:9,opt:!0},{no:4,name:"trailing_comments",kind:"scalar",T:9,opt:!0},{no:6,name:"leading_detached_comments",kind:"scalar",T:9,repeated:!0}]);let GeneratedCodeInfo=class GeneratedCodeInfo extends Message{constructor(e){super(),this.annotation=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new GeneratedCodeInfo().fromBinary(e,t)}static fromJson(e,t){return new GeneratedCodeInfo().fromJson(e,t)}static fromJsonString(e,t){return new GeneratedCodeInfo().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(GeneratedCodeInfo,e,t)}};GeneratedCodeInfo.runtime=eL,GeneratedCodeInfo.typeName="google.protobuf.GeneratedCodeInfo",GeneratedCodeInfo.fields=eL.util.newFieldList(()=>[{no:1,name:"annotation",kind:"message",T:GeneratedCodeInfo_Annotation,repeated:!0}]);let GeneratedCodeInfo_Annotation=class GeneratedCodeInfo_Annotation extends Message{constructor(e){super(),this.path=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new GeneratedCodeInfo_Annotation().fromBinary(e,t)}static fromJson(e,t){return new GeneratedCodeInfo_Annotation().fromJson(e,t)}static fromJsonString(e,t){return new GeneratedCodeInfo_Annotation().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(GeneratedCodeInfo_Annotation,e,t)}};GeneratedCodeInfo_Annotation.runtime=eL,GeneratedCodeInfo_Annotation.typeName="google.protobuf.GeneratedCodeInfo.Annotation",GeneratedCodeInfo_Annotation.fields=eL.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:5,repeated:!0,packed:!0},{no:2,name:"source_file",kind:"scalar",T:9,opt:!0},{no:3,name:"begin",kind:"scalar",T:5,opt:!0},{no:4,name:"end",kind:"scalar",T:5,opt:!0},{no:5,name:"semantic",kind:"enum",T:eL.getEnumType(eh),opt:!0}]),(N=eh||(eh={}))[N.NONE=0]="NONE",N[N.SET=1]="SET",N[N.ALIAS=2]="ALIAS",eL.util.setEnumType(eh,"google.protobuf.GeneratedCodeInfo.Annotation.Semantic",[{no:0,name:"NONE"},{no:1,name:"SET"},{no:2,name:"ALIAS"}]);let e$=FeatureSetDefaults.fromBinary(eD.dec("ChESDAgBEAIYAiABKAEwAhjmBwoREgwIAhABGAEgAigBMAEY5wcKERIMCAEQARgBIAIoATABGOgHIOYHKOgH"));function createDescriptorSet(e,t){var r;let n={enums:new Map,messages:new Map,services:new Map,extensions:new Map,mapEntries:new Map,resolveFeatures:function(e){let t=e.minimumEdition,r=e.maximumEdition;if(void 0===t||void 0===r||e.defaults.some(e=>void 0===e.edition))throw Error("Invalid FeatureSetDefaults");let n=new Map;return(i,...o)=>{var s,a;let l=n.get(i);if(void 0===l){let o;if(i<t)throw Error(`Edition ${H[i]} is earlier than the minimum supported edition ${H[t]}`);if(r<i)throw Error(`Edition ${H[i]} is later than the maximum supported edition ${H[r]}`);for(let t of e.defaults){let e=null!==(s=t.edition)&&void 0!==s?s:0;e>i||void 0!==o&&o.e>e||(o={e,f:null!==(a=t.features)&&void 0!==a?a:new FeatureSet})}if(void 0===o)throw Error(`No valid default found for edition ${H[i]}`);l=o.f.toBinary(),n.set(i,l)}let u=FeatureSet.fromBinary(l);for(let e of o)void 0!==e&&u.fromBinary(e.toBinary());if(!function(e){for(let t of FeatureSet.fields.list()){let r=e[t.localName];if(void 0===r||"enum"==t.kind&&0===r)return!1}return!0}(u))throw Error(`Invalid FeatureSet for edition ${H[i]}`);return u}}(null!==(r=null==t?void 0:t.featureSetDefaults)&&void 0!==r?r:e$)},i=e instanceof FileDescriptorSet?e.file:e instanceof Uint8Array?FileDescriptorSet.fromBinary(e).file:e,o=i.map(e=>(function(e,t){var r,n;assert(e.name,"invalid FileDescriptorProto: missing name");let i=Object.assign(Object.assign({kind:"file",proto:e,deprecated:null!==(n=null===(r=e.options)||void 0===r?void 0:r.deprecated)&&void 0!==n&&n},function(e,t){let r,n;switch(e){case void 0:case"proto2":n="proto2",r=H.EDITION_PROTO2;break;case"proto3":n="proto3",r=H.EDITION_PROTO3;break;case"editions":switch(n="editions",t){case void 0:case H.EDITION_1_TEST_ONLY:case H.EDITION_2_TEST_ONLY:case H.EDITION_99997_TEST_ONLY:case H.EDITION_99998_TEST_ONLY:case H.EDITION_99999_TEST_ONLY:case H.EDITION_UNKNOWN:r=H.EDITION_UNKNOWN;break;default:r=t}break;default:throw Error(`invalid FileDescriptorProto: unsupported syntax: ${e}`)}if("editions"===e&&t===H.EDITION_UNKNOWN)throw Error(`invalid FileDescriptorProto: syntax ${e} cannot have edition ${String(t)}`);return{syntax:n,edition:r}}(e.syntax,e.edition)),{name:e.name.replace(/\.proto/,""),enums:[],messages:[],extensions:[],services:[],toString(){return`file ${this.proto.name}`},getSyntaxComments(){return findComments(this.proto.sourceCodeInfo,[em.FileDescriptorProto_Syntax])},getPackageComments(){return findComments(this.proto.sourceCodeInfo,[em.FileDescriptorProto_Package])},getFeatures(){var e;return t.resolveFeatures(this.edition,null===(e=this.proto.options)||void 0===e?void 0:e.features)}});for(let r of(t.mapEntries.clear(),e.enumType))addEnum(r,i,void 0,t);for(let r of e.messageType)!function addMessage(e,t,r,n){var i,o,s,a;assert(e.name,"invalid DescriptorProto: missing name");let l={kind:"message",proto:e,deprecated:null!==(o=null===(i=e.options)||void 0===i?void 0:i.deprecated)&&void 0!==o&&o,file:t,parent:r,name:e.name,typeName:makeTypeName(e,r,t),fields:[],oneofs:[],members:[],nestedEnums:[],nestedMessages:[],nestedExtensions:[],toString(){return`message ${this.typeName}`},getComments(){let e=this.parent?[...this.parent.getComments().sourcePath,em.DescriptorProto_NestedType,this.parent.proto.nestedType.indexOf(this.proto)]:[em.FileDescriptorProto_MessageType,this.file.proto.messageType.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e,t,r;let i=null!==(t=null===(e=this.parent)||void 0===e?void 0:e.getFeatures())&&void 0!==t?t:this.file.getFeatures();return n.resolveFeatures(this.file.edition,i,null===(r=this.proto.options)||void 0===r?void 0:r.features)}};for(let i of((null===(s=e.options)||void 0===s?void 0:s.mapEntry)===!0?n.mapEntries.set(l.typeName,l):((null!==(a=null==r?void 0:r.nestedMessages)&&void 0!==a?a:t.messages).push(l),n.messages.set(l.typeName,l)),e.enumType))addEnum(i,t,l,n);for(let r of e.nestedType)addMessage(r,t,l,n)}(r,i,void 0,t);for(let r of e.service)!function(e,t,r){var n,i;assert(e.name,"invalid ServiceDescriptorProto: missing name");let o={kind:"service",proto:e,deprecated:null!==(i=null===(n=e.options)||void 0===n?void 0:n.deprecated)&&void 0!==i&&i,file:t,name:e.name,typeName:makeTypeName(e,void 0,t),methods:[],toString(){return`service ${this.typeName}`},getComments(){let e=[em.FileDescriptorProto_Service,this.file.proto.service.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e;return r.resolveFeatures(this.file.edition,this.file.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}};for(let n of(t.services.push(o),r.services.set(o.typeName,o),e.method))o.methods.push(function(e,t,r){var n,i,o;let s,a;switch(assert(e.name,"invalid MethodDescriptorProto: missing name"),assert(e.inputType,"invalid MethodDescriptorProto: missing input_type"),assert(e.outputType,"invalid MethodDescriptorProto: missing output_type"),s=!0===e.clientStreaming&&!0===e.serverStreaming?z.BiDiStreaming:!0===e.clientStreaming?z.ClientStreaming:!0===e.serverStreaming?z.ServerStreaming:z.Unary,null===(n=e.options)||void 0===n?void 0:n.idempotencyLevel){case eo.IDEMPOTENT:a=W.Idempotent;break;case eo.NO_SIDE_EFFECTS:a=W.NoSideEffects;break;case eo.IDEMPOTENCY_UNKNOWN:case void 0:a=void 0}let l=r.messages.get(trimLeadingDot(e.inputType)),u=r.messages.get(trimLeadingDot(e.outputType));assert(l,`invalid MethodDescriptorProto: input_type ${e.inputType} not found`),assert(u,`invalid MethodDescriptorProto: output_type ${e.inputType} not found`);let d=e.name;return{kind:"rpc",proto:e,deprecated:null!==(o=null===(i=e.options)||void 0===i?void 0:i.deprecated)&&void 0!==o&&o,parent:t,name:d,methodKind:s,input:l,output:u,idempotency:a,toString:()=>`rpc ${t.typeName}.${d}`,getComments(){let e=[...this.parent.getComments().sourcePath,em.ServiceDescriptorProto_Method,this.parent.proto.method.indexOf(this.proto)];return findComments(t.file.proto.sourceCodeInfo,e)},getFeatures(){var e;return r.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}}}(n,o,r))}(r,i,t);for(let e of(addExtensions(i,t),t.mapEntries.values()))addFields(e,t);for(let e of i.messages)addFields(e,t),addExtensions(e,t);return t.mapEntries.clear(),i})(e,n));return Object.assign({files:o},n)}function addExtensions(e,t){switch(e.kind){case"file":for(let r of e.proto.extension){let n=newExtension(r,e,void 0,t);e.extensions.push(n),t.extensions.set(n.typeName,n)}break;case"message":for(let r of e.proto.extension){let n=newExtension(r,e.file,e,t);e.nestedExtensions.push(n),t.extensions.set(n.typeName,n)}for(let r of e.nestedMessages)addExtensions(r,t)}}function addFields(e,t){let r=e.proto.oneofDecl.map(r=>(assert(r.name,"invalid OneofDescriptorProto: missing name"),{kind:"oneof",proto:r,deprecated:!1,parent:e,fields:[],name:r.name,toString(){return`oneof ${e.typeName}.${this.name}`},getComments(){let t=[...this.parent.getComments().sourcePath,em.DescriptorProto_OneofDecl,this.parent.proto.oneofDecl.indexOf(this.proto)];return findComments(e.file.proto.sourceCodeInfo,t)},getFeatures(){var e;return t.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}})),n=new Set;for(let i of e.proto.field){let o=function(e,t){var r;let n;let i=e.oneofIndex;if(void 0!==i)return!0!==e.proto3Optional&&assert(n=t[i],`invalid FieldDescriptorProto: oneof #${i} for field #${null!==(r=e.number)&&void 0!==r?r:-1} not found`),n}(i,r),s=newField(i,e.file,e,o,t);e.fields.push(s),void 0===o?e.members.push(s):(o.fields.push(s),n.has(o)||(n.add(o),e.members.push(o)))}for(let t of r.filter(e=>n.has(e)))e.oneofs.push(t);for(let r of e.nestedMessages)addFields(r,t)}function addEnum(e,t,r,n){var i,o,s;assert(e.name,"invalid EnumDescriptorProto: missing name");let a={kind:"enum",proto:e,deprecated:null!==(o=null===(i=e.options)||void 0===i?void 0:i.deprecated)&&void 0!==o&&o,file:t,parent:r,name:e.name,typeName:makeTypeName(e,r,t),values:[],sharedPrefix:function(e,t){let r=(e.substring(0,1)+e.substring(1).replace(/[A-Z]/g,e=>"_"+e)).toLowerCase()+"_";for(let e of t){if(!e.toLowerCase().startsWith(r))return;let t=e.substring(r.length);if(0==t.length||/^\d/.test(t))return}return r}(e.name,e.value.map(e=>{var t;return null!==(t=e.name)&&void 0!==t?t:""})),toString(){return`enum ${this.typeName}`},getComments(){let e=this.parent?[...this.parent.getComments().sourcePath,em.DescriptorProto_EnumType,this.parent.proto.enumType.indexOf(this.proto)]:[em.FileDescriptorProto_EnumType,this.file.proto.enumType.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e,t,r;let i=null!==(t=null===(e=this.parent)||void 0===e?void 0:e.getFeatures())&&void 0!==t?t:this.file.getFeatures();return n.resolveFeatures(this.file.edition,i,null===(r=this.proto.options)||void 0===r?void 0:r.features)}};n.enums.set(a.typeName,a),e.value.forEach(e=>{var r,i;assert(e.name,"invalid EnumValueDescriptorProto: missing name"),assert(void 0!==e.number,"invalid EnumValueDescriptorProto: missing number"),a.values.push({kind:"enum_value",proto:e,deprecated:null!==(i=null===(r=e.options)||void 0===r?void 0:r.deprecated)&&void 0!==i&&i,parent:a,name:e.name,number:e.number,toString(){return`enum value ${a.typeName}.${this.name}`},declarationString(){var e;let t=`${this.name} = ${this.number}`;return(null===(e=this.proto.options)||void 0===e?void 0:e.deprecated)===!0&&(t+=" [deprecated = true]"),t},getComments(){let e=[...this.parent.getComments().sourcePath,em.EnumDescriptorProto_Value,this.parent.proto.value.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e;return n.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}})}),(null!==(s=null==r?void 0:r.nestedEnums)&&void 0!==s?s:t.enums).push(a)}function newField(e,t,r,n,i){var o,s,a;assert(e.name,"invalid FieldDescriptorProto: missing name"),assert(e.number,"invalid FieldDescriptorProto: missing number"),assert(e.type,"invalid FieldDescriptorProto: missing type");let l={proto:e,deprecated:null!==(s=null===(o=e.options)||void 0===o?void 0:o.deprecated)&&void 0!==s&&s,name:e.name,number:e.number,parent:r,oneof:n,optional:function(e,t){switch(t){case"proto2":return void 0===e.oneofIndex&&e.label===Q.OPTIONAL;case"proto3":return!0===e.proto3Optional;case"editions":return!1}}(e,t.syntax),packedByDefault:function(e,t,r){let{repeatedFieldEncoding:n}=r(e.edition);if(n!=el.PACKED)return!1;switch(t.type){case Z.STRING:case Z.BYTES:case Z.GROUP:case Z.MESSAGE:return!1;default:return!0}}(t,e,i.resolveFeatures),packed:function(e,t,r,n){var i,o,s,a,l,u;switch(r.type){case Z.STRING:case Z.BYTES:case Z.GROUP:case Z.MESSAGE:return!1;default:switch(e.edition){case H.EDITION_PROTO2:return null!==(o=null===(i=r.options)||void 0===i?void 0:i.packed)&&void 0!==o&&o;case H.EDITION_PROTO3:return null===(a=null===(s=r.options)||void 0===s?void 0:s.packed)||void 0===a||a;default:{let{repeatedFieldEncoding:i}=n(e.edition,null!==(l=null==t?void 0:t.getFeatures())&&void 0!==l?l:e.getFeatures(),null===(u=r.options)||void 0===u?void 0:u.features);return i==el.PACKED}}}}(t,r,e,i.resolveFeatures),jsonName:e.jsonName===ew(e.name)?void 0:e.jsonName,scalar:void 0,longType:void 0,message:void 0,enum:void 0,mapKey:void 0,mapValue:void 0,declarationString,toString(){return`field ${this.parent.typeName}.${this.name}`},getComments(){let e=[...this.parent.getComments().sourcePath,em.DescriptorProto_Field,this.parent.proto.field.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e;return i.resolveFeatures(t.edition,this.parent.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}},u=e.label===Q.REPEATED;switch(e.type){case Z.MESSAGE:case Z.GROUP:{assert(e.typeName,"invalid FieldDescriptorProto: missing type_name");let t=i.mapEntries.get(trimLeadingDot(e.typeName));if(void 0!==t)return assert(u,"invalid FieldDescriptorProto: expected map entry to be repeated"),Object.assign(Object.assign(Object.assign({},l),{kind:"field",fieldKind:"map",repeated:!1}),function(e){var t,r;assert(null===(t=e.proto.options)||void 0===t?void 0:t.mapEntry,`invalid DescriptorProto: expected ${e.toString()} to be a map entry`),assert(2===e.fields.length,`invalid DescriptorProto: map entry ${e.toString()} has ${e.fields.length} fields`);let n=e.fields.find(e=>1===e.proto.number);assert(n,`invalid DescriptorProto: map entry ${e.toString()} is missing key field`);let i=n.scalar;assert(void 0!==i&&i!==G.BYTES&&i!==G.FLOAT&&i!==G.DOUBLE,`invalid DescriptorProto: map entry ${e.toString()} has unexpected key type ${null!==(r=n.proto.type)&&void 0!==r?r:-1}`);let o=e.fields.find(e=>2===e.proto.number);switch(assert(o,`invalid DescriptorProto: map entry ${e.toString()} is missing value field`),o.fieldKind){case"scalar":return{mapKey:i,mapValue:Object.assign(Object.assign({},o),{kind:"scalar"})};case"message":return{mapKey:i,mapValue:Object.assign(Object.assign({},o),{kind:"message"})};case"enum":return{mapKey:i,mapValue:Object.assign(Object.assign({},o),{kind:"enum"})};default:throw Error("invalid DescriptorProto: unsupported map entry value field")}}(t));let r=i.messages.get(trimLeadingDot(e.typeName));return assert(void 0!==r,`invalid FieldDescriptorProto: type_name ${e.typeName} not found`),Object.assign(Object.assign({},l),{kind:"field",fieldKind:"message",repeated:u,message:r})}case Z.ENUM:{assert(e.typeName,"invalid FieldDescriptorProto: missing type_name");let t=i.enums.get(trimLeadingDot(e.typeName));return assert(void 0!==t,`invalid FieldDescriptorProto: type_name ${e.typeName} not found`),Object.assign(Object.assign({},l),{kind:"field",fieldKind:"enum",getDefaultValue,repeated:u,enum:t})}default:{let t=eq[e.type];return assert(t,`invalid FieldDescriptorProto: unknown type ${e.type}`),Object.assign(Object.assign({},l),{kind:"field",fieldKind:"scalar",getDefaultValue,repeated:u,scalar:t,longType:(null===(a=e.options)||void 0===a?void 0:a.jstype)==er.JS_STRING?Y.STRING:Y.BIGINT})}}}function newExtension(e,t,r,n){assert(e.extendee,"invalid FieldDescriptorProto: missing extendee");let i=newField(e,t,null,void 0,n),o=n.messages.get(trimLeadingDot(e.extendee));return assert(o,`invalid FieldDescriptorProto: extendee ${e.extendee} not found`),Object.assign(Object.assign({},i),{kind:"extension",typeName:makeTypeName(e,r,t),parent:r,file:t,extendee:o,toString(){return`extension ${this.typeName}`},getComments(){let r=this.parent?[...this.parent.getComments().sourcePath,em.DescriptorProto_Extension,this.parent.proto.extension.indexOf(e)]:[em.FileDescriptorProto_Extension,this.file.proto.extension.indexOf(e)];return findComments(t.proto.sourceCodeInfo,r)},getFeatures(){var e,t;return n.resolveFeatures(this.file.edition,(null!==(e=this.parent)&&void 0!==e?e:this.file).getFeatures(),null===(t=this.proto.options)||void 0===t?void 0:t.features)}})}function makeTypeName(e,t,r){return assert(e.name,`invalid ${e.getType().typeName}: missing name`),t?`${t.typeName}.${e.name}`:void 0!==r.proto.package?`${r.proto.package}.${e.name}`:`${e.name}`}function trimLeadingDot(e){return e.startsWith(".")?e.substring(1):e}let eq={[Z.DOUBLE]:G.DOUBLE,[Z.FLOAT]:G.FLOAT,[Z.INT64]:G.INT64,[Z.UINT64]:G.UINT64,[Z.INT32]:G.INT32,[Z.FIXED64]:G.FIXED64,[Z.FIXED32]:G.FIXED32,[Z.BOOL]:G.BOOL,[Z.STRING]:G.STRING,[Z.GROUP]:void 0,[Z.MESSAGE]:void 0,[Z.BYTES]:G.BYTES,[Z.UINT32]:G.UINT32,[Z.ENUM]:void 0,[Z.SFIXED32]:G.SFIXED32,[Z.SFIXED64]:G.SFIXED64,[Z.SINT32]:G.SINT32,[Z.SINT64]:G.SINT64};function findComments(e,t){if(!e)return{leadingDetached:[],sourcePath:t};for(let r of e.location)if(!(r.path.length!==t.length||r.path.some((e,r)=>t[r]!==e)))return{leadingDetached:r.leadingDetachedComments,leading:r.leadingComments,trailing:r.trailingComments,sourcePath:t};return{leadingDetached:[],sourcePath:t}}function declarationString(){var e,t,r;let n;let i=[];this.repeated&&i.push("repeated"),this.optional&&i.push("optional");let o="extension"===this.kind?this.file:this.parent.file;switch("proto2"==o.syntax&&this.proto.label===Q.REQUIRED&&i.push("required"),this.fieldKind){case"scalar":n=G[this.scalar].toLowerCase();break;case"enum":n=this.enum.typeName;break;case"message":n=this.message.typeName;break;case"map":{let e;let t=G[this.mapKey].toLowerCase();switch(this.mapValue.kind){case"scalar":e=G[this.mapValue.scalar].toLowerCase();break;case"enum":e=this.mapValue.enum.typeName;break;case"message":e=this.mapValue.message.typeName}n=`map<${t}, ${e}>`}}i.push(`${n} ${this.name} = ${this.number}`);let s=[];(null===(e=this.proto.options)||void 0===e?void 0:e.packed)!==void 0&&s.push(`packed = ${this.proto.options.packed.toString()}`);let a=this.proto.defaultValue;return void 0!==a&&((this.proto.type==Z.BYTES||this.proto.type==Z.STRING)&&(a='"'+a.replace('"','\\"')+'"'),s.push(`default = ${a}`)),void 0!==this.jsonName&&s.push(`json_name = "${this.jsonName}"`),(null===(t=this.proto.options)||void 0===t?void 0:t.jstype)!==void 0&&s.push(`jstype = ${er[this.proto.options.jstype]}`),(null===(r=this.proto.options)||void 0===r?void 0:r.deprecated)===!0&&s.push("deprecated = true"),s.length>0&&i.push("["+s.join(", ")+"]"),i.join(" ")}function getDefaultValue(){let e=this.proto.defaultValue;if(void 0!==e)switch(this.fieldKind){case"enum":return function(e,t){let r=e.values.find(e=>e.name===t);return assert(r,`cannot parse ${e.name} default value: ${t}`),r.number}(this.enum,e);case"scalar":return function(e,t){switch(e){case G.STRING:return t;case G.BYTES:{let r=function(e){let t=[],r={tail:e,c:"",next(){return 0!=this.tail.length&&(this.c=this.tail[0],this.tail=this.tail.substring(1),!0)},take(e){if(this.tail.length>=e){let t=this.tail.substring(0,e);return this.tail=this.tail.substring(e),t}return!1}};for(;r.next();)if("\\"===r.c){if(r.next())switch(r.c){case"\\":t.push(r.c.charCodeAt(0));break;case"b":t.push(8);break;case"f":t.push(12);break;case"n":t.push(10);break;case"r":t.push(13);break;case"t":t.push(9);break;case"v":t.push(11);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":{let e=r.c,n=r.take(2);if(!1===n)return!1;let i=parseInt(e+n,8);if(isNaN(i))return!1;t.push(i);break}case"x":{let e=r.c,n=r.take(2);if(!1===n)return!1;let i=parseInt(e+n,16);if(isNaN(i))return!1;t.push(i);break}case"u":{let e=r.c,n=r.take(4);if(!1===n)return!1;let i=parseInt(e+n,16);if(isNaN(i))return!1;let o=new Uint8Array(4),s=new DataView(o.buffer);s.setInt32(0,i,!0),t.push(o[0],o[1],o[2],o[3]);break}case"U":{let e=r.c,n=r.take(8);if(!1===n)return!1;let i=eb.uEnc(e+n),o=new Uint8Array(8),s=new DataView(o.buffer);s.setInt32(0,i.lo,!0),s.setInt32(4,i.hi,!0),t.push(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7])}}}else t.push(r.c.charCodeAt(0));return new Uint8Array(t)}(t);if(!1===r)throw Error(`cannot parse ${G[e]} default value: ${t}`);return r}case G.INT64:case G.SFIXED64:case G.SINT64:return eb.parse(t);case G.UINT64:case G.FIXED64:return eb.uParse(t);case G.DOUBLE:case G.FLOAT:switch(t){case"inf":return Number.POSITIVE_INFINITY;case"-inf":return Number.NEGATIVE_INFINITY;case"nan":return Number.NaN;default:return parseFloat(t)}case G.BOOL:return"true"===t;case G.INT32:case G.UINT32:case G.SINT32:case G.FIXED32:case G.SFIXED32:return parseInt(t,10)}}(this.scalar,e);default:return}}(_=em||(em={}))[_.FileDescriptorProto_Package=2]="FileDescriptorProto_Package",_[_.FileDescriptorProto_MessageType=4]="FileDescriptorProto_MessageType",_[_.FileDescriptorProto_EnumType=5]="FileDescriptorProto_EnumType",_[_.FileDescriptorProto_Service=6]="FileDescriptorProto_Service",_[_.FileDescriptorProto_Extension=7]="FileDescriptorProto_Extension",_[_.FileDescriptorProto_Syntax=12]="FileDescriptorProto_Syntax",_[_.DescriptorProto_Field=2]="DescriptorProto_Field",_[_.DescriptorProto_NestedType=3]="DescriptorProto_NestedType",_[_.DescriptorProto_EnumType=4]="DescriptorProto_EnumType",_[_.DescriptorProto_Extension=6]="DescriptorProto_Extension",_[_.DescriptorProto_OneofDecl=8]="DescriptorProto_OneofDecl",_[_.EnumDescriptorProto_Value=2]="EnumDescriptorProto_Value",_[_.ServiceDescriptorProto_Method=2]="ServiceDescriptorProto_Method";let eG=class Timestamp2 extends Message{constructor(e){super(),this.seconds=eb.zero,this.nanos=0,eF.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw Error(`cannot decode google.protobuf.Timestamp from JSON: ${eF.json.debug(e)}`);let r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");let n=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(n))throw Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=eb.parse(n/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){let t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){let e=(this.nanos+1e9).toString().substring(1);r="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return Timestamp2.fromDate(new Date)}static fromDate(e){let t=e.getTime();return new Timestamp2({seconds:eb.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new Timestamp2().fromBinary(e,t)}static fromJson(e,t){return new Timestamp2().fromJson(e,t)}static fromJsonString(e,t){return new Timestamp2().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Timestamp2,e,t)}};eG.runtime=eF,eG.typeName="google.protobuf.Timestamp",eG.fields=eF.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);let Duration=class Duration extends Message{constructor(e){super(),this.seconds=eb.zero,this.nanos=0,eF.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw Error(`cannot decode google.protobuf.Duration from JSON: ${eF.json.debug(e)}`);let r=e.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(null===r)throw Error(`cannot decode google.protobuf.Duration from JSON: ${eF.json.debug(e)}`);let n=Number(r[1]);if(n>315576e6||n<-315576e6)throw Error(`cannot decode google.protobuf.Duration from JSON: ${eF.json.debug(e)}`);if(this.seconds=eb.parse(n),"string"==typeof r[2]){let e=r[2]+"0".repeat(9-r[2].length);this.nanos=parseInt(e),(n<0||Object.is(n,-0))&&(this.nanos=-this.nanos)}return this}toJson(e){if(Number(this.seconds)>315576e6||-315576e6>Number(this.seconds))throw Error("cannot encode google.protobuf.Duration to JSON: value out of range");let t=this.seconds.toString();if(0!==this.nanos){let e=Math.abs(this.nanos).toString();"000000"===(e="0".repeat(9-e.length)+e).substring(3)?e=e.substring(0,3):"000"===e.substring(6)&&(e=e.substring(0,6)),t+="."+e,this.nanos<0&&0==Number(this.seconds)&&(t="-"+t)}return t+"s"}static fromBinary(e,t){return new Duration().fromBinary(e,t)}static fromJson(e,t){return new Duration().fromJson(e,t)}static fromJsonString(e,t){return new Duration().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Duration,e,t)}};Duration.runtime=eF,Duration.typeName="google.protobuf.Duration",Duration.fields=eF.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);let Any=class Any extends Message{constructor(e){super(),this.typeUrl="",this.value=new Uint8Array(0),eF.util.initPartial(e,this)}toJson(e){var t;if(""===this.typeUrl)return{};let r=this.typeUrlToName(this.typeUrl),n=null===(t=null==e?void 0:e.typeRegistry)||void 0===t?void 0:t.findMessage(r);if(!n)throw Error(`cannot encode message google.protobuf.Any to JSON: "${this.typeUrl}" is not in the type registry`);let i=n.fromBinary(this.value),o=i.toJson(e);return(r.startsWith("google.protobuf.")||null===o||Array.isArray(o)||"object"!=typeof o)&&(o={value:o}),o["@type"]=this.typeUrl,o}fromJson(e,t){var r;let n;if(null===e||Array.isArray(e)||"object"!=typeof e)throw Error(`cannot decode message google.protobuf.Any from JSON: expected object but got ${null===e?"null":Array.isArray(e)?"array":typeof e}`);if(0==Object.keys(e).length)return this;let i=e["@type"];if("string"!=typeof i||""==i)throw Error('cannot decode message google.protobuf.Any from JSON: "@type" is empty');let o=this.typeUrlToName(i),s=null===(r=null==t?void 0:t.typeRegistry)||void 0===r?void 0:r.findMessage(o);if(!s)throw Error(`cannot decode message google.protobuf.Any from JSON: ${i} is not in the type registry`);if(o.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(e,"value"))n=s.fromJson(e.value,t);else{let r=Object.assign({},e);delete r["@type"],n=s.fromJson(r,t)}return this.packFrom(n),this}packFrom(e){this.value=e.toBinary(),this.typeUrl=this.typeNameToUrl(e.getType().typeName)}unpackTo(e){return!!this.is(e.getType())&&(e.fromBinary(this.value),!0)}unpack(e){if(""===this.typeUrl)return;let t=e.findMessage(this.typeUrlToName(this.typeUrl));if(t)return t.fromBinary(this.value)}is(e){if(""===this.typeUrl)return!1;let t=this.typeUrlToName(this.typeUrl);return t===("string"==typeof e?e:e.typeName)}typeNameToUrl(e){return`type.googleapis.com/${e}`}typeUrlToName(e){if(!e.length)throw Error(`invalid type url: ${e}`);let t=e.lastIndexOf("/"),r=t>=0?e.substring(t+1):e;if(!r.length)throw Error(`invalid type url: ${e}`);return r}static pack(e){let t=new Any;return t.packFrom(e),t}static fromBinary(e,t){return new Any().fromBinary(e,t)}static fromJson(e,t){return new Any().fromJson(e,t)}static fromJsonString(e,t){return new Any().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Any,e,t)}};Any.runtime=eF,Any.typeName="google.protobuf.Any",Any.fields=eF.util.newFieldList(()=>[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}]);let Empty=class Empty extends Message{constructor(e){super(),eF.util.initPartial(e,this)}static fromBinary(e,t){return new Empty().fromBinary(e,t)}static fromJson(e,t){return new Empty().fromJson(e,t)}static fromJsonString(e,t){return new Empty().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Empty,e,t)}};Empty.runtime=eF,Empty.typeName="google.protobuf.Empty",Empty.fields=eF.util.newFieldList(()=>[]);let FieldMask=class FieldMask extends Message{constructor(e){super(),this.paths=[],eF.util.initPartial(e,this)}toJson(e){return this.paths.map(e=>{if(e.match(/_[0-9]?_/g)||e.match(/[A-Z]/g))throw Error('cannot encode google.protobuf.FieldMask to JSON: lowerCamelCase of path name "'+e+'" is irreversible');return function(e){let t=!1,r=[];for(let n=0;n<e.length;n++){let i=e.charAt(n);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),r.push(i)}}return r.join("")}(e)}).join(",")}fromJson(e,t){if("string"!=typeof e)throw Error("cannot decode google.protobuf.FieldMask from JSON: "+eF.json.debug(e));return""===e||(this.paths=e.split(",").map(function(e){if(e.includes("_"))throw Error("cannot decode google.protobuf.FieldMask from JSON: path names must be lowerCamelCase");let t=e.replace(/[A-Z]/g,e=>"_"+e.toLowerCase());return"_"===t[0]?t.substring(1):t})),this}static fromBinary(e,t){return new FieldMask().fromBinary(e,t)}static fromJson(e,t){return new FieldMask().fromJson(e,t)}static fromJsonString(e,t){return new FieldMask().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(FieldMask,e,t)}};FieldMask.runtime=eF,FieldMask.typeName="google.protobuf.FieldMask",FieldMask.fields=eF.util.newFieldList(()=>[{no:1,name:"paths",kind:"scalar",T:9,repeated:!0}]),(O=ep||(ep={}))[O.NULL_VALUE=0]="NULL_VALUE",eF.util.setEnumType(ep,"google.protobuf.NullValue",[{no:0,name:"NULL_VALUE"}]);let Struct=class Struct extends Message{constructor(e){super(),this.fields={},eF.util.initPartial(e,this)}toJson(e){let t={};for(let[r,n]of Object.entries(this.fields))t[r]=n.toJson(e);return t}fromJson(e,t){if("object"!=typeof e||null==e||Array.isArray(e))throw Error("cannot decode google.protobuf.Struct from JSON "+eF.json.debug(e));for(let[t,r]of Object.entries(e))this.fields[t]=Value.fromJson(r);return this}static fromBinary(e,t){return new Struct().fromBinary(e,t)}static fromJson(e,t){return new Struct().fromJson(e,t)}static fromJsonString(e,t){return new Struct().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Struct,e,t)}};Struct.runtime=eF,Struct.typeName="google.protobuf.Struct",Struct.fields=eF.util.newFieldList(()=>[{no:1,name:"fields",kind:"map",K:9,V:{kind:"message",T:Value}}]);let Value=class Value extends Message{constructor(e){super(),this.kind={case:void 0},eF.util.initPartial(e,this)}toJson(e){switch(this.kind.case){case"nullValue":return null;case"numberValue":if(!Number.isFinite(this.kind.value))throw Error("google.protobuf.Value cannot be NaN or Infinity");return this.kind.value;case"boolValue":case"stringValue":return this.kind.value;case"structValue":case"listValue":return this.kind.value.toJson(Object.assign(Object.assign({},e),{emitDefaultValues:!0}))}throw Error("google.protobuf.Value must have a value")}fromJson(e,t){switch(typeof e){case"number":this.kind={case:"numberValue",value:e};break;case"string":this.kind={case:"stringValue",value:e};break;case"boolean":this.kind={case:"boolValue",value:e};break;case"object":null===e?this.kind={case:"nullValue",value:ep.NULL_VALUE}:Array.isArray(e)?this.kind={case:"listValue",value:ListValue.fromJson(e)}:this.kind={case:"structValue",value:Struct.fromJson(e)};break;default:throw Error("cannot decode google.protobuf.Value from JSON "+eF.json.debug(e))}return this}static fromBinary(e,t){return new Value().fromBinary(e,t)}static fromJson(e,t){return new Value().fromJson(e,t)}static fromJsonString(e,t){return new Value().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Value,e,t)}};Value.runtime=eF,Value.typeName="google.protobuf.Value",Value.fields=eF.util.newFieldList(()=>[{no:1,name:"null_value",kind:"enum",T:eF.getEnumType(ep),oneof:"kind"},{no:2,name:"number_value",kind:"scalar",T:1,oneof:"kind"},{no:3,name:"string_value",kind:"scalar",T:9,oneof:"kind"},{no:4,name:"bool_value",kind:"scalar",T:8,oneof:"kind"},{no:5,name:"struct_value",kind:"message",T:Struct,oneof:"kind"},{no:6,name:"list_value",kind:"message",T:ListValue,oneof:"kind"}]);let ListValue=class ListValue extends Message{constructor(e){super(),this.values=[],eF.util.initPartial(e,this)}toJson(e){return this.values.map(e=>e.toJson())}fromJson(e,t){if(!Array.isArray(e))throw Error("cannot decode google.protobuf.ListValue from JSON "+eF.json.debug(e));for(let t of e)this.values.push(Value.fromJson(t));return this}static fromBinary(e,t){return new ListValue().fromBinary(e,t)}static fromJson(e,t){return new ListValue().fromJson(e,t)}static fromJsonString(e,t){return new ListValue().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(ListValue,e,t)}};ListValue.runtime=eF,ListValue.typeName="google.protobuf.ListValue",ListValue.fields=eF.util.newFieldList(()=>[{no:1,name:"values",kind:"message",T:Value,repeated:!0}]);let DoubleValue=class DoubleValue extends Message{constructor(e){super(),this.value=0,eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.DOUBLE,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.DOUBLE,e)}catch(t){let e='cannot decode message google.protobuf.DoubleValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new DoubleValue().fromBinary(e,t)}static fromJson(e,t){return new DoubleValue().fromJson(e,t)}static fromJsonString(e,t){return new DoubleValue().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(DoubleValue,e,t)}};DoubleValue.runtime=eF,DoubleValue.typeName="google.protobuf.DoubleValue",DoubleValue.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:1}]),DoubleValue.fieldWrapper={wrapField:e=>new DoubleValue({value:e}),unwrapField:e=>e.value};let FloatValue=class FloatValue extends Message{constructor(e){super(),this.value=0,eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.FLOAT,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.FLOAT,e)}catch(t){let e='cannot decode message google.protobuf.FloatValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new FloatValue().fromBinary(e,t)}static fromJson(e,t){return new FloatValue().fromJson(e,t)}static fromJsonString(e,t){return new FloatValue().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(FloatValue,e,t)}};FloatValue.runtime=eF,FloatValue.typeName="google.protobuf.FloatValue",FloatValue.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:2}]),FloatValue.fieldWrapper={wrapField:e=>new FloatValue({value:e}),unwrapField:e=>e.value};let Int64Value=class Int64Value extends Message{constructor(e){super(),this.value=eb.zero,eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.INT64,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.INT64,e)}catch(t){let e='cannot decode message google.protobuf.Int64Value from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new Int64Value().fromBinary(e,t)}static fromJson(e,t){return new Int64Value().fromJson(e,t)}static fromJsonString(e,t){return new Int64Value().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Int64Value,e,t)}};Int64Value.runtime=eF,Int64Value.typeName="google.protobuf.Int64Value",Int64Value.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:3}]),Int64Value.fieldWrapper={wrapField:e=>new Int64Value({value:e}),unwrapField:e=>e.value};let UInt64Value=class UInt64Value extends Message{constructor(e){super(),this.value=eb.zero,eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.UINT64,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.UINT64,e)}catch(t){let e='cannot decode message google.protobuf.UInt64Value from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new UInt64Value().fromBinary(e,t)}static fromJson(e,t){return new UInt64Value().fromJson(e,t)}static fromJsonString(e,t){return new UInt64Value().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(UInt64Value,e,t)}};UInt64Value.runtime=eF,UInt64Value.typeName="google.protobuf.UInt64Value",UInt64Value.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:4}]),UInt64Value.fieldWrapper={wrapField:e=>new UInt64Value({value:e}),unwrapField:e=>e.value};let Int32Value=class Int32Value extends Message{constructor(e){super(),this.value=0,eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.INT32,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.INT32,e)}catch(t){let e='cannot decode message google.protobuf.Int32Value from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new Int32Value().fromBinary(e,t)}static fromJson(e,t){return new Int32Value().fromJson(e,t)}static fromJsonString(e,t){return new Int32Value().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Int32Value,e,t)}};Int32Value.runtime=eF,Int32Value.typeName="google.protobuf.Int32Value",Int32Value.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:5}]),Int32Value.fieldWrapper={wrapField:e=>new Int32Value({value:e}),unwrapField:e=>e.value};let UInt32Value=class UInt32Value extends Message{constructor(e){super(),this.value=0,eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.UINT32,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.UINT32,e)}catch(t){let e='cannot decode message google.protobuf.UInt32Value from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new UInt32Value().fromBinary(e,t)}static fromJson(e,t){return new UInt32Value().fromJson(e,t)}static fromJsonString(e,t){return new UInt32Value().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(UInt32Value,e,t)}};UInt32Value.runtime=eF,UInt32Value.typeName="google.protobuf.UInt32Value",UInt32Value.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:13}]),UInt32Value.fieldWrapper={wrapField:e=>new UInt32Value({value:e}),unwrapField:e=>e.value};let BoolValue=class BoolValue extends Message{constructor(e){super(),this.value=!1,eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.BOOL,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.BOOL,e)}catch(t){let e='cannot decode message google.protobuf.BoolValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new BoolValue().fromBinary(e,t)}static fromJson(e,t){return new BoolValue().fromJson(e,t)}static fromJsonString(e,t){return new BoolValue().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(BoolValue,e,t)}};BoolValue.runtime=eF,BoolValue.typeName="google.protobuf.BoolValue",BoolValue.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:8}]),BoolValue.fieldWrapper={wrapField:e=>new BoolValue({value:e}),unwrapField:e=>e.value};let eY=class StringValue2 extends Message{constructor(e){super(),this.value="",eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.STRING,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.STRING,e)}catch(t){let e='cannot decode message google.protobuf.StringValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new StringValue2().fromBinary(e,t)}static fromJson(e,t){return new StringValue2().fromJson(e,t)}static fromJsonString(e,t){return new StringValue2().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(StringValue2,e,t)}};eY.runtime=eF,eY.typeName="google.protobuf.StringValue",eY.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9}]),eY.fieldWrapper={wrapField:e=>new eY({value:e}),unwrapField:e=>e.value};let BytesValue=class BytesValue extends Message{constructor(e){super(),this.value=new Uint8Array(0),eF.util.initPartial(e,this)}toJson(e){return eF.json.writeScalar(G.BYTES,this.value,!0)}fromJson(e,t){try{this.value=eF.json.readScalar(G.BYTES,e)}catch(t){let e='cannot decode message google.protobuf.BytesValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new BytesValue().fromBinary(e,t)}static fromJson(e,t){return new BytesValue().fromJson(e,t)}static fromJsonString(e,t){return new BytesValue().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(BytesValue,e,t)}};BytesValue.runtime=eF,BytesValue.typeName="google.protobuf.BytesValue",BytesValue.fields=eF.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:12}]),BytesValue.fieldWrapper={wrapField:e=>new BytesValue({value:e}),unwrapField:e=>e.value};let eK=[Any,Duration,Empty,FieldMask,Struct,Value,ListValue,eG,Duration,DoubleValue,FloatValue,Int64Value,Int32Value,UInt32Value,UInt64Value,BoolValue,eY,BytesValue],ez=[getEnumType(ep)];function toPlainMessage(e){if(!(e instanceof Message))return e;let t=e.getType(),r={};for(let n of t.fields.byMember()){let t;let i=e[n.localName];if(n.repeated)t=i.map(e=>toPlainValue(e));else if("map"==n.kind)for(let[e,r]of(t={},Object.entries(i)))t[e]=toPlainValue(r);else if("oneof"==n.kind){let e=n.findField(i.case);t=e?{case:i.case,value:toPlainValue(i.value)}:{case:void 0}}else t=toPlainValue(i);r[n.localName]=t}return r}function toPlainValue(e){if(void 0===e)return e;if(e instanceof Message)return toPlainMessage(e);if(e instanceof Uint8Array){let t=new Uint8Array(e.byteLength);return t.set(e),t}return e}let Version=class Version extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new Version().fromBinary(e,t)}static fromJson(e,t){return new Version().fromJson(e,t)}static fromJsonString(e,t){return new Version().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(Version,e,t)}};Version.runtime=eL,Version.typeName="google.protobuf.compiler.Version",Version.fields=eL.util.newFieldList(()=>[{no:1,name:"major",kind:"scalar",T:5,opt:!0},{no:2,name:"minor",kind:"scalar",T:5,opt:!0},{no:3,name:"patch",kind:"scalar",T:5,opt:!0},{no:4,name:"suffix",kind:"scalar",T:9,opt:!0}]);let CodeGeneratorRequest=class CodeGeneratorRequest extends Message{constructor(e){super(),this.fileToGenerate=[],this.protoFile=[],this.sourceFileDescriptors=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new CodeGeneratorRequest().fromBinary(e,t)}static fromJson(e,t){return new CodeGeneratorRequest().fromJson(e,t)}static fromJsonString(e,t){return new CodeGeneratorRequest().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(CodeGeneratorRequest,e,t)}};CodeGeneratorRequest.runtime=eL,CodeGeneratorRequest.typeName="google.protobuf.compiler.CodeGeneratorRequest",CodeGeneratorRequest.fields=eL.util.newFieldList(()=>[{no:1,name:"file_to_generate",kind:"scalar",T:9,repeated:!0},{no:2,name:"parameter",kind:"scalar",T:9,opt:!0},{no:15,name:"proto_file",kind:"message",T:FileDescriptorProto,repeated:!0},{no:17,name:"source_file_descriptors",kind:"message",T:FileDescriptorProto,repeated:!0},{no:3,name:"compiler_version",kind:"message",T:Version,opt:!0}]);let CodeGeneratorResponse=class CodeGeneratorResponse extends Message{constructor(e){super(),this.file=[],eL.util.initPartial(e,this)}static fromBinary(e,t){return new CodeGeneratorResponse().fromBinary(e,t)}static fromJson(e,t){return new CodeGeneratorResponse().fromJson(e,t)}static fromJsonString(e,t){return new CodeGeneratorResponse().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(CodeGeneratorResponse,e,t)}};CodeGeneratorResponse.runtime=eL,CodeGeneratorResponse.typeName="google.protobuf.compiler.CodeGeneratorResponse",CodeGeneratorResponse.fields=eL.util.newFieldList(()=>[{no:1,name:"error",kind:"scalar",T:9,opt:!0},{no:2,name:"supported_features",kind:"scalar",T:4,opt:!0},{no:15,name:"file",kind:"message",T:CodeGeneratorResponse_File,repeated:!0}]),(k=ef||(ef={}))[k.NONE=0]="NONE",k[k.PROTO3_OPTIONAL=1]="PROTO3_OPTIONAL",k[k.SUPPORTS_EDITIONS=2]="SUPPORTS_EDITIONS",eL.util.setEnumType(ef,"google.protobuf.compiler.CodeGeneratorResponse.Feature",[{no:0,name:"FEATURE_NONE"},{no:1,name:"FEATURE_PROTO3_OPTIONAL"},{no:2,name:"FEATURE_SUPPORTS_EDITIONS"}]);let CodeGeneratorResponse_File=class CodeGeneratorResponse_File extends Message{constructor(e){super(),eL.util.initPartial(e,this)}static fromBinary(e,t){return new CodeGeneratorResponse_File().fromBinary(e,t)}static fromJson(e,t){return new CodeGeneratorResponse_File().fromJson(e,t)}static fromJsonString(e,t){return new CodeGeneratorResponse_File().fromJsonString(e,t)}static equals(e,t){return eL.util.equals(CodeGeneratorResponse_File,e,t)}};CodeGeneratorResponse_File.runtime=eL,CodeGeneratorResponse_File.typeName="google.protobuf.compiler.CodeGeneratorResponse.File",CodeGeneratorResponse_File.fields=eL.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"insertion_point",kind:"scalar",T:9,opt:!0},{no:15,name:"content",kind:"scalar",T:9,opt:!0},{no:16,name:"generated_code_info",kind:"message",T:GeneratedCodeInfo,opt:!0}]);let SourceContext=class SourceContext extends Message{constructor(e){super(),this.fileName="",eF.util.initPartial(e,this)}static fromBinary(e,t){return new SourceContext().fromBinary(e,t)}static fromJson(e,t){return new SourceContext().fromJson(e,t)}static fromJsonString(e,t){return new SourceContext().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(SourceContext,e,t)}};SourceContext.runtime=eF,SourceContext.typeName="google.protobuf.SourceContext",SourceContext.fields=eF.util.newFieldList(()=>[{no:1,name:"file_name",kind:"scalar",T:9}]),(D=eg||(eg={}))[D.PROTO2=0]="PROTO2",D[D.PROTO3=1]="PROTO3",D[D.EDITIONS=2]="EDITIONS",eF.util.setEnumType(eg,"google.protobuf.Syntax",[{no:0,name:"SYNTAX_PROTO2"},{no:1,name:"SYNTAX_PROTO3"},{no:2,name:"SYNTAX_EDITIONS"}]);let Type=class Type extends Message{constructor(e){super(),this.name="",this.fields=[],this.oneofs=[],this.options=[],this.syntax=eg.PROTO2,this.edition="",eF.util.initPartial(e,this)}static fromBinary(e,t){return new Type().fromBinary(e,t)}static fromJson(e,t){return new Type().fromJson(e,t)}static fromJsonString(e,t){return new Type().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Type,e,t)}};Type.runtime=eF,Type.typeName="google.protobuf.Type",Type.fields=eF.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"fields",kind:"message",T:Field,repeated:!0},{no:3,name:"oneofs",kind:"scalar",T:9,repeated:!0},{no:4,name:"options",kind:"message",T:Option,repeated:!0},{no:5,name:"source_context",kind:"message",T:SourceContext},{no:6,name:"syntax",kind:"enum",T:eF.getEnumType(eg)},{no:7,name:"edition",kind:"scalar",T:9}]);let Field=class Field extends Message{constructor(e){super(),this.kind=eT.TYPE_UNKNOWN,this.cardinality=ey.UNKNOWN,this.number=0,this.name="",this.typeUrl="",this.oneofIndex=0,this.packed=!1,this.options=[],this.jsonName="",this.defaultValue="",eF.util.initPartial(e,this)}static fromBinary(e,t){return new Field().fromBinary(e,t)}static fromJson(e,t){return new Field().fromJson(e,t)}static fromJsonString(e,t){return new Field().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Field,e,t)}};Field.runtime=eF,Field.typeName="google.protobuf.Field",Field.fields=eF.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:eF.getEnumType(eT)},{no:2,name:"cardinality",kind:"enum",T:eF.getEnumType(ey)},{no:3,name:"number",kind:"scalar",T:5},{no:4,name:"name",kind:"scalar",T:9},{no:6,name:"type_url",kind:"scalar",T:9},{no:7,name:"oneof_index",kind:"scalar",T:5},{no:8,name:"packed",kind:"scalar",T:8},{no:9,name:"options",kind:"message",T:Option,repeated:!0},{no:10,name:"json_name",kind:"scalar",T:9},{no:11,name:"default_value",kind:"scalar",T:9}]),(A=eT||(eT={}))[A.TYPE_UNKNOWN=0]="TYPE_UNKNOWN",A[A.TYPE_DOUBLE=1]="TYPE_DOUBLE",A[A.TYPE_FLOAT=2]="TYPE_FLOAT",A[A.TYPE_INT64=3]="TYPE_INT64",A[A.TYPE_UINT64=4]="TYPE_UINT64",A[A.TYPE_INT32=5]="TYPE_INT32",A[A.TYPE_FIXED64=6]="TYPE_FIXED64",A[A.TYPE_FIXED32=7]="TYPE_FIXED32",A[A.TYPE_BOOL=8]="TYPE_BOOL",A[A.TYPE_STRING=9]="TYPE_STRING",A[A.TYPE_GROUP=10]="TYPE_GROUP",A[A.TYPE_MESSAGE=11]="TYPE_MESSAGE",A[A.TYPE_BYTES=12]="TYPE_BYTES",A[A.TYPE_UINT32=13]="TYPE_UINT32",A[A.TYPE_ENUM=14]="TYPE_ENUM",A[A.TYPE_SFIXED32=15]="TYPE_SFIXED32",A[A.TYPE_SFIXED64=16]="TYPE_SFIXED64",A[A.TYPE_SINT32=17]="TYPE_SINT32",A[A.TYPE_SINT64=18]="TYPE_SINT64",eF.util.setEnumType(eT,"google.protobuf.Field.Kind",[{no:0,name:"TYPE_UNKNOWN"},{no:1,name:"TYPE_DOUBLE"},{no:2,name:"TYPE_FLOAT"},{no:3,name:"TYPE_INT64"},{no:4,name:"TYPE_UINT64"},{no:5,name:"TYPE_INT32"},{no:6,name:"TYPE_FIXED64"},{no:7,name:"TYPE_FIXED32"},{no:8,name:"TYPE_BOOL"},{no:9,name:"TYPE_STRING"},{no:10,name:"TYPE_GROUP"},{no:11,name:"TYPE_MESSAGE"},{no:12,name:"TYPE_BYTES"},{no:13,name:"TYPE_UINT32"},{no:14,name:"TYPE_ENUM"},{no:15,name:"TYPE_SFIXED32"},{no:16,name:"TYPE_SFIXED64"},{no:17,name:"TYPE_SINT32"},{no:18,name:"TYPE_SINT64"}]),(P=ey||(ey={}))[P.UNKNOWN=0]="UNKNOWN",P[P.OPTIONAL=1]="OPTIONAL",P[P.REQUIRED=2]="REQUIRED",P[P.REPEATED=3]="REPEATED",eF.util.setEnumType(ey,"google.protobuf.Field.Cardinality",[{no:0,name:"CARDINALITY_UNKNOWN"},{no:1,name:"CARDINALITY_OPTIONAL"},{no:2,name:"CARDINALITY_REQUIRED"},{no:3,name:"CARDINALITY_REPEATED"}]);let Enum=class Enum extends Message{constructor(e){super(),this.name="",this.enumvalue=[],this.options=[],this.syntax=eg.PROTO2,this.edition="",eF.util.initPartial(e,this)}static fromBinary(e,t){return new Enum().fromBinary(e,t)}static fromJson(e,t){return new Enum().fromJson(e,t)}static fromJsonString(e,t){return new Enum().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Enum,e,t)}};Enum.runtime=eF,Enum.typeName="google.protobuf.Enum",Enum.fields=eF.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"enumvalue",kind:"message",T:EnumValue,repeated:!0},{no:3,name:"options",kind:"message",T:Option,repeated:!0},{no:4,name:"source_context",kind:"message",T:SourceContext},{no:5,name:"syntax",kind:"enum",T:eF.getEnumType(eg)},{no:6,name:"edition",kind:"scalar",T:9}]);let EnumValue=class EnumValue extends Message{constructor(e){super(),this.name="",this.number=0,this.options=[],eF.util.initPartial(e,this)}static fromBinary(e,t){return new EnumValue().fromBinary(e,t)}static fromJson(e,t){return new EnumValue().fromJson(e,t)}static fromJsonString(e,t){return new EnumValue().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(EnumValue,e,t)}};EnumValue.runtime=eF,EnumValue.typeName="google.protobuf.EnumValue",EnumValue.fields=eF.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"number",kind:"scalar",T:5},{no:3,name:"options",kind:"message",T:Option,repeated:!0}]);let Option=class Option extends Message{constructor(e){super(),this.name="",eF.util.initPartial(e,this)}static fromBinary(e,t){return new Option().fromBinary(e,t)}static fromJson(e,t){return new Option().fromJson(e,t)}static fromJsonString(e,t){return new Option().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Option,e,t)}};Option.runtime=eF,Option.typeName="google.protobuf.Option",Option.fields=eF.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"value",kind:"message",T:Any}]);let Api=class Api extends Message{constructor(e){super(),this.name="",this.methods=[],this.options=[],this.version="",this.mixins=[],this.syntax=eg.PROTO2,eF.util.initPartial(e,this)}static fromBinary(e,t){return new Api().fromBinary(e,t)}static fromJson(e,t){return new Api().fromJson(e,t)}static fromJsonString(e,t){return new Api().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Api,e,t)}};Api.runtime=eF,Api.typeName="google.protobuf.Api",Api.fields=eF.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"methods",kind:"message",T:Method,repeated:!0},{no:3,name:"options",kind:"message",T:Option,repeated:!0},{no:4,name:"version",kind:"scalar",T:9},{no:5,name:"source_context",kind:"message",T:SourceContext},{no:6,name:"mixins",kind:"message",T:Mixin,repeated:!0},{no:7,name:"syntax",kind:"enum",T:eF.getEnumType(eg)}]);let Method=class Method extends Message{constructor(e){super(),this.name="",this.requestTypeUrl="",this.requestStreaming=!1,this.responseTypeUrl="",this.responseStreaming=!1,this.options=[],this.syntax=eg.PROTO2,eF.util.initPartial(e,this)}static fromBinary(e,t){return new Method().fromBinary(e,t)}static fromJson(e,t){return new Method().fromJson(e,t)}static fromJsonString(e,t){return new Method().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Method,e,t)}};Method.runtime=eF,Method.typeName="google.protobuf.Method",Method.fields=eF.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"request_type_url",kind:"scalar",T:9},{no:3,name:"request_streaming",kind:"scalar",T:8},{no:4,name:"response_type_url",kind:"scalar",T:9},{no:5,name:"response_streaming",kind:"scalar",T:8},{no:6,name:"options",kind:"message",T:Option,repeated:!0},{no:7,name:"syntax",kind:"enum",T:eF.getEnumType(eg)}]);let Mixin=class Mixin extends Message{constructor(e){super(),this.name="",this.root="",eF.util.initPartial(e,this)}static fromBinary(e,t){return new Mixin().fromBinary(e,t)}static fromJson(e,t){return new Mixin().fromJson(e,t)}static fromJsonString(e,t){return new Mixin().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Mixin,e,t)}};Mixin.runtime=eF,Mixin.typeName="google.protobuf.Mixin",Mixin.fields=eF.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"root",kind:"scalar",T:9}]);let eW=Object.freeze(Object.defineProperty({__proto__:null,Any,Api,BinaryReader,BinaryWriter,BoolValue,BytesValue,CodeGeneratorRequest,CodeGeneratorResponse,get CodeGeneratorResponse_Feature(){return ef},CodeGeneratorResponse_File,DescriptorProto,DescriptorProto_ExtensionRange,DescriptorProto_ReservedRange,DoubleValue,Duration,get Edition(){return H},Empty,Enum,EnumDescriptorProto,EnumDescriptorProto_EnumReservedRange,EnumOptions,EnumValue,EnumValueDescriptorProto,EnumValueOptions,ExtensionRangeOptions,ExtensionRangeOptions_Declaration,get ExtensionRangeOptions_VerificationState(){return X},FeatureSet,FeatureSetDefaults,FeatureSetDefaults_FeatureSetEditionDefault,get FeatureSet_EnumType(){return ea},get FeatureSet_FieldPresence(){return es},get FeatureSet_JsonFormat(){return ec},get FeatureSet_MessageEncoding(){return ed},get FeatureSet_RepeatedFieldEncoding(){return el},get FeatureSet_Utf8Validation(){return eu},Field,FieldDescriptorProto,get FieldDescriptorProto_Label(){return Q},get FieldDescriptorProto_Type(){return Z},FieldMask,FieldOptions,get FieldOptions_CType(){return et},FieldOptions_EditionDefault,get FieldOptions_JSType(){return er},get FieldOptions_OptionRetention(){return en},get FieldOptions_OptionTargetType(){return ei},get Field_Cardinality(){return ey},get Field_Kind(){return eT},FileDescriptorProto,FileDescriptorSet,FileOptions,get FileOptions_OptimizeMode(){return ee},FloatValue,GeneratedCodeInfo,GeneratedCodeInfo_Annotation,get GeneratedCodeInfo_Annotation_Semantic(){return eh},Int32Value,Int64Value,ListValue,get LongType(){return Y},Message,MessageOptions,Method,MethodDescriptorProto,get MethodIdempotency(){return W},get MethodKind(){return z},MethodOptions,get MethodOptions_IdempotencyLevel(){return eo},Mixin,get NullValue(){return ep},OneofDescriptorProto,OneofOptions,Option,get ScalarType(){return G},ServiceDescriptorProto,ServiceOptions,SourceCodeInfo,SourceCodeInfo_Location,SourceContext,StringValue:eY,Struct,get Syntax(){return eg},Timestamp:eG,Type,UInt32Value,UInt64Value,UninterpretedOption,UninterpretedOption_NamePart,Value,Version,get WireType(){return K},codegenInfo:{packageName:"@bufbuild/protobuf",localName,reifyWkt:function(e){switch(e.typeName){case"google.protobuf.Any":{let t=e.fields.find(e=>1==e.number&&"scalar"==e.fieldKind&&e.scalar===G.STRING),r=e.fields.find(e=>2==e.number&&"scalar"==e.fieldKind&&e.scalar===G.BYTES);if(t&&r)return{typeName:e.typeName,typeUrl:t,value:r};break}case"google.protobuf.Timestamp":{let t=e.fields.find(e=>1==e.number&&"scalar"==e.fieldKind&&e.scalar===G.INT64),r=e.fields.find(e=>2==e.number&&"scalar"==e.fieldKind&&e.scalar===G.INT32);if(t&&r)return{typeName:e.typeName,seconds:t,nanos:r};break}case"google.protobuf.Duration":{let t=e.fields.find(e=>1==e.number&&"scalar"==e.fieldKind&&e.scalar===G.INT64),r=e.fields.find(e=>2==e.number&&"scalar"==e.fieldKind&&e.scalar===G.INT32);if(t&&r)return{typeName:e.typeName,seconds:t,nanos:r};break}case"google.protobuf.Struct":{let t=e.fields.find(e=>1==e.number&&!e.repeated);if((null==t?void 0:t.fieldKind)!=="map"||"message"!==t.mapValue.kind||"google.protobuf.Value"!==t.mapValue.message.typeName)break;return{typeName:e.typeName,fields:t}}case"google.protobuf.Value":{let t=e.oneofs.find(e=>"kind"===e.name),r=e.fields.find(e=>1==e.number&&e.oneof===t);if((null==r?void 0:r.fieldKind)!=="enum"||"google.protobuf.NullValue"!==r.enum.typeName)return;let n=e.fields.find(e=>2==e.number&&"scalar"==e.fieldKind&&e.scalar===G.DOUBLE&&e.oneof===t),i=e.fields.find(e=>3==e.number&&"scalar"==e.fieldKind&&e.scalar===G.STRING&&e.oneof===t),o=e.fields.find(e=>4==e.number&&"scalar"==e.fieldKind&&e.scalar===G.BOOL&&e.oneof===t),s=e.fields.find(e=>5==e.number&&e.oneof===t);if((null==s?void 0:s.fieldKind)!=="message"||"google.protobuf.Struct"!==s.message.typeName)return;let a=e.fields.find(e=>6==e.number&&e.oneof===t);if((null==a?void 0:a.fieldKind)!=="message"||"google.protobuf.ListValue"!==a.message.typeName)return;if(t&&n&&i&&o)return{typeName:e.typeName,kind:t,nullValue:r,numberValue:n,stringValue:i,boolValue:o,structValue:s,listValue:a};break}case"google.protobuf.ListValue":{let t=e.fields.find(e=>1==e.number&&e.repeated);if((null==t?void 0:t.fieldKind)!="message"||"google.protobuf.Value"!==t.message.typeName)break;return{typeName:e.typeName,values:t}}case"google.protobuf.FieldMask":{let t=e.fields.find(e=>1==e.number&&"scalar"==e.fieldKind&&e.scalar===G.STRING&&e.repeated);if(t)return{typeName:e.typeName,paths:t};break}case"google.protobuf.DoubleValue":case"google.protobuf.FloatValue":case"google.protobuf.Int64Value":case"google.protobuf.UInt64Value":case"google.protobuf.Int32Value":case"google.protobuf.UInt32Value":case"google.protobuf.BoolValue":case"google.protobuf.StringValue":case"google.protobuf.BytesValue":{let t=e.fields.find(e=>1==e.number&&"value"==e.name);if(!t||"scalar"!==t.fieldKind)break;return{typeName:e.typeName,value:t}}}},getUnwrappedFieldType:function(e){if("message"===e.fieldKind&&!e.repeated&&void 0==e.oneof)return eE[e.message.typeName]},scalarDefaultValue,safeIdentifier,safeObjectProperty,symbols:{proto2:{typeOnly:!1,privateImportPath:"./proto2.js",publicImportPath:ej},proto3:{typeOnly:!1,privateImportPath:"./proto3.js",publicImportPath:ej},Message:{typeOnly:!1,privateImportPath:"./message.js",publicImportPath:ej},PartialMessage:{typeOnly:!0,privateImportPath:"./message.js",publicImportPath:ej},PlainMessage:{typeOnly:!0,privateImportPath:"./message.js",publicImportPath:ej},FieldList:{typeOnly:!0,privateImportPath:"./field-list.js",publicImportPath:ej},MessageType:{typeOnly:!0,privateImportPath:"./message-type.js",publicImportPath:ej},BinaryReadOptions:{typeOnly:!0,privateImportPath:"./binary-format.js",publicImportPath:ej},BinaryWriteOptions:{typeOnly:!0,privateImportPath:"./binary-format.js",publicImportPath:ej},JsonReadOptions:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:ej},JsonWriteOptions:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:ej},JsonValue:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:ej},JsonObject:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:ej},protoDouble:{typeOnly:!1,privateImportPath:"./proto-double.js",publicImportPath:ej},protoInt64:{typeOnly:!1,privateImportPath:"./proto-int64.js",publicImportPath:ej},ScalarType:{typeOnly:!1,privateImportPath:"./field.js",publicImportPath:ej},LongType:{typeOnly:!1,privateImportPath:"./field.js",publicImportPath:ej},MethodKind:{typeOnly:!1,privateImportPath:"./service-type.js",publicImportPath:ej},MethodIdempotency:{typeOnly:!1,privateImportPath:"./service-type.js",publicImportPath:ej},IMessageTypeRegistry:{typeOnly:!0,privateImportPath:"./type-registry.js",publicImportPath:ej}},wktSourceFiles:["google/protobuf/compiler/plugin.proto","google/protobuf/any.proto","google/protobuf/api.proto","google/protobuf/descriptor.proto","google/protobuf/duration.proto","google/protobuf/empty.proto","google/protobuf/field_mask.proto","google/protobuf/source_context.proto","google/protobuf/struct.proto","google/protobuf/timestamp.proto","google/protobuf/type.proto","google/protobuf/wrappers.proto"]},createDescriptorSet,createRegistry:function(...e){let t={},r={},n={},i={add(e){if("fields"in e){if(!this.findMessage(e.typeName))for(let r of(t[e.typeName]=e,e.fields.list()))"message"==r.kind?this.add(r.T):"map"==r.kind&&"message"==r.V.kind?this.add(r.V.T):"enum"==r.kind&&this.add(r.T)}else if("methods"in e){if(!this.findService(e.typeName))for(let t of(n[e.typeName]=e,Object.values(e.methods)))this.add(t.I),this.add(t.O)}else r[e.typeName]=e},findMessage:e=>t[e],findEnum:e=>r[e],findService:e=>n[e]};for(let t of e)i.add(t);return i},createRegistryFromDescriptors:function(e,t=!0){let r=e instanceof Uint8Array||e instanceof FileDescriptorSet?createDescriptorSet(e):e,n={},i={},o={};if(t){for(let e of eK)i[e.typeName]=e;for(let e of ez)n[e.typeName]=e}return{findEnum(e){let t=n[e];if(t)return t;let i=r.enums.get(e);if(!i)return;let o="proto3"==i.file.syntax?eF:eL,s=o.makeEnumType(e,i.values.map(e=>({no:e.number,name:e.name,localName:localName(e)})),{});return n[e]=s,s},findMessage(e){let t=i[e];if(t)return t;let n=r.messages.get(e);if(!n)return;let o="proto3"==n.file.syntax?eF:eL,s=[],a=o.makeMessageType(e,()=>s,{localName:localName(n)});for(let t of(i[e]=a,n.fields)){let e=function(e,t){switch(e.fieldKind){case"map":return function(e,t){let r={kind:"map",no:e.number,name:e.name,jsonName:e.jsonName,K:e.mapKey};if(e.mapValue.message){let n=t.findMessage(e.mapValue.message.typeName);return assert(n,`message "${e.mapValue.message.typeName}" for ${e.toString()} not found`),Object.assign(Object.assign({},r),{V:{kind:"message",T:n}})}if(e.mapValue.enum){let n=t.findEnum(e.mapValue.enum.typeName);return assert(n,`enum "${e.mapValue.enum.typeName}" for ${e.toString()} not found`),Object.assign(Object.assign({},r),{V:{kind:"enum",T:n}})}return Object.assign(Object.assign({},r),{V:{kind:"scalar",T:e.mapValue.scalar}})}(e,t);case"message":return function(e,t){let r=t.findMessage(e.message.typeName);assert(r,`message "${e.message.typeName}" for ${e.toString()} not found`);let n={kind:"message",no:e.number,name:e.name,jsonName:e.jsonName,T:r,delimited:e.proto.type==Z.GROUP};return e.repeated?Object.assign(Object.assign({},n),{repeated:!0,packed:e.packed,oneof:void 0}):e.oneof?Object.assign(Object.assign({},n),{oneof:e.oneof.name}):e.optional?Object.assign(Object.assign({},n),{opt:!0}):n}(e,t);case"enum":{let r=function(e,t){let r=t.findEnum(e.enum.typeName);assert(r,`enum "${e.enum.typeName}" for ${e.toString()} not found`);let n={kind:"enum",no:e.number,name:e.name,jsonName:e.jsonName,T:r};return e.repeated?Object.assign(Object.assign({},n),{repeated:!0,packed:e.packed,oneof:void 0}):e.oneof?Object.assign(Object.assign({},n),{oneof:e.oneof.name}):e.optional?Object.assign(Object.assign({},n),{opt:!0}):n}(e,t);return r.default=e.getDefaultValue(),r}case"scalar":{let t=function(e){let t=e.longType==Y.STRING?{L:Y.STRING}:{},r=Object.assign({kind:"scalar",no:e.number,name:e.name,jsonName:e.jsonName,T:e.scalar},t);return e.repeated?Object.assign(Object.assign({},r),{repeated:!0,packed:e.packed,oneof:void 0,T:e.scalar}):e.oneof?Object.assign(Object.assign({},r),{oneof:e.oneof.name}):e.optional?Object.assign(Object.assign({},r),{opt:!0}):r}(e);return t.default=e.getDefaultValue(),t}}}(t,this);s.push(e)}return a},findService(e){let t=o[e];if(t)return t;let n=r.services.get(e);if(!n)return;let i={};for(let e of n.methods){let t=this.findMessage(e.input.typeName),r=this.findMessage(e.output.typeName);assert(t,`message "${e.input.typeName}" for ${e.toString()} not found`),assert(r,`output message "${e.output.typeName}" for ${e.toString()} not found`),i[localName(e)]={name:e.name,I:t,O:r,kind:e.methodKind,idempotency:e.idempotency}}return o[e]={typeName:n.typeName,methods:i}}}},proto2:eL,proto3:eF,protoBase64:eD,protoDelimited:eU,protoDouble:eM,protoInt64:eb,toPlainMessage},Symbol.toStringTag,{value:"Module"}));function codeToString(e){let t=q[e];return"string"!=typeof t?e.toString():t[0].toLowerCase()+t.substring(1).replace(/[A-Z]/g,e=>"_"+e.toLowerCase())}let ConnectError=class ConnectError extends Error{constructor(e,t=q.Unknown,r,n,i){super(e.length?`[${codeToString(t)}] ${e}`:`[${codeToString(t)}]`),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(null!=r?r:{}),this.details=null!=n?n:[],this.cause=i}static from(e,t=q.Unknown){return e instanceof ConnectError?e:e instanceof Error?"AbortError"==e.name?new ConnectError(e.message,q.Canceled):new ConnectError(e.message,t,void 0,void 0,e):new ConnectError(String(e),t,void 0,void 0,e)}findDetails(e){let t="typeName"in e?{findMessage:t=>t===e.typeName?e:void 0}:e,r=[];for(let e of this.details){if(e instanceof Message){t.findMessage(e.getType().typeName)&&r.push(e);continue}let n=t.findMessage(e.type);if(n)try{r.push(n.fromBinary(e.value))}catch(e){}}return r}};function createEnvelopeReadableStream(e){let t;let r=new Uint8Array(0);return new ReadableStream({start(){t=e.getReader()},async pull(e){let n;for(;;){if(void 0===n&&r.byteLength>=5){let e=0;for(let t=1;t<5;t++)e=(e<<8)+r[t];n={flags:r[0],length:e}}if(void 0!==n&&r.byteLength>=n.length+5)break;let e=await t.read();if(e.done)break;!function(e){let t=new Uint8Array(r.length+e.length);t.set(r),t.set(e,r.length),r=t}(e.value)}if(void 0===n){if(0==r.byteLength){e.close();return}e.error(new ConnectError("premature end of stream",q.DataLoss));return}let i=r.subarray(5,5+n.length);r=r.subarray(5+n.length),e.enqueue({flags:n.flags,data:i})}})}function encodeEnvelope(e,t){let r=new Uint8Array(t.length+5);r.set(t,5);let n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.setUint8(0,e),n.setUint32(1,t.length),r}var eH=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},eX=globalThis&&globalThis.__await||function(e){return this instanceof eX?(this.v=e,this):new eX(e)},eZ=globalThis&&globalThis.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},verb("next"),verb("throw"),verb("return"),n[Symbol.asyncIterator]=function(){return this},n;function verb(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||resume(e,t)})})}function resume(e,t){try{var r;(r=i[e](t)).value instanceof eX?Promise.resolve(r.value.v).then(fulfill,reject):settle(o[0][2],r)}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}},eQ=globalThis&&globalThis.__asyncDelegator||function(e){var t,r;return t={},verb("next"),verb("throw",function(e){throw e}),verb("return"),t[Symbol.iterator]=function(){return this},t;function verb(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:eX(e[n](t)),done:!1}:i?i(t):t}:i}},e0=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},e1=globalThis&&globalThis.__await||function(e){return this instanceof e1?(this.v=e,this):new e1(e)},e2=globalThis&&globalThis.__asyncDelegator||function(e){var t,r;return t={},verb("next"),verb("throw",function(e){throw e}),verb("return"),t[Symbol.iterator]=function(){return this},t;function verb(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:e1(e[n](t)),done:!1}:i?i(t):t}:i}},e3=globalThis&&globalThis.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},verb("next"),verb("throw"),verb("return"),n[Symbol.asyncIterator]=function(){return this},n;function verb(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||resume(e,t)})})}function resume(e,t){try{var r;(r=i[e](t)).value instanceof e1?Promise.resolve(r.value.v).then(fulfill,reject):settle(o[0][2],r)}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}};function handleStreamResponse(e,t){let r=(function(){var r,n;return e3(this,arguments,function*(){let i=yield e1(e);null===(r=null==t?void 0:t.onHeader)||void 0===r||r.call(t,i.header),yield e1((yield*e2(e0(i.message)))),null===(n=null==t?void 0:t.onTrailer)||void 0===n||n.call(t,i.trailer)})})()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>r.next()})}}function getAbortSignalReason(e){if(!e.aborted)return;if(void 0!==e.reason)return e.reason;let t=Error("This operation was aborted");return t.name="AbortError",t}function createContextValues(){return{get(e){return e.id in this?this[e.id]:e.defaultValue},set(e,t){return this[e.id]=t,this},delete(e){return delete this[e.id],this}}}function trailerParse(e){let t=new Headers,r=new TextDecoder().decode(e).split("\r\n");for(let e of r){if(""===e)continue;let r=e.indexOf(":");if(r>0){let n=e.substring(0,r).trim(),i=e.substring(r+1).trim();t.append(n,i)}}return t}let e6="Grpc-Status",e4="Grpc-Message";let Status=class Status extends Message{constructor(e){super(),this.code=0,this.message="",this.details=[],eF.util.initPartial(e,this)}static fromBinary(e,t){return new Status().fromBinary(e,t)}static fromJson(e,t){return new Status().fromJson(e,t)}static fromJsonString(e,t){return new Status().fromJsonString(e,t)}static equals(e,t){return eF.util.equals(Status,e,t)}};function findTrailerError(e){var t;let r=e.get("Grpc-Status-Details-Bin");if(null!=r){let t=function(e,t,r){try{let r=eD.dec(e);if(t)return t.fromBinary(r,void 0);return r}catch(e){throw ConnectError.from(e,q.DataLoss)}}(r,Status);if(0==t.code)return;let n=new ConnectError(t.message,t.code,e);return n.details=t.details.map(e=>({type:e.typeUrl.substring(e.typeUrl.lastIndexOf("/")+1),value:e.value})),n}let n=e.get(e6);if(null!=n){if("0"===n)return;let r=parseInt(n,10);return r in q?new ConnectError(decodeURIComponent(null!==(t=e.get(e4))&&void 0!==t?t:""),r,e):new ConnectError(`invalid grpc-status: ${n}`,q.Internal,e)}}function createMethodUrl(e,t,r){let n="string"==typeof t?t:t.typeName,i="string"==typeof r?r:r.name;return e.toString().replace(/\/?$/,`/${n}/${i}`)}function normalize(e,t){return t instanceof Message?t:new e(t)}function createClientMethodSerializers(e,t,r,n){let i=t?createBinarySerialization(e.I,n):createJsonSerialization(e.I,r),o=t?createBinarySerialization(e.O,n):createJsonSerialization(e.O,r);return{parse:o.parse,serialize:i.serialize}}function createBinarySerialization(e,t){return{parse(r){try{return e.fromBinary(r,t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new ConnectError(`parse binary: ${e}`,q.InvalidArgument)}},serialize(e){try{return e.toBinary(t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new ConnectError(`serialize binary: ${e}`,q.Internal)}}}}function createJsonSerialization(e,t){var r,n;let i=null!==(r=null==t?void 0:t.textEncoder)&&void 0!==r?r:new TextEncoder,o=null!==(n=null==t?void 0:t.textDecoder)&&void 0!==n?n:new TextDecoder,s=function(e){var t;let r=Object.assign({},e);return null!==(t=r.ignoreUnknownFields)&&void 0!==t||(r.ignoreUnknownFields=!0),r}(t);return{parse(t){try{let r=o.decode(t);return e.fromJsonString(r,s)}catch(e){throw ConnectError.from(e,q.InvalidArgument)}},serialize(e){try{let t=e.toJsonString(s);return i.encode(t)}catch(e){throw ConnectError.from(e,q.Internal)}}}}function setupSignal(e){let{signal:t,cleanup:r}=function(e){let t;let r=new AbortController,listener=()=>{r.abort(new ConnectError("the operation timed out",q.DeadlineExceeded))};return void 0!==e&&(e<=0?listener():t=setTimeout(listener,e)),{signal:r.signal,cleanup:()=>clearTimeout(t)}}(e.timeoutMs),n=function(...e){let t=new AbortController,r=e.filter(e=>void 0!==e).concat(t.signal);for(let e of r){if(e.aborted){onAbort.apply(e);break}e.addEventListener("abort",onAbort)}function onAbort(){for(let e of(t.signal.aborted||t.abort(getAbortSignalReason(this)),r))e.removeEventListener("abort",onAbort)}return t}(e.signal,t);return[n.signal,function(e){let i=ConnectError.from(t.aborted?getAbortSignalReason(t):e);return n.abort(i),r(),Promise.reject(i)},function(){r(),n.abort()}]}function applyInterceptors(e,t){var r;return null!==(r=null==t?void 0:t.concat().reverse().reduce((e,t)=>t(e),e))&&void 0!==r?r:e}function validateTrailer(e,t){let r=findTrailerError(e);if(r)throw t.forEach((e,t)=>{r.metadata.append(t,e)}),r}function requestHeader(e,t,r,n){let i=new Headers(null!=r?r:{});return i.set("Content-Type",e?"application/grpc-web+proto":"application/grpc-web+json"),i.set("X-Grpc-Web","1"),i.set("X-User-Agent","connect-es/1.2.0"),n&&i.set("User-Agent","connect-es/1.2.0"),void 0!==t&&i.set("Grpc-Timeout",`${t}m`),i}function validateResponse(e,t){var r;if(e>=200&&e<300){let e=findTrailerError(t);if(e)throw e;return{foundStatus:t.has(e6)}}throw new ConnectError(decodeURIComponent(null!==(r=t.get(e4))&&void 0!==r?r:`HTTP ${e}`),function(e){switch(e){case 400:return q.Internal;case 401:return q.Unauthenticated;case 403:return q.PermissionDenied;case 404:return q.Unimplemented;case 429:case 502:case 503:case 504:return q.Unavailable;default:return q.Unknown}}(e),t)}Status.runtime=eF,Status.typeName="google.rpc.Status",Status.fields=eF.util.newFieldList(()=>[{no:1,name:"code",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"details",kind:"message",T:Any,repeated:!0}]);var e9=globalThis&&globalThis.__await||function(e){return this instanceof e9?(this.v=e,this):new e9(e)},e5=globalThis&&globalThis.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},verb("next"),verb("throw"),verb("return"),n[Symbol.asyncIterator]=function(){return this},n;function verb(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||resume(e,t)})})}function resume(e,t){try{var r;(r=i[e](t)).value instanceof e9?Promise.resolve(r.value.v).then(fulfill,reject):settle(o[0][2],r)}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}},e8={exports:{}},e7=e8.exports;Object.defineProperty(e7,"__esModule",{value:!0});let{proto3:te,StringValue:tt,Timestamp:tr}=eW,tn=te.makeEnum("yorkie.v1.ValueType",[{no:0,name:"VALUE_TYPE_NULL",localName:"NULL"},{no:1,name:"VALUE_TYPE_BOOLEAN",localName:"BOOLEAN"},{no:2,name:"VALUE_TYPE_INTEGER",localName:"INTEGER"},{no:3,name:"VALUE_TYPE_LONG",localName:"LONG"},{no:4,name:"VALUE_TYPE_DOUBLE",localName:"DOUBLE"},{no:5,name:"VALUE_TYPE_STRING",localName:"STRING"},{no:6,name:"VALUE_TYPE_BYTES",localName:"BYTES"},{no:7,name:"VALUE_TYPE_DATE",localName:"DATE"},{no:8,name:"VALUE_TYPE_JSON_OBJECT",localName:"JSON_OBJECT"},{no:9,name:"VALUE_TYPE_JSON_ARRAY",localName:"JSON_ARRAY"},{no:10,name:"VALUE_TYPE_TEXT",localName:"TEXT"},{no:11,name:"VALUE_TYPE_INTEGER_CNT",localName:"INTEGER_CNT"},{no:12,name:"VALUE_TYPE_LONG_CNT",localName:"LONG_CNT"},{no:13,name:"VALUE_TYPE_TREE",localName:"TREE"}]),ti=te.makeEnum("yorkie.v1.DocEventType",[{no:0,name:"DOC_EVENT_TYPE_DOCUMENT_CHANGED",localName:"DOCUMENT_CHANGED"},{no:1,name:"DOC_EVENT_TYPE_DOCUMENT_WATCHED",localName:"DOCUMENT_WATCHED"},{no:2,name:"DOC_EVENT_TYPE_DOCUMENT_UNWATCHED",localName:"DOCUMENT_UNWATCHED"},{no:3,name:"DOC_EVENT_TYPE_DOCUMENT_BROADCAST",localName:"DOCUMENT_BROADCAST"}]),to=te.makeMessageType("yorkie.v1.Snapshot",()=>[{no:1,name:"root",kind:"message",T:tb},{no:2,name:"presences",kind:"map",K:9,V:{kind:"message",T:tq}}]),ts=te.makeMessageType("yorkie.v1.ChangePack",()=>[{no:1,name:"document_key",kind:"scalar",T:9},{no:2,name:"checkpoint",kind:"message",T:tG},{no:3,name:"snapshot",kind:"scalar",T:12},{no:4,name:"changes",kind:"message",T:ta,repeated:!0},{no:5,name:"min_synced_ticket",kind:"message",T:tK},{no:6,name:"is_removed",kind:"scalar",T:8}]),ta=te.makeMessageType("yorkie.v1.Change",()=>[{no:1,name:"id",kind:"message",T:tl},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"operations",kind:"message",T:tu,repeated:!0},{no:4,name:"presence_change",kind:"message",T:tj}]),tl=te.makeMessageType("yorkie.v1.ChangeID",()=>[{no:1,name:"client_seq",kind:"scalar",T:13},{no:2,name:"server_seq",kind:"scalar",T:3,L:1},{no:3,name:"lamport",kind:"scalar",T:3,L:1},{no:4,name:"actor_id",kind:"scalar",T:12}]),tu=te.makeMessageType("yorkie.v1.Operation",()=>[{no:1,name:"set",kind:"message",T:td,oneof:"body"},{no:2,name:"add",kind:"message",T:tc,oneof:"body"},{no:3,name:"move",kind:"message",T:th,oneof:"body"},{no:4,name:"remove",kind:"message",T:tm,oneof:"body"},{no:5,name:"edit",kind:"message",T:tp,oneof:"body"},{no:6,name:"select",kind:"message",T:tf,oneof:"body"},{no:7,name:"style",kind:"message",T:tg,oneof:"body"},{no:8,name:"increase",kind:"message",T:tT,oneof:"body"},{no:9,name:"tree_edit",kind:"message",T:ty,oneof:"body"},{no:10,name:"tree_style",kind:"message",T:tv,oneof:"body"}]),td=te.makeMessageType("yorkie.v1.Operation.Set",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"value",kind:"message",T:tS},{no:4,name:"executed_at",kind:"message",T:tK}],{localName:"Operation_Set"}),tc=te.makeMessageType("yorkie.v1.Operation.Add",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"prev_created_at",kind:"message",T:tK},{no:3,name:"value",kind:"message",T:tS},{no:4,name:"executed_at",kind:"message",T:tK}],{localName:"Operation_Add"}),th=te.makeMessageType("yorkie.v1.Operation.Move",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"prev_created_at",kind:"message",T:tK},{no:3,name:"created_at",kind:"message",T:tK},{no:4,name:"executed_at",kind:"message",T:tK}],{localName:"Operation_Move"}),tm=te.makeMessageType("yorkie.v1.Operation.Remove",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"created_at",kind:"message",T:tK},{no:3,name:"executed_at",kind:"message",T:tK}],{localName:"Operation_Remove"}),tp=te.makeMessageType("yorkie.v1.Operation.Edit",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"from",kind:"message",T:tY},{no:3,name:"to",kind:"message",T:tY},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:tK}},{no:5,name:"content",kind:"scalar",T:9},{no:6,name:"executed_at",kind:"message",T:tK},{no:7,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"Operation_Edit"}),tf=te.makeMessageType("yorkie.v1.Operation.Select",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"from",kind:"message",T:tY},{no:3,name:"to",kind:"message",T:tY},{no:4,name:"executed_at",kind:"message",T:tK}],{localName:"Operation_Select"}),tg=te.makeMessageType("yorkie.v1.Operation.Style",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"from",kind:"message",T:tY},{no:3,name:"to",kind:"message",T:tY},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:tK},{no:6,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:tK}}],{localName:"Operation_Style"}),tT=te.makeMessageType("yorkie.v1.Operation.Increase",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"value",kind:"message",T:tS},{no:3,name:"executed_at",kind:"message",T:tK}],{localName:"Operation_Increase"}),ty=te.makeMessageType("yorkie.v1.Operation.TreeEdit",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"from",kind:"message",T:tL},{no:3,name:"to",kind:"message",T:tL},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:tK}},{no:5,name:"contents",kind:"message",T:tR,repeated:!0},{no:7,name:"split_level",kind:"scalar",T:5},{no:6,name:"executed_at",kind:"message",T:tK}],{localName:"Operation_TreeEdit"}),tv=te.makeMessageType("yorkie.v1.Operation.TreeStyle",()=>[{no:1,name:"parent_created_at",kind:"message",T:tK},{no:2,name:"from",kind:"message",T:tL},{no:3,name:"to",kind:"message",T:tL},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:tK},{no:6,name:"attributes_to_remove",kind:"scalar",T:9,repeated:!0},{no:7,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:tK}}],{localName:"Operation_TreeStyle"}),tS=te.makeMessageType("yorkie.v1.JSONElementSimple",()=>[{no:1,name:"created_at",kind:"message",T:tK},{no:2,name:"moved_at",kind:"message",T:tK},{no:3,name:"removed_at",kind:"message",T:tK},{no:4,name:"type",kind:"enum",T:te.getEnumType(tn)},{no:5,name:"value",kind:"scalar",T:12}]),tb=te.makeMessageType("yorkie.v1.JSONElement",()=>[{no:1,name:"json_object",kind:"message",T:tE,oneof:"body"},{no:2,name:"json_array",kind:"message",T:tI,oneof:"body"},{no:3,name:"primitive",kind:"message",T:tN,oneof:"body"},{no:5,name:"text",kind:"message",T:t_,oneof:"body"},{no:6,name:"counter",kind:"message",T:tO,oneof:"body"},{no:7,name:"tree",kind:"message",T:tk,oneof:"body"}]),tE=te.makeMessageType("yorkie.v1.JSONElement.JSONObject",()=>[{no:1,name:"nodes",kind:"message",T:tD,repeated:!0},{no:2,name:"created_at",kind:"message",T:tK},{no:3,name:"moved_at",kind:"message",T:tK},{no:4,name:"removed_at",kind:"message",T:tK}],{localName:"JSONElement_JSONObject"}),tI=te.makeMessageType("yorkie.v1.JSONElement.JSONArray",()=>[{no:1,name:"nodes",kind:"message",T:tA,repeated:!0},{no:2,name:"created_at",kind:"message",T:tK},{no:3,name:"moved_at",kind:"message",T:tK},{no:4,name:"removed_at",kind:"message",T:tK}],{localName:"JSONElement_JSONArray"}),tN=te.makeMessageType("yorkie.v1.JSONElement.Primitive",()=>[{no:1,name:"type",kind:"enum",T:te.getEnumType(tn)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:tK},{no:4,name:"moved_at",kind:"message",T:tK},{no:5,name:"removed_at",kind:"message",T:tK}],{localName:"JSONElement_Primitive"}),t_=te.makeMessageType("yorkie.v1.JSONElement.Text",()=>[{no:1,name:"nodes",kind:"message",T:tw,repeated:!0},{no:2,name:"created_at",kind:"message",T:tK},{no:3,name:"moved_at",kind:"message",T:tK},{no:4,name:"removed_at",kind:"message",T:tK}],{localName:"JSONElement_Text"}),tO=te.makeMessageType("yorkie.v1.JSONElement.Counter",()=>[{no:1,name:"type",kind:"enum",T:te.getEnumType(tn)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:tK},{no:4,name:"moved_at",kind:"message",T:tK},{no:5,name:"removed_at",kind:"message",T:tK}],{localName:"JSONElement_Counter"}),tk=te.makeMessageType("yorkie.v1.JSONElement.Tree",()=>[{no:1,name:"nodes",kind:"message",T:tx,repeated:!0},{no:2,name:"created_at",kind:"message",T:tK},{no:3,name:"moved_at",kind:"message",T:tK},{no:4,name:"removed_at",kind:"message",T:tK}],{localName:"JSONElement_Tree"}),tD=te.makeMessageType("yorkie.v1.RHTNode",()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"element",kind:"message",T:tb}]),tA=te.makeMessageType("yorkie.v1.RGANode",()=>[{no:1,name:"next",kind:"message",T:tA},{no:2,name:"element",kind:"message",T:tb}]),tP=te.makeMessageType("yorkie.v1.NodeAttr",()=>[{no:1,name:"value",kind:"scalar",T:9},{no:2,name:"updated_at",kind:"message",T:tK}]),tw=te.makeMessageType("yorkie.v1.TextNode",()=>[{no:1,name:"id",kind:"message",T:tC},{no:2,name:"value",kind:"scalar",T:9},{no:3,name:"removed_at",kind:"message",T:tK},{no:4,name:"ins_prev_id",kind:"message",T:tC},{no:5,name:"attributes",kind:"map",K:9,V:{kind:"message",T:tP}}]),tC=te.makeMessageType("yorkie.v1.TextNodeID",()=>[{no:1,name:"created_at",kind:"message",T:tK},{no:2,name:"offset",kind:"scalar",T:5}]),tx=te.makeMessageType("yorkie.v1.TreeNode",()=>[{no:1,name:"id",kind:"message",T:tF},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9},{no:4,name:"removed_at",kind:"message",T:tK},{no:5,name:"ins_prev_id",kind:"message",T:tF},{no:6,name:"ins_next_id",kind:"message",T:tF},{no:7,name:"depth",kind:"scalar",T:5},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:tP}}]),tR=te.makeMessageType("yorkie.v1.TreeNodes",()=>[{no:1,name:"content",kind:"message",T:tx,repeated:!0}]),tF=te.makeMessageType("yorkie.v1.TreeNodeID",()=>[{no:1,name:"created_at",kind:"message",T:tK},{no:2,name:"offset",kind:"scalar",T:5}]),tL=te.makeMessageType("yorkie.v1.TreePos",()=>[{no:1,name:"parent_id",kind:"message",T:tF},{no:2,name:"left_sibling_id",kind:"message",T:tF}]),tM=te.makeMessageType("yorkie.v1.User",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"created_at",kind:"message",T:tr}]),tB=te.makeMessageType("yorkie.v1.Project",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"public_key",kind:"scalar",T:9},{no:4,name:"secret_key",kind:"scalar",T:9},{no:5,name:"auth_webhook_url",kind:"scalar",T:9},{no:6,name:"auth_webhook_methods",kind:"scalar",T:9,repeated:!0},{no:7,name:"client_deactivate_threshold",kind:"scalar",T:9},{no:8,name:"created_at",kind:"message",T:tr},{no:9,name:"updated_at",kind:"message",T:tr}]),tJ=te.makeMessageType("yorkie.v1.UpdatableProjectFields",()=>[{no:1,name:"name",kind:"message",T:tt},{no:2,name:"auth_webhook_url",kind:"message",T:tt},{no:3,name:"auth_webhook_methods",kind:"message",T:tV},{no:4,name:"client_deactivate_threshold",kind:"message",T:tt}]),tV=te.makeMessageType("yorkie.v1.UpdatableProjectFields.AuthWebhookMethods",()=>[{no:1,name:"methods",kind:"scalar",T:9,repeated:!0}],{localName:"UpdatableProjectFields_AuthWebhookMethods"}),tU=te.makeMessageType("yorkie.v1.DocumentSummary",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"snapshot",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:tr},{no:5,name:"accessed_at",kind:"message",T:tr},{no:6,name:"updated_at",kind:"message",T:tr}]),tj=te.makeMessageType("yorkie.v1.PresenceChange",()=>[{no:1,name:"type",kind:"enum",T:te.getEnumType(t$)},{no:2,name:"presence",kind:"message",T:tq}]),t$=te.makeEnum("yorkie.v1.PresenceChange.ChangeType",[{no:0,name:"CHANGE_TYPE_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"CHANGE_TYPE_PUT",localName:"PUT"},{no:2,name:"CHANGE_TYPE_DELETE",localName:"DELETE"},{no:3,name:"CHANGE_TYPE_CLEAR",localName:"CLEAR"}]),tq=te.makeMessageType("yorkie.v1.Presence",()=>[{no:1,name:"data",kind:"map",K:9,V:{kind:"scalar",T:9}}]),tG=te.makeMessageType("yorkie.v1.Checkpoint",()=>[{no:1,name:"server_seq",kind:"scalar",T:3,L:1},{no:2,name:"client_seq",kind:"scalar",T:13}]),tY=te.makeMessageType("yorkie.v1.TextNodePos",()=>[{no:1,name:"created_at",kind:"message",T:tK},{no:2,name:"offset",kind:"scalar",T:5},{no:3,name:"relative_offset",kind:"scalar",T:5}]),tK=te.makeMessageType("yorkie.v1.TimeTicket",()=>[{no:1,name:"lamport",kind:"scalar",T:3,L:1},{no:2,name:"delimiter",kind:"scalar",T:13},{no:3,name:"actor_id",kind:"scalar",T:12}]),tz=te.makeMessageType("yorkie.v1.DocEventBody",()=>[{no:1,name:"topic",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12}]),tW=te.makeMessageType("yorkie.v1.DocEvent",()=>[{no:1,name:"type",kind:"enum",T:te.getEnumType(ti)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"body",kind:"message",T:tz}]);e7.ValueType=tn,e7.DocEventType=ti,e7.Snapshot=to,e7.ChangePack=ts,e7.Change=ta,e7.ChangeID=tl,e7.Operation=tu,e7.Operation_Set=td,e7.Operation_Add=tc,e7.Operation_Move=th,e7.Operation_Remove=tm,e7.Operation_Edit=tp,e7.Operation_Select=tf,e7.Operation_Style=tg,e7.Operation_Increase=tT,e7.Operation_TreeEdit=ty,e7.Operation_TreeStyle=tv,e7.JSONElementSimple=tS,e7.JSONElement=tb,e7.JSONElement_JSONObject=tE,e7.JSONElement_JSONArray=tI,e7.JSONElement_Primitive=tN,e7.JSONElement_Text=t_,e7.JSONElement_Counter=tO,e7.JSONElement_Tree=tk,e7.RHTNode=tD,e7.RGANode=tA,e7.NodeAttr=tP,e7.TextNode=tw,e7.TextNodeID=tC,e7.TreeNode=tx,e7.TreeNodes=tR,e7.TreeNodeID=tF,e7.TreePos=tL,e7.User=tM,e7.Project=tB,e7.UpdatableProjectFields=tJ,e7.UpdatableProjectFields_AuthWebhookMethods=tV,e7.DocumentSummary=tU,e7.PresenceChange=tj,e7.PresenceChange_ChangeType=t$,e7.Presence=tq,e7.Checkpoint=tG,e7.TextNodePos=tY,e7.TimeTicket=tK,e7.DocEventBody=tz,e7.DocEvent=tW;let tH=(null==e8.exports?{}:e8.exports).default||e8.exports,tX=(null==e8.exports?{}:e8.exports).ValueType,tZ=(null==e8.exports?{}:e8.exports).DocEventType,tQ=(null==e8.exports?{}:e8.exports).Snapshot,t0=(null==e8.exports?{}:e8.exports).ChangePack,t1=(null==e8.exports?{}:e8.exports).Change,t2=(null==e8.exports?{}:e8.exports).ChangeID,t3=(null==e8.exports?{}:e8.exports).Operation,t6=(null==e8.exports?{}:e8.exports).Operation_Set,t4=(null==e8.exports?{}:e8.exports).Operation_Add,t9=(null==e8.exports?{}:e8.exports).Operation_Move,t5=(null==e8.exports?{}:e8.exports).Operation_Remove,t8=(null==e8.exports?{}:e8.exports).Operation_Edit,t7=(null==e8.exports?{}:e8.exports).Operation_Select,re=(null==e8.exports?{}:e8.exports).Operation_Style,rt=(null==e8.exports?{}:e8.exports).Operation_Increase,rr=(null==e8.exports?{}:e8.exports).Operation_TreeEdit,rn=(null==e8.exports?{}:e8.exports).Operation_TreeStyle,ri=(null==e8.exports?{}:e8.exports).JSONElementSimple,ro=(null==e8.exports?{}:e8.exports).JSONElement,rs=(null==e8.exports?{}:e8.exports).JSONElement_JSONObject,ra=(null==e8.exports?{}:e8.exports).JSONElement_JSONArray,rl=(null==e8.exports?{}:e8.exports).JSONElement_Primitive,ru=(null==e8.exports?{}:e8.exports).JSONElement_Text,rd=(null==e8.exports?{}:e8.exports).JSONElement_Counter,rc=(null==e8.exports?{}:e8.exports).JSONElement_Tree,rh=(null==e8.exports?{}:e8.exports).RHTNode,rm=(null==e8.exports?{}:e8.exports).RGANode,rp=(null==e8.exports?{}:e8.exports).NodeAttr,rf=(null==e8.exports?{}:e8.exports).TextNode,rg=(null==e8.exports?{}:e8.exports).TextNodeID,rT=(null==e8.exports?{}:e8.exports).TreeNode,ry=(null==e8.exports?{}:e8.exports).TreeNodes,rv=(null==e8.exports?{}:e8.exports).TreeNodeID,rS=(null==e8.exports?{}:e8.exports).TreePos,rb=(null==e8.exports?{}:e8.exports).User,rE=(null==e8.exports?{}:e8.exports).Project,rI=(null==e8.exports?{}:e8.exports).UpdatableProjectFields,rN=(null==e8.exports?{}:e8.exports).UpdatableProjectFields_AuthWebhookMethods,r_=(null==e8.exports?{}:e8.exports).DocumentSummary,rO=(null==e8.exports?{}:e8.exports).PresenceChange,rk=(null==e8.exports?{}:e8.exports).PresenceChange_ChangeType,rD=(null==e8.exports?{}:e8.exports).Presence,rA=(null==e8.exports?{}:e8.exports).Checkpoint,rP=(null==e8.exports?{}:e8.exports).TextNodePos,rw=(null==e8.exports?{}:e8.exports).TimeTicket,rC=(null==e8.exports?{}:e8.exports).DocEventBody,rx=(null==e8.exports?{}:e8.exports).DocEvent,rR=Object.freeze(Object.defineProperty({__proto__:null,Change:t1,ChangeID:t2,ChangePack:t0,Checkpoint:rA,DocEvent:rx,DocEventBody:rC,DocEventType:tZ,DocumentSummary:r_,JSONElement:ro,JSONElementSimple:ri,JSONElement_Counter:rd,JSONElement_JSONArray:ra,JSONElement_JSONObject:rs,JSONElement_Primitive:rl,JSONElement_Text:ru,JSONElement_Tree:rc,NodeAttr:rp,Operation:t3,Operation_Add:t4,Operation_Edit:t8,Operation_Increase:rt,Operation_Move:t9,Operation_Remove:t5,Operation_Select:t7,Operation_Set:t6,Operation_Style:re,Operation_TreeEdit:rr,Operation_TreeStyle:rn,Presence:rD,PresenceChange:rO,PresenceChange_ChangeType:rk,Project:rE,RGANode:rm,RHTNode:rh,Snapshot:tQ,TextNode:rf,TextNodeID:rg,TextNodePos:rP,TimeTicket:rw,TreeNode:rT,TreeNodeID:rv,TreeNodes:ry,TreePos:rS,UpdatableProjectFields:rI,UpdatableProjectFields_AuthWebhookMethods:rN,User:rb,ValueType:tX,default:tH},Symbol.toStringTag,{value:"Module"}));var rF={exports:{}},rL=rF.exports;Object.defineProperty(rL,"__esModule",{value:!0});let{proto3:rM}=eW,{ChangePack:rB,DocEvent:rJ}=tH||rR,rV=rM.makeMessageType("yorkie.v1.ActivateClientRequest",()=>[{no:1,name:"client_key",kind:"scalar",T:9}]),rU=rM.makeMessageType("yorkie.v1.ActivateClientResponse",()=>[{no:1,name:"client_id",kind:"scalar",T:9}]),rj=rM.makeMessageType("yorkie.v1.DeactivateClientRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9}]),r$=rM.makeMessageType("yorkie.v1.DeactivateClientResponse",[]),rq=rM.makeMessageType("yorkie.v1.AttachDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:rB}]),rG=rM.makeMessageType("yorkie.v1.AttachDocumentResponse",()=>[{no:1,name:"document_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:rB}]),rY=rM.makeMessageType("yorkie.v1.DetachDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:rB},{no:4,name:"remove_if_not_attached",kind:"scalar",T:8}]),rK=rM.makeMessageType("yorkie.v1.DetachDocumentResponse",()=>[{no:2,name:"change_pack",kind:"message",T:rB}]),rz=rM.makeMessageType("yorkie.v1.WatchDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9}]),rW=rM.makeMessageType("yorkie.v1.WatchDocumentResponse",()=>[{no:1,name:"initialization",kind:"message",T:rH,oneof:"body"},{no:2,name:"event",kind:"message",T:rJ,oneof:"body"}]),rH=rM.makeMessageType("yorkie.v1.WatchDocumentResponse.Initialization",()=>[{no:1,name:"client_ids",kind:"scalar",T:9,repeated:!0}],{localName:"WatchDocumentResponse_Initialization"}),rX=rM.makeMessageType("yorkie.v1.RemoveDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:rB}]),rZ=rM.makeMessageType("yorkie.v1.RemoveDocumentResponse",()=>[{no:1,name:"change_pack",kind:"message",T:rB}]),rQ=rM.makeMessageType("yorkie.v1.PushPullChangesRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:rB},{no:4,name:"push_only",kind:"scalar",T:8}]),r0=rM.makeMessageType("yorkie.v1.PushPullChangesResponse",()=>[{no:1,name:"change_pack",kind:"message",T:rB}]),r1=rM.makeMessageType("yorkie.v1.BroadcastRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}]),r2=rM.makeMessageType("yorkie.v1.BroadcastResponse",[]);rL.ActivateClientRequest=rV,rL.ActivateClientResponse=rU,rL.DeactivateClientRequest=rj,rL.DeactivateClientResponse=r$,rL.AttachDocumentRequest=rq,rL.AttachDocumentResponse=rG,rL.DetachDocumentRequest=rY,rL.DetachDocumentResponse=rK,rL.WatchDocumentRequest=rz,rL.WatchDocumentResponse=rW,rL.WatchDocumentResponse_Initialization=rH,rL.RemoveDocumentRequest=rX,rL.RemoveDocumentResponse=rZ,rL.PushPullChangesRequest=rQ,rL.PushPullChangesResponse=r0,rL.BroadcastRequest=r1,rL.BroadcastResponse=r2;let r3=(null==rF.exports?{}:rF.exports).default||rF.exports,r6=(null==rF.exports?{}:rF.exports).ActivateClientRequest,r4=(null==rF.exports?{}:rF.exports).ActivateClientResponse,r9=(null==rF.exports?{}:rF.exports).DeactivateClientRequest,r5=(null==rF.exports?{}:rF.exports).DeactivateClientResponse,r8=(null==rF.exports?{}:rF.exports).AttachDocumentRequest,r7=(null==rF.exports?{}:rF.exports).AttachDocumentResponse,ne=(null==rF.exports?{}:rF.exports).DetachDocumentRequest,nt=(null==rF.exports?{}:rF.exports).DetachDocumentResponse,nr=(null==rF.exports?{}:rF.exports).WatchDocumentRequest,nn=(null==rF.exports?{}:rF.exports).WatchDocumentResponse,ni=(null==rF.exports?{}:rF.exports).WatchDocumentResponse_Initialization,no=(null==rF.exports?{}:rF.exports).RemoveDocumentRequest,ns=(null==rF.exports?{}:rF.exports).RemoveDocumentResponse,na=(null==rF.exports?{}:rF.exports).PushPullChangesRequest,nl=(null==rF.exports?{}:rF.exports).PushPullChangesResponse,nu=(null==rF.exports?{}:rF.exports).BroadcastRequest,nd=(null==rF.exports?{}:rF.exports).BroadcastResponse,nc=Object.freeze(Object.defineProperty({__proto__:null,ActivateClientRequest:r6,ActivateClientResponse:r4,AttachDocumentRequest:r8,AttachDocumentResponse:r7,BroadcastRequest:nu,BroadcastResponse:nd,DeactivateClientRequest:r9,DeactivateClientResponse:r5,DetachDocumentRequest:ne,DetachDocumentResponse:nt,PushPullChangesRequest:na,PushPullChangesResponse:nl,RemoveDocumentRequest:no,RemoveDocumentResponse:ns,WatchDocumentRequest:nr,WatchDocumentResponse:nn,WatchDocumentResponse_Initialization:ni,default:r3},Symbol.toStringTag,{value:"Module"}));var nh={exports:{}},nm=nh.exports;Object.defineProperty(nm,"__esModule",{value:!0});let{ActivateClientRequest:np,ActivateClientResponse:nf,AttachDocumentRequest:ng,AttachDocumentResponse:nT,BroadcastRequest:ny,BroadcastResponse:nv,DeactivateClientRequest:nS,DeactivateClientResponse:nb,DetachDocumentRequest:nE,DetachDocumentResponse:nI,PushPullChangesRequest:nN,PushPullChangesResponse:n_,RemoveDocumentRequest:nO,RemoveDocumentResponse:nk,WatchDocumentRequest:nD,WatchDocumentResponse:nA}=r3||nc,{MethodKind:nP}=eW,nw={typeName:"yorkie.v1.YorkieService",methods:{activateClient:{name:"ActivateClient",I:np,O:nf,kind:nP.Unary},deactivateClient:{name:"DeactivateClient",I:nS,O:nb,kind:nP.Unary},attachDocument:{name:"AttachDocument",I:ng,O:nT,kind:nP.Unary},detachDocument:{name:"DetachDocument",I:nE,O:nI,kind:nP.Unary},removeDocument:{name:"RemoveDocument",I:nO,O:nk,kind:nP.Unary},pushPullChanges:{name:"PushPullChanges",I:nN,O:n_,kind:nP.Unary},watchDocument:{name:"WatchDocument",I:nD,O:nA,kind:nP.ServerStreaming},broadcast:{name:"Broadcast",I:ny,O:nv,kind:nP.Unary}}};nm.YorkieService=nw,(null==nh.exports?{}:nh.exports).default||nh.exports;let nC=(null==nh.exports?{}:nh.exports).YorkieService;/**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   */var nx=null;try{nx=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function isLong(e){return!0===(e&&e.__isLong__)}function ctz32(e){var t=Math.clz32(e&-e);return e?31-t:t}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var nR={},nF={};function fromInt(e,t){var r,n,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(n=nF[e]))?n:(r=fromBits(e,0,!0),i&&(nF[e]=r),r):(e|=0,(i=-128<=e&&e<128)&&(n=nR[e]))?n:(r=fromBits(e,e<0?-1:0,!1),i&&(nR[e]=r),r)}function fromNumber(e,t){if(isNaN(e))return t?nj:nU;if(t){if(e<0)return nj;if(e>=nB)return nK}else{if(e<=-nJ)return nz;if(e+1>=nJ)return nY}return e<0?fromNumber(-e,t).neg():fromBits(e%nM|0,e/nM|0,t)}function fromBits(e,t,r){return new Long(e,t,r)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var nL=Math.pow;function fromString(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?nj:nU;if((r=r||10)<2||36<r)throw RangeError("radix");if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return fromString(e.substring(1),t,r).neg();for(var n,i=fromNumber(nL(r,8)),o=nU,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+a),r);if(a<8){var u=fromNumber(nL(r,a));o=o.mul(u).add(fromNumber(l))}else o=(o=o.mul(i)).add(fromNumber(l))}return o.unsigned=t,o}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var nM=4294967296,nB=18446744073709552e3,nJ=0x7fffffffffffffff,nV=fromInt(16777216),nU=fromInt(0);Long.ZERO=nU;var nj=fromInt(0,!0);Long.UZERO=nj;var n$=fromInt(1);Long.ONE=n$;var nq=fromInt(1,!0);Long.UONE=nq;var nG=fromInt(-1);Long.NEG_ONE=nG;var nY=fromBits(-1,2147483647,!1);Long.MAX_VALUE=nY;var nK=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=nK;var nz=fromBits(0,-2147483648,!1);Long.MIN_VALUE=nz;var nW=Long.prototype;nW.toInt=function(){return this.unsigned?this.low>>>0:this.low},nW.toNumber=function(){return this.unsigned?(this.high>>>0)*nM+(this.low>>>0):this.high*nM+(this.low>>>0)},nW.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(nz))return"-"+this.neg().toString(e);var t=fromNumber(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}for(var i=fromNumber(nL(e,6),this.unsigned),o=this,s="";;){var a=o.div(i),l=(o.sub(a.mul(i)).toInt()>>>0).toString(e);if((o=a).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},nW.getHighBits=function(){return this.high},nW.getHighBitsUnsigned=function(){return this.high>>>0},nW.getLowBits=function(){return this.low},nW.getLowBitsUnsigned=function(){return this.low>>>0},nW.getNumBitsAbs=function(){if(this.isNegative())return this.eq(nz)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},nW.isZero=function(){return 0===this.high&&0===this.low},nW.eqz=nW.isZero,nW.isNegative=function(){return!this.unsigned&&this.high<0},nW.isPositive=function(){return this.unsigned||this.high>=0},nW.isOdd=function(){return(1&this.low)==1},nW.isEven=function(){return(1&this.low)==0},nW.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},nW.eq=nW.equals,nW.notEquals=function(e){return!this.eq(e)},nW.neq=nW.notEquals,nW.ne=nW.notEquals,nW.lessThan=function(e){return 0>this.comp(e)},nW.lt=nW.lessThan,nW.lessThanOrEqual=function(e){return 0>=this.comp(e)},nW.lte=nW.lessThanOrEqual,nW.le=nW.lessThanOrEqual,nW.greaterThan=function(e){return this.comp(e)>0},nW.gt=nW.greaterThan,nW.greaterThanOrEqual=function(e){return this.comp(e)>=0},nW.gte=nW.greaterThanOrEqual,nW.ge=nW.greaterThanOrEqual,nW.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},nW.comp=nW.compare,nW.negate=function(){return!this.unsigned&&this.eq(nz)?nz:this.not().add(n$)},nW.neg=nW.negate,nW.add=function(e){isLong(e)||(e=fromValue(e));var t,r,n=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,l=65535&e.high,u=e.low>>>16,d=65535&e.low,c=0,h=0;return t=0+((r=0+(s+d))>>>16),r&=65535,t+=o+u,h+=t>>>16,t&=65535,h+=i+l,c+=h>>>16,h&=65535,c+=n+a,fromBits(t<<16|r,(c&=65535)<<16|h,this.unsigned)},nW.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},nW.sub=nW.subtract,nW.multiply=function(e){if(this.isZero())return this;if(isLong(e)||(e=fromValue(e)),nx)return fromBits(nx.mul(this.low,this.high,e.low,e.high),nx.get_high(),this.unsigned);if(e.isZero())return this.unsigned?nj:nU;if(this.eq(nz))return e.isOdd()?nz:nU;if(e.eq(nz))return this.isOdd()?nz:nU;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(nV)&&e.lt(nV))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t,r,n=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,l=65535&e.high,u=e.low>>>16,d=65535&e.low,c=0,h=0;return t=0+((r=0+s*d)>>>16),r&=65535,t+=o*d,h+=t>>>16,t&=65535,t+=s*u,h+=t>>>16,t&=65535,h+=i*d,c+=h>>>16,h&=65535,h+=o*u,c+=h>>>16,h&=65535,h+=s*l,c+=h>>>16,h&=65535,c+=n*d+i*u+o*l+s*a,fromBits(t<<16|r,(c&=65535)<<16|h,this.unsigned)},nW.mul=nW.multiply,nW.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");if(nx){var t,r,n;return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?fromBits((this.unsigned?nx.div_u:nx.div_s)(this.low,this.high,e.low,e.high),nx.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?nj:nU;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return nj;if(e.gt(this.shru(1)))return nq;n=nj}else{if(this.eq(nz))return e.eq(n$)||e.eq(nG)?nz:e.eq(nz)?n$:(t=this.shr(1).div(e).shl(1)).eq(nU)?e.isNegative()?n$:nG:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(nz))return this.unsigned?nj:nU;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=nU}for(r=this;r.gte(e);){for(var i=Math.ceil(Math.log(t=Math.max(1,Math.floor(r.toNumber()/e.toNumber())))/Math.LN2),o=i<=48?1:nL(2,i-48),s=fromNumber(t),a=s.mul(e);a.isNegative()||a.gt(r);)t-=o,a=(s=fromNumber(t,this.unsigned)).mul(e);s.isZero()&&(s=n$),n=n.add(s),r=r.sub(a)}return n},nW.div=nW.divide,nW.modulo=function(e){return(isLong(e)||(e=fromValue(e)),nx)?fromBits((this.unsigned?nx.rem_u:nx.rem_s)(this.low,this.high,e.low,e.high),nx.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},nW.mod=nW.modulo,nW.rem=nW.modulo,nW.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},nW.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},nW.clz=nW.countLeadingZeros,nW.countTrailingZeros=function(){return this.low?ctz32(this.low):ctz32(this.high)+32},nW.ctz=nW.countTrailingZeros,nW.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},nW.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},nW.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},nW.shiftLeft=function(e){return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},nW.shl=nW.shiftLeft,nW.shiftRight=function(e){return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},nW.shr=nW.shiftRight,nW.shiftRightUnsigned=function(e){return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):32===e?fromBits(this.high,0,this.unsigned):fromBits(this.high>>>e-32,0,this.unsigned)},nW.shru=nW.shiftRightUnsigned,nW.shr_u=nW.shiftRightUnsigned,nW.rotateLeft=function(e){var t;return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?fromBits(this.high,this.low,this.unsigned):e<32?(t=32-e,fromBits(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,fromBits(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},nW.rotl=nW.rotateLeft,nW.rotateRight=function(e){var t;return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?fromBits(this.high,this.low,this.unsigned):e<32?(t=32-e,fromBits(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,fromBits(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},nW.rotr=nW.rotateRight,nW.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},nW.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},nW.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},nW.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},nW.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function(e,t,r){return r?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var nH=((w=nH||{}).Ok="ok",w.ClientNotActive="client-not-active",w.Unimplemented="unimplemented",w.Unsupported="unsupported",w.DocumentNotAttached="document-not-attached",w.DocumentNotDetached="document-not-detached",w.DocumentRemoved="document-removed",w.InvalidObjectKey="invalid-object-key",w.InvalidArgument="invalid-argument",w);let YorkieError=class YorkieError extends Error{constructor(e,t){super(t),__publicField(this,"name","YorkieError"),__publicField(this,"stack"),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};function deepcopy(e){if(e instanceof Map){let t=Array.from(e);return new Map(JSON.parse(JSON.stringify(t)))}return JSON.parse(JSON.stringify(e))}let isEmpty=e=>!e||0===Object.entries(e).length,stringifyObjectValues=e=>{let t={};for(let[r,n]of Object.entries(e))t[r]=JSON.stringify(n);return t},parseObjectValues=e=>{let t={};for(let[r,n]of Object.entries(e))t[r]=JSON.parse(n);return t};var nX=((C=nX||{}).Put="put",C.Clear="clear",C);let Presence=class Presence{constructor(e,t){__publicField(this,"context"),__publicField(this,"presence"),this.context=e,this.presence=t}set(e,t){for(let t of Object.keys(e))this.presence[t]=e[t];this.context.setPresenceChange({type:"put",presence:deepcopy(this.presence)}),this.context.setReversePresence(e,t)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:"clear"})}};let nZ="000000000000000000000000";let TimeTicket=class TimeTicket{constructor(e,t,r){__publicField(this,"lamport"),__publicField(this,"delimiter"),__publicField(this,"actorID"),this.lamport=e,this.delimiter=t,this.actorID=r}static of(e,t,r){return new TimeTicket(e,t,r)}static fromStruct(e){return TimeTicket.of(Long.fromString(e.lamport,!0),e.delimiter,e.actorID)}toIDString(){return`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`}setActor(e){return new TimeTicket(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return 0===this.compare(e)}compare(e){if(this.lamport.greaterThan(e.lamport))return 1;if(e.lamport.greaterThan(this.lamport))return -1;let t=this.actorID.localeCompare(e.actorID);return 0!==t?t:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}};let nQ=Long.MAX_VALUE,n0=new TimeTicket(Long.fromNumber(0),0,nZ);new TimeTicket(Long.fromNumber(1),1,nZ);let n1=new TimeTicket(nQ,4294967295,"FFFFFFFFFFFFFFFFFFFFFFFF");var n2=((x=n2||{})[x.Trivial=0]="Trivial",x[x.Debug=1]="Debug",x[x.Info=2]="Info",x[x.Warn=3]="Warn",x[x.Error=4]="Error",x[x.Fatal=5]="Fatal",x);let n3=2,n6={trivial:(...e)=>{n3>0||"undefined"==typeof console||console.log("YORKIE T:",...e)},debug:(...e)=>{n3>1||"undefined"==typeof console||console.log("YORKIE D:",...e)},info:(...e)=>{n3>2||"undefined"==typeof console||console.log("YORKIE I:",...e)},warn:(...e)=>{n3>3||"undefined"==typeof console||(void 0!==console.warn?console.warn("YORKIE W:",...e):console.log("YORKIE W:",...e))},error:(...e)=>{n3>4||"undefined"==typeof console||(void 0!==console.error?console.error("YORKIE E:",...e):console.log("YORKIE E:",...e))},fatal:(e,...t)=>{throw"undefined"!=typeof console&&(void 0!==console.error?console.error("YORKIE F:",...t):console.log("YORKIE F:",...t)),Error(`YORKIE F: ${e}`)},isEnabled:e=>n3<=e};function escapeString(e){return e.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case"\n":return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}let CRDTElement=class CRDTElement{constructor(e){__publicField(this,"createdAt"),__publicField(this,"movedAt"),__publicField(this,"removedAt"),this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setMovedAt(e){return!!(!this.movedAt||e&&e.after(this.movedAt))&&(this.movedAt=e,!0)}setRemovedAt(e){this.removedAt=e}remove(e){return!!(e&&e.after(this.getPositionedAt())&&(!this.removedAt||e.after(this.removedAt)))&&(this.removedAt=e,!0)}isRemoved(){return!!this.removedAt}};let CRDTContainer=class CRDTContainer extends CRDTElement{constructor(e){super(e)}};let ElementRHTNode=class ElementRHTNode{constructor(e,t){__publicField(this,"strKey"),__publicField(this,"value"),this.strKey=e,this.value=t}static of(e,t){return new ElementRHTNode(e,t)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}};let ElementRHT=class ElementRHT{constructor(){__publicField(this,"nodeMapByKey"),__publicField(this,"nodeMapByCreatedAt"),this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new ElementRHT}set(e,t,r){let n;let i=this.nodeMapByKey.get(e);null!=i&&!i.isRemoved()&&i.remove(r)&&(n=i.getValue());let o=ElementRHTNode.of(e,t);return this.nodeMapByCreatedAt.set(t.getCreatedAt().toIDString(),o),(null==i||r.after(i.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,o),t.setMovedAt(r)),n}delete(e,t){this.nodeMapByCreatedAt.has(e.toIDString())||n6.fatal(`fail to find ${e.toIDString()}`);let r=this.nodeMapByCreatedAt.get(e.toIDString());return r.remove(t),r.getValue()}subPathOf(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return t.getStrKey()}purge(e){let t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t){n6.fatal(`fail to find ${e.getCreatedAt().toIDString()}`);return}let r=this.nodeMapByKey.get(t.getStrKey());t===r&&this.nodeMapByKey.delete(r.getStrKey()),this.nodeMapByCreatedAt.delete(t.getValue().getCreatedAt().toIDString())}deleteByKey(e,t){let r=this.nodeMapByKey.get(e);if(null!=r&&r.remove(t))return r.getValue()}has(e){let t=this.nodeMapByKey.get(e);return null!=t&&!t.isRemoved()}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){let t=this.nodeMapByKey.get(e);if(!(!t||t.isRemoved()))return t}*[Symbol.iterator](){for(let[,e]of this.nodeMapByKey)yield e}};let CRDTObject=class CRDTObject extends CRDTContainer{constructor(e,t){super(e),__publicField(this,"memberNodes"),this.memberNodes=t}static create(e,t){if(!t)return new CRDTObject(e,ElementRHT.create());let r=ElementRHT.create();for(let[e,n]of Object.entries(t))r.set(e,n.deepcopy(),n.getCreatedAt());return new CRDTObject(e,r)}subPathOf(e){return this.memberNodes.subPathOf(e)}purge(e){this.memberNodes.purge(e)}set(e,t,r){return this.memberNodes.set(e,t,r)}delete(e,t){return this.memberNodes.delete(e,t)}deleteByKey(e,t){return this.memberNodes.deleteByKey(e,t)}get(e){let t=this.memberNodes.get(e);return null==t?void 0:t.getValue()}getByID(e){let t=this.memberNodes.getByID(e);return null==t?void 0:t.getValue()}has(e){return this.memberNodes.has(e)}toJSON(){let e=[];for(let[t,r]of this)e.push(`"${escapeString(t)}":${r.toJSON()}`);return`{${e.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){let e={};for(let[t,r]of this){let{createdAt:n,value:i,type:o}=r.toJSForTest();e[t]={key:t,createdAt:n,value:i,type:o}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_OBJECT"}}getKeys(){let e=[];for(let[t]of this)e.push(t);return e}toSortedJSON(){var e;let t=[];for(let[e]of this)t.push(e);let r=[];for(let n of t.sort()){let t=null==(e=this.memberNodes.get(n))?void 0:e.getValue();r.push(`"${escapeString(n)}":${t.toSortedJSON()}`)}return`{${r.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){let e=CRDTObject.create(this.getCreatedAt());for(let t of this.memberNodes)e.memberNodes.set(t.getStrKey(),t.getValue().deepcopy(),this.getPositionedAt());return e.remove(this.getRemovedAt()),e}getDescendants(e){for(let t of this.memberNodes){let r=t.getValue();if(e(r,this))return;r instanceof CRDTContainer&&r.getDescendants(e)}}*[Symbol.iterator](){let e=new Set;for(let t of this.memberNodes)e.has(t.getStrKey())||(e.add(t.getStrKey()),t.isRemoved()||(yield[t.getStrKey(),t.getValue()]))}};var n4=((R=n4||{}).Local="local",R.Remote="remote",R.UndoRedo="undoredo",R);let Operation=class Operation{constructor(e,t){__publicField(this,"parentCreatedAt"),__publicField(this,"executedAt"),this.parentCreatedAt=e,this.executedAt=t}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw Error("executedAt has not been set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}};let SplayNode=class SplayNode{constructor(e){__publicField(this,"value"),__publicField(this,"left"),__publicField(this,"right"),__publicField(this,"parent"),__publicField(this,"weight"),this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}};let SplayTree=class SplayTree{constructor(e){__publicField(this,"root"),this.root=e}get length(){return this.root?this.root.getWeight():0}find(e){if(!this.root||e<0)return[void 0,0];let t=this.root;for(;;)if(t.hasLeft()&&e<=t.getLeftWeight())t=t.getLeft();else if(t.hasRight()&&t.getLeftWeight()+t.getLength()<e)e-=t.getLeftWeight()+t.getLength(),t=t.getRight();else{e-=t.getLeftWeight();break}return e>t.getLength()&&n6.fatal(`out of index range: pos: ${e} > node.length: ${t.getLength()}`),[t,e]}indexOf(e){let t;if(!e||e!==this.root&&!e.hasLinks())return -1;let r=0,n=e;for(;n;)t&&t!==n.getRight()||(r+=n.getLength()+(n.hasLeft()?n.getLeftWeight():0)),t=n,n=n.getParent();return r-e.getLength()}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,t){return e?(this.splayNode(e),this.root=t,t.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(t),t.setLeft(e),e.setParent(t),e.setRight(),this.updateWeight(e),this.updateWeight(t)):this.root=t,t}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);let t=new SplayTree(e.getLeft());t.root&&t.root.setParent();let r=new SplayTree(e.getRight());if(r.root&&r.root.setParent(),t.root){let e=t.getRightmost();t.splayNode(e),t.root.setRight(r.root),r.root&&r.root.setParent(t.root),this.root=t.root}else this.root=r.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,t){if(!t){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(t),t.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){let t=[];for(let r of(this.traversePostorder(e.getRight(),t),t))r.initWeight();this.updateTreeWeight(e)}toTestString(){let e=[];return this.traverseInorder(this.root,e),e.map(e=>`[${e.getWeight()},${e.getLength()}]${e.getValue()||""}`).join("")}checkWeight(){let e=[];for(let t of(this.traverseInorder(this.root,e),e))if(t.getWeight()!=t.getLength()+t.getLeftWeight()+t.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,t){e&&(this.traverseInorder(e.getLeft(),t),t.push(e),this.traverseInorder(e.getRight(),t))}traversePostorder(e,t){e&&(this.traversePostorder(e.getLeft(),t),this.traversePostorder(e.getRight(),t),t.push(e))}rotateLeft(e){let t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setRight(e.getLeft()),t.hasRight()&&t.getRight().setParent(t),e.setLeft(t),e.getLeft().setParent(e),this.updateWeight(t),this.updateWeight(e)}rotateRight(e){let t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setLeft(e.getRight()),t.hasLeft()&&t.getLeft().setParent(t),e.setRight(t),e.getRight().setParent(e),this.updateWeight(t),this.updateWeight(e)}isLeftChild(e){return!!(e&&e.hasParent())&&e.getParent().getLeft()===e}isRightChild(e){return!!(e&&e.hasParent())&&e.getParent().getRight()===e}};var n9=((F=n9||{})[F.Null=0]="Null",F[F.Boolean=1]="Boolean",F[F.Integer=2]="Integer",F[F.Long=3]="Long",F[F.Double=4]="Double",F[F.String=5]="String",F[F.Bytes=6]="Bytes",F[F.Date=7]="Date",F);let Primitive=class Primitive extends CRDTElement{constructor(e,t){super(t),__publicField(this,"valueType"),__publicField(this,"value"),this.valueType=Primitive.getPrimitiveType(e),this.value=void 0===e?null:e}static of(e,t){return new Primitive(e,t)}static valueFromBytes(e,t){switch(e){case 0:return null;case 1:return!!t[0];case 2:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case 4:{let e=new DataView(t.buffer);return t.forEach(function(t,r){e.setUint8(r,t)}),e.getFloat64(0,!0)}case 5:return new TextDecoder("utf-8").decode(t);case 3:return Long.fromBytesLE(Array.from(t));case 6:return t;case 7:return new Date(Long.fromBytesLE(Array.from(t),!0).toNumber());default:throw new YorkieError(nH.Unimplemented,`unimplemented type: ${e}`)}}toJSON(){return 5===this.valueType?`"${escapeString(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){let e=Primitive.of(this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e.setRemovedAt(this.getRemovedAt()),e}getType(){return this.valueType}static getPrimitiveType(e){switch(typeof e){case"undefined":return 0;case"boolean":return 1;case"number":if(this.isInteger(e))return 2;return 4;case"string":return 5;case"object":if(null===e)return 0;if(e instanceof Long)return 3;if(e instanceof Uint8Array)return 6;if(e instanceof Date)return 7}}static isSupport(e){let t=Primitive.getPrimitiveType(e);return void 0!==t}static isInteger(e){return e%1==0}isNumericType(){let e=this.valueType;return 2===e||3===e||4===e}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:return new Uint8Array;case 1:{let e=this.value;return new Uint8Array(e?[1]:[0])}case 2:{let e=this.value;return new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24&255])}case 4:{let e=this.value,t=new Uint8Array(8),r=new DataView(t.buffer);return r.setFloat64(0,e,!0),t}case 5:return new TextEncoder().encode(this.value);case 3:{let e=this.value,t=e.toBytesLE();return Uint8Array.from(t)}case 6:{let e=this.value;return e}case 7:{let e=this.value,t=Long.fromNumber(e.getTime(),!0).toBytesLE();return Uint8Array.from(t)}default:throw new YorkieError(nH.Unimplemented,`unimplemented type: ${this.valueType}`)}}};let RGATreeListNode=class RGATreeListNode extends SplayNode{constructor(e){super(e),__publicField(this,"prev"),__publicField(this,"next"),this.value=e}static createAfter(e,t){let r=new RGATreeListNode(t),n=e.next;return e.next=r,r.prev=e,r.next=n,n&&(n.prev=r),r}remove(e){return this.value.remove(e)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}};let RGATreeList=class RGATreeList{constructor(){__publicField(this,"dummyHead"),__publicField(this,"last"),__publicField(this,"nodeMapByIndex"),__publicField(this,"nodeMapByCreatedAt");let e=Primitive.of(0,n0);e.setRemovedAt(n0),this.dummyHead=new RGATreeListNode(e),this.last=this.dummyHead,this.nodeMapByIndex=new SplayTree,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new RGATreeList}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,t){let r=this.nodeMapByCreatedAt.get(e.toIDString());for(r||n6.fatal(`cant find the given node: ${e.toIDString()}`);r.getNext()&&r.getNext().getPositionedAt().after(t);)r=r.getNext();return r}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,t,r=t.getCreatedAt()){let n=this.findNextBeforeExecutedAt(e,r),i=RGATreeListNode.createAfter(n,t);n===this.last&&(this.last=i),this.nodeMapByIndex.insertAfter(n,i),this.nodeMapByCreatedAt.set(i.getCreatedAt().toIDString(),i)}moveAfter(e,t,r){let n=this.nodeMapByCreatedAt.get(e.toIDString());n||n6.fatal(`cant find the given node: ${e.toIDString()}`);let i=this.nodeMapByCreatedAt.get(t.toIDString());i||n6.fatal(`cant find the given node: ${t.toIDString()}`),n!==i&&(!i.getValue().getMovedAt()||r.after(i.getValue().getMovedAt()))&&(this.release(i),this.insertAfter(n.getCreatedAt(),i.getValue(),r),i.getValue().setMovedAt(r))}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return String(this.nodeMapByIndex.indexOf(t))}purge(e){let t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());t||n6.fatal(`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`),this.release(t)}getByIndex(e){if(e>=this.length)return;let[t,r]=this.nodeMapByIndex.find(e),n=t;if(0===e&&t===this.dummyHead||r>0)do n&&(n=n.getNext());while(n&&n.isRemoved());return n}getPrevCreatedAt(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());do t=t.getPrev();while(this.dummyHead!==t&&t.isRemoved());return t.getValue().getCreatedAt()}delete(e,t){let r=this.nodeMapByCreatedAt.get(e.toIDString()),n=r.isRemoved();return r.remove(t)&&!n&&this.nodeMapByIndex.splayNode(r),r.getValue()}deleteByIndex(e,t){let r=this.getByIndex(e);if(r)return r.remove(t)&&this.nodeMapByIndex.splayNode(r),r.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){let e=[];for(let t of this){let r=`${t.getCreatedAt().toIDString()}:${t.getValue().toJSON()}`;t.isRemoved()?e.push(`{${r}}`):e.push(`[${r}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}};let CRDTArray=class CRDTArray extends CRDTContainer{constructor(e,t){super(e),__publicField(this,"elements"),this.elements=t}static create(e,t){if(!t)return new CRDTArray(e,RGATreeList.create());let r=RGATreeList.create();for(let e of t)r.insertAfter(r.getLastCreatedAt(),e.deepcopy());return new CRDTArray(e,r)}subPathOf(e){return this.elements.subPathOf(e)}purge(e){this.elements.purge(e)}insertAfter(e,t){this.elements.insertAfter(e,t)}moveAfter(e,t,r){this.elements.moveAfter(e,t,r)}get(e){let t=this.elements.getByIndex(e);return null==t?void 0:t.getValue()}getByID(e){let t=this.elements.getByID(e);return null==t?void 0:t.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(e){return this.elements.getPrevCreatedAt(e)}delete(e,t){return this.elements.delete(e,t)}deleteByIndex(e,t){return this.elements.deleteByIndex(e,t)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(let e of this.elements)e.isRemoved()||(yield e.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(e){for(let t of this.elements){let r=t.getValue();if(e(r,this))return;r instanceof CRDTContainer&&r.getDescendants(e)}}toJSON(){let e=[];for(let t of this)e.push(t.toJSON());return`[${e.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){let e={};for(let t=0;t<this.length;t++){let{createdAt:r,value:n,type:i}=this.get(t).toJSForTest();e[t]={key:String(t),createdAt:r,value:n,type:i}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){let e=CRDTArray.create(this.getCreatedAt());for(let t of this.elements)e.elements.insertAfter(e.getLastCreatedAt(),t.getValue().deepcopy());return e.remove(this.getRemovedAt()),e}};let RemoveOperation=class RemoveOperation extends Operation{constructor(e,t,r){super(e,r),__publicField(this,"createdAt"),this.createdAt=t}static create(e,t,r){return new RemoveOperation(e,t,r)}execute(e,t){var r;let n=e.findByCreatedAt(this.getParentCreatedAt());if(n||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),n instanceof CRDTContainer||n6.fatal(`only object and array can execute remove: ${n}`),t===n4.UndoRedo){let t=n.getByID(this.createdAt);for(;t;){if(t.getRemovedAt())return;t=null==(r=e.findElementPairByCreatedAt(t.getCreatedAt()))?void 0:r.parent}}let i=n.subPathOf(this.createdAt),o=this.toReverseOperation(n),s=n.delete(this.createdAt,this.getExecutedAt());e.registerRemovedElement(s);let a=n instanceof CRDTArray?[{type:"remove",path:e.createPath(this.getParentCreatedAt()),index:Number(i)}]:[{type:"remove",path:e.createPath(this.getParentCreatedAt()),key:i}];return{opInfos:a,reverseOp:o}}toReverseOperation(e){if(e instanceof CRDTObject){let t=e.subPathOf(this.createdAt);if(void 0!==t){let r=e.get(t);if(void 0!==r)return SetOperation.create(t,r.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}};let SetOperation=class SetOperation extends Operation{constructor(e,t,r,n){super(r,n),__publicField(this,"key"),__publicField(this,"value"),this.key=e,this.value=t}static create(e,t,r,n){return new SetOperation(e,t,r,n)}execute(e,t){var r;let n=e.findByCreatedAt(this.getParentCreatedAt());if(n||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),n instanceof CRDTObject||n6.fatal("fail to execute, only object can execute set"),t===n4.UndoRedo){let t=n;for(;t;){if(t.getRemovedAt())return;t=null==(r=e.findElementPairByCreatedAt(t.getCreatedAt()))?void 0:r.parent}}let i=n.get(this.key),o=this.toReverseOperation(i),s=this.value.deepcopy(),a=n.set(this.key,s,this.getExecutedAt());return t===n4.UndoRedo&&e.findByCreatedAt(s.getCreatedAt())&&e.deregisterElement(s),e.registerElement(s,n),a&&e.registerRemovedElement(a),{opInfos:[{type:"set",path:e.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:o}}toReverseOperation(e){let t=RemoveOperation.create(this.getParentCreatedAt(),this.value.getCreatedAt());return void 0===e||e.isRemoved()||(t=SetOperation.create(this.key,e.deepcopy(),this.getParentCreatedAt())),t}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}};let AddOperation=class AddOperation extends Operation{constructor(e,t,r,n){super(e,n),__publicField(this,"prevCreatedAt"),__publicField(this,"value"),this.prevCreatedAt=t,this.value=r}static create(e,t,r,n){return new AddOperation(e,t,r,n)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());t||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof CRDTArray||n6.fatal("fail to execute, only array can execute add");let r=this.value.deepcopy();return t.insertAfter(this.prevCreatedAt,r),e.registerElement(r,t),{opInfos:[{type:"add",path:e.createPath(this.getParentCreatedAt()),index:Number(t.subPathOf(this.getEffectedCreatedAt()))}]}}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}};let MoveOperation=class MoveOperation extends Operation{constructor(e,t,r,n){super(e,n),__publicField(this,"prevCreatedAt"),__publicField(this,"createdAt"),this.prevCreatedAt=t,this.createdAt=r}static create(e,t,r,n){return new MoveOperation(e,t,r,n)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());t||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof CRDTArray||n6.fatal("fail to execute, only array can execute move");let r=Number(t.subPathOf(this.createdAt));t.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());let n=Number(t.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:e.createPath(this.getParentCreatedAt()),index:n,previousIndex:r}]}}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}};let RHTNode=class RHTNode{constructor(e,t,r,n){__publicField(this,"key"),__publicField(this,"value"),__publicField(this,"updatedAt"),__publicField(this,"_isRemoved"),this.key=e,this.value=t,this.updatedAt=r,this._isRemoved=n}static of(e,t,r,n){return new RHTNode(e,t,r,n)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}isRemoved(){return this._isRemoved}toIDString(){return`${this.updatedAt.toIDString()}:${this.key}`}getRemovedAt(){if(this._isRemoved)return this.updatedAt}};let RHT=class RHT{constructor(){__publicField(this,"nodeMapByKey"),__publicField(this,"numberOfRemovedElement"),this.nodeMapByKey=new Map,this.numberOfRemovedElement=0}static create(){return new RHT}set(e,t,r){let n=this.nodeMapByKey.get(e);if(n&&n.isRemoved()&&r.after(n.getUpdatedAt())&&(this.numberOfRemovedElement-=1),void 0===n||r.after(n.getUpdatedAt())){let i=RHTNode.of(e,t,r,!1);return(this.nodeMapByKey.set(e,i),void 0!==n&&n.isRemoved())?[n,i]:[void 0,i]}return n.isRemoved()?[n,void 0]:[void 0,void 0]}remove(e,t){let r=this.nodeMapByKey.get(e),n=[];if(void 0===r||t.after(r.getUpdatedAt())){if(void 0===r){this.numberOfRemovedElement+=1;let r=RHTNode.of(e,"",t,!0);return this.nodeMapByKey.set(e,r),n.push(r),n}let i=r.isRemoved();i||(this.numberOfRemovedElement+=1),i&&n.push(r);let o=RHTNode.of(e,r.getValue(),t,!0);this.nodeMapByKey.set(e,o),n.push(o)}return n}has(e){if(this.nodeMapByKey.has(e)){let t=this.nodeMapByKey.get(e);return void 0!==t&&!t.isRemoved()}return!1}get(e){if(this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){let e=new RHT;for(let[,t]of this.nodeMapByKey)e.set(t.getKey(),t.getValue(),t.getUpdatedAt());return e}toJSON(){if(!this.size())return"{}";let e=[];for(let[t,r]of this.nodeMapByKey)r.isRemoved()||e.push(`"${escapeString(t)}":"${escapeString(r.getValue())}"`);return`{${e.join(",")}}`}size(){return this.nodeMapByKey.size-this.numberOfRemovedElement}toObject(){let e={};for(let[t,r]of this.nodeMapByKey)r.isRemoved()||(e[t]=r.getValue());return e}*[Symbol.iterator](){for(let[,e]of this.nodeMapByKey)yield e}purge(e){let t=this.nodeMapByKey.get(e.getKey());void 0!=t&&t.toIDString()==e.toIDString()&&(this.nodeMapByKey.delete(e.getKey()),this.numberOfRemovedElement--)}};let CRDTTextValue=class CRDTTextValue{constructor(e){__publicField(this,"attributes"),__publicField(this,"content"),this.attributes=RHT.create(),this.content=e}static create(e){return new CRDTTextValue(e)}get length(){return this.content.length}substring(e,t){let r=new CRDTTextValue(this.content.substring(e,t));return r.attributes=this.attributes.deepcopy(),r}setAttr(e,t,r){return this.attributes.set(e,t,r)}getAttrs(){return this.attributes}toString(){return this.content}toJSON(){let e=escapeString(this.content),t=this.attributes.toObject(),r=[];for(let[e,n]of Object.entries(t)){let t=JSON.parse(n),i="string"==typeof t?`"${escapeString(e)}":"${escapeString(t)}"`:`"${escapeString(e)}":${String(t)}`;r.push(i)}return(r.sort(),0===r.length)?`{"val":"${e}"}`:`{"attrs":{${r.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}purge(e){this.attributes&&e instanceof RHTNode&&this.attributes.purge(e)}getGCPairs(){let e=[];for(let t of this.attributes)t.getRemovedAt()&&e.push({parent:this,child:t});return e}};let CRDTText=class CRDTText extends CRDTElement{constructor(e,t){super(t),__publicField(this,"rgaTreeSplit"),this.rgaTreeSplit=e}static create(e,t){return new CRDTText(e,t)}edit(e,t,r,n,i){let o=t?CRDTTextValue.create(t):void 0;if(o&&n)for(let[e,t]of Object.entries(n))o.setAttr(e,t,r);let[s,a,l,u]=this.rgaTreeSplit.edit(e,r,o,i),d=u.map(e=>({...e,value:e.value?{attributes:parseObjectValues(e.value.getAttributes()),content:e.value.getContent()}:{attributes:void 0,content:""},type:"content"}));return[a,d,l,[s,s]]}setStyle(e,t,r,n){let[,i]=this.rgaTreeSplit.findNodeWithSplit(e[1],r),[,o]=this.rgaTreeSplit.findNodeWithSplit(e[0],r),s=[],a=this.rgaTreeSplit.findBetween(o,i),l=new Map,u=[];for(let e of a){let t=e.getCreatedAt().getActorID(),i=(null==n?void 0:n.size)?n.has(t)?n.get(t):n0:n1;if(e.canStyle(r,i)){let r=l.get(t),n=e.getCreatedAt();(!r||n.after(r))&&l.set(t,n),u.push(e)}}let d=[];for(let e of u){if(e.isRemoved())continue;let[n,i]=this.rgaTreeSplit.findIndexesFromRange(e.createPosRange());for(let[o,a]of(s.push({type:"style",actor:r.getActorID(),from:n,to:i,value:{attributes:parseObjectValues(t)}}),Object.entries(t))){let[t]=e.getValue().setAttr(o,a,r);void 0!==t&&d.push({parent:e.getValue(),child:t})}}return[l,d,s]}indexRangeToPosRange(e,t){let r=this.rgaTreeSplit.indexToPos(e);return e===t?[r,r]:[r,this.rgaTreeSplit.indexToPos(t)]}get length(){return this.rgaTreeSplit.length}checkWeight(){return this.rgaTreeSplit.checkWeight()}toJSON(){let e=[];for(let t of this.rgaTreeSplit)t.isRemoved()||e.push(t.getValue().toJSON());return`[${e.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){let e=[];for(let t of this.rgaTreeSplit)if(!t.isRemoved()){let r=t.getValue();e.push({attributes:parseObjectValues(r.getAttributes()),content:r.getContent()})}return e}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}deepcopy(){let e=new CRDTText(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return e.remove(this.getRemovedAt()),e}findIndexesFromRange(e){return this.rgaTreeSplit.findIndexesFromRange(e)}getGCPairs(){let e=[];for(let t of this.rgaTreeSplit)for(let r of(t.getRemovedAt()&&e.push({parent:this.rgaTreeSplit,child:t}),t.getValue().getGCPairs()))e.push(r);return e}};let EditOperation=class EditOperation extends Operation{constructor(e,t,r,n,i,o,s){super(e,s),__publicField(this,"fromPos"),__publicField(this,"toPos"),__publicField(this,"maxCreatedAtMapByActor"),__publicField(this,"content"),__publicField(this,"attributes"),this.fromPos=t,this.toPos=r,this.maxCreatedAtMapByActor=n,this.content=i,this.attributes=o}static create(e,t,r,n,i,o,s){return new EditOperation(e,t,r,n,i,o,s)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());t||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof CRDTText||n6.fatal("fail to execute, only Text can execute edit");let[,r,n]=t.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),this.maxCreatedAtMapByActor);for(let t of n)e.registerGCPair(t);return{opInfos:r.map(({from:t,to:r,value:n})=>({type:"edit",from:t,to:r,value:n,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),r=this.toPos.toTestString(),n=this.content;return`${e}.EDIT(${t},${r},${n})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}};let StyleOperation=class StyleOperation extends Operation{constructor(e,t,r,n,i,o){super(e,o),__publicField(this,"fromPos"),__publicField(this,"toPos"),__publicField(this,"maxCreatedAtMapByActor"),__publicField(this,"attributes"),this.fromPos=t,this.toPos=r,this.maxCreatedAtMapByActor=n,this.attributes=i}static create(e,t,r,n,i,o){return new StyleOperation(e,t,r,n,i,o)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());t||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof CRDTText||n6.fatal("fail to execute, only Text can execute edit");let[,r,n]=t.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),this.maxCreatedAtMapByActor);for(let t of r)e.registerGCPair(t);return{opInfos:n.map(({from:t,to:r,value:n})=>({type:"style",from:t,to:r,value:n,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),r=this.toPos.toTestString(),n=this.attributes;return`${e}.STYL(${t},${r},${JSON.stringify(n)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}};let n5="text";function addSizeOfLeftSiblings(e,t){let r=0,n=e.children;for(let e=0;e<t;e++){let t=n[e];t&&!t.isRemoved&&(r+=t.paddedSize)}return r}let IndexTreeNode=class IndexTreeNode{constructor(e,t=[]){if(__publicField(this,"type"),__publicField(this,"parent"),__publicField(this,"_children"),__publicField(this,"size"),this.type=e,this.size=0,this._children=t,this.isText&&this._children.length>0)throw Error(`Text node cannot have children: ${this.type}`)}updateAncestorsSize(){let e=this.parent,t=this.isRemoved?-1:1;for(;e;)e.size+=this.paddedSize*t,e=e.parent}updateDescendantsSize(){if(this.isRemoved)return this.size=0,0;let e=0;for(let t of this._children)e+=t.updateDescendantsSize();return this.size+=e,this.paddedSize}get isText(){return this.type===n5}get paddedSize(){return this.size+(this.isText?0:2)}isAncestorOf(e){return function(e,t){if(e===t)return!1;for(;t.parent;){if(t.parent===e)return!0;t=t.parent}return!1}(this,e)}get nextSibling(){let e=this.parent.findOffset(this),t=this.parent.children[e+1];if(t)return t}get prevSibling(){let e=this.parent.findOffset(this),t=this.parent.children[e-1];if(t)return t}splitText(e,t){if(0===e||e===this.size)return;let r=this.value.slice(0,e),n=this.value.slice(e);if(!n.length)return;this.value=r;let i=this.cloneText(e+t);return i.value=n,this.parent.insertAfterInternal(i,this),i}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.length>0&&this.children.every(e=>e.isText)}append(...e){if(this.isText)throw Error("Text node cannot have children");for(let t of(this._children.push(...e),e))t.parent=this,t.updateAncestorsSize()}prepend(...e){if(this.isText)throw Error("Text node cannot have children");for(let t of(this._children.unshift(...e),e))t.parent=this}insertBefore(e,t){if(this.isText)throw Error("Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw Error("child not found");this.insertAtInternal(e,r),e.updateAncestorsSize()}insertAfter(e,t){if(this.isText)throw Error("Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw Error("child not found");this.insertAtInternal(e,r+1),e.updateAncestorsSize()}insertAt(e,t){if(this.isText)throw Error("Text node cannot have children");this.insertAtInternal(e,t),e.updateAncestorsSize()}removeChild(e){if(this.isText)throw Error("Text node cannot have children");let t=this._children.indexOf(e);if(-1===t)throw Error("child not found");this._children.splice(t,1),e.parent=void 0}splitElement(e,t){let r=this.cloneElement(t);this.parent.insertAfterInternal(r,this),r.updateAncestorsSize();let n=this.children.slice(0,e),i=this.children.slice(e);for(let e of(this._children=n,r._children=i,this.size=this._children.reduce((e,t)=>e+t.paddedSize,0),r.size=r._children.reduce((e,t)=>e+t.paddedSize,0),r._children))e.parent=r;return r}insertAfterInternal(e,t){if(this.isText)throw Error("Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw Error("child not found");this.insertAtInternal(e,r+1)}insertAtInternal(e,t){if(this.isText)throw Error("Text node cannot have children");this._children.splice(t,0,e),e.parent=this}findOffset(e){if(this.isText)throw Error("Text node cannot have children");if(e.isRemoved){let t=this._children.indexOf(e),r=this.allChildren.splice(0,t).filter(e=>!e.isRemoved).length;return r}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw Error("Text node cannot have children");let t=e;for(;t;){let e=this._children.indexOf(t);if(-1!==e)return e;t=t.parent}return -1}};var n8=((L=n8||{}).Start="Start",L.End="End",L.Text="Text",L);function traverseAll(e,t,r=0){for(let n of e._children)traverseAll(n,t,r+1);t(e,r)}let IndexTree=class IndexTree{constructor(e){__publicField(this,"root"),this.root=e}tokensBetween(e,t,r){!function tokensBetween(e,t,r,n){if(t>r)throw Error(`from is greater than to: ${t} > ${r}`);if(t>e.size)throw Error(`from is out of range: ${t} > ${e.size}`);if(r>e.size)throw Error(`to is out of range: ${r} > ${e.size}`);if(t===r)return;let i=0;for(let o of e.children){if(t-o.paddedSize<i&&i<r){let e=o.isText?t-i:t-i-1,s=o.isText?r-i:r-i-1,a=!o.isText&&e<0,l=!o.isText&&s>o.size;(o.isText||a)&&n([o,o.isText?"Text":"Start"],l),tokensBetween(o,Math.max(0,e),Math.min(s,o.size),n),l&&n([o,"End"],l)}i+=o.paddedSize}}(this.root,e,t,r)}traverse(e){!function traverse(e,t,r=0){for(let n of e.children)traverse(n,t,r+1);t(e,r)}(this.root,e,0)}traverseAll(e){traverseAll(this.root,e,0)}findTreePos(e,t=!0){return function findTreePos(e,t,r=!0){if(t>e.size)throw Error(`index is out of range: ${t} > ${e.size}`);if(e.isText)return{node:e,offset:t};let n=0,i=0;for(let o of e.children){if(r&&o.isText&&o.size>=t-i)return findTreePos(o,t-i,r);if(t===i)break;if(!r&&o.paddedSize===t-i)return{node:e,offset:n+1};if(o.paddedSize>t-i)return findTreePos(o,t-i-1,r);i+=o.paddedSize,n+=1}return{node:e,offset:n}}(this.root,e,t)}treePosToPath(e){let t=[],r=e.node;if(r.isText){let n=r.parent.findOffset(r);if(-1===n)throw Error("invalid treePos");let i=addSizeOfLeftSiblings(r.parent,n);t.push(i+e.offset),r=r.parent}else if(r.hasTextChild()){let n=addSizeOfLeftSiblings(r,e.offset);t.push(n)}else t.push(e.offset);for(;r.parent;){let e=r.parent.findOffset(r);if(-1===e)throw Error("invalid treePos");t.push(e),r=r.parent}return t.reverse()}pathToIndex(e){let t=this.pathToTreePos(e);return this.indexOf(t)}pathToTreePos(e){if(!e.length)throw Error("unacceptable path");let t=this.root;for(let r=0;r<e.length-1;r++){let n=e[r];if(!(t=t.children[n]))throw Error("unacceptable path")}if(t.hasTextChild())return function(e,t){if(e.size<t)throw Error("unacceptable path");for(let r=0;r<e.children.length;r++){let n=e.children[r];if(n.size<t)t-=n.size;else{e=n;break}}return{node:e,offset:t}}(t,e[e.length-1]);if(t.children.length<e[e.length-1])throw Error("unacceptable path");return{node:t,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.size}findPostorderRight(e){let{node:t,offset:r}=e;if(t.isText){if(t.size===r){let e=t.nextSibling;return e||t.parent}return t}return t.children.length===r?t:function findLeftmost(e){return e.isText||0===e.children.length?e:findLeftmost(e.children[0])}(t.children[r])}indexOf(e){let{node:t}=e,{offset:r}=e,n=0,i=1;if(t.isText){n+=r;let e=t.parent,i=e.findOffset(t);if(-1===i)throw Error("invalid pos");n+=addSizeOfLeftSiblings(e,i),t=t.parent}else n+=addSizeOfLeftSiblings(t,r);for(;null==t?void 0:t.parent;){let e=t.parent,r=e.findOffset(t);if(-1===r)throw Error("invalid pos");n+=addSizeOfLeftSiblings(e,r),i++,t=t.parent}return n+i-1}indexToPath(e){let t=this.findTreePos(e);return this.treePosToPath(t)}};let DefaultComparator=(e,t)=>e===t?0:e<t?-1:1;let LLRBNode=class LLRBNode{constructor(e,t,r){__publicField(this,"key"),__publicField(this,"value"),__publicField(this,"parent"),__publicField(this,"left"),__publicField(this,"right"),__publicField(this,"isRed"),this.key=e,this.value=t,this.isRed=r}};let SortedMapIterator=class SortedMapIterator{constructor(e){__publicField(this,"stack"),this.stack=[],this.traverseInorder(e)}traverseInorder(e){e&&(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}};let LLRBTree=class LLRBTree{constructor(e){__publicField(this,"root"),__publicField(this,"comparator"),__publicField(this,"counter"),this.comparator=void 0!==e?e:DefaultComparator,this.counter=0}put(e,t){return this.root=this.putInternal(e,t,this.root),this.root.isRed=!1,t}get(e){let t=this.getInternal(e,this.root);return t?t.value:void 0}remove(e){this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new SortedMapIterator(this.root)}values(){let e=[];for(let t of this.getIterator().stack)e.push(t.value);return e}floorEntry(e){let t=this.root;for(;t;){let r=this.comparator(e,t.key);if(r>0){if(!t.right)return t;t.right.parent=t,t=t.right}else if(!(r<0))return t;else if(t.left)t.left.parent=t,t=t.left;else{let e=t.parent,r=t;for(;e&&r===e.left;)r=e,e=e.parent;return e}}}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return 0===this.counter}getInternal(e,t){for(;t;){let r=this.comparator(e,t.key);if(0===r)return t;r<0?t=t.left:r>0&&(t=t.right)}}putInternal(e,t,r){if(!r)return this.counter+=1,new LLRBNode(e,t,!0);let n=this.comparator(e,r.key);return n<0?r.left=this.putInternal(e,t,r.left):n>0?r.right=this.putInternal(e,t,r.right):r.value=t,this.isRed(r.right)&&!this.isRed(r.left)&&(r=this.rotateLeft(r)),this.isRed(r.left)&&this.isRed(r.left.left)&&(r=this.rotateRight(r)),this.isRed(r.left)&&this.isRed(r.right)&&this.flipColors(r),r}removeInternal(e,t){if(0>this.comparator(t,e.key))this.isRed(e.left)||this.isRed(e.left.left)||(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),0===this.comparator(t,e.key)&&!e.right){this.counter-=1;return}if(this.isRed(e.right)||this.isRed(e.right.left)||(e=this.moveRedRight(e)),0===this.comparator(t,e.key)){this.counter-=1;let t=this.min(e.right);e.value=t.value,e.key=t.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,t)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(e.left)return this.isRed(e.left)||this.isRed(e.left.left)||(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){let t=e.right;return e.right=t.left,t.left=e,t.isRed=t.left.isRed,t.left.isRed=!0,t}rotateRight(e){let t=e.left;return e.left=t.right,t.right=e,t.isRed=t.right.isRed,t.right.isRed=!0,t}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}};let CRDTTreePos=class CRDTTreePos{constructor(e,t){__publicField(this,"parentID"),__publicField(this,"leftSiblingID"),this.parentID=e,this.leftSiblingID=t}static of(e,t){return new CRDTTreePos(e,t)}static fromTreePos(e){let t;let{offset:r}=e,{node:n}=e;return n.isText?(t=n.parent.children[0]===n&&0===r?n.parent:n,n=n.parent):t=0===r?n:n.children[r-1],CRDTTreePos.of(n.id,CRDTTreeNodeID.of(t.getCreatedAt(),t.getOffset()+r))}getParentID(){return this.parentID}static fromStruct(e){return CRDTTreePos.of(CRDTTreeNodeID.of(TimeTicket.fromStruct(e.parentID.createdAt),e.parentID.offset),CRDTTreeNodeID.of(TimeTicket.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodePair(e){let t=this.getParentID(),r=this.getLeftSiblingID(),n=e.findFloorNode(t),i=e.findFloorNode(r);if(!n||!i)throw Error(`cannot find node of CRDTTreePos(${t.toTestString()}, ${r.toTestString()})`);return!r.equals(t)&&r.getOffset()>0&&r.getOffset()===i.id.getOffset()&&i.insPrevID&&(i=e.findFloorNode(i.insPrevID)),[n,i]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}};let CRDTTreeNodeID=class CRDTTreeNodeID{constructor(e,t){__publicField(this,"createdAt"),__publicField(this,"offset"),this.createdAt=e,this.offset=t}static of(e,t){return new CRDTTreeNodeID(e,t)}static fromStruct(e){return CRDTTreeNodeID.of(TimeTicket.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,t)=>{let r=e.getCreatedAt().compare(t.getCreatedAt());return 0!==r?r:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return 0===this.createdAt.compare(e.createdAt)&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}/${this.offset}`}};let CRDTTreeNode=class CRDTTreeNode extends IndexTreeNode{constructor(e,t,r,n,i){super(t),__publicField(this,"id"),__publicField(this,"removedAt"),__publicField(this,"attrs"),__publicField(this,"insPrevID"),__publicField(this,"insNextID"),__publicField(this,"_value",""),this.id=e,this.removedAt=i,n&&(this.attrs=n),"string"==typeof r?this.value=r:Array.isArray(r)&&(this._children=r)}toIDString(){return this.id.toIDString()}getRemovedAt(){return this.removedAt}static create(e,t,r,n){return new CRDTTreeNode(e,t,r,n)}deepcopy(){var e;let t=new CRDTTreeNode(this.id,this.type);return t.removedAt=this.removedAt,t._value=this._value,t.size=this.size,t.attrs=null==(e=this.attrs)?void 0:e.deepcopy(),t._children=this._children.map(e=>{let r=e.deepcopy();return r.parent=t,r}),t.insPrevID=this.insPrevID,t.insNextID=this.insNextID,t}get value(){if(!this.isText)throw Error(`cannot get value of element node: ${this.type}`);return this._value}set value(e){if(!this.isText)throw Error(`cannot set value of element node: ${this.type}`);this._value=e,this.size=e.length}get isRemoved(){return!!this.removedAt}remove(e){let t=!this.removedAt;(!this.removedAt||this.removedAt.compare(e)>0)&&(this.removedAt=e),t&&(this.parent.removedAt?this.parent.size-=this.paddedSize:this.updateAncestorsSize())}cloneText(e){return new CRDTTreeNode(CRDTTreeNodeID.of(this.id.getCreatedAt(),e),this.type,void 0,void 0,this.removedAt)}cloneElement(e){return new CRDTTreeNode(CRDTTreeNodeID.of(e(),0),this.type,void 0,void 0,this.removedAt)}split(e,t,r){let n=this.isText?this.splitText(t,this.id.getOffset()):this.splitElement(t,r);if(n){if(n.insPrevID=this.id,this.insNextID){let t=e.findFloorNode(this.insNextID);t.insPrevID=n.id,n.insNextID=this.insNextID}this.insNextID=n.id,e.registerNode(n)}return n}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}canStyle(e,t){return!this.isText&&!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}setAttrs(e,t){this.attrs||(this.attrs=new RHT);let r=[];for(let[n,i]of Object.entries(e))r.push(this.attrs.set(n,i,t));return r}purge(e){this.attrs&&this.attrs.purge(e)}getGCPairs(){let e=[];if(!this.attrs)return e;for(let t of this.attrs)t.getRemovedAt()&&e.push({parent:this,child:t});return e}};function toTreeNode(e){var t;if(e.isText)return{type:e.type,value:e.value};let r={type:e.type,children:e.children.map(toTreeNode)};return e.attrs&&(r.attributes=parseObjectValues(null==(t=e.attrs)?void 0:t.toObject())),r}function toXML(e){if(e.isText)return e.value;let t="";return e.attrs&&e.attrs.size()&&(t=" "+Array.from(e.attrs).filter(e=>!e.isRemoved()).sort((e,t)=>e.getKey().localeCompare(t.getKey())).map(e=>{let t=JSON.parse(e.getValue());return"string"==typeof t?`${e.getKey()}="${t}"`:`${e.getKey()}="${escapeString(e.getValue())}"`}).join(" ")),`<${e.type}${t}>${e.children.map(e=>toXML(e)).join("")}</${e.type}>`}let CRDTTree=class CRDTTree extends CRDTElement{constructor(e,t){super(t),__publicField(this,"indexTree"),__publicField(this,"nodeMapByID"),this.indexTree=new IndexTree(e),this.nodeMapByID=new LLRBTree(CRDTTreeNodeID.createComparator()),this.indexTree.traverseAll(e=>{this.nodeMapByID.put(e.id,e)})}static create(e,t){return new CRDTTree(e,t)}findFloorNode(e){let t=this.nodeMapByID.floorEntry(e);if(t&&t.key.getCreatedAt().equals(e.getCreatedAt()))return t.value}registerNode(e){this.nodeMapByID.put(e.id,e)}findNodesAndSplitText(e,t){let[r,n]=e.toTreeNodePair(this),i=n,o=r===i,s=i.parent&&!o?i.parent:r;if(i.isText&&i.split(this,e.getLeftSiblingID().getOffset()-i.id.getOffset()),t){let e=s.allChildren,r=o?0:e.indexOf(i)+1;for(let n=r;n<e.length;n++){let r=e[n];if(!r.id.getCreatedAt().after(t))break;i=r}}return[s,i]}style(e,t,r,n){let[i,o]=this.findNodesAndSplitText(e[0],r),[s,a]=this.findNodesAndSplitText(e[1],r),l=[],u=t?parseObjectValues(t):{},d=new Map,c=[];return this.traverseInPosRange(i,o,s,a,([e])=>{let i=e.getCreatedAt().getActorID(),o=n?n.has(i)?n.get(i):n0:n1;if(e.canStyle(r,o)&&t){let n=d.get(i),o=e.getCreatedAt();(!n||o.after(n))&&d.set(i,o);let s=e.setAttrs(t,r),a=s.reduce((e,[,t])=>(t&&(e[t.getKey()]=u[t.getKey()]),e),{}),h=e.parent,m=e.prevSibling||e.parent;for(let[t]of(Object.keys(a).length>0&&l.push({type:"style",from:this.toIndex(h,m),to:this.toIndex(e,e),fromPath:this.toPath(h,m),toPath:this.toPath(e,e),actor:r.getActorID(),value:a}),s))t&&c.push({parent:e,child:t})}}),[d,c,l]}removeStyle(e,t,r,n){let[i,o]=this.findNodesAndSplitText(e[0],r),[s,a]=this.findNodesAndSplitText(e[1],r),l=[],u=new Map,d=[];return this.traverseInPosRange(i,o,s,a,([e])=>{let i=e.getCreatedAt().getActorID(),o=n?n.has(i)?n.get(i):n0:n1;if(e.canStyle(r,o)&&t){let n=u.get(i),o=e.getCreatedAt();for(let s of((!n||o.after(n))&&u.set(i,o),e.attrs||(e.attrs=new RHT),t)){let t=e.attrs.remove(s,r);for(let r of t)d.push({parent:e,child:r})}let s=e.parent,a=e.prevSibling||e.parent;l.push({actor:r.getActorID(),type:"removeStyle",from:this.toIndex(s,a),to:this.toIndex(e,e),fromPath:this.toPath(s,a),toPath:this.toPath(e,e),value:t})}}),[u,d,l]}edit(e,t,r,n,i,o){let[s,a]=this.findNodesAndSplitText(e[0],n),[l,u]=this.findNodesAndSplitText(e[1],n),d=this.toIndex(s,a),c=this.toPath(s,a),h=[],m=[],p=[],f=new Map;this.traverseInPosRange(s,a,l,u,([e,t],r)=>{if(t===n8.Start&&!r)for(let t of e.children)p.push(t);let i=e.getCreatedAt().getActorID(),s=o?o.has(i)?o.get(i):n0:n1;if(e.canDelete(n,s)||h.includes(e.parent)){let r=f.get(i),n=e.getCreatedAt();(!r||n.after(r))&&f.set(i,n),(t===n8.Text||t===n8.Start)&&h.push(e),m.push([e,t])}});let g=this.makeDeletionChanges(m,n),T=[];for(let e of h)e.remove(n),e.isRemoved&&T.push({parent:this,child:e});for(let e of p)e.removedAt||s.append(e);if(r>0){let e=0,t=s,o=a;for(;e<r;)t.split(this,t.findOffset(o)+1,i),o=t,t=t.parent,e++;g.push({type:"content",from:d,to:d,fromPath:c,toPath:c,actor:n.getActorID()})}if(null==t?void 0:t.length){let e=[],r=a;for(let i of t)r===s?s.insertAt(i,0):s.insertAfter(i,r),r=i,traverseAll(i,e=>{s.isRemoved&&(e.remove(n),T.push({parent:this,child:e})),this.nodeMapByID.put(e.id,e)}),i.isRemoved||e.push(i);if(e.length){let t=e.map(e=>toTreeNode(e));g.length&&g[g.length-1].from===d?g[g.length-1].value=t:g.push({type:"content",from:d,to:d,fromPath:c,toPath:c,actor:n.getActorID(),value:t})}}return[g,T,f]}editT(e,t,r,n,i){let o=this.findPos(e[0]),s=this.findPos(e[1]);this.edit([o,s],t,r,n,i)}move(e,t,r){throw Error(`not implemented: ${e}, ${t}, ${r}`)}purge(e){var t;null==(t=e.parent)||t.removeChild(e),this.nodeMapByID.remove(e.id);let r=e.insPrevID,n=e.insNextID;if(r){let e=this.findFloorNode(r);e.insNextID=n}if(n){let e=this.findFloorNode(n);e.insPrevID=r}e.insPrevID=void 0,e.insNextID=void 0}getGCPairs(){let e=[];return this.indexTree.traverse(t=>{for(let r of(t.getRemovedAt()&&e.push({parent:this,child:t}),t.getGCPairs()))e.push(r)}),e}findPos(e,t=!0){let r=this.indexTree.findTreePos(e,t);return CRDTTreePos.fromTreePos(r)}pathToPosRange(e){let t=this.pathToIndex(e);return[this.findPos(t),this.findPos(t+1)]}pathToPos(e){let t=this.indexTree.pathToIndex(e);return this.findPos(t)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getNodeSize(){return this.nodeMapByID.size()}getIndexTree(){return this.indexTree}toXML(){return toXML(this.indexTree.getRoot())}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){let e=this.indexTree.getRoot(),toTreeNodeInfo=(e,t,r,n=0)=>{var i,o,s,a;let l,u,d;let c=e.isText?{node:e,offset:0}:t&&r?this.toTreePos(t,r):null;c&&(l=this.indexTree.indexOf(c),u=this.indexTree.treePosToPath(c),d=CRDTTreePos.fromTreePos(c).toStruct());let h={type:e.type,parent:null==t?void 0:t.id.toTestString(),size:e.size,id:e.id.toTestString(),removedAt:null==(i=e.removedAt)?void 0:i.toTestString(),insPrev:null==(o=e.insPrevID)?void 0:o.toTestString(),insNext:null==(s=e.insNextID)?void 0:s.toTestString(),value:e.isText?e.value:void 0,isRemoved:e.isRemoved,children:[],depth:n,attributes:e.attrs?parseObjectValues(null==(a=e.attrs)?void 0:a.toObject()):void 0,index:l,path:u,pos:d};for(let t=0;t<e.allChildren.length;t++){let r=0===t?e:e.allChildren[t-1];h.children.push(toTreeNodeInfo(e.allChildren[t],e,r,n+1))}return h};return toTreeNodeInfo(e)}getRootTreeNode(){return toTreeNode(this.indexTree.getRoot())}toTestTreeNode(){return function toTestTreeNode(e){return e.isText?{type:e.type,value:e.value,size:e.size,isRemoved:e.isRemoved}:{type:e.type,children:e.children.map(toTestTreeNode),size:e.size,isRemoved:e.isRemoved}}(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){let e=this.getRoot();return new CRDTTree(e.deepcopy(),this.getCreatedAt())}toPath(e,t){let r=this.toTreePos(e,t);return r?this.indexTree.treePosToPath(r):[]}toIndex(e,t){let r=this.toTreePos(e,t);return r?this.indexTree.indexOf(r):-1}indexToPath(e){return this.indexTree.indexToPath(e)}pathToIndex(e){return this.indexTree.pathToIndex(e)}indexRangeToPosRange(e){let t=this.findPos(e[0]);return e[0]===e[1]?[t,t]:[t,this.findPos(e[1])]}indexRangeToPosStructRange(e){let[t,r]=e,n=this.findPos(t);return t===r?[n.toStruct(),n.toStruct()]:[n.toStruct(),this.findPos(r).toStruct()]}posRangeToPathRange(e){let[t,r]=this.findNodesAndSplitText(e[0]),[n,i]=this.findNodesAndSplitText(e[1]);return[this.toPath(t,r),this.toPath(n,i)]}posRangeToIndexRange(e){let[t,r]=this.findNodesAndSplitText(e[0]),[n,i]=this.findNodesAndSplitText(e[1]);return[this.toIndex(t,r),this.toIndex(n,i)]}traverseInPosRange(e,t,r,n,i){let o=this.toIndex(e,t),s=this.toIndex(r,n);return this.indexTree.tokensBetween(o,s,i)}toTreePos(e,t){if(!e||!t)return;if(e.isRemoved){let t;for(;e.isRemoved;)e=(t=e).parent;let r=e.findOffset(t);return{node:e,offset:r}}if(e===t)return{node:e,offset:0};let r=e.findOffset(t);if(!t.isRemoved){if(t.isText)return{node:t,offset:t.paddedSize};r++}return{node:e,offset:r}}makeDeletionChanges(e,t){let r=[],n=[],i=null,o=null;for(let t=0;t<e.length;t++){let r=e[t],s=e[t+1];i||(i=r),o=r;let a=this.findRightToken(r);a&&s&&a[0]===s[0]&&a[1]===s[1]||(n.push([i,o]),i=null,o=null)}for(let e of n){let[n,i]=e,[o,s]=this.findLeftToken(n),[a,l]=i,u=s===n8.Start?o:o.parent,d=l===n8.Start?a:a.parent,c=this.toIndex(u,o),h=this.toIndex(d,a);c<h&&(r.length>0&&c===r[r.length-1].to?(r[r.length-1].to=h,r[r.length-1].toPath=this.toPath(d,a)):r.push({type:"content",from:c,to:h,fromPath:this.toPath(u,o),toPath:this.toPath(d,a),actor:t.getActorID()}))}return r.reverse()}findRightToken([e,t]){if(t===n8.Start){let t=e.allChildren;return t.length>0?[t[0],t[0].isText?n8.Text:n8.Start]:[e,n8.End]}let r=e.parent,n=r.allChildren,i=n.indexOf(e);if(r&&i===n.length-1)return[r,n8.End];let o=n[i+1];return[o,o.isText?n8.Text:n8.Start]}findLeftToken([e,t]){if(t===n8.End){let t=e.allChildren;if(t.length>0){let e=t[t.length-1];return[e,e.isText?n8.Text:n8.End]}return[e,n8.Start]}let r=e.parent,n=r.allChildren,i=n.indexOf(e);if(r&&0===i)return[r,n8.Start];let o=n[i-1];return[o,o.isText?n8.Text:n8.End]}};let TreeEditOperation=class TreeEditOperation extends Operation{constructor(e,t,r,n,i,o,s){super(e,s),__publicField(this,"fromPos"),__publicField(this,"toPos"),__publicField(this,"contents"),__publicField(this,"splitLevel"),__publicField(this,"maxCreatedAtMapByActor"),this.fromPos=t,this.toPos=r,this.contents=n,this.splitLevel=i,this.maxCreatedAtMapByActor=o}static create(e,t,r,n,i,o,s){return new TreeEditOperation(e,t,r,n,i,o,s)}execute(e){var t;let r=e.findByCreatedAt(this.getParentCreatedAt());r||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),r instanceof CRDTTree||n6.fatal("fail to execute, only Tree can execute edit");let n=this.getExecutedAt(),[i,o]=r.edit([this.fromPos,this.toPos],null==(t=this.contents)?void 0:t.map(e=>e.deepcopy()),this.splitLevel,n,(()=>{let e=n.getDelimiter();return void 0!==this.contents&&(e+=this.contents.length),()=>TimeTicket.of(n.getLamport(),++e,n.getActorID())})(),this.maxCreatedAtMapByActor);for(let t of o)e.registerGCPair(t);return{opInfos:i.map(({from:t,to:r,value:n,splitLevel:i,fromPath:o,toPath:s})=>({type:"tree-edit",path:e.createPath(this.getParentCreatedAt()),from:t,to:r,value:n,splitLevel:i,fromPath:o,toPath:s}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.toPos.getLeftSiblingID().getOffset()}`,n=this.contents||[];return`${e}.EDIT(${t},${r},${n.map(e=>toXML(e)).join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}};let ChangeID=class ChangeID{constructor(e,t,r,n){__publicField(this,"clientSeq"),__publicField(this,"serverSeq"),__publicField(this,"lamport"),__publicField(this,"actor"),this.clientSeq=e,this.serverSeq=n,this.lamport=t,this.actor=r}static of(e,t,r,n){return new ChangeID(e,t,r,n)}next(){return new ChangeID(this.clientSeq+1,this.lamport.add(1),this.actor)}syncLamport(e){return e.greaterThan(this.lamport)?new ChangeID(this.clientSeq,e,this.actor):new ChangeID(this.clientSeq,this.lamport.add(1),this.actor)}createTimeTicket(e){return TimeTicket.of(this.lamport,e,this.actor)}setActor(e){return new ChangeID(this.clientSeq,this.lamport,e,this.serverSeq)}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq?this.serverSeq.toString():""}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}toTestString(){return`${this.lamport.toString()}:${this.actor.slice(-2)}:${this.clientSeq}`}};let n7=new ChangeID(0,Long.fromInt(0,!0),nZ);let Change=class Change{constructor({id:e,operations:t,presenceChange:r,message:n}){__publicField(this,"id"),__publicField(this,"operations"),__publicField(this,"presenceChange"),__publicField(this,"message"),this.id=e,this.operations=t||[],this.presenceChange=r,this.message=n}static create({id:e,operations:t,presenceChange:r,message:n}){return new Change({id:e,operations:t,presenceChange:r,message:n})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(let t of this.operations)t.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return void 0!==this.presenceChange}getPresenceChange(){return this.presenceChange}execute(e,t,r){let n=[],i=[];for(let t of this.operations){let o=t.execute(e,r);if(!o)continue;let{opInfos:s,reverseOp:a}=o;n.push(...s),a&&i.unshift(a)}return this.presenceChange&&(this.presenceChange.type===nX.Put?t.set(this.id.getActorID(),deepcopy(this.presenceChange.presence)):t.delete(this.id.getActorID())),{opInfos:n,reverseOps:i}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}toStruct(){return{changeID:ii.bytesToHex(ii.toChangeID(this.getID()).toBinary()),message:this.getMessage(),operations:this.getOperations().map(e=>ii.bytesToHex(ii.toOperation(e).toBinary())),presenceChange:this.getPresenceChange()}}static fromStruct(e){let{changeID:t,operations:r,presenceChange:n,message:i}=e;return Change.create({id:ii.bytesToChangeID(ii.hexToBytes(t)),operations:null==r?void 0:r.map(e=>ii.bytesToOperation(ii.hexToBytes(e))),presenceChange:n,message:i})}};let ChangePack=class ChangePack{constructor(e,t,r,n,i,o){__publicField(this,"documentKey"),__publicField(this,"checkpoint"),__publicField(this,"isRemoved"),__publicField(this,"changes"),__publicField(this,"snapshot"),__publicField(this,"minSyncedTicket"),this.documentKey=e,this.checkpoint=t,this.isRemoved=r,this.changes=n,this.snapshot=i,this.minSyncedTicket=o}static create(e,t,r,n,i,o){return new ChangePack(e,t,r,n,i,o)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getMinSyncedTicket(){return this.minSyncedTicket}};let Checkpoint=class Checkpoint{constructor(e,t){__publicField(this,"serverSeq"),__publicField(this,"clientSeq"),this.serverSeq=e,this.clientSeq=t}static of(e,t){return new Checkpoint(e,t)}increaseClientSeq(e){return 0===e?this:new Checkpoint(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;let t=this.serverSeq.greaterThan(e.serverSeq)?this.serverSeq:e.serverSeq,r=Math.max(this.clientSeq,e.clientSeq);return Checkpoint.of(t,r)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq.equals(e.serverSeq)}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}};let ie=new Checkpoint(Long.fromInt(0,!0),0);let RGATreeSplitNodeID=class RGATreeSplitNodeID{constructor(e,t){__publicField(this,"createdAt"),__publicField(this,"offset"),this.createdAt=e,this.offset=t}static of(e,t){return new RGATreeSplitNodeID(e,t)}static fromStruct(e){return RGATreeSplitNodeID.of(TimeTicket.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return 0===this.createdAt.compare(e.createdAt)&&this.offset===e.offset}hasSameCreatedAt(e){return 0===this.createdAt.compare(e.createdAt)}split(e){return new RGATreeSplitNodeID(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}};let it=RGATreeSplitNodeID.of(n0,0);let RGATreeSplitPos=class RGATreeSplitPos{constructor(e,t){__publicField(this,"id"),__publicField(this,"relativeOffset"),this.id=e,this.relativeOffset=t}static of(e,t){return new RGATreeSplitPos(e,t)}static fromStruct(e){let t=RGATreeSplitNodeID.fromStruct(e.id);return RGATreeSplitPos.of(t,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return RGATreeSplitNodeID.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return!!this.id.equals(e.id)&&this.relativeOffset===e.relativeOffset}};let RGATreeSplitNode=class RGATreeSplitNode extends SplayNode{constructor(e,t,r){super(t),__publicField(this,"id"),__publicField(this,"removedAt"),__publicField(this,"prev"),__publicField(this,"next"),__publicField(this,"insPrev"),__publicField(this,"insNext"),this.id=e,this.removedAt=r}static create(e,t){return new RGATreeSplitNode(e,t)}static createComparator(){return(e,t)=>{let r=e.getCreatedAt().compare(t.getCreatedAt());return 0!==r?r:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(e){this.prev=e,e&&(e.next=this)}setNext(e){this.next=e,e&&(e.prev=this)}setInsPrev(e){this.insPrev=e,e&&(e.insNext=this)}setInsNext(e){this.insNext=e,e&&(e.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(e){return new RGATreeSplitNode(this.id.split(e),this.splitValue(e),this.removedAt)}canDelete(e,t){let r=!this.removedAt;return!!(!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt)))&&r}canStyle(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}remove(e){this.removedAt=e}createPosRange(){return[RGATreeSplitPos.of(this.id,0),RGATreeSplitPos.of(this.id,this.getLength())]}deepcopy(){return new RGATreeSplitNode(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(e){let t=this.value;return this.value=t.substring(0,e),t.substring(e,t.length)}toIDString(){return this.id.toIDString()}};let RGATreeSplit=class RGATreeSplit{constructor(){__publicField(this,"head"),__publicField(this,"treeByIndex"),__publicField(this,"treeByID"),this.head=RGATreeSplitNode.create(it),this.treeByIndex=new SplayTree,this.treeByID=new LLRBTree(RGATreeSplitNode.createComparator()),this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new RGATreeSplit}edit(e,t,r,n){let[i,o]=this.findNodeWithSplit(e[1],t),[s,a]=this.findNodeWithSplit(e[0],t),l=this.findBetween(a,o),[u,d,c]=this.deleteNodes(l,t,n),h=o?o.getID():i.getID(),m=RGATreeSplitPos.of(h,0);if(r){let e=this.posToIndex(s.createPosRange()[1],!0),n=this.insertAfter(s,RGATreeSplitNode.create(RGATreeSplitNodeID.of(t,0),r));u.length&&u[u.length-1].from===e?u[u.length-1].value=r:u.push({actor:t.getActorID(),from:e,to:e,value:r}),m=RGATreeSplitPos.of(n.getID(),n.getContentLength())}let p=[];for(let[,e]of c)p.push({parent:this,child:e});return[m,d,p,u]}indexToPos(e){let[t,r]=this.treeByIndex.find(e);return RGATreeSplitPos.of(t.getID(),r)}findIndexesFromRange(e){let[t,r]=e;return[this.posToIndex(t,!1),this.posToIndex(r,!0)]}posToIndex(e,t){let r=e.getAbsoluteID(),n=t?this.findFloorNodePreferToLeft(r):this.findFloorNode(r);n||n6.fatal(`the node of the given id should be found: ${r.toTestString()}`);let i=this.treeByIndex.indexOf(n),o=n.isRemoved()?0:r.getOffset()-n.getID().getOffset();return i+o}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}checkWeight(){return this.treeByIndex.checkWeight()}toString(){let e=[];for(let t of this)t.isRemoved()||e.push(t.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){let e;let t=new RGATreeSplit,r=this.head.getNext(),n=t.head;for(;r;){if(e=t.insertAfter(n,r.deepcopy()),r.hasInsPrev()){let n=t.findNode(r.getInsPrevID());e.setInsPrev(n)}n=e,r=r.getNext()}return t}toTestString(){let e=[],t=this.head;for(;t;)t.isRemoved()?e.push(`{${t.toTestString()}}`):e.push(`[${t.toTestString()}]`),t=t.getNext();return e.join("")}insertAfter(e,t){let r=e.getNext();return t.setPrev(e),r&&r.setPrev(t),this.treeByID.put(t.getID(),t),this.treeByIndex.insertAfter(e,t),t}findNodeWithSplit(e,t){let r=e.getAbsoluteID(),n=this.findFloorNodePreferToLeft(r),i=r.getOffset()-n.getID().getOffset();for(this.splitNode(n,i);n.hasNext()&&n.getNext().getCreatedAt().after(t);)n=n.getNext();return[n,n.getNext()]}findFloorNodePreferToLeft(e){let t=this.findFloorNode(e);if(t||n6.fatal(`the node of the given id should be found: ${e.toTestString()}`),e.getOffset()>0&&t.getID().getOffset()==e.getOffset()){if(!t.hasInsPrev())return t;t=t.getInsPrev()}return t}findFloorNode(e){let t=this.treeByID.floorEntry(e);if(t&&(t.key.equals(e)||t.key.hasSameCreatedAt(e)))return t.value}findBetween(e,t){let r=[],n=e;for(;n&&n!==t;)r.push(n),n=n.getNext();return r}splitNode(e,t){if(t>e.getContentLength()&&n6.fatal("offset should be less than or equal to length"),0===t)return e;if(t===e.getContentLength())return e.getNext();let r=e.split(t);this.treeByIndex.updateWeight(r),this.insertAfter(e,r);let n=e.getInsNext();return n&&n.setInsPrev(r),r.setInsPrev(e),r}deleteNodes(e,t,r){if(!e.length)return[[],new Map,new Map];let[n,i]=this.filterNodes(e,t,r),o=new Map,s=new Map,a=this.makeChanges(i,t);for(let e of n){let r=e.getCreatedAt().getActorID();(!o.has(r)||e.getID().getCreatedAt().after(o.get(r)))&&o.set(r,e.getID().getCreatedAt()),s.set(e.getID().toIDString(),e),e.remove(t)}return this.deleteIndexNodes(i),[a,o,s]}filterNodes(e,t,r){let n=!!r,i=[],o=[],[s,a]=this.findEdgesOfCandidates(e);for(let a of(o.push(s),e)){let e=a.getCreatedAt().getActorID(),s=n?r.has(e)?r.get(e):n0:n1;a.canDelete(t,s)?i.push(a):o.push(a)}return o.push(a),[i,o]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,t){let r,n;let i=[];for(let o=0;o<e.length-1;o++){let s=e[o],a=e[o+1];s.getNext()!=a&&([r]=this.findIndexesFromRange(s.getNext().createPosRange()),a?[,n]=this.findIndexesFromRange(a.getPrev().createPosRange()):n=this.treeByIndex.length,r<n&&i.push({actor:t.getActorID(),from:r,to:n}))}return i.reverse()}deleteIndexNodes(e){for(let t=0;t<e.length-1;t++){let r=e[t],n=e[t+1];r.getNext()!=n&&this.treeByIndex.deleteRange(r,n)}}purge(e){let t=e.getPrev(),r=e.getNext(),n=e.getInsPrev(),i=e.getInsNext();t&&t.setNext(r),r&&r.setPrev(t),e.setPrev(void 0),e.setNext(void 0),n&&n.setInsNext(i),i&&i.setInsPrev(n),e.setInsPrev(void 0),e.setInsNext(void 0)}};let removeDecimal=e=>e<0?Math.ceil(e):Math.floor(e);var ir=((M=ir||{})[M.IntegerCnt=0]="IntegerCnt",M[M.LongCnt=1]="LongCnt",M);let CRDTCounter=class CRDTCounter extends CRDTElement{constructor(e,t,r){switch(super(r),__publicField(this,"valueType"),__publicField(this,"value"),this.valueType=e,e){case 0:"number"==typeof t?t>2147483647||t<-2147483648?this.value=Long.fromNumber(t).toInt():this.value=removeDecimal(t):this.value=t.toInt();break;case 1:"number"==typeof t?this.value=Long.fromNumber(t):this.value=t;break;default:throw new YorkieError(nH.Unimplemented,`unimplemented type: ${e}`)}}static create(e,t,r){return new CRDTCounter(e,t,r)}static valueFromBytes(e,t){switch(e){case 0:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case 1:return Long.fromBytesLE(Array.from(t));default:throw new YorkieError(nH.Unimplemented,`unimplemented type: ${e}`)}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){let e=CRDTCounter.create(this.valueType,this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e}getType(){return this.valueType}static getCounterType(e){switch(typeof e){case"object":if(e instanceof Long)return 1;return;case"number":if(e>2147483647||e<-2147483648)return 1;return 0;default:return}}static isSupport(e){return!!CRDTCounter.getCounterType(e)}static isInteger(e){return e%1==0}isNumericType(){let e=this.valueType;return 0===e||1===e}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:{let e=this.value;return new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24&255])}case 1:{let e=this.value,t=e.toBytesLE();return Uint8Array.from(t)}default:throw new YorkieError(nH.Unimplemented,`unimplemented type: ${this.valueType}`)}}increase(e){function checkNumericType(e){if(!e.isNumericType())throw TypeError(`Unsupported type of value: ${typeof e.getValue()}`)}return checkNumericType(this),checkNumericType(e),1===this.valueType?this.value=this.value.add(e.getValue()):e.getType()===n9.Long?this.value=this.value+e.getValue().toInt():this.value=Long.fromNumber(this.value+removeDecimal(e.getValue())).toInt(),this}};let IncreaseOperation=class IncreaseOperation extends Operation{constructor(e,t,r){super(e,r),__publicField(this,"value"),this.value=t}static create(e,t,r){return new IncreaseOperation(e,t,r)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());t||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof CRDTCounter||n6.fatal("fail to execute, only Counter can execute increase");let r=this.value.deepcopy();return t.increase(r),{opInfos:[{type:"increase",path:e.createPath(this.getParentCreatedAt()),value:r.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){let e=this.value.deepcopy(),t=e.getType(),r=t===n9.Long?e.getValue().multiply(-1):-1*e.getValue(),n=IncreaseOperation.create(this.getParentCreatedAt(),Primitive.of(r,e.getCreatedAt()));return n}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}};let TreeStyleOperation=class TreeStyleOperation extends Operation{constructor(e,t,r,n,i,o,s){super(e,s),__publicField(this,"fromPos"),__publicField(this,"toPos"),__publicField(this,"maxCreatedAtMapByActor"),__publicField(this,"attributes"),__publicField(this,"attributesToRemove"),this.fromPos=t,this.toPos=r,this.maxCreatedAtMapByActor=n,this.attributes=i,this.attributesToRemove=o}static create(e,t,r,n,i,o){return new TreeStyleOperation(e,t,r,n,i,[],o)}static createTreeRemoveStyleOperation(e,t,r,n,i,o){return new TreeStyleOperation(e,t,r,n,new Map,i,o)}execute(e){let t,r;let n=e.findByCreatedAt(this.getParentCreatedAt());if(n||n6.fatal(`fail to find ${this.getParentCreatedAt()}`),n instanceof CRDTTree||n6.fatal("fail to execute, only Tree can execute edit"),this.attributes.size){let e={};[...this.attributes].forEach(([t,r])=>e[t]=r),[,r,t]=n.style([this.fromPos,this.toPos],e,this.getExecutedAt(),this.maxCreatedAtMapByActor)}else{let e=this.attributesToRemove;[,r,t]=n.removeStyle([this.fromPos,this.toPos],e,this.getExecutedAt(),this.maxCreatedAtMapByActor)}for(let t of r)e.registerGCPair(t);return{opInfos:t.map(({from:t,to:r,value:n,fromPath:i,toPath:o})=>({type:"tree-style",from:t,to:r,value:this.attributes.size?{attributes:n}:{attributesToRemove:n},fromPath:i,toPath:o,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${e}.STYLE(${t},${r},${Object.entries(this.attributes||{}).map(([e,t])=>`${e}:"${t}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}};function toChangeID(e){var t;return new t2({clientSeq:e.getClientSeq(),lamport:e.getLamportAsString(),actorId:hexToBytes(e.getActorID())})}function toTimeTicket(e){if(e){var t;return new rw({lamport:e.getLamportAsString(),delimiter:e.getDelimiter(),actorId:hexToBytes(e.getActorID())})}}function toValueType(e){switch(e){case n9.Null:return tX.NULL;case n9.Boolean:return tX.BOOLEAN;case n9.Integer:return tX.INTEGER;case n9.Long:return tX.LONG;case n9.Double:return tX.DOUBLE;case n9.String:return tX.STRING;case n9.Bytes:return tX.BYTES;case n9.Date:return tX.DATE;default:throw new YorkieError(nH.Unsupported,`unsupported type: ${e}`)}}function toCounterType(e){switch(e){case ir.IntegerCnt:return tX.INTEGER_CNT;case ir.LongCnt:return tX.LONG_CNT;default:throw new YorkieError(nH.Unsupported,`unsupported type: ${e}`)}}function toElementSimple(e){if(e instanceof CRDTObject)return new ri({type:tX.JSON_OBJECT,createdAt:toTimeTicket(e.getCreatedAt()),value:objectToBytes(e)});if(e instanceof CRDTArray)return new ri({type:tX.JSON_ARRAY,createdAt:toTimeTicket(e.getCreatedAt()),value:toArray(e).toBinary()});if(e instanceof CRDTText)return new ri({type:tX.TEXT,createdAt:toTimeTicket(e.getCreatedAt())});if(e instanceof Primitive)return new ri({type:toValueType(e.getType()),createdAt:toTimeTicket(e.getCreatedAt()),value:e.toBytes()});if(e instanceof CRDTCounter)return new ri({type:toCounterType(e.getType()),createdAt:toTimeTicket(e.getCreatedAt()),value:e.toBytes()});if(e instanceof CRDTTree)return new ri({type:tX.TREE,createdAt:toTimeTicket(e.getCreatedAt()),value:toTree(e).toBinary()});throw new YorkieError(nH.Unimplemented,"unimplemented element")}function toTextNodePos(e){return new rP({createdAt:toTimeTicket(e.getID().getCreatedAt()),offset:e.getID().getOffset(),relativeOffset:e.getRelativeOffset()})}function toTreePos(e){return new rS({parentId:toTreeNodeID(e.getParentID()),leftSiblingId:toTreeNodeID(e.getLeftSiblingID())})}function toTreeNodeID(e){return new rv({createdAt:toTimeTicket(e.getCreatedAt()),offset:e.getOffset()})}function toOperation(e){let t=new t3;if(e instanceof SetOperation){let r=new t6;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.key=e.getKey(),r.value=toElementSimple(e.getValue()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="set",t.body.value=r}else if(e instanceof AddOperation){let r=new t4;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.prevCreatedAt=toTimeTicket(e.getPrevCreatedAt()),r.value=toElementSimple(e.getValue()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="add",t.body.value=r}else if(e instanceof MoveOperation){let r=new t9;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.prevCreatedAt=toTimeTicket(e.getPrevCreatedAt()),r.createdAt=toTimeTicket(e.getCreatedAt()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="move",t.body.value=r}else if(e instanceof RemoveOperation){let r=new t5;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.createdAt=toTimeTicket(e.getCreatedAt()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="remove",t.body.value=r}else if(e instanceof EditOperation){let r=new t8;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.from=toTextNodePos(e.getFromPos()),r.to=toTextNodePos(e.getToPos());let n=r.createdAtMapByActor;for(let[t,r]of e.getMaxCreatedAtMapByActor())n[t]=toTimeTicket(r);r.content=e.getContent();let i=r.attributes;for(let[t,r]of e.getAttributes())i[t]=r;r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="edit",t.body.value=r}else if(e instanceof StyleOperation){let r=new re;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.from=toTextNodePos(e.getFromPos()),r.to=toTextNodePos(e.getToPos());let n=r.createdAtMapByActor;for(let[t,r]of e.getMaxCreatedAtMapByActor())n[t]=toTimeTicket(r);let i=r.attributes;for(let[t,r]of e.getAttributes())i[t]=r;r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="style",t.body.value=r}else if(e instanceof IncreaseOperation){let r=new rt;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.value=toElementSimple(e.getValue()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="increase",t.body.value=r}else if(e instanceof TreeEditOperation){let r=new rr,n=r.createdAtMapByActor;for(let[t,r]of e.getMaxCreatedAtMapByActor())n[t]=toTimeTicket(r);r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.from=toTreePos(e.getFromPos()),r.to=toTreePos(e.getToPos()),r.contents=function(e){let t=[];if(!e||!e.length)return t;for(let r of e)t.push(new ry({content:toTreeNodes(r)}));return t}(e.getContents()),r.splitLevel=e.getSplitLevel(),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="treeEdit",t.body.value=r}else if(e instanceof TreeStyleOperation){let r=new rn;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.from=toTreePos(e.getFromPos()),r.to=toTreePos(e.getToPos());let n=r.createdAtMapByActor;for(let[t,r]of e.getMaxCreatedAtMapByActor())n[t]=toTimeTicket(r);let i=e.getAttributesToRemove();if(i.length>0)r.attributesToRemove=i;else{let t=r.attributes;for(let[r,n]of e.getAttributes())t[r]=n}r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="treeStyle",t.body.value=r}else throw new YorkieError(nH.Unimplemented,"unimplemented operation");return t}function toTreeNodes(e){if(!e)return[];let t=[];return traverseAll(e,(e,r)=>{let n=new rT({id:toTreeNodeID(e.id),type:e.type,removedAt:toTimeTicket(e.removedAt),depth:r});if(e.isText&&(n.value=e.value),e.insPrevID&&(n.insPrevId=toTreeNodeID(e.insPrevID)),e.insNextID&&(n.insNextId=toTreeNodeID(e.insNextID)),e.attrs)for(let t of e.attrs)n.attributes[t.getKey()]=new rp({value:t.getValue(),updatedAt:toTimeTicket(t.getUpdatedAt())});t.push(n)}),t}function toArray(e){let t=new ro;return t.body.case="jsonArray",t.body.value=new ra({nodes:function(e){let t=[];for(let r of e)t.push(new rm({element:toElement(r.getValue())}));return t}(e.getElements()),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}function toTree(e){let t=new ro;return t.body.case="tree",t.body.value=new rc({nodes:toTreeNodes(e.getRoot()),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}function toElement(e){if(e instanceof CRDTObject)return function(e){let t=new ro;return t.body.case="jsonObject",t.body.value=new rs({nodes:function(e){let t=[];for(let r of e)t.push(new rh({key:r.getStrKey(),element:toElement(r.getValue())}));return t}(e.getRHT()),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}(e);if(e instanceof CRDTArray)return toArray(e);if(e instanceof Primitive)return function(e){let t=new ro;return t.body.case="primitive",t.body.value=new rl({type:toValueType(e.getType()),value:e.toBytes(),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}(e);if(e instanceof CRDTText)return function(e){let t=new ro;return t.body.case="text",t.body.value=new ru({nodes:function(e){let t=[];for(let n of e){var r;let e=new rf;e.id=(r=n.getID(),new rg({createdAt:toTimeTicket(r.getCreatedAt()),offset:r.getOffset()})),e.value=n.getValue().getContent(),e.removedAt=toTimeTicket(n.getRemovedAt());let i=e.attributes,o=n.getValue().getAttrs();for(let e of o){let t=new rp;t.value=e.getValue(),t.updatedAt=toTimeTicket(e.getUpdatedAt()),i[e.getKey()]=t}t.push(e)}return t}(e.getRGATreeSplit()),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}(e);if(e instanceof CRDTCounter)return function(e){let t=new ro;return t.body.case="counter",t.body.value=new rd({type:toCounterType(e.getType()),value:e.toBytes(),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}(e);if(e instanceof CRDTTree)return toTree(e);throw new YorkieError(nH.Unimplemented,"unimplemented element")}function fromChangeID(e){var t;let r;return e.serverSeq&&(r=Long.fromString(e.serverSeq,!0)),ChangeID.of(e.clientSeq,Long.fromString(e.lamport,!0),bytesToHex(e.actorId),r)}function fromTimeTicket(e){if(e){var t;return TimeTicket.of(Long.fromString(e.lamport,!0),e.delimiter,bytesToHex(e.actorId))}}function fromPresence(e){let t={};return Object.entries(e.data).forEach(([e,r])=>{t[e]=JSON.parse(r)}),t}function fromValueType(e){switch(e){case tX.NULL:return n9.Null;case tX.BOOLEAN:return n9.Boolean;case tX.INTEGER:return n9.Integer;case tX.LONG:return n9.Long;case tX.DOUBLE:return n9.Double;case tX.STRING:return n9.String;case tX.BYTES:return n9.Bytes;case tX.DATE:return n9.Date}throw new YorkieError(nH.Unimplemented,`unimplemented value type: ${e}`)}function fromCounterType(e){switch(e){case tX.INTEGER_CNT:return ir.IntegerCnt;case tX.LONG_CNT:return ir.LongCnt}throw new YorkieError(nH.Unimplemented,`unimplemented value type: ${e}`)}function fromElementSimple(e){switch(e.type){case tX.JSON_OBJECT:if(!e.value)return CRDTObject.create(fromTimeTicket(e.createdAt));return bytesToObject(e.value);case tX.JSON_ARRAY:if(!e.value)return CRDTArray.create(fromTimeTicket(e.createdAt));return function(e){if(!e)throw Error("bytes is empty");let t=ro.fromBinary(e);return fromArray(t.body.value)}(e.value);case tX.TEXT:return CRDTText.create(RGATreeSplit.create(),fromTimeTicket(e.createdAt));case tX.TREE:return function(e){if(!e)throw Error("bytes is empty");let t=ro.fromBinary(e);return fromTree(t.body.value)}(e.value);case tX.NULL:case tX.BOOLEAN:case tX.INTEGER:case tX.LONG:case tX.DOUBLE:case tX.STRING:case tX.BYTES:case tX.DATE:return Primitive.of(Primitive.valueFromBytes(fromValueType(e.type),e.value),fromTimeTicket(e.createdAt));case tX.INTEGER_CNT:case tX.LONG_CNT:return CRDTCounter.create(fromCounterType(e.type),CRDTCounter.valueFromBytes(fromCounterType(e.type),e.value),fromTimeTicket(e.createdAt))}}function fromTextNodePos(e){return RGATreeSplitPos.of(RGATreeSplitNodeID.of(fromTimeTicket(e.createdAt),e.offset),e.relativeOffset)}function fromTextNodeID(e){return RGATreeSplitNodeID.of(fromTimeTicket(e.createdAt),e.offset)}function fromTreePos(e){return CRDTTreePos.of(fromTreeNodeID(e.parentId),fromTreeNodeID(e.leftSiblingId))}function fromTreeNodeID(e){return CRDTTreeNodeID.of(fromTimeTicket(e.createdAt),e.offset)}function fromTreeNodes(e){if(0===e.length)return;let t=[];for(let r of e)t.push(function(e){let t=fromTreeNodeID(e.id),r=CRDTTreeNode.create(t,e.type),n=Object.entries(e.attributes);if(r.isText)r.value=e.value;else if(n.length){let e=RHT.create();for(let[t,r]of n)e.set(t,r.value,fromTimeTicket(r.updatedAt));r.attrs=e}return e.insPrevId&&(r.insPrevID=fromTreeNodeID(e.insPrevId)),e.insNextId&&(r.insNextID=fromTreeNodeID(e.insNextId)),r.removedAt=fromTimeTicket(e.removedAt),r}(r));let r=t[t.length-1];for(let r=t.length-2;r>=0;r--){let n;for(let i=r+1;i<t.length;i++)if(e[r].depth-1===e[i].depth){n=t[i];break}n.prepend(t[r])}return r.updateDescendantsSize(),CRDTTree.create(r,n0).getRoot()}function fromOperation(e){if("set"===e.body.case){let t=e.body.value;return SetOperation.create(t.key,fromElementSimple(t.value),fromTimeTicket(t.parentCreatedAt),fromTimeTicket(t.executedAt))}if("add"===e.body.case){let t=e.body.value;return AddOperation.create(fromTimeTicket(t.parentCreatedAt),fromTimeTicket(t.prevCreatedAt),fromElementSimple(t.value),fromTimeTicket(t.executedAt))}if("move"===e.body.case){let t=e.body.value;return MoveOperation.create(fromTimeTicket(t.parentCreatedAt),fromTimeTicket(t.prevCreatedAt),fromTimeTicket(t.createdAt),fromTimeTicket(t.executedAt))}if("remove"===e.body.case){let t=e.body.value;return RemoveOperation.create(fromTimeTicket(t.parentCreatedAt),fromTimeTicket(t.createdAt),fromTimeTicket(t.executedAt))}if("edit"===e.body.case){let t=e.body.value,r=new Map;Object.entries(t.createdAtMapByActor).forEach(([e,t])=>{r.set(e,fromTimeTicket(t))});let n=new Map;return Object.entries(t.attributes).forEach(([e,t])=>{n.set(e,t)}),EditOperation.create(fromTimeTicket(t.parentCreatedAt),fromTextNodePos(t.from),fromTextNodePos(t.to),r,t.content,n,fromTimeTicket(t.executedAt))}if("style"===e.body.case){let t=e.body.value,r=new Map;Object.entries(t.createdAtMapByActor).forEach(([e,t])=>{r.set(e,fromTimeTicket(t))});let n=new Map;return Object.entries(t.attributes).forEach(([e,t])=>{n.set(e,t)}),StyleOperation.create(fromTimeTicket(t.parentCreatedAt),fromTextNodePos(t.from),fromTextNodePos(t.to),r,n,fromTimeTicket(t.executedAt))}if("select"===e.body.case)return;else if("increase"===e.body.case){let t=e.body.value;return IncreaseOperation.create(fromTimeTicket(t.parentCreatedAt),fromElementSimple(t.value),fromTimeTicket(t.executedAt))}else if("treeEdit"===e.body.case){let t=e.body.value,r=new Map;return Object.entries(t.createdAtMapByActor).forEach(([e,t])=>{r.set(e,fromTimeTicket(t))}),TreeEditOperation.create(fromTimeTicket(t.parentCreatedAt),fromTreePos(t.from),fromTreePos(t.to),function(e){if(!e.length)return;let t=[];return e.forEach(e=>{let r=fromTreeNodes(e.content);t.push(r)}),t}(t.contents),t.splitLevel,r,fromTimeTicket(t.executedAt))}else if("treeStyle"===e.body.case){let t=e.body.value,r=new Map,n=t.attributesToRemove,i=new Map;return((null==t?void 0:t.createdAtMapByActor)&&Object.entries(t.createdAtMapByActor).forEach(([e,t])=>{i.set(e,fromTimeTicket(t))}),(null==n?void 0:n.length)>0)?TreeStyleOperation.createTreeRemoveStyleOperation(fromTimeTicket(t.parentCreatedAt),fromTreePos(t.from),fromTreePos(t.to),i,n,fromTimeTicket(t.executedAt)):(Object.entries(t.attributes).forEach(([e,t])=>{r.set(e,t)}),TreeStyleOperation.create(fromTimeTicket(t.parentCreatedAt),fromTreePos(t.from),fromTreePos(t.to),i,r,fromTimeTicket(t.executedAt)))}else throw new YorkieError(nH.Unimplemented,"unimplemented operation")}function fromChanges(e){let t=[];for(let r of e)t.push(Change.create({id:fromChangeID(r.id),operations:function(e){let t=[];for(let r of e){let e=fromOperation(r);e&&t.push(e)}return t}(r.operations),presenceChange:r.presenceChange?function(e){let t=e.type;if(t===rk.PUT){let t=fromPresence(e.presence);return{type:nX.Put,presence:t}}if(t===rk.CLEAR)return{type:nX.Clear};throw new YorkieError(nH.Unsupported,`unsupported type: ${t}`)}(r.presenceChange):void 0,message:r.message}));return t}function fromObject(e){let t=new ElementRHT;for(let r of e.nodes){let e=fromElement(r.element);t.set(r.key,e,e.getPositionedAt())}let r=new CRDTObject(fromTimeTicket(e.createdAt),t);return r.setMovedAt(fromTimeTicket(e.movedAt)),r.setRemovedAt(fromTimeTicket(e.removedAt)),r}function fromArray(e){let t=new RGATreeList;for(let r of e.nodes)t.insert(fromElement(r.element));let r=new CRDTArray(fromTimeTicket(e.createdAt),t);return r.setMovedAt(fromTimeTicket(e.movedAt)),r.setRemovedAt(fromTimeTicket(e.removedAt)),r}function fromTree(e){let t=fromTreeNodes(e.nodes);return CRDTTree.create(t,fromTimeTicket(e.createdAt))}function fromElement(e){if("jsonObject"===e.body.case)return fromObject(e.body.value);if("jsonArray"===e.body.case)return fromArray(e.body.value);if("primitive"===e.body.case)return function(e){let t=Primitive.of(Primitive.valueFromBytes(fromValueType(e.type),e.value),fromTimeTicket(e.createdAt));return t.setMovedAt(fromTimeTicket(e.movedAt)),t.setRemovedAt(fromTimeTicket(e.removedAt)),t}(e.body.value);if("text"===e.body.case)return function(e){let t=new RGATreeSplit,r=t.getHead();for(let n of e.nodes){let e=t.insertAfter(r,function(e){let t=CRDTTextValue.create(e.value);Object.entries(e.attributes).forEach(([e,r])=>{t.setAttr(e,r.value,fromTimeTicket(r.updatedAt))});let r=RGATreeSplitNode.create(fromTextNodeID(e.id),t);return r.remove(fromTimeTicket(e.removedAt)),r}(n));n.insPrevId&&e.setInsPrev(t.findNode(fromTextNodeID(n.insPrevId))),r=e}let n=new CRDTText(t,fromTimeTicket(e.createdAt));return n.setMovedAt(fromTimeTicket(e.movedAt)),n.setRemovedAt(fromTimeTicket(e.removedAt)),n}(e.body.value);if("counter"===e.body.case)return function(e){let t=CRDTCounter.create(fromCounterType(e.type),CRDTCounter.valueFromBytes(fromCounterType(e.type),e.value),fromTimeTicket(e.createdAt));return t.setMovedAt(fromTimeTicket(e.movedAt)),t.setRemovedAt(fromTimeTicket(e.removedAt)),t}(e.body.value);if("tree"===e.body.case)return fromTree(e.body.value);throw new YorkieError(nH.Unimplemented,"unimplemented element")}function bytesToObject(e){if(!e)throw Error("bytes is empty");let t=ro.fromBinary(e);return fromObject(t.body.value)}function objectToBytes(e){return toElement(e).toBinary()}function bytesToHex(e){return e?Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function hexToBytes(e){return new Uint8Array(e.match(/.{1,2}/g).map(e=>parseInt(e,16)))}let ii={fromPresence,toChangePack:function(e){var t;return new t0({documentKey:e.getDocumentKey(),checkpoint:(t=e.getCheckpoint(),new rA({serverSeq:t.getServerSeqAsString(),clientSeq:t.getClientSeq()})),isRemoved:e.getIsRemoved(),changes:function(e){let t=[];for(let r of e)t.push(function(e){let t=new t1({id:toChangeID(e.getID()),message:e.getMessage()});return e.hasOperations()&&(t.operations=function(e){let t=[];for(let r of e)t.push(toOperation(r));return t}(e.getOperations())),e.hasPresenceChange()&&(t.presenceChange=function(e){if(e.type===nX.Put)return new rO({type:rk.PUT,presence:function(e){let t=new rD,r=t.data;for(let[t,n]of Object.entries(e))r[t]=JSON.stringify(n);return t}(e.presence)});if(e.type===nX.Clear)return new rO({type:rk.CLEAR});throw new YorkieError(nH.Unimplemented,"unimplemented type")}(e.getPresenceChange())),t}(r));return t}(e.getChanges()),snapshot:e.getSnapshot(),minSyncedTicket:toTimeTicket(e.getMinSyncedTicket())})},fromChangePack:function(e){var t;return ChangePack.create(e.documentKey,(t=e.checkpoint,Checkpoint.of(Long.fromString(t.serverSeq,!0),t.clientSeq)),e.isRemoved,fromChanges(e.changes),e.snapshot,fromTimeTicket(e.minSyncedTicket))},fromChanges,objectToBytes,bytesToObject,bytesToSnapshot:function(e){if(!e)return{root:CRDTObject.create(n0),presences:new Map};let t=tQ.fromBinary(e);return{root:fromElement(t.root),presences:function(e){let t=new Map;return Object.entries(e).forEach(([e,r])=>{t.set(e,fromPresence(r))}),t}(t.presences)}},bytesToHex,hexToBytes,toHexString:function(e){return bytesToHex(e)},toUint8Array:function(e){return hexToBytes(e)},toOperation,toChangeID,PbChangeID:t2,bytesToChangeID:function(e){let t=t2.fromBinary(e);return fromChangeID(t)},bytesToOperation:function(e){let t=t3.fromBinary(e);return fromOperation(t)}};function uuid(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}let Attachment=class Attachment{constructor(e,t,r,n){__publicField(this,"reconnectStreamDelay"),__publicField(this,"doc"),__publicField(this,"docID"),__publicField(this,"syncMode"),__publicField(this,"remoteChangeEventReceived"),__publicField(this,"watchStream"),__publicField(this,"watchLoopTimerID"),__publicField(this,"watchAbortController"),this.reconnectStreamDelay=e,this.doc=t,this.docID=r,this.syncMode=n,this.remoteChangeEventReceived=!1}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.syncMode!==ip.RealtimeSyncOff&&(this.syncMode===ip.RealtimePushOnly?this.doc.hasLocalChanges():this.syncMode!==ip.Manual&&(this.doc.hasLocalChanges()||this.remoteChangeEventReceived))}async runWatchLoop(e){let doLoop=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.watchLoopTimerID=setTimeout(doLoop,this.reconnectStreamDelay)})}catch(e){}};await doLoop()}cancelWatchStream(){this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}};let Noop=()=>{};let ObserverProxy=class ObserverProxy{constructor(e){__publicField(this,"finalized",!1),__publicField(this,"observers",[]),__publicField(this,"finalError");try{e(this)}catch(e){this.error(e)}}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;e||n6.fatal("missing observer"),this.finalized&&n6.fatal("observable is finalized due to previous error"),void 0===(n="object"==typeof e?e:{next:e,error:t,complete:r}).next&&(n.next=Noop),void 0===n.error&&(n.error=Noop),void 0===n.complete&&(n.complete=Noop);let i=uuid(),o=this.unsubscribeOne.bind(this,i);if(this.observers.push({subscriptionID:i,observer:n}),this.finalized)try{this.finalError?n.error(this.finalError):n.complete()}catch(e){n6.warn(e)}return o}unsubscribeOne(e){var t;this.observers=null==(t=this.observers)?void 0:t.filter(t=>t.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e].observer)}catch(e){n6.error(e)}}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.observers=void 0)}};let ChangeContext=class ChangeContext{constructor(e,t,r,n){__publicField(this,"id"),__publicField(this,"delimiter"),__publicField(this,"message"),__publicField(this,"root"),__publicField(this,"operations"),__publicField(this,"presenceChange"),__publicField(this,"previousPresence"),__publicField(this,"reversePresenceKeys"),this.id=e,this.delimiter=0,this.root=t,this.operations=[],this.previousPresence=deepcopy(r),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=n}static create(e,t,r,n){return new ChangeContext(e,t,r,n)}push(e){this.operations.push(e)}registerElement(e,t){this.root.registerElement(e,t)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerGCPair(e){this.root.registerGCPair(e)}getChange(){return Change.create({id:this.id,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}hasChange(){return this.operations.length>0||void 0!==this.presenceChange}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,t){for(let r of Object.keys(e))(null==t?void 0:t.addToHistory)?this.reversePresenceKeys.add(r):this.reversePresenceKeys.delete(r)}getReversePresence(){if(0===this.reversePresenceKeys.size)return;let e={};for(let t of this.reversePresenceKeys)e[t]=this.previousPresence[t];return e}issueTimeTicket(){return this.delimiter+=1,this.id.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.id.createTimeTicket(this.delimiter)}};let CRDTRoot=class CRDTRoot{constructor(e){__publicField(this,"rootObject"),__publicField(this,"elementPairMapByCreatedAt"),__publicField(this,"gcElementSetByCreatedAt"),__publicField(this,"gcPairMap"),this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.gcElementSetByCreatedAt=new Set,this.gcPairMap=new Map,this.registerElement(e,void 0),e.getDescendants(e=>{if(e.getRemovedAt()&&this.registerRemovedElement(e),e instanceof CRDTText||e instanceof CRDTTree)for(let t of e.getGCPairs())this.registerGCPair(t);return!1})}static create(){return new CRDTRoot(CRDTObject.create(n0))}findByCreatedAt(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(t)return t.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!t)return[];let r=[];for(;t.parent;){let e=t.element.getCreatedAt(),n=t.parent.subPathOf(e);void 0===n&&n6.fatal(`cant find the given element: ${e.toIDString()}`),r.unshift(n),t=this.elementPairMapByCreatedAt.get(t.parent.getCreatedAt().toIDString())}return r.unshift("$"),r}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,t){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),e instanceof CRDTContainer&&e.getDescendants((e,t)=>(this.registerElement(e,t),!1))}deregisterElement(e){let t=0,deregisterElementInternal=e=>{let r=e.getCreatedAt().toIDString();this.elementPairMapByCreatedAt.delete(r),this.gcElementSetByCreatedAt.delete(r),t++};return deregisterElementInternal(e),e instanceof CRDTContainer&&e.getDescendants(e=>(deregisterElementInternal(e),!1)),t}registerRemovedElement(e){this.gcElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerGCPair(e){let t=this.gcPairMap.get(e.child.toIDString());if(t){this.gcPairMap.delete(e.child.toIDString());return}this.gcPairMap.set(e.child.toIDString(),e)}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getGarbageElementSetSize(){let e=new Set;for(let t of this.gcElementSetByCreatedAt){e.add(t);let r=this.elementPairMapByCreatedAt.get(t);r.element instanceof CRDTContainer&&r.element.getDescendants(t=>(e.add(t.getCreatedAt().toIDString()),!1))}return e.size}getObject(){return this.rootObject}getGarbageLen(){return this.getGarbageElementSetSize()+this.gcPairMap.size}deepcopy(){return new CRDTRoot(this.rootObject.deepcopy())}garbageCollect(e){let t=0;for(let r of this.gcElementSetByCreatedAt){let n=this.elementPairMapByCreatedAt.get(r);n.element.getRemovedAt()&&e.compare(n.element.getRemovedAt())>=0&&(n.parent.purge(n.element),t+=this.deregisterElement(n.element))}for(let[,r]of this.gcPairMap){let n=r.child.getRemovedAt();void 0!==n&&e.compare(n)>=0&&(r.parent.purge(r.child),this.gcPairMap.delete(r.child.toIDString()),t+=1)}return t}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}};function createJSONObject(e,t){let r=new ObjectProxy(e);return new Proxy(t,r.getHandlers())}let ObjectProxy=class ObjectProxy{constructor(e){__publicField(this,"context"),__publicField(this,"handlers"),this.context=e,this.handlers={set:(t,r,n)=>(n6.isEnabled(n2.Trivial)&&n6.trivial(`obj[${r}]=${JSON.stringify(n)}`),ObjectProxy.setInternal(e,t,r,n),!0),get:(t,r)=>(n6.isEnabled(n2.Trivial)&&n6.trivial(`obj[${r}]`),"getID"===r)?()=>t.getCreatedAt():"toJSON"===r||"toString"===r?()=>t.toJSON():"toJS"===r?()=>t.toJS():"toJSForTest"===r?()=>t.toJSForTest():toJSONElement(e,t.get(r)),ownKeys:e=>e.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(t,r)=>(n6.isEnabled(n2.Trivial)&&n6.trivial(`obj[${r}]`),ObjectProxy.deleteInternal(e,t,r),!0)}}static setInternal(e,t,r,n){if(r.includes("."))throw new YorkieError(nH.InvalidObjectKey,"key must not contain the '.'.");let i=e.issueTimeTicket(),o=buildCRDTElement(e,n,i),s=t.set(r,o,i);e.registerElement(o,t),s&&e.registerRemovedElement(s),e.push(SetOperation.create(r,o.deepcopy(),t.getCreatedAt(),i))}static buildObjectMembers(e,t){let r={};for(let[n,i]of Object.entries(t)){if(n.includes("."))throw new YorkieError(nH.InvalidObjectKey,"key must not contain the '.'.");let t=e.issueTimeTicket(),o=buildCRDTElement(e,i,t);r[n]=o}return r}static deleteInternal(e,t,r){let n=e.issueTimeTicket(),i=t.deleteByKey(r,n);i&&(e.push(RemoveOperation.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i))}getHandlers(){return this.handlers}};let ArrayProxy=class ArrayProxy{constructor(e,t){__publicField(this,"context"),__publicField(this,"handlers"),__publicField(this,"array"),this.context=e,this.array=t,this.handlers={get:(t,r,n)=>"getID"===r?()=>t.getCreatedAt():"getElementByID"===r?r=>{let n=t.getByID(r);if(!(!n||n.isRemoved()))return toWrappedElement(e,n)}:"getElementByIndex"===r?r=>{let n=t.get(r);return toWrappedElement(e,n)}:"getLast"===r?()=>toWrappedElement(e,t.getLast()):"deleteByID"===r?r=>{let n=ArrayProxy.deleteInternalByID(e,t,r);return toWrappedElement(e,n)}:"insertAfter"===r?(r,n)=>{let i=ArrayProxy.insertAfterInternal(e,t,r,n);return toWrappedElement(e,i)}:"insertBefore"===r?(r,n)=>{let i=ArrayProxy.insertBeforeInternal(e,t,r,n);return toWrappedElement(e,i)}:"moveBefore"===r?(r,n)=>{ArrayProxy.moveBeforeInternal(e,t,r,n)}:"moveAfter"===r?(r,n)=>{ArrayProxy.moveAfterInternal(e,t,r,n)}:"moveFront"===r?r=>{ArrayProxy.moveFrontInternal(e,t,r)}:"moveLast"===r?r=>{ArrayProxy.moveLastInternal(e,t,r)}:("string"==typeof r||r instanceof String)&&!isNaN(r)?toJSONElement(e,t.get(Number(r))):"push"===r?r=>ArrayProxy.pushInternal(e,t,r):"splice"===r?(r,n,...i)=>ArrayProxy.splice(e,t,r,n,...i):"length"===r?t.length:"symbol"==typeof r&&r===Symbol.iterator?ArrayProxy.iteratorInternal.bind(this,e,t):"includes"===r?(r,n)=>ArrayProxy.includes(e,t,r,n):"indexOf"===r?(r,n)=>ArrayProxy.indexOf(e,t,r,n):"lastIndexOf"===r?(r,n)=>ArrayProxy.lastIndexOf(e,t,r,n):"toJSForTest"===r?()=>t.toJSForTest():"toTestString"===r?()=>ArrayProxy.toTestString(t):"string"==typeof r&&["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(r)?(...n)=>{let i=Array.from(t).map(t=>toJSONElement(e,t));return Array.prototype[r].apply(i,n)}:Reflect.get(t,r,n),deleteProperty:(t,r)=>(n6.isEnabled(n2.Trivial)&&n6.trivial(`array[${r}]`),ArrayProxy.deleteInternalByIndex(e,t,Number.parseInt(r)),!0)}}static*iteratorInternal(e,t){for(let r of t)yield toWrappedElement(e,r)}static buildArrayElements(e,t){let r=[];for(let n of t){let t=e.issueTimeTicket(),i=buildCRDTElement(e,n,t);r.push(i)}return r}static pushInternal(e,t,r){return ArrayProxy.insertAfterInternal(e,t,t.getLastCreatedAt(),r),t.length}static moveBeforeInternal(e,t,r,n){let i=e.issueTimeTicket(),o=t.getPrevCreatedAt(r);t.moveAfter(o,n,i),e.push(MoveOperation.create(t.getCreatedAt(),o,n,i))}static moveAfterInternal(e,t,r,n){let i=e.issueTimeTicket();t.moveAfter(r,n,i),e.push(MoveOperation.create(t.getCreatedAt(),r,n,i))}static moveFrontInternal(e,t,r){let n=e.issueTimeTicket(),i=t.getHead();t.moveAfter(i.getCreatedAt(),r,n),e.push(MoveOperation.create(t.getCreatedAt(),i.getCreatedAt(),r,n))}static moveLastInternal(e,t,r){let n=e.issueTimeTicket(),i=t.getLastCreatedAt();t.moveAfter(i,r,n),e.push(MoveOperation.create(t.getCreatedAt(),i,r,n))}static insertAfterInternal(e,t,r,n){let i=e.issueTimeTicket(),o=buildCRDTElement(e,n,i);return t.insertAfter(r,o),e.registerElement(o,t),e.push(AddOperation.create(t.getCreatedAt(),r,o.deepcopy(),i)),o}static insertBeforeInternal(e,t,r,n){return ArrayProxy.insertAfterInternal(e,t,t.getPrevCreatedAt(r),n)}static deleteInternalByIndex(e,t,r){let n=e.issueTimeTicket(),i=t.deleteByIndex(r,n);if(i)return e.push(RemoveOperation.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i),i}static deleteInternalByID(e,t,r){let n=e.issueTimeTicket(),i=t.delete(r,n);return e.push(RemoveOperation.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i),i}static splice(e,t,r,n,...i){let o=t.length,s=r>=0?Math.min(r,o):Math.max(o+r,0),a=void 0===n?o:n<0?s:Math.min(s+n,o),l=[];for(let r=s;r<a;r++){let r=ArrayProxy.deleteInternalByIndex(e,t,s);if(r){let t=r.deepcopy();t.setRemovedAt(),l.push(toJSONElement(e,t))}}if(i){let r=0===s?t.getHead().getID():t.get(s-1).getID();for(let n of i){let i=ArrayProxy.insertAfterInternal(e,t,r,n);r=i.getID()}}return l}static includes(e,t,r,n){var i;let o=t.length,s=void 0===n?0:n<0?Math.max(n+o,0):n;if(s>=o)return!1;if(Primitive.isSupport(r)){let n=Array.from(t).map(t=>toJSONElement(e,t));return n.includes(r,s)}for(let e=s;e<o;e++)if((null==(i=t.get(e))?void 0:i.getID())===r.getID())return!0;return!1}static indexOf(e,t,r,n){var i;let o=t.length,s=void 0===n?0:n<0?Math.max(n+o,0):n;if(s>=o)return -1;if(Primitive.isSupport(r)){let n=Array.from(t).map(t=>toJSONElement(e,t));return n.indexOf(r,s)}for(let e=s;e<o;e++)if((null==(i=t.get(e))?void 0:i.getID())===r.getID())return e;return -1}static lastIndexOf(e,t,r,n){var i;let o=t.length,s=void 0===n||n>=o?o-1:n<0?n+o:n;if(s<0)return -1;if(Primitive.isSupport(r)){let n=Array.from(t).map(t=>toJSONElement(e,t));return n.lastIndexOf(r,s)}for(let e=s;e>0;e--)if((null==(i=t.get(e))?void 0:i.getID())===r.getID())return e;return -1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}};let Text=class Text{constructor(e,t){__publicField(this,"context"),__publicField(this,"text"),this.context=e,this.text=t}initialize(e,t){this.context=e,this.text=t}getID(){return this.text.getID()}edit(e,t,r,n){if(!this.context||!this.text){n6.fatal("it is not initialized yet");return}if(e>t){n6.fatal("from should be less than or equal to to");return}let i=this.text.indexRangeToPosRange(e,t);n6.isEnabled(n2.Debug)&&n6.debug(`EDIT: f:${e}->${i[0].toTestString()}, t:${t}->${i[1].toTestString()} c:${r}`);let o=n?stringifyObjectValues(n):void 0,s=this.context.issueTimeTicket(),[a,,l,u]=this.text.edit(i,r,s,o);for(let e of l)this.context.registerGCPair(e);return this.context.push(new EditOperation(this.text.getCreatedAt(),i[0],i[1],a,r,o?new Map(Object.entries(o)):new Map,s)),this.text.findIndexesFromRange(u)}delete(e,t){return this.edit(e,t,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,t,r){if(!this.context||!this.text)return n6.fatal("it is not initialized yet"),!1;if(e>t)return n6.fatal("from should be less than or equal to to"),!1;let n=this.text.indexRangeToPosRange(e,t);n6.isEnabled(n2.Debug)&&n6.debug(`STYL: f:${e}->${n[0].toTestString()}, t:${t}->${n[1].toTestString()} a:${JSON.stringify(r)}`);let i=stringifyObjectValues(r),o=this.context.issueTimeTicket(),[s,a]=this.text.setStyle(n,i,o);for(let e of a)this.context.registerGCPair(e);return this.context.push(new StyleOperation(this.text.getCreatedAt(),n[0],n[1],s,new Map(Object.entries(i)),o)),!0}indexRangeToPosRange(e){if(!this.context||!this.text){n6.fatal("it is not initialized yet");return}let t=this.text.indexRangeToPosRange(e[0],e[1]);return[t[0].toStruct(),t[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text){n6.fatal("it is not initialized yet");return}let t=this.text.findIndexesFromRange([RGATreeSplitPos.fromStruct(e[0]),RGATreeSplitPos.fromStruct(e[1])]);return[t[0],t[1]]}toTestString(){if(!this.context||!this.text){n6.fatal("it is not initialized yet");return}return this.text.toTestString()}values(){if(!this.context||!this.text){n6.fatal("it is not initialized yet");return}return this.text.values()}get length(){return this.text.length}checkWeight(){return this.text.checkWeight()}toString(){return this.context&&this.text?this.text.toString():(n6.fatal("it is not initialized yet"),"")}toJSON(){if(!this.context||!this.text)throw Error("it is not initialized yet");return this.text.toJSON()}toJSForTest(){if(!this.context||!this.text)throw Error("it is not initialized yet");return this.text.toJSForTest()}createRangeForTest(e,t){if(!this.context||!this.text){n6.fatal("it is not initialized yet");return}return this.text.indexRangeToPosRange(e,t)}};let Counter=class Counter{constructor(e,t){__publicField(this,"valueType"),__publicField(this,"value"),__publicField(this,"context"),__publicField(this,"counter"),this.valueType=e,this.value=t}initialize(e,t){this.valueType=t.getValueType(),this.context=e,this.counter=t,this.value=t.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter){n6.fatal("it is not initialized yet");return}let t=this.context.issueTimeTicket(),r=Primitive.of(e,t);if(!r.isNumericType())throw TypeError(`Unsupported type of value: ${typeof r.getValue()}`);return this.counter.increase(r),this.context.push(IncreaseOperation.create(this.counter.getCreatedAt(),r,t)),this}toJSForTest(){if(!this.context||!this.counter)throw Error("it is not initialized yet");return this.counter.toJSForTest()}};function buildDescendants(e,t,r){let{type:n}=e,i=r.issueTimeTicket();if(n===n5){validateTextNode(e);let{value:r}=e,o=CRDTTreeNode.create(CRDTTreeNodeID.of(i,0),n,r);t.append(o)}else{let o;let{children:s=[]}=e,{attributes:a}=e;if("object"==typeof a&&!isEmpty(a))for(let[e,t]of(a=stringifyObjectValues(a),o=new RHT,Object.entries(a)))o.set(e,t,i);let l=CRDTTreeNode.create(CRDTTreeNodeID.of(i,0),n,void 0,o);for(let e of(t.append(l),s))buildDescendants(e,l,r)}}function validateTextNode(e){if(!e.value.length)throw Error("text node cannot have empty value");return!0}function validateTreeNodes(e){if(!e.length)return!0;let t=e[0].type;if(t===n5)for(let t of e){let{type:e}=t;if(e!==n5)throw Error("element node and text node cannot be passed together");validateTextNode(t)}else for(let t of e){let{type:e}=t;if(e===n5)throw Error("element node and text node cannot be passed together")}return!0}let Tree=class Tree{constructor(e){__publicField(this,"initialRoot"),__publicField(this,"context"),__publicField(this,"tree"),this.initialRoot=e}initialize(e,t){this.context=e,this.tree=t}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return CRDTTreeNode.create(CRDTTreeNodeID.of(e.issueTimeTicket(),0),"root");let t=CRDTTreeNode.create(CRDTTreeNodeID.of(e.issueTimeTicket(),0),this.initialRoot.type);for(let r of this.initialRoot.children)buildDescendants(r,t,e);return t}getSize(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.getSize()}getNodeSize(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.getNodeSize()}getIndexTree(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.getIndexTree()}styleByPath(e,t){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(!e.length)throw Error("path should not be empty");let[r,n]=this.tree.pathToPosRange(e),i=this.context.issueTimeTicket(),o=t?stringifyObjectValues(t):void 0,[s]=this.tree.style([r,n],o,i);this.context.push(TreeStyleOperation.create(this.tree.getCreatedAt(),r,n,s,o?new Map(Object.entries(o)):new Map,i))}style(e,t,r){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e>t)throw Error("from should be less than or equal to to");let n=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),s=r?stringifyObjectValues(r):void 0,[a,l]=this.tree.style([n,i],s,o);for(let e of l)this.context.registerGCPair(e);this.context.push(TreeStyleOperation.create(this.tree.getCreatedAt(),n,i,a,s?new Map(Object.entries(s)):new Map,o))}removeStyle(e,t,r){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e>t)throw Error("from should be less than or equal to to");let n=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),[s,a]=this.tree.removeStyle([n,i],r,o);for(let e of a)this.context.registerGCPair(e);this.context.push(TreeStyleOperation.createTreeRemoveStyleOperation(this.tree.getCreatedAt(),n,i,s,r,o))}editInternal(e,t,r,n=0){var i;if(0!==r.length&&r[0]&&(validateTreeNodes(r),r[0].type!==n5))for(let e of r){let{children:t=[]}=e;validateTreeNodes(t)}let o=this.context.getLastTimeTicket(),s=[];if((null==(i=r[0])?void 0:i.type)===n5){let e="";for(let t of r){let{value:r}=t;e+=r}s.push(CRDTTreeNode.create(CRDTTreeNodeID.of(this.context.issueTimeTicket(),0),n5,e))}else s=r.map(e=>e&&function(e,t){let r;let{type:n}=t,i=e.issueTimeTicket();if(t.type===n5){let{value:e}=t;r=CRDTTreeNode.create(CRDTTreeNodeID.of(i,0),n,e)}else if(t){let o;let{children:s=[]}=t,{attributes:a}=t;if("object"==typeof a&&!isEmpty(a))for(let[e,t]of(a=stringifyObjectValues(a),o=new RHT,Object.entries(a)))o.set(e,t,i);for(let t of(r=CRDTTreeNode.create(CRDTTreeNodeID.of(e.issueTimeTicket(),0),n,void 0,o),s))buildDescendants(t,r,e)}return r}(this.context,e)).filter(e=>e);let[,a,l]=this.tree.edit([e,t],s.length?s.map(e=>null==e?void 0:e.deepcopy()):void 0,n,o,()=>this.context.issueTimeTicket());for(let e of a)this.context.registerGCPair(e);return this.context.push(TreeEditOperation.create(this.tree.getCreatedAt(),e,t,s.length?s:void 0,n,l,o)),!0}editByPath(e,t,r,n=0){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e.length!==t.length)throw Error("path length should be equal");if(!e.length||!t.length)throw Error("path should not be empty");let i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,r?[r]:[],n)}editBulkByPath(e,t,r,n=0){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e.length!==t.length)throw Error("path length should be equal");if(!e.length||!t.length)throw Error("path should not be empty");let i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,r,n)}edit(e,t,r,n=0){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e>t)throw Error("from should be less than or equal to to");let i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,r?[r]:[],n)}editBulk(e,t,r,n=0){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e>t)throw Error("from should be less than or equal to to");let i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,r,n)}toXML(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.toJSON()}toJSForTest(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.toJSForTest()}toJSInfoForTest(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree){n6.fatal("it is not initialized yet");return}let t=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],r=this.tree.indexRangeToPosRange(t);return[r[0].toStruct(),r[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree){n6.fatal("it is not initialized yet");return}return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree){n6.fatal("it is not initialized yet");return}let t=[CRDTTreePos.fromStruct(e[0]),CRDTTreePos.fromStruct(e[1])];return this.tree.posRangeToIndexRange(t)}posRangeToPathRange(e){if(!this.context||!this.tree){n6.fatal("it is not initialized yet");return}let t=[CRDTTreePos.fromStruct(e[0]),CRDTTreePos.fromStruct(e[1])];return this.tree.posRangeToPathRange(t)}};function toWrappedElement(e,t){if(t){if(t instanceof Primitive)return t;if(t instanceof CRDTObject)return createJSONObject(e,t);if(t instanceof CRDTArray)return function(e,t){let r=new ArrayProxy(e,t);return new Proxy(t,r.getHandlers())}(e,t);if(t instanceof CRDTText)return new Text(e,t);else if(t instanceof CRDTCounter){let r=new Counter(ir.IntegerCnt,0);return r.initialize(e,t),r}else if(t instanceof CRDTTree){let r=new Tree;return r.initialize(e,t),r}throw TypeError(`Unsupported type of element: ${typeof t}`)}}function toJSONElement(e,t){let r=toWrappedElement(e,t);return r instanceof Primitive?r.getValue():r}function buildCRDTElement(e,t,r){let n;if(Primitive.isSupport(t))n=Primitive.of(t,r);else if(Array.isArray(t))n=CRDTArray.create(r,ArrayProxy.buildArrayElements(e,t));else if("object"==typeof t)t instanceof Text?(n=CRDTText.create(RGATreeSplit.create(),r),t.initialize(e,n)):t instanceof Counter?(n=CRDTCounter.create(t.getValueType(),t.getValue(),r),t.initialize(e,n)):t instanceof Tree?(n=CRDTTree.create(t.buildRoot(e),r),t.initialize(e,n)):n=CRDTObject.create(r,ObjectProxy.buildObjectMembers(e,t));else throw TypeError(`Unsupported type of value: ${typeof t}`);return n}let History=class History{constructor(){__publicField(this,"undoStack",[]),__publicField(this,"redoStack",[])}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=50&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=50&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}};let io="yorkie-devtools-panel",is="yorkie-devtools-sdk",ia="disconnected",il=new Map,iu=new Map;function sendToPanel(e,t){((null==t?void 0:t.force)||"disconnected"!==ia)&&window.postMessage({source:is,...e},"*")}"undefined"!=typeof window&&(window.transactionEventsByDocKey=iu);var id=((B=id||{}).Detached="detached",B.Attached="attached",B.Removed="removed",B),ic=((J=ic||{}).StatusChanged="status-changed",J.ConnectionChanged="connection-changed",J.SyncStatusChanged="sync-status-changed",J.Snapshot="snapshot",J.LocalChange="local-change",J.RemoteChange="remote-change",J.Initialized="initialized",J.Watched="watched",J.Unwatched="unwatched",J.PresenceChanged="presence-changed",J),ih=((V=ih||{}).Connected="connected",V.Disconnected="disconnected",V),im=((U=im||{}).Synced="synced",U.SyncFailed="sync-failed",U);let Document=class Document{constructor(e,t){__publicField(this,"key"),__publicField(this,"status"),__publicField(this,"opts"),__publicField(this,"changeID"),__publicField(this,"checkpoint"),__publicField(this,"localChanges"),__publicField(this,"root"),__publicField(this,"clone"),__publicField(this,"eventStream"),__publicField(this,"eventStreamObserver"),__publicField(this,"onlineClients"),__publicField(this,"presences"),__publicField(this,"history"),__publicField(this,"internalHistory"),__publicField(this,"isUpdating"),this.opts=t||{},this.key=e,this.status="detached",this.root=CRDTRoot.create(),this.changeID=n7,this.checkpoint=ie,this.localChanges=[],this.eventStream=function(e){let t=new ObserverProxy(e);return{subscribe:t.subscribe.bind(t),getProxy:()=>t}}(e=>{this.eventStreamObserver=e}),this.onlineClients=new Set,this.presences=new Map,this.isUpdating=!1,this.internalHistory=new History,this.history={canUndo:this.canUndo.bind(this),canRedo:this.canRedo.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this)},function(e){if(!e.isEnableDevtools()||"undefined"==typeof window||il.has(e.getKey()))return;iu.set(e.getKey(),[]);let t=e.subscribe("all",t=>{t.some(e=>e.type!==ic.StatusChanged&&e.type!==ic.Snapshot&&e.type!==ic.LocalChange&&e.type!==ic.RemoteChange&&e.type!==ic.Initialized&&e.type!==ic.Watched&&e.type!==ic.Unwatched&&e.type!==ic.PresenceChanged)||(iu.get(e.getKey()).push(t),"synced"===ia&&sendToPanel({msg:"doc::sync::partial",docKey:e.getKey(),event:t}))});il.set(e.getKey(),[t]),sendToPanel({msg:"refresh-devtools"},{force:!0}),window.addEventListener("message",t=>{var r;if((null==(r=t.data)?void 0:r.source)!==io)return;let n=t.data;switch(n.msg){case"devtools::connect":if("disconnected"!==ia)break;ia="connected",sendToPanel({msg:"doc::available",docKey:e.getKey()}),n6.info(`[YD] Devtools connected. Doc: ${e.getKey()}`);break;case"devtools::disconnect":ia="disconnected",n6.info(`[YD] Devtools disconnected. Doc: ${e.getKey()}`);break;case"devtools::subscribe":ia="synced",sendToPanel({msg:"doc::sync::full",docKey:e.getKey(),events:iu.get(e.getKey())}),n6.info(`[YD] Devtools subscribed. Doc: ${e.getKey()}`)}})}(this)}update(e,t){if("removed"===this.getStatus())throw new YorkieError(nH.DocumentRemoved,`${this.key} is removed`);this.ensureClone();let r=this.changeID.getActorID(),n=ChangeContext.create(this.changeID.next(),this.clone.root,this.clone.presences.get(r)||{},t);try{var i;let t=(i=this.clone.root.getObject(),createJSONObject(n,i));this.presences.has(r)||this.clone.presences.set(r,{}),this.isUpdating=!0,e(t,new Presence(n,this.clone.presences.get(r)))}catch(e){throw this.clone=void 0,n6.error(e),e}finally{this.isUpdating=!1}if(n.hasChange()){n6.isEnabled(n2.Trivial)&&n6.trivial(`trying to update a local change: ${this.toJSON()}`);let e=n.getChange(),{opInfos:t,reverseOps:i}=e.execute(this.root,this.presences,n4.Local),o=n.getReversePresence();o&&i.push({type:"presence",value:o}),this.localChanges.push(e),i.length>0&&this.internalHistory.pushUndo(i),t.length>0&&this.internalHistory.clearRedo(),this.changeID=e.getID();let s=[];t.length>0&&s.push({type:"local-change",source:n4.Local,value:{message:e.getMessage()||"",operations:t,actor:r,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq()},rawChange:this.isEnableDevtools()?e.toStruct():void 0}),e.hasPresenceChange()&&s.push({type:"presence-changed",source:n4.Local,value:{clientID:r,presence:this.getPresence(r)}}),this.publish(s),n6.isEnabled(n2.Trivial)&&n6.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(e,t,r,n){if("string"==typeof e){if("function"!=typeof t)throw Error("Second argument must be a callback function");return"presence"===e?this.eventStream.subscribe(e=>{for(let r of e)("initialized"===r.type||"watched"===r.type||"unwatched"===r.type||"presence-changed"===r.type)&&t(r)},r,n):"my-presence"===e?this.eventStream.subscribe(e=>{for(let r of e)("initialized"===r.type||"presence-changed"===r.type)&&("presence-changed"!==r.type||r.value.clientID===this.changeID.getActorID())&&t(r)},r,n):"others"===e?this.eventStream.subscribe(e=>{for(let r of e)("watched"===r.type||"unwatched"===r.type||"presence-changed"===r.type)&&r.value.clientID!==this.changeID.getActorID()&&t(r)},r,n):"connection"===e?this.eventStream.subscribe(e=>{for(let r of e)"connection-changed"===r.type&&t(r)},r,n):"sync"===e?this.eventStream.subscribe(e=>{for(let r of e)"sync-status-changed"===r.type&&t(r)},r,n):"all"===e?this.eventStream.subscribe(t,r,n):this.eventStream.subscribe(r=>{for(let n of r){if("local-change"!==n.type&&"remote-change"!==n.type)continue;let r=[];for(let t of n.value.operations)this.isSameElementOrChildOf(t.path,e)&&r.push(t);r.length&&t({...n,value:{...n.value,operations:r}})}},r,n)}if("function"==typeof e)return this.eventStream.subscribe(t=>{for(let r of t)("snapshot"===r.type||"local-change"===r.type||"remote-change"===r.type)&&e(r)},t,r);throw Error(`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}isSameElementOrChildOf(e,t){if(t===e)return!0;let r=e.split("."),n=t.split(".");return n.every((e,t)=>e===r[t])}applyChangePack(e){for(e.hasSnapshot()?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getSnapshot()):e.hasChanges()&&this.applyChanges(e.getChanges(),n4.Remote);this.localChanges.length;){let t=this.localChanges[0];if(t.getID().getClientSeq()>e.getCheckpoint().getClientSeq())break;this.localChanges.shift()}this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),this.garbageCollect(e.getMinSyncedTicket()),e.getIsRemoved()&&this.applyStatus("removed"),n6.isEnabled(n2.Trivial)&&n6.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:deepcopy(this.presences)})}createChangePack(){let e=Array.from(this.localChanges),t=this.checkpoint.increaseClientSeq(e.length);return ChangePack.create(this.key,t,!1,e)}setActor(e){for(let t of this.localChanges)t.setActor(e);this.changeID=this.changeID.setActor(e)}isEnableDevtools(){return!!this.opts.enableDevtools}getKey(){return this.key}getStatus(){return this.status}getCloneRoot(){if(this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();let e=ChangeContext.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return createJSONObject(e,this.clone.root.getObject())}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(e,t){let{root:r,presences:n}=ii.bytesToSnapshot(t);this.root=new CRDTRoot(r),this.presences=n,this.changeID=this.changeID.syncLamport(e),this.clone=void 0,this.publish([{type:"snapshot",source:n4.Remote,value:{snapshot:this.isEnableDevtools()?ii.bytesToHex(t):void 0,serverSeq:e.toString()}}])}applyChanges(e,t){for(let r of(n6.isEnabled(n2.Debug)&&n6.debug(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getGarbageElementSetSize()}`),n6.isEnabled(n2.Trivial)&&n6.trivial(e.map(e=>`${e.getID().toTestString()}	${e.toTestString()}`).join("\n")),e))this.applyChange(r,t);n6.isEnabled(n2.Debug)&&n6.debug(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getGarbageElementSetSize()}`)}applyChange(e,t){this.ensureClone(),e.execute(this.clone.root,this.clone.presences,t);let r=[],n=e.getID().getActorID();if(e.hasPresenceChange()&&this.onlineClients.has(n)){let i=e.getPresenceChange();switch(i.type){case nX.Put:r.push(this.presences.has(n)?{type:"presence-changed",source:t,value:{clientID:n,presence:i.presence}}:{type:"watched",source:n4.Remote,value:{clientID:n,presence:i.presence}});break;case nX.Clear:r.push({type:"unwatched",source:n4.Remote,value:{clientID:n,presence:this.getPresence(n)}}),this.removeOnlineClient(n)}}let{opInfos:i}=e.execute(this.root,this.presences,t);if(this.changeID=this.changeID.syncLamport(e.getID().getLamport()),i.length>0){let o=this.isEnableDevtools()?e.toStruct():void 0;r.push(t===n4.Remote?{type:"remote-change",source:t,value:{actor:n,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:o}:{type:"local-change",source:t,value:{actor:n,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:o})}r.length>0&&this.publish(r)}applyWatchStream(e){if("initialization"===e.body.case){let t=e.body.value.clientIds,r=new Set;for(let e of t)e!==this.changeID.getActorID()&&r.add(e);this.setOnlineClients(r),this.publish([{type:"initialized",source:n4.Local,value:this.getPresences()}]);return}if("event"===e.body.case){let{type:t,publisher:r}=e.body.value,n=[];if(t===tZ.DOCUMENT_WATCHED)this.addOnlineClient(r),this.hasPresence(r)&&n.push({type:"watched",source:n4.Remote,value:{clientID:r,presence:this.getPresence(r)}});else if(t===tZ.DOCUMENT_UNWATCHED){let e=this.getPresence(r);this.removeOnlineClient(r),e&&n.push({type:"unwatched",source:n4.Remote,value:{clientID:r,presence:e}})}n.length>0&&this.publish(n)}}applyStatus(e){this.status=e,"detached"===e&&this.setActor(nZ),this.publish([{source:"removed"===e?n4.Remote:n4.Local,type:"status-changed",value:"attached"===e?{status:e,actorID:this.changeID.getActorID()}:{status:e}}])}applyDocEvent(e){if("status-changed"===e.type){this.applyStatus(e.value.status),"attached"===e.value.status&&this.setActor(e.value.actorID);return}if("snapshot"===e.type){let{snapshot:t,serverSeq:r}=e.value;if(!t)return;this.applySnapshot(Long.fromString(r),ii.hexToBytes(t));return}if("local-change"===e.type||"remote-change"===e.type){if(!e.rawChange)return;let t=Change.fromStruct(e.rawChange);this.applyChange(t,e.source)}if("initialized"===e.type){let t=new Set;for(let{clientID:r,presence:n}of e.value)t.add(r),this.presences.set(r,n);this.setOnlineClients(t);return}if("watched"===e.type){let{clientID:t,presence:r}=e.value;this.addOnlineClient(t),this.presences.set(t,r);return}if("unwatched"===e.type){let{clientID:t}=e.value;this.removeOnlineClient(t),this.presences.delete(t)}if("presence-changed"===e.type){let{clientID:t,presence:r}=e.value;this.presences.set(t,r)}}applyTransactionEvent(e){for(let t of e)this.applyDocEvent(t)}getValueByPath(e){if(!e.startsWith("$"))throw new YorkieError(nH.InvalidArgument,'path must start with "$"');let t=e.split(".");t.shift();let r=this.getRoot();for(let e of t)if(void 0===(r=r[e]))return;return r}setOnlineClients(e){this.onlineClients=e}resetOnlineClients(){this.onlineClients=new Set}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if("attached"!==this.status)return{};let e=this.presences.get(this.changeID.getActorID());return e?deepcopy(e):{}}getPresence(e){if(e===this.changeID.getActorID())return this.getMyPresence();if(!this.onlineClients.has(e))return;let t=this.presences.get(e);return t?deepcopy(t):void 0}getPresenceForTest(e){let t=this.presences.get(e);return t?deepcopy(t):void 0}getPresences(){let e=[];for(let t of(e.push({clientID:this.changeID.getActorID(),presence:deepcopy(this.getMyPresence())}),this.onlineClients))this.presences.has(t)&&e.push({clientID:t,presence:deepcopy(this.presences.get(t))});return e}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){let e=this.getChangeID().getActorID();return this.getPresences().filter(t=>t.clientID!==e).sort((e,t)=>e.clientID>t.clientID?1:-1)}canUndo(){return this.internalHistory.hasUndo()&&!this.isUpdating}canRedo(){return this.internalHistory.hasRedo()&&!this.isUpdating}undo(){if(this.isUpdating)throw Error("Undo is not allowed during an update");let e=this.internalHistory.popUndo();if(void 0===e)throw Error("There is no operation to be undone");this.ensureClone();let t=ChangeContext.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(let r of e){if(!(r instanceof Operation)){let e=new Presence(t,deepcopy(this.clone.presences.get(this.changeID.getActorID())));e.set(r.value,{addToHistory:!0});continue}let e=t.issueTimeTicket();r.setExecutedAt(e),t.push(r)}let r=t.getChange();r.execute(this.clone.root,this.clone.presences,n4.UndoRedo);let{opInfos:n,reverseOps:i}=r.execute(this.root,this.presences,n4.UndoRedo),o=t.getReversePresence();if(o&&i.push({type:"presence",value:o}),i.length>0&&this.internalHistory.pushRedo(i),!r.hasPresenceChange()&&0===n.length)return;this.localChanges.push(r),this.changeID=r.getID();let s=this.changeID.getActorID(),a=[];n.length>0&&a.push({type:"local-change",source:n4.UndoRedo,value:{message:r.getMessage()||"",operations:n,actor:s,clientSeq:r.getID().getClientSeq(),serverSeq:r.getID().getServerSeq()},rawChange:this.isEnableDevtools()?r.toStruct():void 0}),r.hasPresenceChange()&&a.push({type:"presence-changed",source:n4.UndoRedo,value:{clientID:s,presence:this.getPresence(s)}}),this.publish(a)}redo(){if(this.isUpdating)throw Error("Redo is not allowed during an update");let e=this.internalHistory.popRedo();if(void 0===e)throw Error("There is no operation to be redone");this.ensureClone();let t=ChangeContext.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(let r of e){if(!(r instanceof Operation)){let e=new Presence(t,deepcopy(this.clone.presences.get(this.changeID.getActorID())));e.set(r.value,{addToHistory:!0});continue}let e=t.issueTimeTicket();r.setExecutedAt(e),t.push(r)}let r=t.getChange();r.execute(this.clone.root,this.clone.presences,n4.UndoRedo);let{opInfos:n,reverseOps:i}=r.execute(this.root,this.presences,n4.UndoRedo),o=t.getReversePresence();if(o&&i.push({type:"presence",value:o}),i.length>0&&this.internalHistory.pushUndo(i),!r.hasPresenceChange()&&0===n.length)return;this.localChanges.push(r),this.changeID=r.getID();let s=this.changeID.getActorID(),a=[];n.length>0&&a.push({type:"local-change",source:n4.UndoRedo,value:{message:r.getMessage()||"",operations:n,actor:s,clientSeq:r.getID().getClientSeq(),serverSeq:r.getID().getServerSeq()},rawChange:this.isEnableDevtools()?r.toStruct():void 0}),r.hasPresenceChange()&&a.push({type:"presence-changed",source:n4.UndoRedo,value:{clientID:s,presence:this.getPresence(s)}}),this.publish(a)}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}};var ip=((j=ip||{}).Manual="manual",j.Realtime="realtime",j.RealtimePushOnly="realtime-pushonly",j.RealtimeSyncOff="realtime-syncoff",j),ig=(($=ig||{}).Deactivated="deactivated",$.Activated="activated",$);let iT={syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3};let Client=class Client{constructor(e,t){var r,n,i;__publicField(this,"id"),__publicField(this,"key"),__publicField(this,"status"),__publicField(this,"attachmentMap"),__publicField(this,"apiKey"),__publicField(this,"syncLoopDuration"),__publicField(this,"reconnectStreamDelay"),__publicField(this,"retrySyncLoopDelay"),__publicField(this,"rpcClient"),t=t||iT,this.key=t.key?t.key:uuid(),this.status="deactivated",this.attachmentMap=new Map,this.apiKey=t.apiKey||"",this.syncLoopDuration=t.syncLoopDuration||iT.syncLoopDuration,this.reconnectStreamDelay=t.reconnectStreamDelay||iT.reconnectStreamDelay,this.retrySyncLoopDelay=t.retrySyncLoopDelay||iT.retrySyncLoopDelay,this.rpcClient=(i=function(e){var t;!function(){try{new Headers}catch(e){throw Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}();let r=null===(t=e.useBinaryFormat)||void 0===t||t;return{async unary(t,n,i,o,s,a,l){var u;let{serialize:d,parse:c}=createClientMethodSerializers(n,r,e.jsonOptions,e.binaryOptions);return o=void 0===o?e.defaultTimeoutMs:o<=0?void 0:o,await function(e){let t=applyInterceptors(e.next,e.interceptors),[r,n,i]=setupSignal(e),o=Object.assign(Object.assign({},e.req),{message:normalize(e.req.method.I,e.req.message),signal:r});return t(o).then(e=>(i(),e),n)}({interceptors:e.interceptors,signal:i,timeoutMs:o,req:{stream:!1,service:t,method:n,url:createMethodUrl(e.baseUrl,t,n),init:{method:"POST",credentials:null!==(u=e.credentials)&&void 0!==u?u:"same-origin",redirect:"error",mode:"cors"},header:requestHeader(r,o,s,!1),contextValues:null!=l?l:createContextValues(),message:a},next:async t=>{var r;let n,i;let o=null!==(r=e.fetch)&&void 0!==r?r:globalThis.fetch,s=await o(t.url,Object.assign(Object.assign({},t.init),{headers:t.header,signal:t.signal,body:encodeEnvelope(0,d(t.message))}));if(validateResponse(s.status,s.headers),!s.body)throw"missing response body";let a=createEnvelopeReadableStream(s.body).getReader();for(;;){let e=await a.read();if(e.done)break;let{flags:t,data:r}=e.value;if(128===t){if(void 0!==n)throw"extra trailer";n=trailerParse(r);continue}if(void 0!==i)throw"extra message";i=c(r)}if(void 0===n)throw"missing trailer";if(validateTrailer(n,s.headers),void 0===i)throw"missing message";return{stream:!1,header:s.headers,message:i,trailer:n}}})},async stream(t,n,i,o,s,a,l){var u;let{serialize:d,parse:c}=createClientMethodSerializers(n,r,e.jsonOptions,e.binaryOptions);async function createRequestBody(e){if(n.kind!=z.ServerStreaming)throw"The fetch API does not support streaming request bodies";let t=await e[Symbol.asyncIterator]().next();if(!0==t.done)throw"missing request message";return encodeEnvelope(0,d(t.value))}return o=void 0===o?e.defaultTimeoutMs:o<=0?void 0:o,function(e){let t=applyInterceptors(e.next,e.interceptors),[r,n,i]=setupSignal(e),o=Object.assign(Object.assign({},e.req),{message:function(e,t){function transform(t){return!0===t.done?t:{done:t.done,value:normalize(e,t.value)}}return{[Symbol.asyncIterator](){let e=t[Symbol.asyncIterator](),r={next:()=>e.next().then(transform)};return void 0!==e.throw&&(r.throw=t=>e.throw(t).then(transform)),void 0!==e.return&&(r.return=t=>e.return(t).then(transform)),r}}}(e.req.method.I,e.req.message),signal:r}),s=!1;return r.addEventListener("abort",function(){var t,r;let n=e.req.message[Symbol.asyncIterator]();s||null===(t=n.throw)||void 0===t||t.call(n,this.reason).catch(()=>{}),null===(r=n.return)||void 0===r||r.call(n).catch(()=>{})}),t(o).then(e=>Object.assign(Object.assign({},e),{message:{[Symbol.asyncIterator](){let t=e.message[Symbol.asyncIterator]();return{next:()=>t.next().then(e=>(!0==e.done&&(s=!0,i()),e),n)}}}}),n)}({interceptors:e.interceptors,signal:i,timeoutMs:o,req:{stream:!0,service:t,method:n,url:createMethodUrl(e.baseUrl,t,n),init:{method:"POST",credentials:null!==(u=e.credentials)&&void 0!==u?u:"same-origin",redirect:"error",mode:"cors"},header:requestHeader(r,o,s,!1),contextValues:null!=l?l:createContextValues(),message:a},next:async t=>{var r;let n=null!==(r=e.fetch)&&void 0!==r?r:globalThis.fetch,i=await n(t.url,Object.assign(Object.assign({},t.init),{headers:t.header,signal:t.signal,body:await createRequestBody(t.message)})),{foundStatus:o}=validateResponse(i.status,i.headers);if(!i.body)throw"missing response body";let s=new Headers,a=Object.assign(Object.assign({},t),{header:i.headers,trailer:s,message:function(e,t,r,n){return e5(this,arguments,function*(){let i=createEnvelopeReadableStream(e).getReader();if(t){if(!(yield e9(i.read())).done)throw"extra data for trailers-only";return yield e9(void 0)}let o=!1;for(;;){let e=yield e9(i.read());if(e.done)break;let{flags:t,data:s}=e.value;if((128&t)==128){if(o)throw"extra trailer";o=!0;let e=trailerParse(s);validateTrailer(e,n),e.forEach((e,t)=>r.set(t,e));continue}if(o)throw"extra message";yield yield e9(c(s))}if(!o)throw"missing trailer"})}(i.body,o,s,i.headers)});return a}})}}}({baseUrl:e,interceptors:[(r=t.apiKey,n=t.token,e=>async t=>(r&&t.header.set("x-api-key",r),n&&t.header.set("authorization",n),await e(t))),e=>async t=>(t.header.set("x-yorkie-user-agent","yorkie-js-sdk/0.4.21"),await e(t))]}),function(e,t){let r={};for(let[n,i]of Object.entries(e.methods)){let o=t(Object.assign(Object.assign({},i),{localName:n,service:e}));null!=o&&(r[n]=o)}return r}(nC,e=>{switch(e.kind){case z.Unary:return async function(t,r){var n,o;let s=await i.unary(nC,e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,t,null==r?void 0:r.contextValues);return null===(n=null==r?void 0:r.onHeader)||void 0===n||n.call(r,s.header),null===(o=null==r?void 0:r.onTrailer)||void 0===o||o.call(r,s.trailer),s.message};case z.ServerStreaming:return function(t,r){return handleStreamResponse(i.stream(nC,e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,function(e){return eZ(this,arguments,function*(){yield eX((yield*eQ(eH(e))))})}([t]),null==r?void 0:r.contextValues),r)};case z.ClientStreaming:return async function(t,r){let n;let o=await i.stream(nC,e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,t,null==r?void 0:r.contextValues);null===(d=null==r?void 0:r.onHeader)||void 0===d||d.call(r,o.header);try{for(var s,a,l,u,d,c,h,m=!0,p=e0(o.message);!(s=(h=await p.next()).done);m=!0)u=h.value,m=!1,n=u}catch(e){a={error:e}}finally{try{!m&&!s&&(l=p.return)&&await l.call(p)}finally{if(a)throw a.error}}if(!n)throw new ConnectError("protocol error: missing response message",q.Internal);return null===(c=null==r?void 0:r.onTrailer)||void 0===c||c.call(r,o.trailer),n};case z.BiDiStreaming:return function(t,r){return handleStreamResponse(i.stream(nC,e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,t,null==r?void 0:r.contextValues),r)};default:return null}}))}activate(){return this.isActive()?Promise.resolve():this.rpcClient.activateClient({clientKey:this.key},{headers:{"x-shard-key":this.apiKey}}).then(e=>{this.id=e.clientId,this.status="activated",this.runSyncLoop(),n6.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`)}).catch(e=>{throw n6.error(`[AC] c:"${this.getKey()}" err :`,e),e})}deactivate(){if("deactivated"===this.status)return Promise.resolve();for(let[e]of this.attachmentMap)this.detachInternal(e);return this.rpcClient.deactivateClient({clientId:this.id},{headers:{"x-shard-key":this.apiKey}}).then(()=>{this.status="deactivated",n6.info(`[DC] c"${this.getKey()}" deactivated`)}).catch(e=>{throw n6.error(`[DC] c:"${this.getKey()}" err :`,e),e})}attach(e,t={}){if(!this.isActive())throw new YorkieError(nH.ClientNotActive,`${this.key} is not active`);if(e.getStatus()!==id.Detached)throw new YorkieError(nH.DocumentNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((e,r)=>r.set(t.initialPresence||{}));let r=t.syncMode??"realtime";return this.rpcClient.attachDocument({clientId:this.id,changePack:ii.toChangePack(e.createChangePack())},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(async t=>{let n=ii.fromChangePack(t.changePack);return e.applyChangePack(n),e.getStatus()===id.Removed||(e.applyStatus(id.Attached),this.attachmentMap.set(e.getKey(),new Attachment(this.reconnectStreamDelay,e,t.documentId,r)),"manual"!==r&&await this.runWatchLoop(e.getKey()),n6.info(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`)),e}).catch(e=>{throw n6.error(`[AD] c:"${this.getKey()}" err :`,e),e})}detach(e,t={}){if(!this.isActive())throw new YorkieError(nH.ClientNotActive,`${this.key} is not active`);let r=this.attachmentMap.get(e.getKey());if(!r)throw new YorkieError(nH.DocumentNotAttached,`${e.getKey()} is not attached`);return e.update((e,t)=>t.clear()),this.rpcClient.detachDocument({clientId:this.id,documentId:r.docID,changePack:ii.toChangePack(e.createChangePack()),removeIfNotAttached:t.removeIfNotAttached??!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(t=>{let r=ii.fromChangePack(t.changePack);return e.applyChangePack(r),e.getStatus()!==id.Removed&&e.applyStatus(id.Detached),this.detachInternal(e.getKey()),n6.info(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}).catch(e=>{throw n6.error(`[DD] c:"${this.getKey()}" err :`,e),e})}async changeSyncMode(e,t){if(!this.isActive())throw new YorkieError(nH.ClientNotActive,`${this.key} is not active`);let r=this.attachmentMap.get(e.getKey());if(!r)throw new YorkieError(nH.DocumentNotAttached,`${e.getKey()} is not attached`);let n=r.syncMode;return n===t||((r.changeSyncMode(t),"manual"===t)?r.cancelWatchStream():("realtime"===t&&(r.remoteChangeEventReceived=!0),"manual"===n&&await this.runWatchLoop(e.getKey()))),e}sync(e){if(!this.isActive())throw new YorkieError(nH.ClientNotActive,`${this.key} is not active`);let t=[];if(e){let r=this.attachmentMap.get(e.getKey());if(!r)throw new YorkieError(nH.DocumentNotAttached,`${e.getKey()} is not attached`);t.push(this.syncInternal(r,"realtime"))}else this.attachmentMap.forEach(e=>{t.push(this.syncInternal(e,e.syncMode))});return Promise.all(t)}remove(e){if(!this.isActive())throw new YorkieError(nH.ClientNotActive,`${this.key} is not active`);let t=this.attachmentMap.get(e.getKey());if(!t)throw new YorkieError(nH.DocumentNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);let r=ii.toChangePack(e.createChangePack());return r.isRemoved=!0,this.rpcClient.removeDocument({clientId:this.id,documentId:t.docID,changePack:r},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(t=>{let r=ii.fromChangePack(t.changePack);e.applyChangePack(r),this.detachInternal(e.getKey()),n6.info(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}).catch(e=>{throw n6.error(`[RD] c:"${this.getKey()}" err :`,e),e})}getID(){return this.id}getKey(){return this.key}isActive(){return"activated"===this.status}getStatus(){return this.status}runSyncLoop(){let doLoop=()=>{if(!this.isActive()){n6.debug(`[SL] c:"${this.getKey()}" exit sync loop`);return}let e=[];for(let[,t]of this.attachmentMap)t.needRealtimeSync()&&(t.remoteChangeEventReceived=!1,e.push(this.syncInternal(t,t.syncMode)));Promise.all(e).then(()=>setTimeout(doLoop,this.syncLoopDuration)).catch(e=>{n6.error(`[SL] c:"${this.getKey()}" sync failed:`,e),setTimeout(doLoop,this.retrySyncLoopDelay)})};n6.debug(`[SL] c:"${this.getKey()}" run sync loop`),doLoop()}async runWatchLoop(e){let t=this.attachmentMap.get(e);if(!t)throw new YorkieError(nH.DocumentNotAttached,`${e} is not attached`);return t.runWatchLoop(r=>{if(!this.isActive())return Promise.reject(new YorkieError(nH.ClientNotActive,`${this.key} is not active`));let n=new AbortController,i=this.rpcClient.watchDocument({clientId:this.id,documentId:t.docID},{headers:{"x-shard-key":`${this.apiKey}/${e}`},signal:n.signal});return t.doc.publish([{type:ic.ConnectionChanged,value:ih.Connected}]),n6.info(`[WD] c:"${this.getKey()}" watches d:"${e}"`),new Promise((e,o)=>{let handleStream=async()=>{try{for await(let r of i)this.handleWatchDocumentsResponse(t,r),"initialization"===r.body.case&&e([i,n])}catch(e){t.doc.resetOnlineClients(),t.doc.publish([{type:ic.Initialized,source:n4.Local,value:t.doc.getPresences()}]),t.doc.publish([{type:ic.ConnectionChanged,value:ih.Disconnected}]),n6.debug(`[WD] c:"${this.getKey()}" unwatches`),e instanceof ConnectError&&e.code!=q.Canceled&&r(),o(e)}};handleStream()})})}handleWatchDocumentsResponse(e,t){if("event"===t.body.case&&t.body.value.type===tZ.DOCUMENT_CHANGED){e.remoteChangeEventReceived=!0;return}e.doc.applyWatchStream(t)}detachInternal(e){let t=this.attachmentMap.get(e);t&&(t.cancelWatchStream(),n6.debug(`[WD] c:"${this.getKey()}" unwatches`),this.attachmentMap.delete(e))}syncInternal(e,t){let{doc:r,docID:n}=e,i=r.createChangePack();return this.rpcClient.pushPullChanges({clientId:this.id,documentId:n,changePack:ii.toChangePack(i),pushOnly:"realtime-pushonly"===t},{headers:{"x-shard-key":`${this.apiKey}/${r.getKey()}`}}).then(t=>{let n=ii.fromChangePack(t.changePack);if(n.hasChanges()&&("realtime-pushonly"===e.syncMode||"realtime-syncoff"===e.syncMode))return r;r.applyChangePack(n),e.doc.publish([{type:ic.SyncStatusChanged,value:im.Synced}]),r.getStatus()===id.Removed&&this.detachInternal(r.getKey());let o=r.getKey(),s=n.getChangeSize();return n6.info(`[PP] c:"${this.getKey()}" sync d:"${o}", push:${i.getChangeSize()} pull:${s} cp:${n.getCheckpoint().toTestString()}`),r}).catch(e=>{throw r.publish([{type:ic.SyncStatusChanged,value:im.SyncFailed}]),n6.error(`[PP] c:"${this.getKey()}" err :`,e),e})}};let iy=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),iv={Client,Document,Primitive,Text,Counter,Tree,IntType:ir.IntegerCnt,LongType:ir.LongCnt};"undefined"!=typeof globalThis&&(globalThis.yorkie={Client,Document,Primitive,Text,Counter,Tree,IntType:ir.IntegerCnt,LongType:ir.LongCnt}),e.Change=Change,e.Client=Client,e.ClientStatus=ig,e.Counter=Counter,e.Devtools=iy,e.DocEventType=ic,e.Document=Document,e.DocumentStatus=id,e.DocumentSyncStatus=im,e.EventSourceDevPanel=io,e.EventSourceSDK=is,e.OpSource=n4,e.Primitive=Primitive,e.StreamConnectionStatus=ih,e.SyncMode=ip,e.Text=Text,e.TimeTicket=TimeTicket,e.Tree=Tree,e.converter=ii,e.default=iv,e.setLogLevel=function(e){n3=e},Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}(t)}}]);