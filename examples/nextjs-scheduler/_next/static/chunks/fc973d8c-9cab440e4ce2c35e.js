(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[476],{1083:function(e,t,r){var n=r(8571);/*!
 * 
 * yorkie-js-sdk for building collaborative editing applications.
 *  - Version: v0.4.13
 *  - Date: 2024-01-19T10:43Z
 *  - Homepage: https://yorkie.dev
 *
 * Copyright 2020 The Yorkie Authors. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */e.exports=(()=>{"use strict";var e={646:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let{proto3:n,StringValue:i,Timestamp:o}=r(532),s=n.makeEnum("yorkie.v1.ValueType",[{no:0,name:"VALUE_TYPE_NULL",localName:"NULL"},{no:1,name:"VALUE_TYPE_BOOLEAN",localName:"BOOLEAN"},{no:2,name:"VALUE_TYPE_INTEGER",localName:"INTEGER"},{no:3,name:"VALUE_TYPE_LONG",localName:"LONG"},{no:4,name:"VALUE_TYPE_DOUBLE",localName:"DOUBLE"},{no:5,name:"VALUE_TYPE_STRING",localName:"STRING"},{no:6,name:"VALUE_TYPE_BYTES",localName:"BYTES"},{no:7,name:"VALUE_TYPE_DATE",localName:"DATE"},{no:8,name:"VALUE_TYPE_JSON_OBJECT",localName:"JSON_OBJECT"},{no:9,name:"VALUE_TYPE_JSON_ARRAY",localName:"JSON_ARRAY"},{no:10,name:"VALUE_TYPE_TEXT",localName:"TEXT"},{no:11,name:"VALUE_TYPE_INTEGER_CNT",localName:"INTEGER_CNT"},{no:12,name:"VALUE_TYPE_LONG_CNT",localName:"LONG_CNT"},{no:13,name:"VALUE_TYPE_TREE",localName:"TREE"}]),a=n.makeEnum("yorkie.v1.DocEventType",[{no:0,name:"DOC_EVENT_TYPE_DOCUMENT_CHANGED",localName:"DOCUMENT_CHANGED"},{no:1,name:"DOC_EVENT_TYPE_DOCUMENT_WATCHED",localName:"DOCUMENT_WATCHED"},{no:2,name:"DOC_EVENT_TYPE_DOCUMENT_UNWATCHED",localName:"DOCUMENT_UNWATCHED"},{no:3,name:"DOC_EVENT_TYPE_DOCUMENT_BROADCAST",localName:"DOCUMENT_BROADCAST"}]),l=n.makeMessageType("yorkie.v1.Snapshot",()=>[{no:1,name:"root",kind:"message",T:b},{no:2,name:"presences",kind:"map",K:9,V:{kind:"message",T:K}}]),u=n.makeMessageType("yorkie.v1.ChangePack",()=>[{no:1,name:"document_key",kind:"scalar",T:9},{no:2,name:"checkpoint",kind:"message",T:z},{no:3,name:"snapshot",kind:"scalar",T:12},{no:4,name:"changes",kind:"message",T:d,repeated:!0},{no:5,name:"min_synced_ticket",kind:"message",T:H},{no:6,name:"is_removed",kind:"scalar",T:8}]),d=n.makeMessageType("yorkie.v1.Change",()=>[{no:1,name:"id",kind:"message",T:c},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"operations",kind:"message",T:h,repeated:!0},{no:4,name:"presence_change",kind:"message",T:G}]),c=n.makeMessageType("yorkie.v1.ChangeID",()=>[{no:1,name:"client_seq",kind:"scalar",T:13},{no:2,name:"server_seq",kind:"scalar",T:3,L:1},{no:3,name:"lamport",kind:"scalar",T:3,L:1},{no:4,name:"actor_id",kind:"scalar",T:12}]),h=n.makeMessageType("yorkie.v1.Operation",()=>[{no:1,name:"set",kind:"message",T:m,oneof:"body"},{no:2,name:"add",kind:"message",T:f,oneof:"body"},{no:3,name:"move",kind:"message",T:p,oneof:"body"},{no:4,name:"remove",kind:"message",T:g,oneof:"body"},{no:5,name:"edit",kind:"message",T:T,oneof:"body"},{no:6,name:"select",kind:"message",T:y,oneof:"body"},{no:7,name:"style",kind:"message",T:v,oneof:"body"},{no:8,name:"increase",kind:"message",T:S,oneof:"body"},{no:9,name:"tree_edit",kind:"message",T:E,oneof:"body"},{no:10,name:"tree_style",kind:"message",T:w,oneof:"body"}]),m=n.makeMessageType("yorkie.v1.Operation.Set",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"value",kind:"message",T:N},{no:4,name:"executed_at",kind:"message",T:H}],{localName:"Operation_Set"}),f=n.makeMessageType("yorkie.v1.Operation.Add",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"prev_created_at",kind:"message",T:H},{no:3,name:"value",kind:"message",T:N},{no:4,name:"executed_at",kind:"message",T:H}],{localName:"Operation_Add"}),p=n.makeMessageType("yorkie.v1.Operation.Move",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"prev_created_at",kind:"message",T:H},{no:3,name:"created_at",kind:"message",T:H},{no:4,name:"executed_at",kind:"message",T:H}],{localName:"Operation_Move"}),g=n.makeMessageType("yorkie.v1.Operation.Remove",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"created_at",kind:"message",T:H},{no:3,name:"executed_at",kind:"message",T:H}],{localName:"Operation_Remove"}),T=n.makeMessageType("yorkie.v1.Operation.Edit",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"from",kind:"message",T:W},{no:3,name:"to",kind:"message",T:W},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:H}},{no:5,name:"content",kind:"scalar",T:9},{no:6,name:"executed_at",kind:"message",T:H},{no:7,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"Operation_Edit"}),y=n.makeMessageType("yorkie.v1.Operation.Select",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"from",kind:"message",T:W},{no:3,name:"to",kind:"message",T:W},{no:4,name:"executed_at",kind:"message",T:H}],{localName:"Operation_Select"}),v=n.makeMessageType("yorkie.v1.Operation.Style",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"from",kind:"message",T:W},{no:3,name:"to",kind:"message",T:W},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:H},{no:6,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:H}}],{localName:"Operation_Style"}),S=n.makeMessageType("yorkie.v1.Operation.Increase",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"value",kind:"message",T:N},{no:3,name:"executed_at",kind:"message",T:H}],{localName:"Operation_Increase"}),E=n.makeMessageType("yorkie.v1.Operation.TreeEdit",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"from",kind:"message",T:M},{no:3,name:"to",kind:"message",T:M},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:H}},{no:5,name:"contents",kind:"message",T:B,repeated:!0},{no:7,name:"split_level",kind:"scalar",T:5},{no:6,name:"executed_at",kind:"message",T:H}],{localName:"Operation_TreeEdit"}),w=n.makeMessageType("yorkie.v1.Operation.TreeStyle",()=>[{no:1,name:"parent_created_at",kind:"message",T:H},{no:2,name:"from",kind:"message",T:M},{no:3,name:"to",kind:"message",T:M},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:H}],{localName:"Operation_TreeStyle"}),N=n.makeMessageType("yorkie.v1.JSONElementSimple",()=>[{no:1,name:"created_at",kind:"message",T:H},{no:2,name:"moved_at",kind:"message",T:H},{no:3,name:"removed_at",kind:"message",T:H},{no:4,name:"type",kind:"enum",T:n.getEnumType(s)},{no:5,name:"value",kind:"scalar",T:12}]),b=n.makeMessageType("yorkie.v1.JSONElement",()=>[{no:1,name:"json_object",kind:"message",T:I,oneof:"body"},{no:2,name:"json_array",kind:"message",T:k,oneof:"body"},{no:3,name:"primitive",kind:"message",T:O,oneof:"body"},{no:5,name:"text",kind:"message",T:D,oneof:"body"},{no:6,name:"counter",kind:"message",T:A,oneof:"body"},{no:7,name:"tree",kind:"message",T:_,oneof:"body"}]),I=n.makeMessageType("yorkie.v1.JSONElement.JSONObject",()=>[{no:1,name:"nodes",kind:"message",T:P,repeated:!0},{no:2,name:"created_at",kind:"message",T:H},{no:3,name:"moved_at",kind:"message",T:H},{no:4,name:"removed_at",kind:"message",T:H}],{localName:"JSONElement_JSONObject"}),k=n.makeMessageType("yorkie.v1.JSONElement.JSONArray",()=>[{no:1,name:"nodes",kind:"message",T:C,repeated:!0},{no:2,name:"created_at",kind:"message",T:H},{no:3,name:"moved_at",kind:"message",T:H},{no:4,name:"removed_at",kind:"message",T:H}],{localName:"JSONElement_JSONArray"}),O=n.makeMessageType("yorkie.v1.JSONElement.Primitive",()=>[{no:1,name:"type",kind:"enum",T:n.getEnumType(s)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:H},{no:4,name:"moved_at",kind:"message",T:H},{no:5,name:"removed_at",kind:"message",T:H}],{localName:"JSONElement_Primitive"}),D=n.makeMessageType("yorkie.v1.JSONElement.Text",()=>[{no:1,name:"nodes",kind:"message",T:x,repeated:!0},{no:2,name:"created_at",kind:"message",T:H},{no:3,name:"moved_at",kind:"message",T:H},{no:4,name:"removed_at",kind:"message",T:H}],{localName:"JSONElement_Text"}),A=n.makeMessageType("yorkie.v1.JSONElement.Counter",()=>[{no:1,name:"type",kind:"enum",T:n.getEnumType(s)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:H},{no:4,name:"moved_at",kind:"message",T:H},{no:5,name:"removed_at",kind:"message",T:H}],{localName:"JSONElement_Counter"}),_=n.makeMessageType("yorkie.v1.JSONElement.Tree",()=>[{no:1,name:"nodes",kind:"message",T:L,repeated:!0},{no:2,name:"created_at",kind:"message",T:H},{no:3,name:"moved_at",kind:"message",T:H},{no:4,name:"removed_at",kind:"message",T:H}],{localName:"JSONElement_Tree"}),P=n.makeMessageType("yorkie.v1.RHTNode",()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"element",kind:"message",T:b}]),C=n.makeMessageType("yorkie.v1.RGANode",()=>[{no:1,name:"next",kind:"message",T:C},{no:2,name:"element",kind:"message",T:b}]),R=n.makeMessageType("yorkie.v1.NodeAttr",()=>[{no:1,name:"value",kind:"scalar",T:9},{no:2,name:"updated_at",kind:"message",T:H}]),x=n.makeMessageType("yorkie.v1.TextNode",()=>[{no:1,name:"id",kind:"message",T:F},{no:2,name:"value",kind:"scalar",T:9},{no:3,name:"removed_at",kind:"message",T:H},{no:4,name:"ins_prev_id",kind:"message",T:F},{no:5,name:"attributes",kind:"map",K:9,V:{kind:"message",T:R}}]),F=n.makeMessageType("yorkie.v1.TextNodeID",()=>[{no:1,name:"created_at",kind:"message",T:H},{no:2,name:"offset",kind:"scalar",T:5}]),L=n.makeMessageType("yorkie.v1.TreeNode",()=>[{no:1,name:"id",kind:"message",T:V},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9},{no:4,name:"removed_at",kind:"message",T:H},{no:5,name:"ins_prev_id",kind:"message",T:V},{no:6,name:"ins_next_id",kind:"message",T:V},{no:7,name:"depth",kind:"scalar",T:5},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:R}}]),B=n.makeMessageType("yorkie.v1.TreeNodes",()=>[{no:1,name:"content",kind:"message",T:L,repeated:!0}]),V=n.makeMessageType("yorkie.v1.TreeNodeID",()=>[{no:1,name:"created_at",kind:"message",T:H},{no:2,name:"offset",kind:"scalar",T:5}]),M=n.makeMessageType("yorkie.v1.TreePos",()=>[{no:1,name:"parent_id",kind:"message",T:V},{no:2,name:"left_sibling_id",kind:"message",T:V}]),J=n.makeMessageType("yorkie.v1.User",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"created_at",kind:"message",T:o}]),U=n.makeMessageType("yorkie.v1.Project",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"public_key",kind:"scalar",T:9},{no:4,name:"secret_key",kind:"scalar",T:9},{no:5,name:"auth_webhook_url",kind:"scalar",T:9},{no:6,name:"auth_webhook_methods",kind:"scalar",T:9,repeated:!0},{no:7,name:"client_deactivate_threshold",kind:"scalar",T:9},{no:8,name:"created_at",kind:"message",T:o},{no:9,name:"updated_at",kind:"message",T:o}]),j=n.makeMessageType("yorkie.v1.UpdatableProjectFields",()=>[{no:1,name:"name",kind:"message",T:i},{no:2,name:"auth_webhook_url",kind:"message",T:i},{no:3,name:"auth_webhook_methods",kind:"message",T:$},{no:4,name:"client_deactivate_threshold",kind:"message",T:i}]),$=n.makeMessageType("yorkie.v1.UpdatableProjectFields.AuthWebhookMethods",()=>[{no:1,name:"methods",kind:"scalar",T:9,repeated:!0}],{localName:"UpdatableProjectFields_AuthWebhookMethods"}),q=n.makeMessageType("yorkie.v1.DocumentSummary",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"snapshot",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:o},{no:5,name:"accessed_at",kind:"message",T:o},{no:6,name:"updated_at",kind:"message",T:o}]),G=n.makeMessageType("yorkie.v1.PresenceChange",()=>[{no:1,name:"type",kind:"enum",T:n.getEnumType(Y)},{no:2,name:"presence",kind:"message",T:K}]),Y=n.makeEnum("yorkie.v1.PresenceChange.ChangeType",[{no:0,name:"CHANGE_TYPE_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"CHANGE_TYPE_PUT",localName:"PUT"},{no:2,name:"CHANGE_TYPE_DELETE",localName:"DELETE"},{no:3,name:"CHANGE_TYPE_CLEAR",localName:"CLEAR"}]),K=n.makeMessageType("yorkie.v1.Presence",()=>[{no:1,name:"data",kind:"map",K:9,V:{kind:"scalar",T:9}}]),z=n.makeMessageType("yorkie.v1.Checkpoint",()=>[{no:1,name:"server_seq",kind:"scalar",T:3,L:1},{no:2,name:"client_seq",kind:"scalar",T:13}]),W=n.makeMessageType("yorkie.v1.TextNodePos",()=>[{no:1,name:"created_at",kind:"message",T:H},{no:2,name:"offset",kind:"scalar",T:5},{no:3,name:"relative_offset",kind:"scalar",T:5}]),H=n.makeMessageType("yorkie.v1.TimeTicket",()=>[{no:1,name:"lamport",kind:"scalar",T:3,L:1},{no:2,name:"delimiter",kind:"scalar",T:13},{no:3,name:"actor_id",kind:"scalar",T:12}]),X=n.makeMessageType("yorkie.v1.DocEventBody",()=>[{no:1,name:"topic",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12}]),Z=n.makeMessageType("yorkie.v1.DocEvent",()=>[{no:1,name:"type",kind:"enum",T:n.getEnumType(a)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"body",kind:"message",T:X}]);t.ValueType=s,t.DocEventType=a,t.Snapshot=l,t.ChangePack=u,t.Change=d,t.ChangeID=c,t.Operation=h,t.Operation_Set=m,t.Operation_Add=f,t.Operation_Move=p,t.Operation_Remove=g,t.Operation_Edit=T,t.Operation_Select=y,t.Operation_Style=v,t.Operation_Increase=S,t.Operation_TreeEdit=E,t.Operation_TreeStyle=w,t.JSONElementSimple=N,t.JSONElement=b,t.JSONElement_JSONObject=I,t.JSONElement_JSONArray=k,t.JSONElement_Primitive=O,t.JSONElement_Text=D,t.JSONElement_Counter=A,t.JSONElement_Tree=_,t.RHTNode=P,t.RGANode=C,t.NodeAttr=R,t.TextNode=x,t.TextNodeID=F,t.TreeNode=L,t.TreeNodes=B,t.TreeNodeID=V,t.TreePos=M,t.User=J,t.Project=U,t.UpdatableProjectFields=j,t.UpdatableProjectFields_AuthWebhookMethods=$,t.DocumentSummary=q,t.PresenceChange=G,t.PresenceChange_ChangeType=Y,t.Presence=K,t.Checkpoint=z,t.TextNodePos=W,t.TimeTicket=H,t.DocEventBody=X,t.DocEvent=Z},295:(e,t,r)=>{let{ActivateClientRequest:n,ActivateClientResponse:i,AttachDocumentRequest:o,AttachDocumentResponse:s,BroadcastRequest:a,BroadcastResponse:l,DeactivateClientRequest:u,DeactivateClientResponse:d,DetachDocumentRequest:c,DetachDocumentResponse:h,PushPullChangesRequest:m,PushPullChangesResponse:f,RemoveDocumentRequest:p,RemoveDocumentResponse:g,WatchDocumentRequest:T,WatchDocumentResponse:y}=r(176),{MethodKind:v}=r(532),S={typeName:"yorkie.v1.YorkieService",methods:{activateClient:{name:"ActivateClient",I:n,O:i,kind:v.Unary},deactivateClient:{name:"DeactivateClient",I:u,O:d,kind:v.Unary},attachDocument:{name:"AttachDocument",I:o,O:s,kind:v.Unary},detachDocument:{name:"DetachDocument",I:c,O:h,kind:v.Unary},removeDocument:{name:"RemoveDocument",I:p,O:g,kind:v.Unary},pushPullChanges:{name:"PushPullChanges",I:m,O:f,kind:v.Unary},watchDocument:{name:"WatchDocument",I:T,O:y,kind:v.ServerStreaming},broadcast:{name:"Broadcast",I:a,O:l,kind:v.Unary}}};t.V=S},176:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let{proto3:n}=r(532),{ChangePack:i,DocEvent:o}=r(646),s=n.makeMessageType("yorkie.v1.ActivateClientRequest",()=>[{no:1,name:"client_key",kind:"scalar",T:9}]),a=n.makeMessageType("yorkie.v1.ActivateClientResponse",()=>[{no:1,name:"client_id",kind:"scalar",T:9}]),l=n.makeMessageType("yorkie.v1.DeactivateClientRequest",()=>[{no:2,name:"client_key",kind:"scalar",T:9},{no:1,name:"client_id",kind:"scalar",T:9}]),u=n.makeMessageType("yorkie.v1.DeactivateClientResponse",[]),d=n.makeMessageType("yorkie.v1.AttachDocumentRequest",()=>[{no:3,name:"client_key",kind:"scalar",T:9},{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:i}]),c=n.makeMessageType("yorkie.v1.AttachDocumentResponse",()=>[{no:1,name:"document_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:i}]),h=n.makeMessageType("yorkie.v1.DetachDocumentRequest",()=>[{no:5,name:"client_key",kind:"scalar",T:9},{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:i},{no:4,name:"remove_if_not_attached",kind:"scalar",T:8}]),m=n.makeMessageType("yorkie.v1.DetachDocumentResponse",()=>[{no:2,name:"change_pack",kind:"message",T:i}]),f=n.makeMessageType("yorkie.v1.WatchDocumentRequest",()=>[{no:4,name:"client_key",kind:"scalar",T:9},{no:1,name:"client_id",kind:"scalar",T:9},{no:3,name:"document_key",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9}]),p=n.makeMessageType("yorkie.v1.WatchDocumentResponse",()=>[{no:1,name:"initialization",kind:"message",T:g,oneof:"body"},{no:2,name:"event",kind:"message",T:o,oneof:"body"}]),g=n.makeMessageType("yorkie.v1.WatchDocumentResponse.Initialization",()=>[{no:1,name:"client_ids",kind:"scalar",T:9,repeated:!0}],{localName:"WatchDocumentResponse_Initialization"}),T=n.makeMessageType("yorkie.v1.RemoveDocumentRequest",()=>[{no:4,name:"client_key",kind:"scalar",T:9},{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:i}]),y=n.makeMessageType("yorkie.v1.RemoveDocumentResponse",()=>[{no:1,name:"change_pack",kind:"message",T:i}]),v=n.makeMessageType("yorkie.v1.PushPullChangesRequest",()=>[{no:5,name:"client_key",kind:"scalar",T:9},{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:i},{no:4,name:"push_only",kind:"scalar",T:8}]),S=n.makeMessageType("yorkie.v1.PushPullChangesResponse",()=>[{no:1,name:"change_pack",kind:"message",T:i}]),E=n.makeMessageType("yorkie.v1.BroadcastRequest",()=>[{no:6,name:"client_key",kind:"scalar",T:9},{no:1,name:"client_id",kind:"scalar",T:9},{no:5,name:"document_key",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}]),w=n.makeMessageType("yorkie.v1.BroadcastResponse",[]);t.ActivateClientRequest=s,t.ActivateClientResponse=a,t.DeactivateClientRequest=l,t.DeactivateClientResponse=u,t.AttachDocumentRequest=d,t.AttachDocumentResponse=c,t.DetachDocumentRequest=h,t.DetachDocumentResponse=m,t.WatchDocumentRequest=f,t.WatchDocumentResponse=p,t.WatchDocumentResponse_Initialization=g,t.RemoveDocumentRequest=T,t.RemoveDocumentResponse=y,t.PushPullChangesRequest=v,t.PushPullChangesResponse=S,t.BroadcastRequest=E,t.BroadcastResponse=w},79:(e,t,r)=>{r.d(t,{Lt:()=>BinaryWriter,TD:()=>i,oP:()=>BinaryReader});var n,i,o=r(818),s=r(120),a=r(210);(n=i||(i={}))[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32";let BinaryWriter=class BinaryWriter{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),r=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],r),r+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for((0,s.fp)(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return(0,s.ug)(e),(0,o.fC)(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){(0,s.E_)(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){(0,s.fp)(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){(0,s.ug)(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return(0,s.ug)(e),e=(e<<1^e>>31)>>>0,(0,o.fC)(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),n=a.q.enc(e);return r.setInt32(0,n.lo,!0),r.setInt32(4,n.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),n=a.q.uEnc(e);return r.setInt32(0,n.lo,!0),r.setInt32(4,n.hi,!0),this.raw(t)}int64(e){let t=a.q.enc(e);return(0,o._y)(t.lo,t.hi,this.buf),this}sint64(e){let t=a.q.enc(e),r=t.hi>>31,n=t.lo<<1^r,i=(t.hi<<1|t.lo>>>31)^r;return(0,o._y)(n,i,this.buf),this}uint64(e){let t=a.q.uEnc(e);return(0,o._y)(t.lo,t.hi,this.buf),this}};let BinaryReader=class BinaryReader{constructor(e,t){this.varint64=o.sg,this.uint32=o.jI,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=7&e;if(t<=0||r<0||r>5)throw Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e){let t=this.pos;switch(e){case i.Varint:for(;128&this.buf[this.pos++];);break;case i.Bit64:this.pos+=4;case i.Bit32:this.pos+=4;break;case i.LengthDelimited:let r=this.uint32();this.pos+=r;break;case i.StartGroup:let n;for(;(n=this.tag()[1])!==i.EndGroup;)this.skip(n);break;default:throw Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return a.q.dec(...this.varint64())}uint64(){return a.q.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(1&e);return e=(e>>>1|(1&t)<<31)^r,t=t>>>1^r,a.q.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return a.q.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return a.q.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}},465:(e,t,r)=>{var n,i,o,s;r.d(t,{p:()=>i,w:()=>n}),(o=n||(n={}))[o.DOUBLE=1]="DOUBLE",o[o.FLOAT=2]="FLOAT",o[o.INT64=3]="INT64",o[o.UINT64=4]="UINT64",o[o.INT32=5]="INT32",o[o.FIXED64=6]="FIXED64",o[o.FIXED32=7]="FIXED32",o[o.BOOL=8]="BOOL",o[o.STRING=9]="STRING",o[o.BYTES=12]="BYTES",o[o.UINT32=13]="UINT32",o[o.SFIXED32=15]="SFIXED32",o[o.SFIXED64=16]="SFIXED64",o[o.SINT32=17]="SINT32",o[o.SINT64=18]="SINT64",(s=i||(i={}))[s.BIGINT=0]="BIGINT",s[s.STRING=1]="STRING"},733:(e,t,r)=>{r.d(t,{I:()=>Any});var n=r(561),i=r(850);let Any=class Any extends n.v{constructor(e){super(),this.typeUrl="",this.value=new Uint8Array(0),i.w.util.initPartial(e,this)}toJson(e){var t;if(""===this.typeUrl)return{};let r=this.typeUrlToName(this.typeUrl),n=null===(t=null==e?void 0:e.typeRegistry)||void 0===t?void 0:t.findMessage(r);if(!n)throw Error(`cannot encode message google.protobuf.Any to JSON: "${this.typeUrl}" is not in the type registry`);let i=n.fromBinary(this.value),o=i.toJson(e);return(r.startsWith("google.protobuf.")||null===o||Array.isArray(o)||"object"!=typeof o)&&(o={value:o}),o["@type"]=this.typeUrl,o}fromJson(e,t){var r;let n;if(null===e||Array.isArray(e)||"object"!=typeof e)throw Error(`cannot decode message google.protobuf.Any from JSON: expected object but got ${null===e?"null":Array.isArray(e)?"array":typeof e}`);if(0==Object.keys(e).length)return this;let i=e["@type"];if("string"!=typeof i||""==i)throw Error('cannot decode message google.protobuf.Any from JSON: "@type" is empty');let o=this.typeUrlToName(i),s=null===(r=null==t?void 0:t.typeRegistry)||void 0===r?void 0:r.findMessage(o);if(!s)throw Error(`cannot decode message google.protobuf.Any from JSON: ${i} is not in the type registry`);if(o.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(e,"value"))n=s.fromJson(e.value,t);else{let r=Object.assign({},e);delete r["@type"],n=s.fromJson(r,t)}return this.packFrom(n),this}packFrom(e){this.value=e.toBinary(),this.typeUrl=this.typeNameToUrl(e.getType().typeName)}unpackTo(e){return!!this.is(e.getType())&&(e.fromBinary(this.value),!0)}unpack(e){if(""===this.typeUrl)return;let t=e.findMessage(this.typeUrlToName(this.typeUrl));if(t)return t.fromBinary(this.value)}is(e){if(""===this.typeUrl)return!1;let t=this.typeUrlToName(this.typeUrl);return t===("string"==typeof e?e:e.typeName)}typeNameToUrl(e){return`type.googleapis.com/${e}`}typeUrlToName(e){if(!e.length)throw Error(`invalid type url: ${e}`);let t=e.lastIndexOf("/"),r=t>=0?e.substring(t+1):e;if(!r.length)throw Error(`invalid type url: ${e}`);return r}static pack(e){let t=new Any;return t.packFrom(e),t}static fromBinary(e,t){return new Any().fromBinary(e,t)}static fromJson(e,t){return new Any().fromJson(e,t)}static fromJsonString(e,t){return new Any().fromJsonString(e,t)}static equals(e,t){return i.w.util.equals(Any,e,t)}};Any.runtime=i.w,Any.typeName="google.protobuf.Any",Any.fields=i.w.util.newFieldList(()=>[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}])},818:(e,t,r)=>{function varint64read(){let e=0,t=0;for(let r=0;r<28;r+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<r,(128&n)==0)return this.assertBounds(),[e,t]}let r=this.buf[this.pos++];if(e|=(15&r)<<28,t=(112&r)>>4,(128&r)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<r,(128&n)==0)return this.assertBounds(),[e,t]}throw Error("invalid varint")}function varint64write(e,t,r){for(let n=0;n<28;n+=7){let i=e>>>n,o=!(i>>>7==0&&0==t),s=(o?128|i:i)&255;if(r.push(s),!o)return}let n=e>>>28&15|(7&t)<<4,i=t>>3!=0;if(r.push((i?128|n:n)&255),i){for(let e=3;e<31;e+=7){let n=t>>>e,i=n>>>7!=0,o=(i?128|n:n)&255;if(r.push(o),!i)return}r.push(t>>>31&1)}}function int64FromString(e){let t="-"===e[0];t&&(e=e.slice(1));let r=0,n=0;function add1e6digit(t,i){let o=Number(e.slice(t,i));n*=1e6,(r=1e6*r+o)>=4294967296&&(n+=r/4294967296|0,r%=4294967296)}return add1e6digit(-24,-18),add1e6digit(-18,-12),add1e6digit(-12,-6),add1e6digit(-6),t?negate(r,n):newBits(r,n)}function int64ToString(e,t){let r=newBits(e,t),n=2147483648&r.hi;n&&(r=negate(r.lo,r.hi));let i=uInt64ToString(r.lo,r.hi);return n?"-"+i:i}function uInt64ToString(e,t){if({lo:e,hi:t}={lo:e>>>0,hi:t>>>0},t<=2097151)return String(4294967296*t+e);let r=16777215&e,n=(e>>>24|t<<8)&16777215,i=t>>16&65535,o=r+6777216*n+6710656*i,s=n+8147497*i,a=2*i;return o>=1e7&&(s+=Math.floor(o/1e7),o%=1e7),s>=1e7&&(a+=Math.floor(s/1e7),s%=1e7),a.toString()+decimalFrom1e7WithLeadingZeros(s)+decimalFrom1e7WithLeadingZeros(o)}function newBits(e,t){return{lo:0|e,hi:0|t}}function negate(e,t){return t=~t,e?e=~e+1:t+=1,newBits(e,t)}r.d(t,{Ak:()=>int64ToString,CZ:()=>int64FromString,Fd:()=>uInt64ToString,_y:()=>varint64write,fC:()=>varint32write,jI:()=>varint32read,sg:()=>varint64read});let decimalFrom1e7WithLeadingZeros=e=>{let t=String(e);return"0000000".slice(t.length)+t};function varint32write(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let r=0;r<9;r++)t.push(127&e|128),e>>=7;t.push(1)}}function varint32read(){let e=this.buf[this.pos++],t=127&e;if((128&e)==0||(t|=(127&(e=this.buf[this.pos++]))<<7,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<14,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<21,(128&e)==0))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(let t=5;(128&e)!=0&&t<10;t++)e=this.buf[this.pos++];if((128&e)!=0)throw Error("invalid varint");return this.assertBounds(),t>>>0}},532:(e,t,r)=>{r.r(t),r.d(t,{Any:()=>ev.I,Api:()=>Api,BinaryReader:()=>ed.oP,BinaryWriter:()=>ed.Lt,BoolValue:()=>BoolValue,BytesValue:()=>BytesValue,CodeGeneratorRequest:()=>CodeGeneratorRequest,CodeGeneratorResponse:()=>CodeGeneratorResponse,CodeGeneratorResponse_Feature:()=>G,CodeGeneratorResponse_File:()=>CodeGeneratorResponse_File,DescriptorProto:()=>DescriptorProto,DescriptorProto_ExtensionRange:()=>DescriptorProto_ExtensionRange,DescriptorProto_ReservedRange:()=>DescriptorProto_ReservedRange,DoubleValue:()=>DoubleValue,Duration:()=>Duration,Edition:()=>k,Empty:()=>Empty,Enum:()=>Enum,EnumDescriptorProto:()=>EnumDescriptorProto,EnumDescriptorProto_EnumReservedRange:()=>EnumDescriptorProto_EnumReservedRange,EnumOptions:()=>EnumOptions,EnumValue:()=>EnumValue,EnumValueDescriptorProto:()=>EnumValueDescriptorProto,EnumValueOptions:()=>EnumValueOptions,ExtensionRangeOptions:()=>ExtensionRangeOptions,ExtensionRangeOptions_Declaration:()=>ExtensionRangeOptions_Declaration,ExtensionRangeOptions_VerificationState:()=>O,FeatureSet:()=>FeatureSet,FeatureSetDefaults:()=>FeatureSetDefaults,FeatureSetDefaults_FeatureSetEditionDefault:()=>FeatureSetDefaults_FeatureSetEditionDefault,FeatureSet_EnumType:()=>B,FeatureSet_FieldPresence:()=>L,FeatureSet_JsonFormat:()=>U,FeatureSet_MessageEncoding:()=>J,FeatureSet_RepeatedFieldEncoding:()=>V,FeatureSet_Utf8Validation:()=>M,Field:()=>Field,FieldDescriptorProto:()=>FieldDescriptorProto,FieldDescriptorProto_Label:()=>A,FieldDescriptorProto_Type:()=>D,FieldMask:()=>FieldMask,FieldOptions:()=>FieldOptions,FieldOptions_CType:()=>P,FieldOptions_EditionDefault:()=>FieldOptions_EditionDefault,FieldOptions_JSType:()=>C,FieldOptions_OptionRetention:()=>R,FieldOptions_OptionTargetType:()=>x,Field_Cardinality:()=>z,Field_Kind:()=>K,FileDescriptorProto:()=>FileDescriptorProto,FileDescriptorSet:()=>FileDescriptorSet,FileOptions:()=>FileOptions,FileOptions_OptimizeMode:()=>_,FloatValue:()=>FloatValue,GeneratedCodeInfo:()=>GeneratedCodeInfo,GeneratedCodeInfo_Annotation:()=>GeneratedCodeInfo_Annotation,GeneratedCodeInfo_Annotation_Semantic:()=>j,Int32Value:()=>Int32Value,Int64Value:()=>Int64Value,ListValue:()=>ListValue,LongType:()=>X.p,Message:()=>ep.v,MessageOptions:()=>MessageOptions,Method:()=>Method,MethodDescriptorProto:()=>MethodDescriptorProto,MethodIdempotency:()=>eg.w,MethodKind:()=>eg.t,MethodOptions:()=>MethodOptions,MethodOptions_IdempotencyLevel:()=>F,Mixin:()=>Mixin,NullValue:()=>q,OneofDescriptorProto:()=>OneofDescriptorProto,OneofOptions:()=>OneofOptions,Option:()=>Option,ScalarType:()=>X.w,ServiceDescriptorProto:()=>ServiceDescriptorProto,ServiceOptions:()=>ServiceOptions,SourceCodeInfo:()=>SourceCodeInfo,SourceCodeInfo_Location:()=>SourceCodeInfo_Location,SourceContext:()=>SourceContext,StringValue:()=>StringValue,Struct:()=>Struct,Syntax:()=>Y,Timestamp:()=>Timestamp,Type:()=>Type,UInt32Value:()=>UInt32Value,UInt64Value:()=>UInt64Value,UninterpretedOption:()=>UninterpretedOption,UninterpretedOption_NamePart:()=>UninterpretedOption_NamePart,Value:()=>Value,Version:()=>Version,WireType:()=>ed.TD,codegenInfo:()=>ef,createDescriptorSet:()=>createDescriptorSet,createRegistry:()=>createRegistry,createRegistryFromDescriptors:()=>createRegistryFromDescriptors,proto2:()=>es,proto3:()=>W.w,protoBase64:()=>eu.W,protoDelimited:()=>ec,protoDouble:()=>ea,protoInt64:()=>el.q,toPlainMessage:()=>toPlainMessage});var n,i,o,s,a,l,u,d,c,h,m,f,p,g,T,y,v,S,E,w,N,b,I,k,O,D,A,_,P,C,R,x,F,L,B,V,M,J,U,j,$,q,G,Y,K,z,W=r(850),H=r(493),X=r(465),Z=r(744),Q=r(433),ee=r(501),et=r(215),er=r(504),en=r(432),ei=r(120),eo=r(814);let es=(0,H.F)("proto2",(0,eo.b)((e,t)=>function(r,n,i){if("map"==r.kind){let o={};switch(r.V.kind){case"scalar":for(let[e,i]of Object.entries(n)){let n=t(r.V.T,i,!0);(0,ei.hu)(void 0!==n),o[e.toString()]=n}break;case"message":for(let[e,t]of Object.entries(n))o[e.toString()]=t.toJson(i);break;case"enum":let s=r.V.T;for(let[t,r]of Object.entries(n)){(0,ei.hu)(void 0===r||"number"==typeof r);let n=e(s,r,!0,i.enumAsInteger);(0,ei.hu)(void 0!==n),o[t.toString()]=n}}return i.emitDefaultValues||Object.keys(o).length>0?o:void 0}if(r.repeated){let o=[];switch(r.kind){case"scalar":for(let e=0;e<n.length;e++)o.push(t(r.T,n[e],!0));break;case"enum":for(let t=0;t<n.length;t++)o.push(e(r.T,n[t],!0,i.enumAsInteger));break;case"message":for(let e=0;e<n.length;e++)o.push(n[e].toJson(i))}return i.emitDefaultValues||o.length>0?o:void 0}if(void 0===n){if(!r.oneof&&!r.opt)throw"required field not set";return}switch(r.kind){case"scalar":return t(r.T,n,!0);case"enum":return e(r.T,n,!0,i.enumAsInteger);case"message":return(0,en.E)(r.T,n).toJson(i)}}),Object.assign(Object.assign({},(0,Z.gY)()),{writeMessage(e,t,r){let n;let i=e.getType();try{for(n of i.fields.byNumber()){let o,s=n.repeated,a=n.localName;if(n.oneof){let t=e[n.oneof.localName];if(t.case!==a)continue;o=t.value}else if(o=e[a],void 0===o&&!n.oneof&&!n.opt)throw Error(`cannot encode field ${i.typeName}.${n.name} to binary: required field not set`);switch(n.kind){case"scalar":case"enum":let l="enum"==n.kind?X.w.INT32:n.T;if(s){if(n.packed)(0,Z.Jj)(t,l,n.no,o);else for(let e of o)(0,Z.NN)(t,l,n.no,e,!0)}else void 0!==o&&(0,Z.NN)(t,l,n.no,o,!0);break;case"message":if(s)for(let e of o)(0,Z.oQ)(t,r,n,e);else(0,Z.oQ)(t,r,n,o);break;case"map":for(let[e,i]of Object.entries(o))(0,Z.gQ)(t,r,n,e,i)}}}catch(r){let e=n?`cannot encode field ${i.typeName}.${null==n?void 0:n.name} to binary`:`cannot encode message ${i.typeName} to binary`,t=r instanceof Error?r.message:String(r);throw Error(e+(t.length>0?`: ${t}`:""))}return r.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),Object.assign(Object.assign({},(0,Q.f)()),{newFieldList:e=>new ee.i(e,normalizeFieldInfosProto2),initFields(e){for(let t of e.getType().fields.byMember()){let r=t.localName;if(t.repeated){e[r]=[];continue}switch(t.kind){case"oneof":e[r]={case:void 0};break;case"map":e[r]={}}}}}));function normalizeFieldInfosProto2(e){var t,r,n,i,o;let s;let a=[];for(let l of"function"==typeof e?e():e){if(l.localName=(0,er.Rz)(l.name,void 0!==l.oneof),l.jsonName=null!==(t=l.jsonName)&&void 0!==t?t:(0,er.x1)(l.name),l.repeated=null!==(r=l.repeated)&&void 0!==r&&r,"scalar"==l.kind&&(l.L=null!==(n=l.L)&&void 0!==n?n:X.p.BIGINT),void 0!==l.oneof){let e="string"==typeof l.oneof?l.oneof:l.oneof.name;s&&s.name==e||(s=new et.o(e)),l.oneof=s,s.addField(l)}"message"==l.kind&&(l.delimited=null!==(i=l.delimited)&&void 0!==i&&i),l.packed=null!==(o=l.packed)&&void 0!==o&&o,a.push(l)}return a}let ea={NaN:Number.NaN,POSITIVE_INFINITY:Number.POSITIVE_INFINITY,NEGATIVE_INFINITY:Number.NEGATIVE_INFINITY};var el=r(210),eu=r(236),ed=r(79),__asyncValues=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)},__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},verb("next"),verb("throw"),verb("return",function(e){return function(t){return Promise.resolve(t).then(e,reject)}}),n[Symbol.asyncIterator]=function(){return this},n;function verb(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||resume(e,t)})},t&&(n[e]=t(n[e])))}function resume(e,t){try{var r;(r=i[e](t)).value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(o[0][2],r)}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}};let ec={enc(e,t){let r=(0,Z.gY)().makeWriteOptions(t);return r.writerFactory().bytes(e.toBinary(r)).finish()},dec(e,t,r){let n=(0,Z.gY)().makeReadOptions(r);return e.fromBinary(n.readerFactory(t).bytes(),n)},decStream(e,t){return __asyncGenerator(this,arguments,function*(){var r,n,i,o;let s=new Uint8Array(0);try{for(var a,l=!0,u=__asyncValues(t);!(r=(a=yield __await(u.next())).done);l=!0)for(o=a.value,l=!1,s=function(e,t){let r=new Uint8Array(e.byteLength+t.byteLength);return r.set(e),r.set(t,e.length),r}(s,o);;){let t=ec.peekSize(s);if(t.eof||t.offset+t.size>s.byteLength)break;yield yield __await(ec.dec(e,s)),s=s.subarray(t.offset+t.size)}}catch(e){n={error:e}}finally{try{!l&&!r&&(i=u.return)&&(yield __await(i.call(u)))}finally{if(n)throw n.error}}if(s.byteLength>0)throw Error("incomplete data")})},peekSize(e){let t={eof:!0,size:null,offset:null};for(let r=0;r<10;r++){if(r>e.byteLength)return t;if((128&e[r])==0){let r;let n=new ed.oP(e);try{r=n.uint32()}catch(e){if(e instanceof RangeError)return t;throw e}return{eof:!1,size:r,offset:n.pos}}}throw Error("invalid varint")}};var eh=r(781);let em="@bufbuild/protobuf",ef={packageName:"@bufbuild/protobuf",localName:er.r1,reifyWkt:function(e){switch(e.typeName){case"google.protobuf.Any":{let t=e.fields.find(e=>1==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.STRING),r=e.fields.find(e=>2==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.BYTES);if(t&&r)return{typeName:e.typeName,typeUrl:t,value:r};break}case"google.protobuf.Timestamp":{let t=e.fields.find(e=>1==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.INT64),r=e.fields.find(e=>2==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.INT32);if(t&&r)return{typeName:e.typeName,seconds:t,nanos:r};break}case"google.protobuf.Duration":{let t=e.fields.find(e=>1==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.INT64),r=e.fields.find(e=>2==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.INT32);if(t&&r)return{typeName:e.typeName,seconds:t,nanos:r};break}case"google.protobuf.Struct":{let t=e.fields.find(e=>1==e.number&&!e.repeated);if((null==t?void 0:t.fieldKind)!=="map"||"message"!==t.mapValue.kind||"google.protobuf.Value"!==t.mapValue.message.typeName)break;return{typeName:e.typeName,fields:t}}case"google.protobuf.Value":{let t=e.oneofs.find(e=>"kind"===e.name),r=e.fields.find(e=>1==e.number&&e.oneof===t);if((null==r?void 0:r.fieldKind)!=="enum"||"google.protobuf.NullValue"!==r.enum.typeName)return;let n=e.fields.find(e=>2==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.DOUBLE&&e.oneof===t),i=e.fields.find(e=>3==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.STRING&&e.oneof===t),o=e.fields.find(e=>4==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.BOOL&&e.oneof===t),s=e.fields.find(e=>5==e.number&&e.oneof===t);if((null==s?void 0:s.fieldKind)!=="message"||"google.protobuf.Struct"!==s.message.typeName)return;let a=e.fields.find(e=>6==e.number&&e.oneof===t);if((null==a?void 0:a.fieldKind)!=="message"||"google.protobuf.ListValue"!==a.message.typeName)return;if(t&&n&&i&&o)return{typeName:e.typeName,kind:t,nullValue:r,numberValue:n,stringValue:i,boolValue:o,structValue:s,listValue:a};break}case"google.protobuf.ListValue":{let t=e.fields.find(e=>1==e.number&&e.repeated);if((null==t?void 0:t.fieldKind)!="message"||"google.protobuf.Value"!==t.message.typeName)break;return{typeName:e.typeName,values:t}}case"google.protobuf.FieldMask":{let t=e.fields.find(e=>1==e.number&&"scalar"==e.fieldKind&&e.scalar===X.w.STRING&&e.repeated);if(t)return{typeName:e.typeName,paths:t};break}case"google.protobuf.DoubleValue":case"google.protobuf.FloatValue":case"google.protobuf.Int64Value":case"google.protobuf.UInt64Value":case"google.protobuf.Int32Value":case"google.protobuf.UInt32Value":case"google.protobuf.BoolValue":case"google.protobuf.StringValue":case"google.protobuf.BytesValue":{let t=e.fields.find(e=>1==e.number&&"value"==e.name);if(!t||"scalar"!==t.fieldKind)break;return{typeName:e.typeName,value:t}}}},getUnwrappedFieldType:en.w,scalarDefaultValue:eh.kY,safeIdentifier:er.GD,safeObjectProperty:er.ll,symbols:{proto2:{typeOnly:!1,privateImportPath:"./proto2.js",publicImportPath:em},proto3:{typeOnly:!1,privateImportPath:"./proto3.js",publicImportPath:em},Message:{typeOnly:!1,privateImportPath:"./message.js",publicImportPath:em},PartialMessage:{typeOnly:!0,privateImportPath:"./message.js",publicImportPath:em},PlainMessage:{typeOnly:!0,privateImportPath:"./message.js",publicImportPath:em},FieldList:{typeOnly:!0,privateImportPath:"./field-list.js",publicImportPath:em},MessageType:{typeOnly:!0,privateImportPath:"./message-type.js",publicImportPath:em},BinaryReadOptions:{typeOnly:!0,privateImportPath:"./binary-format.js",publicImportPath:em},BinaryWriteOptions:{typeOnly:!0,privateImportPath:"./binary-format.js",publicImportPath:em},JsonReadOptions:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:em},JsonWriteOptions:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:em},JsonValue:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:em},JsonObject:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:em},protoDouble:{typeOnly:!1,privateImportPath:"./proto-double.js",publicImportPath:em},protoInt64:{typeOnly:!1,privateImportPath:"./proto-int64.js",publicImportPath:em},ScalarType:{typeOnly:!1,privateImportPath:"./field.js",publicImportPath:em},LongType:{typeOnly:!1,privateImportPath:"./field.js",publicImportPath:em},MethodKind:{typeOnly:!1,privateImportPath:"./service-type.js",publicImportPath:em},MethodIdempotency:{typeOnly:!1,privateImportPath:"./service-type.js",publicImportPath:em},IMessageTypeRegistry:{typeOnly:!0,privateImportPath:"./type-registry.js",publicImportPath:em}},wktSourceFiles:["google/protobuf/compiler/plugin.proto","google/protobuf/any.proto","google/protobuf/api.proto","google/protobuf/descriptor.proto","google/protobuf/duration.proto","google/protobuf/empty.proto","google/protobuf/field_mask.proto","google/protobuf/source_context.proto","google/protobuf/struct.proto","google/protobuf/timestamp.proto","google/protobuf/type.proto","google/protobuf/wrappers.proto"]};var ep=r(561),eg=r(328);(n=k||(k={}))[n.EDITION_UNKNOWN=0]="EDITION_UNKNOWN",n[n.EDITION_PROTO2=998]="EDITION_PROTO2",n[n.EDITION_PROTO3=999]="EDITION_PROTO3",n[n.EDITION_2023=1e3]="EDITION_2023",n[n.EDITION_1_TEST_ONLY=1]="EDITION_1_TEST_ONLY",n[n.EDITION_2_TEST_ONLY=2]="EDITION_2_TEST_ONLY",n[n.EDITION_99997_TEST_ONLY=99997]="EDITION_99997_TEST_ONLY",n[n.EDITION_99998_TEST_ONLY=99998]="EDITION_99998_TEST_ONLY",n[n.EDITION_99999_TEST_ONLY=99999]="EDITION_99999_TEST_ONLY",es.util.setEnumType(k,"google.protobuf.Edition",[{no:0,name:"EDITION_UNKNOWN"},{no:998,name:"EDITION_PROTO2"},{no:999,name:"EDITION_PROTO3"},{no:1e3,name:"EDITION_2023"},{no:1,name:"EDITION_1_TEST_ONLY"},{no:2,name:"EDITION_2_TEST_ONLY"},{no:99997,name:"EDITION_99997_TEST_ONLY"},{no:99998,name:"EDITION_99998_TEST_ONLY"},{no:99999,name:"EDITION_99999_TEST_ONLY"}]);let FileDescriptorSet=class FileDescriptorSet extends ep.v{constructor(e){super(),this.file=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new FileDescriptorSet().fromBinary(e,t)}static fromJson(e,t){return new FileDescriptorSet().fromJson(e,t)}static fromJsonString(e,t){return new FileDescriptorSet().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FileDescriptorSet,e,t)}};FileDescriptorSet.runtime=es,FileDescriptorSet.typeName="google.protobuf.FileDescriptorSet",FileDescriptorSet.fields=es.util.newFieldList(()=>[{no:1,name:"file",kind:"message",T:FileDescriptorProto,repeated:!0}]);let FileDescriptorProto=class FileDescriptorProto extends ep.v{constructor(e){super(),this.dependency=[],this.publicDependency=[],this.weakDependency=[],this.messageType=[],this.enumType=[],this.service=[],this.extension=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new FileDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new FileDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new FileDescriptorProto().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FileDescriptorProto,e,t)}};FileDescriptorProto.runtime=es,FileDescriptorProto.typeName="google.protobuf.FileDescriptorProto",FileDescriptorProto.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"package",kind:"scalar",T:9,opt:!0},{no:3,name:"dependency",kind:"scalar",T:9,repeated:!0},{no:10,name:"public_dependency",kind:"scalar",T:5,repeated:!0},{no:11,name:"weak_dependency",kind:"scalar",T:5,repeated:!0},{no:4,name:"message_type",kind:"message",T:DescriptorProto,repeated:!0},{no:5,name:"enum_type",kind:"message",T:EnumDescriptorProto,repeated:!0},{no:6,name:"service",kind:"message",T:ServiceDescriptorProto,repeated:!0},{no:7,name:"extension",kind:"message",T:FieldDescriptorProto,repeated:!0},{no:8,name:"options",kind:"message",T:FileOptions,opt:!0},{no:9,name:"source_code_info",kind:"message",T:SourceCodeInfo,opt:!0},{no:12,name:"syntax",kind:"scalar",T:9,opt:!0},{no:14,name:"edition",kind:"enum",T:es.getEnumType(k),opt:!0}]);let DescriptorProto=class DescriptorProto extends ep.v{constructor(e){super(),this.field=[],this.extension=[],this.nestedType=[],this.enumType=[],this.extensionRange=[],this.oneofDecl=[],this.reservedRange=[],this.reservedName=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new DescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new DescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new DescriptorProto().fromJsonString(e,t)}static equals(e,t){return es.util.equals(DescriptorProto,e,t)}};DescriptorProto.runtime=es,DescriptorProto.typeName="google.protobuf.DescriptorProto",DescriptorProto.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"field",kind:"message",T:FieldDescriptorProto,repeated:!0},{no:6,name:"extension",kind:"message",T:FieldDescriptorProto,repeated:!0},{no:3,name:"nested_type",kind:"message",T:DescriptorProto,repeated:!0},{no:4,name:"enum_type",kind:"message",T:EnumDescriptorProto,repeated:!0},{no:5,name:"extension_range",kind:"message",T:DescriptorProto_ExtensionRange,repeated:!0},{no:8,name:"oneof_decl",kind:"message",T:OneofDescriptorProto,repeated:!0},{no:7,name:"options",kind:"message",T:MessageOptions,opt:!0},{no:9,name:"reserved_range",kind:"message",T:DescriptorProto_ReservedRange,repeated:!0},{no:10,name:"reserved_name",kind:"scalar",T:9,repeated:!0}]);let DescriptorProto_ExtensionRange=class DescriptorProto_ExtensionRange extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new DescriptorProto_ExtensionRange().fromBinary(e,t)}static fromJson(e,t){return new DescriptorProto_ExtensionRange().fromJson(e,t)}static fromJsonString(e,t){return new DescriptorProto_ExtensionRange().fromJsonString(e,t)}static equals(e,t){return es.util.equals(DescriptorProto_ExtensionRange,e,t)}};DescriptorProto_ExtensionRange.runtime=es,DescriptorProto_ExtensionRange.typeName="google.protobuf.DescriptorProto.ExtensionRange",DescriptorProto_ExtensionRange.fields=es.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0},{no:3,name:"options",kind:"message",T:ExtensionRangeOptions,opt:!0}]);let DescriptorProto_ReservedRange=class DescriptorProto_ReservedRange extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new DescriptorProto_ReservedRange().fromBinary(e,t)}static fromJson(e,t){return new DescriptorProto_ReservedRange().fromJson(e,t)}static fromJsonString(e,t){return new DescriptorProto_ReservedRange().fromJsonString(e,t)}static equals(e,t){return es.util.equals(DescriptorProto_ReservedRange,e,t)}};DescriptorProto_ReservedRange.runtime=es,DescriptorProto_ReservedRange.typeName="google.protobuf.DescriptorProto.ReservedRange",DescriptorProto_ReservedRange.fields=es.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0}]);let ExtensionRangeOptions=class ExtensionRangeOptions extends ep.v{constructor(e){super(),this.uninterpretedOption=[],this.declaration=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new ExtensionRangeOptions().fromBinary(e,t)}static fromJson(e,t){return new ExtensionRangeOptions().fromJson(e,t)}static fromJsonString(e,t){return new ExtensionRangeOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(ExtensionRangeOptions,e,t)}};ExtensionRangeOptions.runtime=es,ExtensionRangeOptions.typeName="google.protobuf.ExtensionRangeOptions",ExtensionRangeOptions.fields=es.util.newFieldList(()=>[{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0},{no:2,name:"declaration",kind:"message",T:ExtensionRangeOptions_Declaration,repeated:!0},{no:50,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:3,name:"verification",kind:"enum",T:es.getEnumType(O),opt:!0,default:O.UNVERIFIED}]),(i=O||(O={}))[i.DECLARATION=0]="DECLARATION",i[i.UNVERIFIED=1]="UNVERIFIED",es.util.setEnumType(O,"google.protobuf.ExtensionRangeOptions.VerificationState",[{no:0,name:"DECLARATION"},{no:1,name:"UNVERIFIED"}]);let ExtensionRangeOptions_Declaration=class ExtensionRangeOptions_Declaration extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new ExtensionRangeOptions_Declaration().fromBinary(e,t)}static fromJson(e,t){return new ExtensionRangeOptions_Declaration().fromJson(e,t)}static fromJsonString(e,t){return new ExtensionRangeOptions_Declaration().fromJsonString(e,t)}static equals(e,t){return es.util.equals(ExtensionRangeOptions_Declaration,e,t)}};ExtensionRangeOptions_Declaration.runtime=es,ExtensionRangeOptions_Declaration.typeName="google.protobuf.ExtensionRangeOptions.Declaration",ExtensionRangeOptions_Declaration.fields=es.util.newFieldList(()=>[{no:1,name:"number",kind:"scalar",T:5,opt:!0},{no:2,name:"full_name",kind:"scalar",T:9,opt:!0},{no:3,name:"type",kind:"scalar",T:9,opt:!0},{no:5,name:"reserved",kind:"scalar",T:8,opt:!0},{no:6,name:"repeated",kind:"scalar",T:8,opt:!0}]);let FieldDescriptorProto=class FieldDescriptorProto extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new FieldDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new FieldDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new FieldDescriptorProto().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FieldDescriptorProto,e,t)}};FieldDescriptorProto.runtime=es,FieldDescriptorProto.typeName="google.protobuf.FieldDescriptorProto",FieldDescriptorProto.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:3,name:"number",kind:"scalar",T:5,opt:!0},{no:4,name:"label",kind:"enum",T:es.getEnumType(A),opt:!0},{no:5,name:"type",kind:"enum",T:es.getEnumType(D),opt:!0},{no:6,name:"type_name",kind:"scalar",T:9,opt:!0},{no:2,name:"extendee",kind:"scalar",T:9,opt:!0},{no:7,name:"default_value",kind:"scalar",T:9,opt:!0},{no:9,name:"oneof_index",kind:"scalar",T:5,opt:!0},{no:10,name:"json_name",kind:"scalar",T:9,opt:!0},{no:8,name:"options",kind:"message",T:FieldOptions,opt:!0},{no:17,name:"proto3_optional",kind:"scalar",T:8,opt:!0}]),(o=D||(D={}))[o.DOUBLE=1]="DOUBLE",o[o.FLOAT=2]="FLOAT",o[o.INT64=3]="INT64",o[o.UINT64=4]="UINT64",o[o.INT32=5]="INT32",o[o.FIXED64=6]="FIXED64",o[o.FIXED32=7]="FIXED32",o[o.BOOL=8]="BOOL",o[o.STRING=9]="STRING",o[o.GROUP=10]="GROUP",o[o.MESSAGE=11]="MESSAGE",o[o.BYTES=12]="BYTES",o[o.UINT32=13]="UINT32",o[o.ENUM=14]="ENUM",o[o.SFIXED32=15]="SFIXED32",o[o.SFIXED64=16]="SFIXED64",o[o.SINT32=17]="SINT32",o[o.SINT64=18]="SINT64",es.util.setEnumType(D,"google.protobuf.FieldDescriptorProto.Type",[{no:1,name:"TYPE_DOUBLE"},{no:2,name:"TYPE_FLOAT"},{no:3,name:"TYPE_INT64"},{no:4,name:"TYPE_UINT64"},{no:5,name:"TYPE_INT32"},{no:6,name:"TYPE_FIXED64"},{no:7,name:"TYPE_FIXED32"},{no:8,name:"TYPE_BOOL"},{no:9,name:"TYPE_STRING"},{no:10,name:"TYPE_GROUP"},{no:11,name:"TYPE_MESSAGE"},{no:12,name:"TYPE_BYTES"},{no:13,name:"TYPE_UINT32"},{no:14,name:"TYPE_ENUM"},{no:15,name:"TYPE_SFIXED32"},{no:16,name:"TYPE_SFIXED64"},{no:17,name:"TYPE_SINT32"},{no:18,name:"TYPE_SINT64"}]),(s=A||(A={}))[s.OPTIONAL=1]="OPTIONAL",s[s.REPEATED=3]="REPEATED",s[s.REQUIRED=2]="REQUIRED",es.util.setEnumType(A,"google.protobuf.FieldDescriptorProto.Label",[{no:1,name:"LABEL_OPTIONAL"},{no:3,name:"LABEL_REPEATED"},{no:2,name:"LABEL_REQUIRED"}]);let OneofDescriptorProto=class OneofDescriptorProto extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new OneofDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new OneofDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new OneofDescriptorProto().fromJsonString(e,t)}static equals(e,t){return es.util.equals(OneofDescriptorProto,e,t)}};OneofDescriptorProto.runtime=es,OneofDescriptorProto.typeName="google.protobuf.OneofDescriptorProto",OneofDescriptorProto.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"options",kind:"message",T:OneofOptions,opt:!0}]);let EnumDescriptorProto=class EnumDescriptorProto extends ep.v{constructor(e){super(),this.value=[],this.reservedRange=[],this.reservedName=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new EnumDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new EnumDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new EnumDescriptorProto().fromJsonString(e,t)}static equals(e,t){return es.util.equals(EnumDescriptorProto,e,t)}};EnumDescriptorProto.runtime=es,EnumDescriptorProto.typeName="google.protobuf.EnumDescriptorProto",EnumDescriptorProto.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"value",kind:"message",T:EnumValueDescriptorProto,repeated:!0},{no:3,name:"options",kind:"message",T:EnumOptions,opt:!0},{no:4,name:"reserved_range",kind:"message",T:EnumDescriptorProto_EnumReservedRange,repeated:!0},{no:5,name:"reserved_name",kind:"scalar",T:9,repeated:!0}]);let EnumDescriptorProto_EnumReservedRange=class EnumDescriptorProto_EnumReservedRange extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new EnumDescriptorProto_EnumReservedRange().fromBinary(e,t)}static fromJson(e,t){return new EnumDescriptorProto_EnumReservedRange().fromJson(e,t)}static fromJsonString(e,t){return new EnumDescriptorProto_EnumReservedRange().fromJsonString(e,t)}static equals(e,t){return es.util.equals(EnumDescriptorProto_EnumReservedRange,e,t)}};EnumDescriptorProto_EnumReservedRange.runtime=es,EnumDescriptorProto_EnumReservedRange.typeName="google.protobuf.EnumDescriptorProto.EnumReservedRange",EnumDescriptorProto_EnumReservedRange.fields=es.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0}]);let EnumValueDescriptorProto=class EnumValueDescriptorProto extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new EnumValueDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new EnumValueDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new EnumValueDescriptorProto().fromJsonString(e,t)}static equals(e,t){return es.util.equals(EnumValueDescriptorProto,e,t)}};EnumValueDescriptorProto.runtime=es,EnumValueDescriptorProto.typeName="google.protobuf.EnumValueDescriptorProto",EnumValueDescriptorProto.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"number",kind:"scalar",T:5,opt:!0},{no:3,name:"options",kind:"message",T:EnumValueOptions,opt:!0}]);let ServiceDescriptorProto=class ServiceDescriptorProto extends ep.v{constructor(e){super(),this.method=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new ServiceDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new ServiceDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new ServiceDescriptorProto().fromJsonString(e,t)}static equals(e,t){return es.util.equals(ServiceDescriptorProto,e,t)}};ServiceDescriptorProto.runtime=es,ServiceDescriptorProto.typeName="google.protobuf.ServiceDescriptorProto",ServiceDescriptorProto.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"method",kind:"message",T:MethodDescriptorProto,repeated:!0},{no:3,name:"options",kind:"message",T:ServiceOptions,opt:!0}]);let MethodDescriptorProto=class MethodDescriptorProto extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new MethodDescriptorProto().fromBinary(e,t)}static fromJson(e,t){return new MethodDescriptorProto().fromJson(e,t)}static fromJsonString(e,t){return new MethodDescriptorProto().fromJsonString(e,t)}static equals(e,t){return es.util.equals(MethodDescriptorProto,e,t)}};MethodDescriptorProto.runtime=es,MethodDescriptorProto.typeName="google.protobuf.MethodDescriptorProto",MethodDescriptorProto.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"input_type",kind:"scalar",T:9,opt:!0},{no:3,name:"output_type",kind:"scalar",T:9,opt:!0},{no:4,name:"options",kind:"message",T:MethodOptions,opt:!0},{no:5,name:"client_streaming",kind:"scalar",T:8,opt:!0,default:!1},{no:6,name:"server_streaming",kind:"scalar",T:8,opt:!0,default:!1}]);let FileOptions=class FileOptions extends ep.v{constructor(e){super(),this.uninterpretedOption=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new FileOptions().fromBinary(e,t)}static fromJson(e,t){return new FileOptions().fromJson(e,t)}static fromJsonString(e,t){return new FileOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FileOptions,e,t)}};FileOptions.runtime=es,FileOptions.typeName="google.protobuf.FileOptions",FileOptions.fields=es.util.newFieldList(()=>[{no:1,name:"java_package",kind:"scalar",T:9,opt:!0},{no:8,name:"java_outer_classname",kind:"scalar",T:9,opt:!0},{no:10,name:"java_multiple_files",kind:"scalar",T:8,opt:!0,default:!1},{no:20,name:"java_generate_equals_and_hash",kind:"scalar",T:8,opt:!0},{no:27,name:"java_string_check_utf8",kind:"scalar",T:8,opt:!0,default:!1},{no:9,name:"optimize_for",kind:"enum",T:es.getEnumType(_),opt:!0,default:_.SPEED},{no:11,name:"go_package",kind:"scalar",T:9,opt:!0},{no:16,name:"cc_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:17,name:"java_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:18,name:"py_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:42,name:"php_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:23,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:31,name:"cc_enable_arenas",kind:"scalar",T:8,opt:!0,default:!0},{no:36,name:"objc_class_prefix",kind:"scalar",T:9,opt:!0},{no:37,name:"csharp_namespace",kind:"scalar",T:9,opt:!0},{no:39,name:"swift_prefix",kind:"scalar",T:9,opt:!0},{no:40,name:"php_class_prefix",kind:"scalar",T:9,opt:!0},{no:41,name:"php_namespace",kind:"scalar",T:9,opt:!0},{no:44,name:"php_metadata_namespace",kind:"scalar",T:9,opt:!0},{no:45,name:"ruby_package",kind:"scalar",T:9,opt:!0},{no:50,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]),(a=_||(_={}))[a.SPEED=1]="SPEED",a[a.CODE_SIZE=2]="CODE_SIZE",a[a.LITE_RUNTIME=3]="LITE_RUNTIME",es.util.setEnumType(_,"google.protobuf.FileOptions.OptimizeMode",[{no:1,name:"SPEED"},{no:2,name:"CODE_SIZE"},{no:3,name:"LITE_RUNTIME"}]);let MessageOptions=class MessageOptions extends ep.v{constructor(e){super(),this.uninterpretedOption=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new MessageOptions().fromBinary(e,t)}static fromJson(e,t){return new MessageOptions().fromJson(e,t)}static fromJsonString(e,t){return new MessageOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(MessageOptions,e,t)}};MessageOptions.runtime=es,MessageOptions.typeName="google.protobuf.MessageOptions",MessageOptions.fields=es.util.newFieldList(()=>[{no:1,name:"message_set_wire_format",kind:"scalar",T:8,opt:!0,default:!1},{no:2,name:"no_standard_descriptor_accessor",kind:"scalar",T:8,opt:!0,default:!1},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:7,name:"map_entry",kind:"scalar",T:8,opt:!0},{no:11,name:"deprecated_legacy_json_field_conflicts",kind:"scalar",T:8,opt:!0},{no:12,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let FieldOptions=class FieldOptions extends ep.v{constructor(e){super(),this.targets=[],this.editionDefaults=[],this.uninterpretedOption=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new FieldOptions().fromBinary(e,t)}static fromJson(e,t){return new FieldOptions().fromJson(e,t)}static fromJsonString(e,t){return new FieldOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FieldOptions,e,t)}};FieldOptions.runtime=es,FieldOptions.typeName="google.protobuf.FieldOptions",FieldOptions.fields=es.util.newFieldList(()=>[{no:1,name:"ctype",kind:"enum",T:es.getEnumType(P),opt:!0,default:P.STRING},{no:2,name:"packed",kind:"scalar",T:8,opt:!0},{no:6,name:"jstype",kind:"enum",T:es.getEnumType(C),opt:!0,default:C.JS_NORMAL},{no:5,name:"lazy",kind:"scalar",T:8,opt:!0,default:!1},{no:15,name:"unverified_lazy",kind:"scalar",T:8,opt:!0,default:!1},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:10,name:"weak",kind:"scalar",T:8,opt:!0,default:!1},{no:16,name:"debug_redact",kind:"scalar",T:8,opt:!0,default:!1},{no:17,name:"retention",kind:"enum",T:es.getEnumType(R),opt:!0},{no:19,name:"targets",kind:"enum",T:es.getEnumType(x),repeated:!0},{no:20,name:"edition_defaults",kind:"message",T:FieldOptions_EditionDefault,repeated:!0},{no:21,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]),(l=P||(P={}))[l.STRING=0]="STRING",l[l.CORD=1]="CORD",l[l.STRING_PIECE=2]="STRING_PIECE",es.util.setEnumType(P,"google.protobuf.FieldOptions.CType",[{no:0,name:"STRING"},{no:1,name:"CORD"},{no:2,name:"STRING_PIECE"}]),(u=C||(C={}))[u.JS_NORMAL=0]="JS_NORMAL",u[u.JS_STRING=1]="JS_STRING",u[u.JS_NUMBER=2]="JS_NUMBER",es.util.setEnumType(C,"google.protobuf.FieldOptions.JSType",[{no:0,name:"JS_NORMAL"},{no:1,name:"JS_STRING"},{no:2,name:"JS_NUMBER"}]),(d=R||(R={}))[d.RETENTION_UNKNOWN=0]="RETENTION_UNKNOWN",d[d.RETENTION_RUNTIME=1]="RETENTION_RUNTIME",d[d.RETENTION_SOURCE=2]="RETENTION_SOURCE",es.util.setEnumType(R,"google.protobuf.FieldOptions.OptionRetention",[{no:0,name:"RETENTION_UNKNOWN"},{no:1,name:"RETENTION_RUNTIME"},{no:2,name:"RETENTION_SOURCE"}]),(c=x||(x={}))[c.TARGET_TYPE_UNKNOWN=0]="TARGET_TYPE_UNKNOWN",c[c.TARGET_TYPE_FILE=1]="TARGET_TYPE_FILE",c[c.TARGET_TYPE_EXTENSION_RANGE=2]="TARGET_TYPE_EXTENSION_RANGE",c[c.TARGET_TYPE_MESSAGE=3]="TARGET_TYPE_MESSAGE",c[c.TARGET_TYPE_FIELD=4]="TARGET_TYPE_FIELD",c[c.TARGET_TYPE_ONEOF=5]="TARGET_TYPE_ONEOF",c[c.TARGET_TYPE_ENUM=6]="TARGET_TYPE_ENUM",c[c.TARGET_TYPE_ENUM_ENTRY=7]="TARGET_TYPE_ENUM_ENTRY",c[c.TARGET_TYPE_SERVICE=8]="TARGET_TYPE_SERVICE",c[c.TARGET_TYPE_METHOD=9]="TARGET_TYPE_METHOD",es.util.setEnumType(x,"google.protobuf.FieldOptions.OptionTargetType",[{no:0,name:"TARGET_TYPE_UNKNOWN"},{no:1,name:"TARGET_TYPE_FILE"},{no:2,name:"TARGET_TYPE_EXTENSION_RANGE"},{no:3,name:"TARGET_TYPE_MESSAGE"},{no:4,name:"TARGET_TYPE_FIELD"},{no:5,name:"TARGET_TYPE_ONEOF"},{no:6,name:"TARGET_TYPE_ENUM"},{no:7,name:"TARGET_TYPE_ENUM_ENTRY"},{no:8,name:"TARGET_TYPE_SERVICE"},{no:9,name:"TARGET_TYPE_METHOD"}]);let FieldOptions_EditionDefault=class FieldOptions_EditionDefault extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new FieldOptions_EditionDefault().fromBinary(e,t)}static fromJson(e,t){return new FieldOptions_EditionDefault().fromJson(e,t)}static fromJsonString(e,t){return new FieldOptions_EditionDefault().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FieldOptions_EditionDefault,e,t)}};FieldOptions_EditionDefault.runtime=es,FieldOptions_EditionDefault.typeName="google.protobuf.FieldOptions.EditionDefault",FieldOptions_EditionDefault.fields=es.util.newFieldList(()=>[{no:3,name:"edition",kind:"enum",T:es.getEnumType(k),opt:!0},{no:2,name:"value",kind:"scalar",T:9,opt:!0}]);let OneofOptions=class OneofOptions extends ep.v{constructor(e){super(),this.uninterpretedOption=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new OneofOptions().fromBinary(e,t)}static fromJson(e,t){return new OneofOptions().fromJson(e,t)}static fromJsonString(e,t){return new OneofOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(OneofOptions,e,t)}};OneofOptions.runtime=es,OneofOptions.typeName="google.protobuf.OneofOptions",OneofOptions.fields=es.util.newFieldList(()=>[{no:1,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let EnumOptions=class EnumOptions extends ep.v{constructor(e){super(),this.uninterpretedOption=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new EnumOptions().fromBinary(e,t)}static fromJson(e,t){return new EnumOptions().fromJson(e,t)}static fromJsonString(e,t){return new EnumOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(EnumOptions,e,t)}};EnumOptions.runtime=es,EnumOptions.typeName="google.protobuf.EnumOptions",EnumOptions.fields=es.util.newFieldList(()=>[{no:2,name:"allow_alias",kind:"scalar",T:8,opt:!0},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:6,name:"deprecated_legacy_json_field_conflicts",kind:"scalar",T:8,opt:!0},{no:7,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let EnumValueOptions=class EnumValueOptions extends ep.v{constructor(e){super(),this.uninterpretedOption=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new EnumValueOptions().fromBinary(e,t)}static fromJson(e,t){return new EnumValueOptions().fromJson(e,t)}static fromJsonString(e,t){return new EnumValueOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(EnumValueOptions,e,t)}};EnumValueOptions.runtime=es,EnumValueOptions.typeName="google.protobuf.EnumValueOptions",EnumValueOptions.fields=es.util.newFieldList(()=>[{no:1,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:2,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:3,name:"debug_redact",kind:"scalar",T:8,opt:!0,default:!1},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let ServiceOptions=class ServiceOptions extends ep.v{constructor(e){super(),this.uninterpretedOption=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new ServiceOptions().fromBinary(e,t)}static fromJson(e,t){return new ServiceOptions().fromJson(e,t)}static fromJsonString(e,t){return new ServiceOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(ServiceOptions,e,t)}};ServiceOptions.runtime=es,ServiceOptions.typeName="google.protobuf.ServiceOptions",ServiceOptions.fields=es.util.newFieldList(()=>[{no:34,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:33,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]);let MethodOptions=class MethodOptions extends ep.v{constructor(e){super(),this.uninterpretedOption=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new MethodOptions().fromBinary(e,t)}static fromJson(e,t){return new MethodOptions().fromJson(e,t)}static fromJsonString(e,t){return new MethodOptions().fromJsonString(e,t)}static equals(e,t){return es.util.equals(MethodOptions,e,t)}};MethodOptions.runtime=es,MethodOptions.typeName="google.protobuf.MethodOptions",MethodOptions.fields=es.util.newFieldList(()=>[{no:33,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:34,name:"idempotency_level",kind:"enum",T:es.getEnumType(F),opt:!0,default:F.IDEMPOTENCY_UNKNOWN},{no:35,name:"features",kind:"message",T:FeatureSet,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:UninterpretedOption,repeated:!0}]),(h=F||(F={}))[h.IDEMPOTENCY_UNKNOWN=0]="IDEMPOTENCY_UNKNOWN",h[h.NO_SIDE_EFFECTS=1]="NO_SIDE_EFFECTS",h[h.IDEMPOTENT=2]="IDEMPOTENT",es.util.setEnumType(F,"google.protobuf.MethodOptions.IdempotencyLevel",[{no:0,name:"IDEMPOTENCY_UNKNOWN"},{no:1,name:"NO_SIDE_EFFECTS"},{no:2,name:"IDEMPOTENT"}]);let UninterpretedOption=class UninterpretedOption extends ep.v{constructor(e){super(),this.name=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new UninterpretedOption().fromBinary(e,t)}static fromJson(e,t){return new UninterpretedOption().fromJson(e,t)}static fromJsonString(e,t){return new UninterpretedOption().fromJsonString(e,t)}static equals(e,t){return es.util.equals(UninterpretedOption,e,t)}};UninterpretedOption.runtime=es,UninterpretedOption.typeName="google.protobuf.UninterpretedOption",UninterpretedOption.fields=es.util.newFieldList(()=>[{no:2,name:"name",kind:"message",T:UninterpretedOption_NamePart,repeated:!0},{no:3,name:"identifier_value",kind:"scalar",T:9,opt:!0},{no:4,name:"positive_int_value",kind:"scalar",T:4,opt:!0},{no:5,name:"negative_int_value",kind:"scalar",T:3,opt:!0},{no:6,name:"double_value",kind:"scalar",T:1,opt:!0},{no:7,name:"string_value",kind:"scalar",T:12,opt:!0},{no:8,name:"aggregate_value",kind:"scalar",T:9,opt:!0}]);let UninterpretedOption_NamePart=class UninterpretedOption_NamePart extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new UninterpretedOption_NamePart().fromBinary(e,t)}static fromJson(e,t){return new UninterpretedOption_NamePart().fromJson(e,t)}static fromJsonString(e,t){return new UninterpretedOption_NamePart().fromJsonString(e,t)}static equals(e,t){return es.util.equals(UninterpretedOption_NamePart,e,t)}};UninterpretedOption_NamePart.runtime=es,UninterpretedOption_NamePart.typeName="google.protobuf.UninterpretedOption.NamePart",UninterpretedOption_NamePart.fields=es.util.newFieldList(()=>[{no:1,name:"name_part",kind:"scalar",T:9},{no:2,name:"is_extension",kind:"scalar",T:8}]);let FeatureSet=class FeatureSet extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new FeatureSet().fromBinary(e,t)}static fromJson(e,t){return new FeatureSet().fromJson(e,t)}static fromJsonString(e,t){return new FeatureSet().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FeatureSet,e,t)}};FeatureSet.runtime=es,FeatureSet.typeName="google.protobuf.FeatureSet",FeatureSet.fields=es.util.newFieldList(()=>[{no:1,name:"field_presence",kind:"enum",T:es.getEnumType(L),opt:!0},{no:2,name:"enum_type",kind:"enum",T:es.getEnumType(B),opt:!0},{no:3,name:"repeated_field_encoding",kind:"enum",T:es.getEnumType(V),opt:!0},{no:4,name:"utf8_validation",kind:"enum",T:es.getEnumType(M),opt:!0},{no:5,name:"message_encoding",kind:"enum",T:es.getEnumType(J),opt:!0},{no:6,name:"json_format",kind:"enum",T:es.getEnumType(U),opt:!0}]),(m=L||(L={}))[m.FIELD_PRESENCE_UNKNOWN=0]="FIELD_PRESENCE_UNKNOWN",m[m.EXPLICIT=1]="EXPLICIT",m[m.IMPLICIT=2]="IMPLICIT",m[m.LEGACY_REQUIRED=3]="LEGACY_REQUIRED",es.util.setEnumType(L,"google.protobuf.FeatureSet.FieldPresence",[{no:0,name:"FIELD_PRESENCE_UNKNOWN"},{no:1,name:"EXPLICIT"},{no:2,name:"IMPLICIT"},{no:3,name:"LEGACY_REQUIRED"}]),(f=B||(B={}))[f.ENUM_TYPE_UNKNOWN=0]="ENUM_TYPE_UNKNOWN",f[f.OPEN=1]="OPEN",f[f.CLOSED=2]="CLOSED",es.util.setEnumType(B,"google.protobuf.FeatureSet.EnumType",[{no:0,name:"ENUM_TYPE_UNKNOWN"},{no:1,name:"OPEN"},{no:2,name:"CLOSED"}]),(p=V||(V={}))[p.REPEATED_FIELD_ENCODING_UNKNOWN=0]="REPEATED_FIELD_ENCODING_UNKNOWN",p[p.PACKED=1]="PACKED",p[p.EXPANDED=2]="EXPANDED",es.util.setEnumType(V,"google.protobuf.FeatureSet.RepeatedFieldEncoding",[{no:0,name:"REPEATED_FIELD_ENCODING_UNKNOWN"},{no:1,name:"PACKED"},{no:2,name:"EXPANDED"}]),(g=M||(M={}))[g.UTF8_VALIDATION_UNKNOWN=0]="UTF8_VALIDATION_UNKNOWN",g[g.NONE=1]="NONE",g[g.VERIFY=2]="VERIFY",es.util.setEnumType(M,"google.protobuf.FeatureSet.Utf8Validation",[{no:0,name:"UTF8_VALIDATION_UNKNOWN"},{no:1,name:"NONE"},{no:2,name:"VERIFY"}]),(T=J||(J={}))[T.MESSAGE_ENCODING_UNKNOWN=0]="MESSAGE_ENCODING_UNKNOWN",T[T.LENGTH_PREFIXED=1]="LENGTH_PREFIXED",T[T.DELIMITED=2]="DELIMITED",es.util.setEnumType(J,"google.protobuf.FeatureSet.MessageEncoding",[{no:0,name:"MESSAGE_ENCODING_UNKNOWN"},{no:1,name:"LENGTH_PREFIXED"},{no:2,name:"DELIMITED"}]),(y=U||(U={}))[y.JSON_FORMAT_UNKNOWN=0]="JSON_FORMAT_UNKNOWN",y[y.ALLOW=1]="ALLOW",y[y.LEGACY_BEST_EFFORT=2]="LEGACY_BEST_EFFORT",es.util.setEnumType(U,"google.protobuf.FeatureSet.JsonFormat",[{no:0,name:"JSON_FORMAT_UNKNOWN"},{no:1,name:"ALLOW"},{no:2,name:"LEGACY_BEST_EFFORT"}]);let FeatureSetDefaults=class FeatureSetDefaults extends ep.v{constructor(e){super(),this.defaults=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new FeatureSetDefaults().fromBinary(e,t)}static fromJson(e,t){return new FeatureSetDefaults().fromJson(e,t)}static fromJsonString(e,t){return new FeatureSetDefaults().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FeatureSetDefaults,e,t)}};FeatureSetDefaults.runtime=es,FeatureSetDefaults.typeName="google.protobuf.FeatureSetDefaults",FeatureSetDefaults.fields=es.util.newFieldList(()=>[{no:1,name:"defaults",kind:"message",T:FeatureSetDefaults_FeatureSetEditionDefault,repeated:!0},{no:4,name:"minimum_edition",kind:"enum",T:es.getEnumType(k),opt:!0},{no:5,name:"maximum_edition",kind:"enum",T:es.getEnumType(k),opt:!0}]);let FeatureSetDefaults_FeatureSetEditionDefault=class FeatureSetDefaults_FeatureSetEditionDefault extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new FeatureSetDefaults_FeatureSetEditionDefault().fromBinary(e,t)}static fromJson(e,t){return new FeatureSetDefaults_FeatureSetEditionDefault().fromJson(e,t)}static fromJsonString(e,t){return new FeatureSetDefaults_FeatureSetEditionDefault().fromJsonString(e,t)}static equals(e,t){return es.util.equals(FeatureSetDefaults_FeatureSetEditionDefault,e,t)}};FeatureSetDefaults_FeatureSetEditionDefault.runtime=es,FeatureSetDefaults_FeatureSetEditionDefault.typeName="google.protobuf.FeatureSetDefaults.FeatureSetEditionDefault",FeatureSetDefaults_FeatureSetEditionDefault.fields=es.util.newFieldList(()=>[{no:3,name:"edition",kind:"enum",T:es.getEnumType(k),opt:!0},{no:2,name:"features",kind:"message",T:FeatureSet,opt:!0}]);let SourceCodeInfo=class SourceCodeInfo extends ep.v{constructor(e){super(),this.location=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new SourceCodeInfo().fromBinary(e,t)}static fromJson(e,t){return new SourceCodeInfo().fromJson(e,t)}static fromJsonString(e,t){return new SourceCodeInfo().fromJsonString(e,t)}static equals(e,t){return es.util.equals(SourceCodeInfo,e,t)}};SourceCodeInfo.runtime=es,SourceCodeInfo.typeName="google.protobuf.SourceCodeInfo",SourceCodeInfo.fields=es.util.newFieldList(()=>[{no:1,name:"location",kind:"message",T:SourceCodeInfo_Location,repeated:!0}]);let SourceCodeInfo_Location=class SourceCodeInfo_Location extends ep.v{constructor(e){super(),this.path=[],this.span=[],this.leadingDetachedComments=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new SourceCodeInfo_Location().fromBinary(e,t)}static fromJson(e,t){return new SourceCodeInfo_Location().fromJson(e,t)}static fromJsonString(e,t){return new SourceCodeInfo_Location().fromJsonString(e,t)}static equals(e,t){return es.util.equals(SourceCodeInfo_Location,e,t)}};SourceCodeInfo_Location.runtime=es,SourceCodeInfo_Location.typeName="google.protobuf.SourceCodeInfo.Location",SourceCodeInfo_Location.fields=es.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:5,repeated:!0,packed:!0},{no:2,name:"span",kind:"scalar",T:5,repeated:!0,packed:!0},{no:3,name:"leading_comments",kind:"scalar",T:9,opt:!0},{no:4,name:"trailing_comments",kind:"scalar",T:9,opt:!0},{no:6,name:"leading_detached_comments",kind:"scalar",T:9,repeated:!0}]);let GeneratedCodeInfo=class GeneratedCodeInfo extends ep.v{constructor(e){super(),this.annotation=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new GeneratedCodeInfo().fromBinary(e,t)}static fromJson(e,t){return new GeneratedCodeInfo().fromJson(e,t)}static fromJsonString(e,t){return new GeneratedCodeInfo().fromJsonString(e,t)}static equals(e,t){return es.util.equals(GeneratedCodeInfo,e,t)}};GeneratedCodeInfo.runtime=es,GeneratedCodeInfo.typeName="google.protobuf.GeneratedCodeInfo",GeneratedCodeInfo.fields=es.util.newFieldList(()=>[{no:1,name:"annotation",kind:"message",T:GeneratedCodeInfo_Annotation,repeated:!0}]);let GeneratedCodeInfo_Annotation=class GeneratedCodeInfo_Annotation extends ep.v{constructor(e){super(),this.path=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new GeneratedCodeInfo_Annotation().fromBinary(e,t)}static fromJson(e,t){return new GeneratedCodeInfo_Annotation().fromJson(e,t)}static fromJsonString(e,t){return new GeneratedCodeInfo_Annotation().fromJsonString(e,t)}static equals(e,t){return es.util.equals(GeneratedCodeInfo_Annotation,e,t)}};GeneratedCodeInfo_Annotation.runtime=es,GeneratedCodeInfo_Annotation.typeName="google.protobuf.GeneratedCodeInfo.Annotation",GeneratedCodeInfo_Annotation.fields=es.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:5,repeated:!0,packed:!0},{no:2,name:"source_file",kind:"scalar",T:9,opt:!0},{no:3,name:"begin",kind:"scalar",T:5,opt:!0},{no:4,name:"end",kind:"scalar",T:5,opt:!0},{no:5,name:"semantic",kind:"enum",T:es.getEnumType(j),opt:!0}]),(v=j||(j={}))[v.NONE=0]="NONE",v[v.SET=1]="SET",v[v.ALIAS=2]="ALIAS",es.util.setEnumType(j,"google.protobuf.GeneratedCodeInfo.Annotation.Semantic",[{no:0,name:"NONE"},{no:1,name:"SET"},{no:2,name:"ALIAS"}]);let eT=FeatureSetDefaults.fromBinary(eu.W.dec("ChESDAgBEAIYAiABKAEwAhjmBwoREgwIAhABGAEgAigBMAEY5wcKERIMCAEQARgBIAIoATABGOgHIOYHKOgH"));function createDescriptorSet(e,t){var r;let n={enums:new Map,messages:new Map,services:new Map,extensions:new Map,mapEntries:new Map,resolveFeatures:function(e){let t=e.minimumEdition,r=e.maximumEdition;if(void 0===t||void 0===r||e.defaults.some(e=>void 0===e.edition))throw Error("Invalid FeatureSetDefaults");let n=new Map;return(i,...o)=>{var s,a;let l=n.get(i);if(void 0===l){let o;if(i<t)throw Error(`Edition ${k[i]} is earlier than the minimum supported edition ${k[t]}`);if(r<i)throw Error(`Edition ${k[i]} is later than the maximum supported edition ${k[r]}`);for(let t of e.defaults){let e=null!==(s=t.edition)&&void 0!==s?s:0;e>i||void 0!==o&&o.e>e||(o={e,f:null!==(a=t.features)&&void 0!==a?a:new FeatureSet})}if(void 0===o)throw Error(`No valid default found for edition ${k[i]}`);l=o.f.toBinary(),n.set(i,l)}let u=FeatureSet.fromBinary(l);for(let e of o)void 0!==e&&u.fromBinary(e.toBinary());if(!function(e){for(let t of FeatureSet.fields.list()){let r=e[t.localName];if(void 0===r||"enum"==t.kind&&0===r)return!1}return!0}(u))throw Error(`Invalid FeatureSet for edition ${k[i]}`);return u}}(null!==(r=null==t?void 0:t.featureSetDefaults)&&void 0!==r?r:eT)},i=e instanceof FileDescriptorSet?e.file:e instanceof Uint8Array?FileDescriptorSet.fromBinary(e).file:e,o=i.map(e=>(function(e,t){var r,n;(0,ei.hu)(e.name,"invalid FileDescriptorProto: missing name");let i=Object.assign(Object.assign({kind:"file",proto:e,deprecated:null!==(n=null===(r=e.options)||void 0===r?void 0:r.deprecated)&&void 0!==n&&n},function(e,t){let r,n;switch(e){case void 0:case"proto2":n="proto2",r=k.EDITION_PROTO2;break;case"proto3":n="proto3",r=k.EDITION_PROTO3;break;case"editions":switch(n="editions",t){case void 0:case k.EDITION_1_TEST_ONLY:case k.EDITION_2_TEST_ONLY:case k.EDITION_99997_TEST_ONLY:case k.EDITION_99998_TEST_ONLY:case k.EDITION_99999_TEST_ONLY:case k.EDITION_UNKNOWN:r=k.EDITION_UNKNOWN;break;default:r=t}break;default:throw Error(`invalid FileDescriptorProto: unsupported syntax: ${e}`)}if("editions"===e&&t===k.EDITION_UNKNOWN)throw Error(`invalid FileDescriptorProto: syntax ${e} cannot have edition ${String(t)}`);return{syntax:n,edition:r}}(e.syntax,e.edition)),{name:e.name.replace(/\.proto/,""),enums:[],messages:[],extensions:[],services:[],toString(){return`file ${this.proto.name}`},getSyntaxComments(){return findComments(this.proto.sourceCodeInfo,[$.FileDescriptorProto_Syntax])},getPackageComments(){return findComments(this.proto.sourceCodeInfo,[$.FileDescriptorProto_Package])},getFeatures(){var e;return t.resolveFeatures(this.edition,null===(e=this.proto.options)||void 0===e?void 0:e.features)}});for(let r of(t.mapEntries.clear(),e.enumType))addEnum(r,i,void 0,t);for(let r of e.messageType)!function addMessage(e,t,r,n){var i,o,s,a;(0,ei.hu)(e.name,"invalid DescriptorProto: missing name");let l={kind:"message",proto:e,deprecated:null!==(o=null===(i=e.options)||void 0===i?void 0:i.deprecated)&&void 0!==o&&o,file:t,parent:r,name:e.name,typeName:makeTypeName(e,r,t),fields:[],oneofs:[],members:[],nestedEnums:[],nestedMessages:[],nestedExtensions:[],toString(){return`message ${this.typeName}`},getComments(){let e=this.parent?[...this.parent.getComments().sourcePath,$.DescriptorProto_NestedType,this.parent.proto.nestedType.indexOf(this.proto)]:[$.FileDescriptorProto_MessageType,this.file.proto.messageType.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e,t,r;let i=null!==(t=null===(e=this.parent)||void 0===e?void 0:e.getFeatures())&&void 0!==t?t:this.file.getFeatures();return n.resolveFeatures(this.file.edition,i,null===(r=this.proto.options)||void 0===r?void 0:r.features)}};for(let i of((null===(s=e.options)||void 0===s?void 0:s.mapEntry)===!0?n.mapEntries.set(l.typeName,l):((null!==(a=null==r?void 0:r.nestedMessages)&&void 0!==a?a:t.messages).push(l),n.messages.set(l.typeName,l)),e.enumType))addEnum(i,t,l,n);for(let r of e.nestedType)addMessage(r,t,l,n)}(r,i,void 0,t);for(let r of e.service)!function(e,t,r){var n,i;(0,ei.hu)(e.name,"invalid ServiceDescriptorProto: missing name");let o={kind:"service",proto:e,deprecated:null!==(i=null===(n=e.options)||void 0===n?void 0:n.deprecated)&&void 0!==i&&i,file:t,name:e.name,typeName:makeTypeName(e,void 0,t),methods:[],toString(){return`service ${this.typeName}`},getComments(){let e=[$.FileDescriptorProto_Service,this.file.proto.service.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e;return r.resolveFeatures(this.file.edition,this.file.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}};for(let n of(t.services.push(o),r.services.set(o.typeName,o),e.method))o.methods.push(function(e,t,r){var n,i,o;let s,a;switch((0,ei.hu)(e.name,"invalid MethodDescriptorProto: missing name"),(0,ei.hu)(e.inputType,"invalid MethodDescriptorProto: missing input_type"),(0,ei.hu)(e.outputType,"invalid MethodDescriptorProto: missing output_type"),s=!0===e.clientStreaming&&!0===e.serverStreaming?eg.t.BiDiStreaming:!0===e.clientStreaming?eg.t.ClientStreaming:!0===e.serverStreaming?eg.t.ServerStreaming:eg.t.Unary,null===(n=e.options)||void 0===n?void 0:n.idempotencyLevel){case F.IDEMPOTENT:a=eg.w.Idempotent;break;case F.NO_SIDE_EFFECTS:a=eg.w.NoSideEffects;break;case F.IDEMPOTENCY_UNKNOWN:case void 0:a=void 0}let l=r.messages.get(trimLeadingDot(e.inputType)),u=r.messages.get(trimLeadingDot(e.outputType));(0,ei.hu)(l,`invalid MethodDescriptorProto: input_type ${e.inputType} not found`),(0,ei.hu)(u,`invalid MethodDescriptorProto: output_type ${e.inputType} not found`);let d=e.name;return{kind:"rpc",proto:e,deprecated:null!==(o=null===(i=e.options)||void 0===i?void 0:i.deprecated)&&void 0!==o&&o,parent:t,name:d,methodKind:s,input:l,output:u,idempotency:a,toString:()=>`rpc ${t.typeName}.${d}`,getComments(){let e=[...this.parent.getComments().sourcePath,$.ServiceDescriptorProto_Method,this.parent.proto.method.indexOf(this.proto)];return findComments(t.file.proto.sourceCodeInfo,e)},getFeatures(){var e;return r.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}}}(n,o,r))}(r,i,t);for(let e of(addExtensions(i,t),t.mapEntries.values()))addFields(e,t);for(let e of i.messages)addFields(e,t),addExtensions(e,t);return t.mapEntries.clear(),i})(e,n));return Object.assign({files:o},n)}function addExtensions(e,t){switch(e.kind){case"file":for(let r of e.proto.extension){let n=newExtension(r,e,void 0,t);e.extensions.push(n),t.extensions.set(n.typeName,n)}break;case"message":for(let r of e.proto.extension){let n=newExtension(r,e.file,e,t);e.nestedExtensions.push(n),t.extensions.set(n.typeName,n)}for(let r of e.nestedMessages)addExtensions(r,t)}}function addFields(e,t){let r=e.proto.oneofDecl.map(r=>((0,ei.hu)(r.name,"invalid OneofDescriptorProto: missing name"),{kind:"oneof",proto:r,deprecated:!1,parent:e,fields:[],name:r.name,toString(){return`oneof ${e.typeName}.${this.name}`},getComments(){let t=[...this.parent.getComments().sourcePath,$.DescriptorProto_OneofDecl,this.parent.proto.oneofDecl.indexOf(this.proto)];return findComments(e.file.proto.sourceCodeInfo,t)},getFeatures(){var e;return t.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}})),n=new Set;for(let i of e.proto.field){let o=function(e,t){var r;let n;let i=e.oneofIndex;if(void 0!==i)return!0!==e.proto3Optional&&(n=t[i],(0,ei.hu)(n,`invalid FieldDescriptorProto: oneof #${i} for field #${null!==(r=e.number)&&void 0!==r?r:-1} not found`)),n}(i,r),s=newField(i,e.file,e,o,t);e.fields.push(s),void 0===o?e.members.push(s):(o.fields.push(s),n.has(o)||(n.add(o),e.members.push(o)))}for(let t of r.filter(e=>n.has(e)))e.oneofs.push(t);for(let r of e.nestedMessages)addFields(r,t)}function addEnum(e,t,r,n){var i,o,s;(0,ei.hu)(e.name,"invalid EnumDescriptorProto: missing name");let a={kind:"enum",proto:e,deprecated:null!==(o=null===(i=e.options)||void 0===i?void 0:i.deprecated)&&void 0!==o&&o,file:t,parent:r,name:e.name,typeName:makeTypeName(e,r,t),values:[],sharedPrefix:(0,er.Sm)(e.name,e.value.map(e=>{var t;return null!==(t=e.name)&&void 0!==t?t:""})),toString(){return`enum ${this.typeName}`},getComments(){let e=this.parent?[...this.parent.getComments().sourcePath,$.DescriptorProto_EnumType,this.parent.proto.enumType.indexOf(this.proto)]:[$.FileDescriptorProto_EnumType,this.file.proto.enumType.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e,t,r;let i=null!==(t=null===(e=this.parent)||void 0===e?void 0:e.getFeatures())&&void 0!==t?t:this.file.getFeatures();return n.resolveFeatures(this.file.edition,i,null===(r=this.proto.options)||void 0===r?void 0:r.features)}};n.enums.set(a.typeName,a),e.value.forEach(e=>{var r,i;(0,ei.hu)(e.name,"invalid EnumValueDescriptorProto: missing name"),(0,ei.hu)(void 0!==e.number,"invalid EnumValueDescriptorProto: missing number"),a.values.push({kind:"enum_value",proto:e,deprecated:null!==(i=null===(r=e.options)||void 0===r?void 0:r.deprecated)&&void 0!==i&&i,parent:a,name:e.name,number:e.number,toString(){return`enum value ${a.typeName}.${this.name}`},declarationString(){var e;let t=`${this.name} = ${this.number}`;return(null===(e=this.proto.options)||void 0===e?void 0:e.deprecated)===!0&&(t+=" [deprecated = true]"),t},getComments(){let e=[...this.parent.getComments().sourcePath,$.EnumDescriptorProto_Value,this.parent.proto.value.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e;return n.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}})}),(null!==(s=null==r?void 0:r.nestedEnums)&&void 0!==s?s:t.enums).push(a)}function newField(e,t,r,n,i){var o,s,a;(0,ei.hu)(e.name,"invalid FieldDescriptorProto: missing name"),(0,ei.hu)(e.number,"invalid FieldDescriptorProto: missing number"),(0,ei.hu)(e.type,"invalid FieldDescriptorProto: missing type");let l={proto:e,deprecated:null!==(s=null===(o=e.options)||void 0===o?void 0:o.deprecated)&&void 0!==s&&s,name:e.name,number:e.number,parent:r,oneof:n,optional:function(e,t){switch(t){case"proto2":return void 0===e.oneofIndex&&e.label===A.OPTIONAL;case"proto3":return!0===e.proto3Optional;case"editions":return!1}}(e,t.syntax),packedByDefault:function(e,t,r){let{repeatedFieldEncoding:n}=r(e.edition);if(n!=V.PACKED)return!1;switch(t.type){case D.STRING:case D.BYTES:case D.GROUP:case D.MESSAGE:return!1;default:return!0}}(t,e,i.resolveFeatures),packed:function(e,t,r,n){var i,o,s,a,l,u;switch(r.type){case D.STRING:case D.BYTES:case D.GROUP:case D.MESSAGE:return!1;default:switch(e.edition){case k.EDITION_PROTO2:return null!==(o=null===(i=r.options)||void 0===i?void 0:i.packed)&&void 0!==o&&o;case k.EDITION_PROTO3:return null===(a=null===(s=r.options)||void 0===s?void 0:s.packed)||void 0===a||a;default:{let{repeatedFieldEncoding:i}=n(e.edition,null!==(l=null==t?void 0:t.getFeatures())&&void 0!==l?l:e.getFeatures(),null===(u=r.options)||void 0===u?void 0:u.features);return i==V.PACKED}}}}(t,r,e,i.resolveFeatures),jsonName:e.jsonName===(0,er.x1)(e.name)?void 0:e.jsonName,scalar:void 0,longType:void 0,message:void 0,enum:void 0,mapKey:void 0,mapValue:void 0,declarationString,toString(){return`field ${this.parent.typeName}.${this.name}`},getComments(){let e=[...this.parent.getComments().sourcePath,$.DescriptorProto_Field,this.parent.proto.field.indexOf(this.proto)];return findComments(t.proto.sourceCodeInfo,e)},getFeatures(){var e;return i.resolveFeatures(t.edition,this.parent.getFeatures(),null===(e=this.proto.options)||void 0===e?void 0:e.features)}},u=e.label===A.REPEATED;switch(e.type){case D.MESSAGE:case D.GROUP:{(0,ei.hu)(e.typeName,"invalid FieldDescriptorProto: missing type_name");let t=i.mapEntries.get(trimLeadingDot(e.typeName));if(void 0!==t)return(0,ei.hu)(u,"invalid FieldDescriptorProto: expected map entry to be repeated"),Object.assign(Object.assign(Object.assign({},l),{kind:"field",fieldKind:"map",repeated:!1}),function(e){var t,r;(0,ei.hu)(null===(t=e.proto.options)||void 0===t?void 0:t.mapEntry,`invalid DescriptorProto: expected ${e.toString()} to be a map entry`),(0,ei.hu)(2===e.fields.length,`invalid DescriptorProto: map entry ${e.toString()} has ${e.fields.length} fields`);let n=e.fields.find(e=>1===e.proto.number);(0,ei.hu)(n,`invalid DescriptorProto: map entry ${e.toString()} is missing key field`);let i=n.scalar;(0,ei.hu)(void 0!==i&&i!==X.w.BYTES&&i!==X.w.FLOAT&&i!==X.w.DOUBLE,`invalid DescriptorProto: map entry ${e.toString()} has unexpected key type ${null!==(r=n.proto.type)&&void 0!==r?r:-1}`);let o=e.fields.find(e=>2===e.proto.number);switch((0,ei.hu)(o,`invalid DescriptorProto: map entry ${e.toString()} is missing value field`),o.fieldKind){case"scalar":return{mapKey:i,mapValue:Object.assign(Object.assign({},o),{kind:"scalar"})};case"message":return{mapKey:i,mapValue:Object.assign(Object.assign({},o),{kind:"message"})};case"enum":return{mapKey:i,mapValue:Object.assign(Object.assign({},o),{kind:"enum"})};default:throw Error("invalid DescriptorProto: unsupported map entry value field")}}(t));let r=i.messages.get(trimLeadingDot(e.typeName));return(0,ei.hu)(void 0!==r,`invalid FieldDescriptorProto: type_name ${e.typeName} not found`),Object.assign(Object.assign({},l),{kind:"field",fieldKind:"message",repeated:u,message:r})}case D.ENUM:{(0,ei.hu)(e.typeName,"invalid FieldDescriptorProto: missing type_name");let t=i.enums.get(trimLeadingDot(e.typeName));return(0,ei.hu)(void 0!==t,`invalid FieldDescriptorProto: type_name ${e.typeName} not found`),Object.assign(Object.assign({},l),{kind:"field",fieldKind:"enum",getDefaultValue,repeated:u,enum:t})}default:{let t=ey[e.type];return(0,ei.hu)(t,`invalid FieldDescriptorProto: unknown type ${e.type}`),Object.assign(Object.assign({},l),{kind:"field",fieldKind:"scalar",getDefaultValue,repeated:u,scalar:t,longType:(null===(a=e.options)||void 0===a?void 0:a.jstype)==C.JS_STRING?X.p.STRING:X.p.BIGINT})}}}function newExtension(e,t,r,n){(0,ei.hu)(e.extendee,"invalid FieldDescriptorProto: missing extendee");let i=newField(e,t,null,void 0,n),o=n.messages.get(trimLeadingDot(e.extendee));return(0,ei.hu)(o,`invalid FieldDescriptorProto: extendee ${e.extendee} not found`),Object.assign(Object.assign({},i),{kind:"extension",typeName:makeTypeName(e,r,t),parent:r,file:t,extendee:o,toString(){return`extension ${this.typeName}`},getComments(){let r=this.parent?[...this.parent.getComments().sourcePath,$.DescriptorProto_Extension,this.parent.proto.extension.indexOf(e)]:[$.FileDescriptorProto_Extension,this.file.proto.extension.indexOf(e)];return findComments(t.proto.sourceCodeInfo,r)},getFeatures(){var e,t;return n.resolveFeatures(this.file.edition,(null!==(e=this.parent)&&void 0!==e?e:this.file).getFeatures(),null===(t=this.proto.options)||void 0===t?void 0:t.features)}})}function makeTypeName(e,t,r){return(0,ei.hu)(e.name,`invalid ${e.getType().typeName}: missing name`),t?`${t.typeName}.${e.name}`:void 0!==r.proto.package?`${r.proto.package}.${e.name}`:`${e.name}`}function trimLeadingDot(e){return e.startsWith(".")?e.substring(1):e}let ey={[D.DOUBLE]:X.w.DOUBLE,[D.FLOAT]:X.w.FLOAT,[D.INT64]:X.w.INT64,[D.UINT64]:X.w.UINT64,[D.INT32]:X.w.INT32,[D.FIXED64]:X.w.FIXED64,[D.FIXED32]:X.w.FIXED32,[D.BOOL]:X.w.BOOL,[D.STRING]:X.w.STRING,[D.GROUP]:void 0,[D.MESSAGE]:void 0,[D.BYTES]:X.w.BYTES,[D.UINT32]:X.w.UINT32,[D.ENUM]:void 0,[D.SFIXED32]:X.w.SFIXED32,[D.SFIXED64]:X.w.SFIXED64,[D.SINT32]:X.w.SINT32,[D.SINT64]:X.w.SINT64};function findComments(e,t){if(!e)return{leadingDetached:[],sourcePath:t};for(let r of e.location)if(!(r.path.length!==t.length||r.path.some((e,r)=>t[r]!==e)))return{leadingDetached:r.leadingDetachedComments,leading:r.leadingComments,trailing:r.trailingComments,sourcePath:t};return{leadingDetached:[],sourcePath:t}}function declarationString(){var e,t,r;let n;let i=[];this.repeated&&i.push("repeated"),this.optional&&i.push("optional");let o="extension"===this.kind?this.file:this.parent.file;switch("proto2"==o.syntax&&this.proto.label===A.REQUIRED&&i.push("required"),this.fieldKind){case"scalar":n=X.w[this.scalar].toLowerCase();break;case"enum":n=this.enum.typeName;break;case"message":n=this.message.typeName;break;case"map":{let e;let t=X.w[this.mapKey].toLowerCase();switch(this.mapValue.kind){case"scalar":e=X.w[this.mapValue.scalar].toLowerCase();break;case"enum":e=this.mapValue.enum.typeName;break;case"message":e=this.mapValue.message.typeName}n=`map<${t}, ${e}>`}}i.push(`${n} ${this.name} = ${this.number}`);let s=[];(null===(e=this.proto.options)||void 0===e?void 0:e.packed)!==void 0&&s.push(`packed = ${this.proto.options.packed.toString()}`);let a=this.proto.defaultValue;return void 0!==a&&((this.proto.type==D.BYTES||this.proto.type==D.STRING)&&(a='"'+a.replace('"','\\"')+'"'),s.push(`default = ${a}`)),void 0!==this.jsonName&&s.push(`json_name = "${this.jsonName}"`),(null===(t=this.proto.options)||void 0===t?void 0:t.jstype)!==void 0&&s.push(`jstype = ${C[this.proto.options.jstype]}`),(null===(r=this.proto.options)||void 0===r?void 0:r.deprecated)===!0&&s.push("deprecated = true"),s.length>0&&i.push("["+s.join(", ")+"]"),i.join(" ")}function getDefaultValue(){let e=this.proto.defaultValue;if(void 0!==e)switch(this.fieldKind){case"enum":return function(e,t){let r=e.values.find(e=>e.name===t);return(0,ei.hu)(r,`cannot parse ${e.name} default value: ${t}`),r.number}(this.enum,e);case"scalar":return function(e,t){switch(e){case X.w.STRING:return t;case X.w.BYTES:{let r=function(e){let t=[],r={tail:e,c:"",next(){return 0!=this.tail.length&&(this.c=this.tail[0],this.tail=this.tail.substring(1),!0)},take(e){if(this.tail.length>=e){let t=this.tail.substring(0,e);return this.tail=this.tail.substring(e),t}return!1}};for(;r.next();)if("\\"===r.c){if(r.next())switch(r.c){case"\\":t.push(r.c.charCodeAt(0));break;case"b":t.push(8);break;case"f":t.push(12);break;case"n":t.push(10);break;case"r":t.push(13);break;case"t":t.push(9);break;case"v":t.push(11);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":{let e=r.c,n=r.take(2);if(!1===n)return!1;let i=parseInt(e+n,8);if(isNaN(i))return!1;t.push(i);break}case"x":{let e=r.c,n=r.take(2);if(!1===n)return!1;let i=parseInt(e+n,16);if(isNaN(i))return!1;t.push(i);break}case"u":{let e=r.c,n=r.take(4);if(!1===n)return!1;let i=parseInt(e+n,16);if(isNaN(i))return!1;let o=new Uint8Array(4),s=new DataView(o.buffer);s.setInt32(0,i,!0),t.push(o[0],o[1],o[2],o[3]);break}case"U":{let e=r.c,n=r.take(8);if(!1===n)return!1;let i=el.q.uEnc(e+n),o=new Uint8Array(8),s=new DataView(o.buffer);s.setInt32(0,i.lo,!0),s.setInt32(4,i.hi,!0),t.push(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7])}}}else t.push(r.c.charCodeAt(0));return new Uint8Array(t)}(t);if(!1===r)throw Error(`cannot parse ${X.w[e]} default value: ${t}`);return r}case X.w.INT64:case X.w.SFIXED64:case X.w.SINT64:return el.q.parse(t);case X.w.UINT64:case X.w.FIXED64:return el.q.uParse(t);case X.w.DOUBLE:case X.w.FLOAT:switch(t){case"inf":return Number.POSITIVE_INFINITY;case"-inf":return Number.NEGATIVE_INFINITY;case"nan":return Number.NaN;default:return parseFloat(t)}case X.w.BOOL:return"true"===t;case X.w.INT32:case X.w.UINT32:case X.w.SINT32:case X.w.FIXED32:case X.w.SFIXED32:return parseInt(t,10)}}(this.scalar,e);default:return}}function createRegistry(...e){let t={},r={},n={},i={add(e){if("fields"in e){if(!this.findMessage(e.typeName))for(let r of(t[e.typeName]=e,e.fields.list()))"message"==r.kind?this.add(r.T):"map"==r.kind&&"message"==r.V.kind?this.add(r.V.T):"enum"==r.kind&&this.add(r.T)}else if("methods"in e){if(!this.findService(e.typeName))for(let t of(n[e.typeName]=e,Object.values(e.methods)))this.add(t.I),this.add(t.O)}else r[e.typeName]=e},findMessage:e=>t[e],findEnum:e=>r[e],findService:e=>n[e]};for(let t of e)i.add(t);return i}(S=$||($={}))[S.FileDescriptorProto_Package=2]="FileDescriptorProto_Package",S[S.FileDescriptorProto_MessageType=4]="FileDescriptorProto_MessageType",S[S.FileDescriptorProto_EnumType=5]="FileDescriptorProto_EnumType",S[S.FileDescriptorProto_Service=6]="FileDescriptorProto_Service",S[S.FileDescriptorProto_Extension=7]="FileDescriptorProto_Extension",S[S.FileDescriptorProto_Syntax=12]="FileDescriptorProto_Syntax",S[S.DescriptorProto_Field=2]="DescriptorProto_Field",S[S.DescriptorProto_NestedType=3]="DescriptorProto_NestedType",S[S.DescriptorProto_EnumType=4]="DescriptorProto_EnumType",S[S.DescriptorProto_Extension=6]="DescriptorProto_Extension",S[S.DescriptorProto_OneofDecl=8]="DescriptorProto_OneofDecl",S[S.EnumDescriptorProto_Value=2]="EnumDescriptorProto_Value",S[S.ServiceDescriptorProto_Method=2]="ServiceDescriptorProto_Method";let Timestamp=class Timestamp extends ep.v{constructor(e){super(),this.seconds=el.q.zero,this.nanos=0,W.w.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw Error(`cannot decode google.protobuf.Timestamp from JSON: ${W.w.json.debug(e)}`);let r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");let n=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(n))throw Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=el.q.parse(n/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){let t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){let e=(this.nanos+1e9).toString().substring(1);r="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return Timestamp.fromDate(new Date)}static fromDate(e){let t=e.getTime();return new Timestamp({seconds:el.q.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new Timestamp().fromBinary(e,t)}static fromJson(e,t){return new Timestamp().fromJson(e,t)}static fromJsonString(e,t){return new Timestamp().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Timestamp,e,t)}};Timestamp.runtime=W.w,Timestamp.typeName="google.protobuf.Timestamp",Timestamp.fields=W.w.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);let Duration=class Duration extends ep.v{constructor(e){super(),this.seconds=el.q.zero,this.nanos=0,W.w.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw Error(`cannot decode google.protobuf.Duration from JSON: ${W.w.json.debug(e)}`);let r=e.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(null===r)throw Error(`cannot decode google.protobuf.Duration from JSON: ${W.w.json.debug(e)}`);let n=Number(r[1]);if(n>315576e6||n<-315576e6)throw Error(`cannot decode google.protobuf.Duration from JSON: ${W.w.json.debug(e)}`);if(this.seconds=el.q.parse(n),"string"==typeof r[2]){let e=r[2]+"0".repeat(9-r[2].length);this.nanos=parseInt(e),(n<0||Object.is(n,-0))&&(this.nanos=-this.nanos)}return this}toJson(e){if(Number(this.seconds)>315576e6||-315576e6>Number(this.seconds))throw Error("cannot encode google.protobuf.Duration to JSON: value out of range");let t=this.seconds.toString();if(0!==this.nanos){let e=Math.abs(this.nanos).toString();"000000"===(e="0".repeat(9-e.length)+e).substring(3)?e=e.substring(0,3):"000"===e.substring(6)&&(e=e.substring(0,6)),t+="."+e,this.nanos<0&&0==Number(this.seconds)&&(t="-"+t)}return t+"s"}static fromBinary(e,t){return new Duration().fromBinary(e,t)}static fromJson(e,t){return new Duration().fromJson(e,t)}static fromJsonString(e,t){return new Duration().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Duration,e,t)}};Duration.runtime=W.w,Duration.typeName="google.protobuf.Duration",Duration.fields=W.w.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var ev=r(733);let Empty=class Empty extends ep.v{constructor(e){super(),W.w.util.initPartial(e,this)}static fromBinary(e,t){return new Empty().fromBinary(e,t)}static fromJson(e,t){return new Empty().fromJson(e,t)}static fromJsonString(e,t){return new Empty().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Empty,e,t)}};Empty.runtime=W.w,Empty.typeName="google.protobuf.Empty",Empty.fields=W.w.util.newFieldList(()=>[]);let FieldMask=class FieldMask extends ep.v{constructor(e){super(),this.paths=[],W.w.util.initPartial(e,this)}toJson(e){return this.paths.map(e=>{if(e.match(/_[0-9]?_/g)||e.match(/[A-Z]/g))throw Error('cannot encode google.protobuf.FieldMask to JSON: lowerCamelCase of path name "'+e+'" is irreversible');return function(e){let t=!1,r=[];for(let n=0;n<e.length;n++){let i=e.charAt(n);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),r.push(i)}}return r.join("")}(e)}).join(",")}fromJson(e,t){if("string"!=typeof e)throw Error("cannot decode google.protobuf.FieldMask from JSON: "+W.w.json.debug(e));return""===e||(this.paths=e.split(",").map(function(e){if(e.includes("_"))throw Error("cannot decode google.protobuf.FieldMask from JSON: path names must be lowerCamelCase");let t=e.replace(/[A-Z]/g,e=>"_"+e.toLowerCase());return"_"===t[0]?t.substring(1):t})),this}static fromBinary(e,t){return new FieldMask().fromBinary(e,t)}static fromJson(e,t){return new FieldMask().fromJson(e,t)}static fromJsonString(e,t){return new FieldMask().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(FieldMask,e,t)}};FieldMask.runtime=W.w,FieldMask.typeName="google.protobuf.FieldMask",FieldMask.fields=W.w.util.newFieldList(()=>[{no:1,name:"paths",kind:"scalar",T:9,repeated:!0}]),(E=q||(q={}))[E.NULL_VALUE=0]="NULL_VALUE",W.w.util.setEnumType(q,"google.protobuf.NullValue",[{no:0,name:"NULL_VALUE"}]);let Struct=class Struct extends ep.v{constructor(e){super(),this.fields={},W.w.util.initPartial(e,this)}toJson(e){let t={};for(let[r,n]of Object.entries(this.fields))t[r]=n.toJson(e);return t}fromJson(e,t){if("object"!=typeof e||null==e||Array.isArray(e))throw Error("cannot decode google.protobuf.Struct from JSON "+W.w.json.debug(e));for(let[t,r]of Object.entries(e))this.fields[t]=Value.fromJson(r);return this}static fromBinary(e,t){return new Struct().fromBinary(e,t)}static fromJson(e,t){return new Struct().fromJson(e,t)}static fromJsonString(e,t){return new Struct().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Struct,e,t)}};Struct.runtime=W.w,Struct.typeName="google.protobuf.Struct",Struct.fields=W.w.util.newFieldList(()=>[{no:1,name:"fields",kind:"map",K:9,V:{kind:"message",T:Value}}]);let Value=class Value extends ep.v{constructor(e){super(),this.kind={case:void 0},W.w.util.initPartial(e,this)}toJson(e){switch(this.kind.case){case"nullValue":return null;case"numberValue":if(!Number.isFinite(this.kind.value))throw Error("google.protobuf.Value cannot be NaN or Infinity");return this.kind.value;case"boolValue":case"stringValue":return this.kind.value;case"structValue":case"listValue":return this.kind.value.toJson(Object.assign(Object.assign({},e),{emitDefaultValues:!0}))}throw Error("google.protobuf.Value must have a value")}fromJson(e,t){switch(typeof e){case"number":this.kind={case:"numberValue",value:e};break;case"string":this.kind={case:"stringValue",value:e};break;case"boolean":this.kind={case:"boolValue",value:e};break;case"object":null===e?this.kind={case:"nullValue",value:q.NULL_VALUE}:Array.isArray(e)?this.kind={case:"listValue",value:ListValue.fromJson(e)}:this.kind={case:"structValue",value:Struct.fromJson(e)};break;default:throw Error("cannot decode google.protobuf.Value from JSON "+W.w.json.debug(e))}return this}static fromBinary(e,t){return new Value().fromBinary(e,t)}static fromJson(e,t){return new Value().fromJson(e,t)}static fromJsonString(e,t){return new Value().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Value,e,t)}};Value.runtime=W.w,Value.typeName="google.protobuf.Value",Value.fields=W.w.util.newFieldList(()=>[{no:1,name:"null_value",kind:"enum",T:W.w.getEnumType(q),oneof:"kind"},{no:2,name:"number_value",kind:"scalar",T:1,oneof:"kind"},{no:3,name:"string_value",kind:"scalar",T:9,oneof:"kind"},{no:4,name:"bool_value",kind:"scalar",T:8,oneof:"kind"},{no:5,name:"struct_value",kind:"message",T:Struct,oneof:"kind"},{no:6,name:"list_value",kind:"message",T:ListValue,oneof:"kind"}]);let ListValue=class ListValue extends ep.v{constructor(e){super(),this.values=[],W.w.util.initPartial(e,this)}toJson(e){return this.values.map(e=>e.toJson())}fromJson(e,t){if(!Array.isArray(e))throw Error("cannot decode google.protobuf.ListValue from JSON "+W.w.json.debug(e));for(let t of e)this.values.push(Value.fromJson(t));return this}static fromBinary(e,t){return new ListValue().fromBinary(e,t)}static fromJson(e,t){return new ListValue().fromJson(e,t)}static fromJsonString(e,t){return new ListValue().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(ListValue,e,t)}};ListValue.runtime=W.w,ListValue.typeName="google.protobuf.ListValue",ListValue.fields=W.w.util.newFieldList(()=>[{no:1,name:"values",kind:"message",T:Value,repeated:!0}]);var eS=r(609);let DoubleValue=class DoubleValue extends ep.v{constructor(e){super(),this.value=0,W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.DOUBLE,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.DOUBLE,e)}catch(t){let e='cannot decode message google.protobuf.DoubleValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new DoubleValue().fromBinary(e,t)}static fromJson(e,t){return new DoubleValue().fromJson(e,t)}static fromJsonString(e,t){return new DoubleValue().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(DoubleValue,e,t)}};DoubleValue.runtime=W.w,DoubleValue.typeName="google.protobuf.DoubleValue",DoubleValue.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:1}]),DoubleValue.fieldWrapper={wrapField:e=>new DoubleValue({value:e}),unwrapField:e=>e.value};let FloatValue=class FloatValue extends ep.v{constructor(e){super(),this.value=0,W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.FLOAT,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.FLOAT,e)}catch(t){let e='cannot decode message google.protobuf.FloatValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new FloatValue().fromBinary(e,t)}static fromJson(e,t){return new FloatValue().fromJson(e,t)}static fromJsonString(e,t){return new FloatValue().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(FloatValue,e,t)}};FloatValue.runtime=W.w,FloatValue.typeName="google.protobuf.FloatValue",FloatValue.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:2}]),FloatValue.fieldWrapper={wrapField:e=>new FloatValue({value:e}),unwrapField:e=>e.value};let Int64Value=class Int64Value extends ep.v{constructor(e){super(),this.value=el.q.zero,W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.INT64,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.INT64,e)}catch(t){let e='cannot decode message google.protobuf.Int64Value from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new Int64Value().fromBinary(e,t)}static fromJson(e,t){return new Int64Value().fromJson(e,t)}static fromJsonString(e,t){return new Int64Value().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Int64Value,e,t)}};Int64Value.runtime=W.w,Int64Value.typeName="google.protobuf.Int64Value",Int64Value.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:3}]),Int64Value.fieldWrapper={wrapField:e=>new Int64Value({value:e}),unwrapField:e=>e.value};let UInt64Value=class UInt64Value extends ep.v{constructor(e){super(),this.value=el.q.zero,W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.UINT64,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.UINT64,e)}catch(t){let e='cannot decode message google.protobuf.UInt64Value from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new UInt64Value().fromBinary(e,t)}static fromJson(e,t){return new UInt64Value().fromJson(e,t)}static fromJsonString(e,t){return new UInt64Value().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(UInt64Value,e,t)}};UInt64Value.runtime=W.w,UInt64Value.typeName="google.protobuf.UInt64Value",UInt64Value.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:4}]),UInt64Value.fieldWrapper={wrapField:e=>new UInt64Value({value:e}),unwrapField:e=>e.value};let Int32Value=class Int32Value extends ep.v{constructor(e){super(),this.value=0,W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.INT32,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.INT32,e)}catch(t){let e='cannot decode message google.protobuf.Int32Value from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new Int32Value().fromBinary(e,t)}static fromJson(e,t){return new Int32Value().fromJson(e,t)}static fromJsonString(e,t){return new Int32Value().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Int32Value,e,t)}};Int32Value.runtime=W.w,Int32Value.typeName="google.protobuf.Int32Value",Int32Value.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:5}]),Int32Value.fieldWrapper={wrapField:e=>new Int32Value({value:e}),unwrapField:e=>e.value};let UInt32Value=class UInt32Value extends ep.v{constructor(e){super(),this.value=0,W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.UINT32,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.UINT32,e)}catch(t){let e='cannot decode message google.protobuf.UInt32Value from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new UInt32Value().fromBinary(e,t)}static fromJson(e,t){return new UInt32Value().fromJson(e,t)}static fromJsonString(e,t){return new UInt32Value().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(UInt32Value,e,t)}};UInt32Value.runtime=W.w,UInt32Value.typeName="google.protobuf.UInt32Value",UInt32Value.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:13}]),UInt32Value.fieldWrapper={wrapField:e=>new UInt32Value({value:e}),unwrapField:e=>e.value};let BoolValue=class BoolValue extends ep.v{constructor(e){super(),this.value=!1,W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.BOOL,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.BOOL,e)}catch(t){let e='cannot decode message google.protobuf.BoolValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new BoolValue().fromBinary(e,t)}static fromJson(e,t){return new BoolValue().fromJson(e,t)}static fromJsonString(e,t){return new BoolValue().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(BoolValue,e,t)}};BoolValue.runtime=W.w,BoolValue.typeName="google.protobuf.BoolValue",BoolValue.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:8}]),BoolValue.fieldWrapper={wrapField:e=>new BoolValue({value:e}),unwrapField:e=>e.value};let StringValue=class StringValue extends ep.v{constructor(e){super(),this.value="",W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.STRING,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.STRING,e)}catch(t){let e='cannot decode message google.protobuf.StringValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new StringValue().fromBinary(e,t)}static fromJson(e,t){return new StringValue().fromJson(e,t)}static fromJsonString(e,t){return new StringValue().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(StringValue,e,t)}};StringValue.runtime=W.w,StringValue.typeName="google.protobuf.StringValue",StringValue.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9}]),StringValue.fieldWrapper={wrapField:e=>new StringValue({value:e}),unwrapField:e=>e.value};let BytesValue=class BytesValue extends ep.v{constructor(e){super(),this.value=new Uint8Array(0),W.w.util.initPartial(e,this)}toJson(e){return W.w.json.writeScalar(X.w.BYTES,this.value,!0)}fromJson(e,t){try{this.value=W.w.json.readScalar(X.w.BYTES,e)}catch(t){let e='cannot decode message google.protobuf.BytesValue from JSON"';throw t instanceof Error&&t.message.length>0&&(e+=`: ${t.message}`),Error(e)}return this}static fromBinary(e,t){return new BytesValue().fromBinary(e,t)}static fromJson(e,t){return new BytesValue().fromJson(e,t)}static fromJsonString(e,t){return new BytesValue().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(BytesValue,e,t)}};BytesValue.runtime=W.w,BytesValue.typeName="google.protobuf.BytesValue",BytesValue.fields=W.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:12}]),BytesValue.fieldWrapper={wrapField:e=>new BytesValue({value:e}),unwrapField:e=>e.value};let eE=[ev.I,Duration,Empty,FieldMask,Struct,Value,ListValue,Timestamp,Duration,DoubleValue,FloatValue,Int64Value,Int32Value,UInt32Value,UInt64Value,BoolValue,StringValue,BytesValue],ew=[(0,eS.V3)(q)];function createRegistryFromDescriptors(e,t=!0){let r=e instanceof Uint8Array||e instanceof FileDescriptorSet?createDescriptorSet(e):e,n={},i={},o={};if(t){for(let e of eE)i[e.typeName]=e;for(let e of ew)n[e.typeName]=e}return{findEnum(e){let t=n[e];if(t)return t;let i=r.enums.get(e);if(!i)return;let o="proto3"==i.file.syntax?W.w:es,s=o.makeEnumType(e,i.values.map(e=>({no:e.number,name:e.name,localName:(0,er.r1)(e)})),{});return n[e]=s,s},findMessage(e){let t=i[e];if(t)return t;let n=r.messages.get(e);if(!n)return;let o="proto3"==n.file.syntax?W.w:es,s=[],a=o.makeMessageType(e,()=>s,{localName:(0,er.r1)(n)});for(let t of(i[e]=a,n.fields)){let e=function(e,t){switch(e.fieldKind){case"map":return function(e,t){let r={kind:"map",no:e.number,name:e.name,jsonName:e.jsonName,K:e.mapKey};if(e.mapValue.message){let n=t.findMessage(e.mapValue.message.typeName);return(0,ei.hu)(n,`message "${e.mapValue.message.typeName}" for ${e.toString()} not found`),Object.assign(Object.assign({},r),{V:{kind:"message",T:n}})}if(e.mapValue.enum){let n=t.findEnum(e.mapValue.enum.typeName);return(0,ei.hu)(n,`enum "${e.mapValue.enum.typeName}" for ${e.toString()} not found`),Object.assign(Object.assign({},r),{V:{kind:"enum",T:n}})}return Object.assign(Object.assign({},r),{V:{kind:"scalar",T:e.mapValue.scalar}})}(e,t);case"message":return function(e,t){let r=t.findMessage(e.message.typeName);(0,ei.hu)(r,`message "${e.message.typeName}" for ${e.toString()} not found`);let n={kind:"message",no:e.number,name:e.name,jsonName:e.jsonName,T:r,delimited:e.proto.type==D.GROUP};return e.repeated?Object.assign(Object.assign({},n),{repeated:!0,packed:e.packed,oneof:void 0}):e.oneof?Object.assign(Object.assign({},n),{oneof:e.oneof.name}):e.optional?Object.assign(Object.assign({},n),{opt:!0}):n}(e,t);case"enum":{let r=function(e,t){let r=t.findEnum(e.enum.typeName);(0,ei.hu)(r,`enum "${e.enum.typeName}" for ${e.toString()} not found`);let n={kind:"enum",no:e.number,name:e.name,jsonName:e.jsonName,T:r};return e.repeated?Object.assign(Object.assign({},n),{repeated:!0,packed:e.packed,oneof:void 0}):e.oneof?Object.assign(Object.assign({},n),{oneof:e.oneof.name}):e.optional?Object.assign(Object.assign({},n),{opt:!0}):n}(e,t);return r.default=e.getDefaultValue(),r}case"scalar":{let t=function(e){let t=e.longType==X.p.STRING?{L:X.p.STRING}:{},r=Object.assign({kind:"scalar",no:e.number,name:e.name,jsonName:e.jsonName,T:e.scalar},t);return e.repeated?Object.assign(Object.assign({},r),{repeated:!0,packed:e.packed,oneof:void 0,T:e.scalar}):e.oneof?Object.assign(Object.assign({},r),{oneof:e.oneof.name}):e.optional?Object.assign(Object.assign({},r),{opt:!0}):r}(e);return t.default=e.getDefaultValue(),t}}}(t,this);s.push(e)}return a},findService(e){let t=o[e];if(t)return t;let n=r.services.get(e);if(!n)return;let i={};for(let e of n.methods){let t=this.findMessage(e.input.typeName),r=this.findMessage(e.output.typeName);(0,ei.hu)(t,`message "${e.input.typeName}" for ${e.toString()} not found`),(0,ei.hu)(r,`output message "${e.output.typeName}" for ${e.toString()} not found`),i[(0,er.r1)(e)]={name:e.name,I:t,O:r,kind:e.methodKind,idempotency:e.idempotency}}return o[e]={typeName:n.typeName,methods:i}}}}function toPlainMessage(e){if(!(e instanceof ep.v))return e;let t=e.getType(),r={};for(let n of t.fields.byMember()){let t;let i=e[n.localName];if(n.repeated)t=i.map(e=>toPlainValue(e));else if("map"==n.kind)for(let[e,r]of(t={},Object.entries(i)))t[e]=toPlainValue(r);else if("oneof"==n.kind){let e=n.findField(i.case);t=e?{case:i.case,value:toPlainValue(i.value)}:{case:void 0}}else t=toPlainValue(i);r[n.localName]=t}return r}function toPlainValue(e){if(void 0===e)return e;if(e instanceof ep.v)return toPlainMessage(e);if(e instanceof Uint8Array){let t=new Uint8Array(e.byteLength);return t.set(e),t}return e}let Version=class Version extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new Version().fromBinary(e,t)}static fromJson(e,t){return new Version().fromJson(e,t)}static fromJsonString(e,t){return new Version().fromJsonString(e,t)}static equals(e,t){return es.util.equals(Version,e,t)}};Version.runtime=es,Version.typeName="google.protobuf.compiler.Version",Version.fields=es.util.newFieldList(()=>[{no:1,name:"major",kind:"scalar",T:5,opt:!0},{no:2,name:"minor",kind:"scalar",T:5,opt:!0},{no:3,name:"patch",kind:"scalar",T:5,opt:!0},{no:4,name:"suffix",kind:"scalar",T:9,opt:!0}]);let CodeGeneratorRequest=class CodeGeneratorRequest extends ep.v{constructor(e){super(),this.fileToGenerate=[],this.protoFile=[],this.sourceFileDescriptors=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new CodeGeneratorRequest().fromBinary(e,t)}static fromJson(e,t){return new CodeGeneratorRequest().fromJson(e,t)}static fromJsonString(e,t){return new CodeGeneratorRequest().fromJsonString(e,t)}static equals(e,t){return es.util.equals(CodeGeneratorRequest,e,t)}};CodeGeneratorRequest.runtime=es,CodeGeneratorRequest.typeName="google.protobuf.compiler.CodeGeneratorRequest",CodeGeneratorRequest.fields=es.util.newFieldList(()=>[{no:1,name:"file_to_generate",kind:"scalar",T:9,repeated:!0},{no:2,name:"parameter",kind:"scalar",T:9,opt:!0},{no:15,name:"proto_file",kind:"message",T:FileDescriptorProto,repeated:!0},{no:17,name:"source_file_descriptors",kind:"message",T:FileDescriptorProto,repeated:!0},{no:3,name:"compiler_version",kind:"message",T:Version,opt:!0}]);let CodeGeneratorResponse=class CodeGeneratorResponse extends ep.v{constructor(e){super(),this.file=[],es.util.initPartial(e,this)}static fromBinary(e,t){return new CodeGeneratorResponse().fromBinary(e,t)}static fromJson(e,t){return new CodeGeneratorResponse().fromJson(e,t)}static fromJsonString(e,t){return new CodeGeneratorResponse().fromJsonString(e,t)}static equals(e,t){return es.util.equals(CodeGeneratorResponse,e,t)}};CodeGeneratorResponse.runtime=es,CodeGeneratorResponse.typeName="google.protobuf.compiler.CodeGeneratorResponse",CodeGeneratorResponse.fields=es.util.newFieldList(()=>[{no:1,name:"error",kind:"scalar",T:9,opt:!0},{no:2,name:"supported_features",kind:"scalar",T:4,opt:!0},{no:15,name:"file",kind:"message",T:CodeGeneratorResponse_File,repeated:!0}]),(w=G||(G={}))[w.NONE=0]="NONE",w[w.PROTO3_OPTIONAL=1]="PROTO3_OPTIONAL",w[w.SUPPORTS_EDITIONS=2]="SUPPORTS_EDITIONS",es.util.setEnumType(G,"google.protobuf.compiler.CodeGeneratorResponse.Feature",[{no:0,name:"FEATURE_NONE"},{no:1,name:"FEATURE_PROTO3_OPTIONAL"},{no:2,name:"FEATURE_SUPPORTS_EDITIONS"}]);let CodeGeneratorResponse_File=class CodeGeneratorResponse_File extends ep.v{constructor(e){super(),es.util.initPartial(e,this)}static fromBinary(e,t){return new CodeGeneratorResponse_File().fromBinary(e,t)}static fromJson(e,t){return new CodeGeneratorResponse_File().fromJson(e,t)}static fromJsonString(e,t){return new CodeGeneratorResponse_File().fromJsonString(e,t)}static equals(e,t){return es.util.equals(CodeGeneratorResponse_File,e,t)}};CodeGeneratorResponse_File.runtime=es,CodeGeneratorResponse_File.typeName="google.protobuf.compiler.CodeGeneratorResponse.File",CodeGeneratorResponse_File.fields=es.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"insertion_point",kind:"scalar",T:9,opt:!0},{no:15,name:"content",kind:"scalar",T:9,opt:!0},{no:16,name:"generated_code_info",kind:"message",T:GeneratedCodeInfo,opt:!0}]);let SourceContext=class SourceContext extends ep.v{constructor(e){super(),this.fileName="",W.w.util.initPartial(e,this)}static fromBinary(e,t){return new SourceContext().fromBinary(e,t)}static fromJson(e,t){return new SourceContext().fromJson(e,t)}static fromJsonString(e,t){return new SourceContext().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(SourceContext,e,t)}};SourceContext.runtime=W.w,SourceContext.typeName="google.protobuf.SourceContext",SourceContext.fields=W.w.util.newFieldList(()=>[{no:1,name:"file_name",kind:"scalar",T:9}]),(N=Y||(Y={}))[N.PROTO2=0]="PROTO2",N[N.PROTO3=1]="PROTO3",N[N.EDITIONS=2]="EDITIONS",W.w.util.setEnumType(Y,"google.protobuf.Syntax",[{no:0,name:"SYNTAX_PROTO2"},{no:1,name:"SYNTAX_PROTO3"},{no:2,name:"SYNTAX_EDITIONS"}]);let Type=class Type extends ep.v{constructor(e){super(),this.name="",this.fields=[],this.oneofs=[],this.options=[],this.syntax=Y.PROTO2,this.edition="",W.w.util.initPartial(e,this)}static fromBinary(e,t){return new Type().fromBinary(e,t)}static fromJson(e,t){return new Type().fromJson(e,t)}static fromJsonString(e,t){return new Type().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Type,e,t)}};Type.runtime=W.w,Type.typeName="google.protobuf.Type",Type.fields=W.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"fields",kind:"message",T:Field,repeated:!0},{no:3,name:"oneofs",kind:"scalar",T:9,repeated:!0},{no:4,name:"options",kind:"message",T:Option,repeated:!0},{no:5,name:"source_context",kind:"message",T:SourceContext},{no:6,name:"syntax",kind:"enum",T:W.w.getEnumType(Y)},{no:7,name:"edition",kind:"scalar",T:9}]);let Field=class Field extends ep.v{constructor(e){super(),this.kind=K.TYPE_UNKNOWN,this.cardinality=z.UNKNOWN,this.number=0,this.name="",this.typeUrl="",this.oneofIndex=0,this.packed=!1,this.options=[],this.jsonName="",this.defaultValue="",W.w.util.initPartial(e,this)}static fromBinary(e,t){return new Field().fromBinary(e,t)}static fromJson(e,t){return new Field().fromJson(e,t)}static fromJsonString(e,t){return new Field().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Field,e,t)}};Field.runtime=W.w,Field.typeName="google.protobuf.Field",Field.fields=W.w.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:W.w.getEnumType(K)},{no:2,name:"cardinality",kind:"enum",T:W.w.getEnumType(z)},{no:3,name:"number",kind:"scalar",T:5},{no:4,name:"name",kind:"scalar",T:9},{no:6,name:"type_url",kind:"scalar",T:9},{no:7,name:"oneof_index",kind:"scalar",T:5},{no:8,name:"packed",kind:"scalar",T:8},{no:9,name:"options",kind:"message",T:Option,repeated:!0},{no:10,name:"json_name",kind:"scalar",T:9},{no:11,name:"default_value",kind:"scalar",T:9}]),(b=K||(K={}))[b.TYPE_UNKNOWN=0]="TYPE_UNKNOWN",b[b.TYPE_DOUBLE=1]="TYPE_DOUBLE",b[b.TYPE_FLOAT=2]="TYPE_FLOAT",b[b.TYPE_INT64=3]="TYPE_INT64",b[b.TYPE_UINT64=4]="TYPE_UINT64",b[b.TYPE_INT32=5]="TYPE_INT32",b[b.TYPE_FIXED64=6]="TYPE_FIXED64",b[b.TYPE_FIXED32=7]="TYPE_FIXED32",b[b.TYPE_BOOL=8]="TYPE_BOOL",b[b.TYPE_STRING=9]="TYPE_STRING",b[b.TYPE_GROUP=10]="TYPE_GROUP",b[b.TYPE_MESSAGE=11]="TYPE_MESSAGE",b[b.TYPE_BYTES=12]="TYPE_BYTES",b[b.TYPE_UINT32=13]="TYPE_UINT32",b[b.TYPE_ENUM=14]="TYPE_ENUM",b[b.TYPE_SFIXED32=15]="TYPE_SFIXED32",b[b.TYPE_SFIXED64=16]="TYPE_SFIXED64",b[b.TYPE_SINT32=17]="TYPE_SINT32",b[b.TYPE_SINT64=18]="TYPE_SINT64",W.w.util.setEnumType(K,"google.protobuf.Field.Kind",[{no:0,name:"TYPE_UNKNOWN"},{no:1,name:"TYPE_DOUBLE"},{no:2,name:"TYPE_FLOAT"},{no:3,name:"TYPE_INT64"},{no:4,name:"TYPE_UINT64"},{no:5,name:"TYPE_INT32"},{no:6,name:"TYPE_FIXED64"},{no:7,name:"TYPE_FIXED32"},{no:8,name:"TYPE_BOOL"},{no:9,name:"TYPE_STRING"},{no:10,name:"TYPE_GROUP"},{no:11,name:"TYPE_MESSAGE"},{no:12,name:"TYPE_BYTES"},{no:13,name:"TYPE_UINT32"},{no:14,name:"TYPE_ENUM"},{no:15,name:"TYPE_SFIXED32"},{no:16,name:"TYPE_SFIXED64"},{no:17,name:"TYPE_SINT32"},{no:18,name:"TYPE_SINT64"}]),(I=z||(z={}))[I.UNKNOWN=0]="UNKNOWN",I[I.OPTIONAL=1]="OPTIONAL",I[I.REQUIRED=2]="REQUIRED",I[I.REPEATED=3]="REPEATED",W.w.util.setEnumType(z,"google.protobuf.Field.Cardinality",[{no:0,name:"CARDINALITY_UNKNOWN"},{no:1,name:"CARDINALITY_OPTIONAL"},{no:2,name:"CARDINALITY_REQUIRED"},{no:3,name:"CARDINALITY_REPEATED"}]);let Enum=class Enum extends ep.v{constructor(e){super(),this.name="",this.enumvalue=[],this.options=[],this.syntax=Y.PROTO2,this.edition="",W.w.util.initPartial(e,this)}static fromBinary(e,t){return new Enum().fromBinary(e,t)}static fromJson(e,t){return new Enum().fromJson(e,t)}static fromJsonString(e,t){return new Enum().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Enum,e,t)}};Enum.runtime=W.w,Enum.typeName="google.protobuf.Enum",Enum.fields=W.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"enumvalue",kind:"message",T:EnumValue,repeated:!0},{no:3,name:"options",kind:"message",T:Option,repeated:!0},{no:4,name:"source_context",kind:"message",T:SourceContext},{no:5,name:"syntax",kind:"enum",T:W.w.getEnumType(Y)},{no:6,name:"edition",kind:"scalar",T:9}]);let EnumValue=class EnumValue extends ep.v{constructor(e){super(),this.name="",this.number=0,this.options=[],W.w.util.initPartial(e,this)}static fromBinary(e,t){return new EnumValue().fromBinary(e,t)}static fromJson(e,t){return new EnumValue().fromJson(e,t)}static fromJsonString(e,t){return new EnumValue().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(EnumValue,e,t)}};EnumValue.runtime=W.w,EnumValue.typeName="google.protobuf.EnumValue",EnumValue.fields=W.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"number",kind:"scalar",T:5},{no:3,name:"options",kind:"message",T:Option,repeated:!0}]);let Option=class Option extends ep.v{constructor(e){super(),this.name="",W.w.util.initPartial(e,this)}static fromBinary(e,t){return new Option().fromBinary(e,t)}static fromJson(e,t){return new Option().fromJson(e,t)}static fromJsonString(e,t){return new Option().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Option,e,t)}};Option.runtime=W.w,Option.typeName="google.protobuf.Option",Option.fields=W.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"value",kind:"message",T:ev.I}]);let Api=class Api extends ep.v{constructor(e){super(),this.name="",this.methods=[],this.options=[],this.version="",this.mixins=[],this.syntax=Y.PROTO2,W.w.util.initPartial(e,this)}static fromBinary(e,t){return new Api().fromBinary(e,t)}static fromJson(e,t){return new Api().fromJson(e,t)}static fromJsonString(e,t){return new Api().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Api,e,t)}};Api.runtime=W.w,Api.typeName="google.protobuf.Api",Api.fields=W.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"methods",kind:"message",T:Method,repeated:!0},{no:3,name:"options",kind:"message",T:Option,repeated:!0},{no:4,name:"version",kind:"scalar",T:9},{no:5,name:"source_context",kind:"message",T:SourceContext},{no:6,name:"mixins",kind:"message",T:Mixin,repeated:!0},{no:7,name:"syntax",kind:"enum",T:W.w.getEnumType(Y)}]);let Method=class Method extends ep.v{constructor(e){super(),this.name="",this.requestTypeUrl="",this.requestStreaming=!1,this.responseTypeUrl="",this.responseStreaming=!1,this.options=[],this.syntax=Y.PROTO2,W.w.util.initPartial(e,this)}static fromBinary(e,t){return new Method().fromBinary(e,t)}static fromJson(e,t){return new Method().fromJson(e,t)}static fromJsonString(e,t){return new Method().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Method,e,t)}};Method.runtime=W.w,Method.typeName="google.protobuf.Method",Method.fields=W.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"request_type_url",kind:"scalar",T:9},{no:3,name:"request_streaming",kind:"scalar",T:8},{no:4,name:"response_type_url",kind:"scalar",T:9},{no:5,name:"response_streaming",kind:"scalar",T:8},{no:6,name:"options",kind:"message",T:Option,repeated:!0},{no:7,name:"syntax",kind:"enum",T:W.w.getEnumType(Y)}]);let Mixin=class Mixin extends ep.v{constructor(e){super(),this.name="",this.root="",W.w.util.initPartial(e,this)}static fromBinary(e,t){return new Mixin().fromBinary(e,t)}static fromJson(e,t){return new Mixin().fromJson(e,t)}static fromJsonString(e,t){return new Mixin().fromJsonString(e,t)}static equals(e,t){return W.w.util.equals(Mixin,e,t)}};Mixin.runtime=W.w,Mixin.typeName="google.protobuf.Mixin",Mixin.fields=W.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"root",kind:"scalar",T:9}])},561:(e,t,r)=>{r.d(t,{v:()=>Message});let Message=class Message{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){let r=this.getType(),n=r.runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){let r=this.getType(),n=r.runtime.json,i=n.makeReadOptions(t);return n.readMessage(r,e,i,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(e){throw Error(`cannot decode ${this.getType().typeName} from JSON: ${e instanceof Error?e.message:String(e)}`)}return this.fromJson(r,t)}toBinary(e){let t=this.getType(),r=t.runtime.bin,n=r.makeWriteOptions(e),i=n.writerFactory();return r.writeMessage(this,i,n),i.finish()}toJson(e){let t=this.getType(),r=t.runtime.json,n=r.makeWriteOptions(e);return r.writeMessage(this,n)}toJsonString(e){var t;let r=this.toJson(e);return JSON.stringify(r,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}},120:(e,t,r)=>{function assert(e,t){if(!e)throw Error(t)}function assertInt32(e){if("number"!=typeof e)throw Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw Error("invalid int 32: "+e)}function assertUInt32(e){if("number"!=typeof e)throw Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw Error("invalid uint 32: "+e)}function assertFloat32(e){if("number"!=typeof e)throw Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw Error("invalid float 32: "+e)}r.d(t,{E_:()=>assertFloat32,fp:()=>assertUInt32,hu:()=>assert,ug:()=>assertInt32})},744:(e,t,r)=>{r.d(t,{Jj:()=>writePacked,NN:()=>writeScalar,gQ:()=>writeMapEntry,gY:()=>makeBinaryFormatCommon,oQ:()=>writeMessageField});var n=r(79),i=r(561),o=r(465),s=r(432),a=r(781),l=r(120);let u=Symbol("@bufbuild/protobuf/unknown-fields"),d={readUnknownFields:!0,readerFactory:e=>new n.oP(e)},c={writeUnknownFields:!0,writerFactory:()=>new n.Lt};function makeReadOptions(e){return e?Object.assign(Object.assign({},d),e):d}function makeWriteOptions(e){return e?Object.assign(Object.assign({},c),e):c}function makeBinaryFormatCommon(){return{makeReadOptions,makeWriteOptions,listUnknownFields(e){var t;return null!==(t=e[u])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[u]},writeUnknownFields(e,t){let r=e[u];if(r)for(let e of r)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,r,n){Array.isArray(e[u])||(e[u]=[]),e[u].push({no:t,wireType:r,data:n})},readMessage(e,t,r,s,l){let u,d;let c=e.getType(),h=l?t.len:t.pos+r;for(;t.pos<h&&([u,d]=t.tag(),d!=n.TD.EndGroup);){let r=c.fields.find(u);if(!r){let r=t.skip(d);s.readUnknownFields&&this.onUnknownField(e,u,d,r);continue}let l=e,h=r.repeated,m=r.localName;switch(r.oneof&&((l=l[r.oneof.localName]).case!=m&&delete l.value,l.case=m,m="value"),r.kind){case"scalar":case"enum":let f="enum"==r.kind?o.w.INT32:r.T,p=readScalar;if("scalar"==r.kind&&r.L>0&&(p=readScalarLTString),h){let e=l[m];if(d==n.TD.LengthDelimited&&f!=o.w.STRING&&f!=o.w.BYTES){let r=t.uint32()+t.pos;for(;t.pos<r;)e.push(p(t,f))}else e.push(p(t,f))}else l[m]=p(t,f);break;case"message":let g=r.T;h?l[m].push(readMessageField(t,new g,s,r)):l[m]instanceof i.v?readMessageField(t,l[m],s,r):(l[m]=readMessageField(t,new g,s,r),!g.fieldWrapper||r.oneof||r.repeated||(l[m]=g.fieldWrapper.unwrapField(l[m])));break;case"map":let[T,y]=function(e,t,r){let n,i;let s=t.uint32(),l=t.pos+s;for(;t.pos<l;){let[o]=t.tag();switch(o){case 1:n=readScalar(t,e.K);break;case 2:switch(e.V.kind){case"scalar":i=readScalar(t,e.V.T);break;case"enum":i=t.int32();break;case"message":i=readMessageField(t,new e.V.T,r,void 0)}}}if(void 0===n){let t=(0,a.kY)(e.K,o.p.BIGINT);n=e.K==o.w.BOOL?t.toString():t}if("string"!=typeof n&&"number"!=typeof n&&(n=n.toString()),void 0===i)switch(e.V.kind){case"scalar":i=(0,a.kY)(e.V.T,o.p.BIGINT);break;case"enum":i=0;break;case"message":i=new e.V.T}return[n,i]}(r,t,s);l[m][T]=y}}if(l&&(d!=n.TD.EndGroup||u!==r))throw Error("invalid end group tag")}}}function readMessageField(e,t,r,n){let i=t.getType().runtime.bin,o=null==n?void 0:n.delimited;return i.readMessage(t,e,o?null==n?void 0:n.no:e.uint32(),r,o),t}function readScalarLTString(e,t){let r=readScalar(e,t);return"bigint"==typeof r?r.toString():r}function readScalar(e,t){switch(t){case o.w.STRING:return e.string();case o.w.BOOL:return e.bool();case o.w.DOUBLE:return e.double();case o.w.FLOAT:return e.float();case o.w.INT32:return e.int32();case o.w.INT64:return e.int64();case o.w.UINT64:return e.uint64();case o.w.FIXED64:return e.fixed64();case o.w.BYTES:return e.bytes();case o.w.FIXED32:return e.fixed32();case o.w.SFIXED32:return e.sfixed32();case o.w.SFIXED64:return e.sfixed64();case o.w.SINT64:return e.sint64();case o.w.UINT32:return e.uint32();case o.w.SINT32:return e.sint32()}}function writeMapEntry(e,t,r,i,s){e.tag(r.no,n.TD.LengthDelimited),e.fork();let a=i;switch(r.K){case o.w.INT32:case o.w.FIXED32:case o.w.UINT32:case o.w.SFIXED32:case o.w.SINT32:a=Number.parseInt(i);break;case o.w.BOOL:(0,l.hu)("true"==i||"false"==i),a="true"==i}switch(writeScalar(e,r.K,1,a,!0),r.V.kind){case"scalar":writeScalar(e,r.V.T,2,s,!0);break;case"enum":writeScalar(e,o.w.INT32,2,s,!0);break;case"message":e.tag(2,n.TD.LengthDelimited).bytes(s.toBinary(t))}e.join()}function writeMessageField(e,t,r,i){if(void 0!==i){let o=(0,s.E)(r.T,i);(null==r?void 0:r.delimited)?e.tag(r.no,n.TD.StartGroup).raw(o.toBinary(t)).tag(r.no,n.TD.EndGroup):e.tag(r.no,n.TD.LengthDelimited).bytes(o.toBinary(t))}}function writeScalar(e,t,r,n,i){let[o,s,l]=(0,a.T1)(t,n);(!l||i)&&e.tag(r,o)[s](n)}function writePacked(e,t,r,i){if(!i.length)return;e.tag(r,n.TD.LengthDelimited).fork();let[,o]=(0,a.T1)(t);for(let t=0;t<i.length;t++)e[o](i[t]);e.join()}},609:(e,t,r)=>{r.d(t,{V3:()=>getEnumType,be:()=>makeEnumType,ut:()=>makeEnum,zg:()=>setEnumType});var n=r(120);let i=Symbol("@bufbuild/protobuf/enum-type");function getEnumType(e){let t=e[i];return(0,n.hu)(t,"missing enum type on enum object"),t}function setEnumType(e,t,r,n){e[i]=makeEnumType(t,r.map(t=>({no:t.no,name:t.name,localName:e[t.no]})),n)}function makeEnumType(e,t,r){let n=Object.create(null),i=Object.create(null),o=[];for(let e of t){let t=normalizeEnumValue(e);o.push(t),n[e.name]=t,i[e.no]=t}return{typeName:e,values:o,findName:e=>n[e],findNumber:e=>i[e]}}function makeEnum(e,t,r){let n={};for(let e of t){let t=normalizeEnumValue(e);n[t.localName]=t.no,n[t.no]=t.localName}return setEnumType(n,e,t,r),n}function normalizeEnumValue(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}},501:(e,t,r)=>{r.d(t,{i:()=>InternalFieldList});let InternalFieldList=class InternalFieldList{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){let e={};for(let t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){let e={};for(let t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){let e;this.members=[];let t=this.members;for(let r of this.list())r.oneof?r.oneof!==e&&(e=r.oneof,t.push(e)):t.push(r)}return this.members}}},432:(e,t,r)=>{r.d(t,{E:()=>wrapField,w:()=>getUnwrappedFieldType});var n=r(561),i=r(465);function wrapField(e,t){return t instanceof n.v||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}function getUnwrappedFieldType(e){if("message"===e.fieldKind&&!e.repeated&&void 0==e.oneof)return o[e.message.typeName]}let o={"google.protobuf.DoubleValue":i.w.DOUBLE,"google.protobuf.FloatValue":i.w.FLOAT,"google.protobuf.Int64Value":i.w.INT64,"google.protobuf.UInt64Value":i.w.UINT64,"google.protobuf.Int32Value":i.w.INT32,"google.protobuf.UInt32Value":i.w.UINT32,"google.protobuf.BoolValue":i.w.BOOL,"google.protobuf.StringValue":i.w.STRING,"google.protobuf.BytesValue":i.w.BYTES}},215:(e,t,r)=>{r.d(t,{o:()=>InternalOneofInfo});var n=r(504),i=r(120);let InternalOneofInfo=class InternalOneofInfo{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=(0,n.uA)(e)}addField(e){(0,i.hu)(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}},814:(e,t,r)=>{r.d(t,{b:()=>makeJsonFormatCommon});var n=r(561),i=r(465),o=r(120),s=r(210),a=r(236);let l={ignoreUnknownFields:!1},u={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function makeReadOptions(e){return e?Object.assign(Object.assign({},l),e):l}function makeWriteOptions(e){return e?Object.assign(Object.assign({},u),e):u}function makeJsonFormatCommon(e){let t=e(writeEnum,writeScalar);return{makeReadOptions,makeWriteOptions,readMessage(e,t,r,o){if(null==t||Array.isArray(t)||"object"!=typeof t)throw Error(`cannot decode message ${e.typeName} from JSON: ${this.debug(t)}`);o=null!=o?o:new e;let s={};for(let[a,l]of Object.entries(t)){let t=e.fields.findJsonName(a);if(!t){if(!r.ignoreUnknownFields)throw Error(`cannot decode message ${e.typeName} from JSON: key "${a}" is unknown`);continue}let u=t.localName,d=o;if(t.oneof){if(null===l&&"scalar"==t.kind)continue;let r=s[t.oneof.localName];if(r)throw Error(`cannot decode message ${e.typeName} from JSON: multiple keys for oneof "${t.oneof.name}" present: "${r}", "${a}"`);s[t.oneof.localName]=a,d=d[t.oneof.localName]={case:u},u="value"}if(t.repeated){if(null===l)continue;if(!Array.isArray(l))throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(l)}`);let n=d[u];for(let i of l){let o;if(null===i)throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(i)}`);switch(t.kind){case"message":o=t.T.fromJson(i,r);break;case"enum":if(void 0===(o=readEnum(t.T,i,r.ignoreUnknownFields)))continue;break;case"scalar":try{o=readScalar(t.T,i,t.L)}catch(n){let r=`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(i)}`;throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),Error(r)}}n.push(o)}}else if("map"==t.kind){if(null===l)continue;if(Array.isArray(l)||"object"!=typeof l)throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(l)}`);let n=d[u];for(let[o,s]of Object.entries(l)){let a;if(null===s)throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: map value null`);switch(t.V.kind){case"message":a=t.V.T.fromJson(s,r);break;case"enum":if(void 0===(a=readEnum(t.V.T,s,r.ignoreUnknownFields)))continue;break;case"scalar":try{a=readScalar(t.V.T,s,i.p.BIGINT)}catch(n){let r=`cannot decode map value for field ${e.typeName}.${t.name} from JSON: ${this.debug(l)}`;throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),Error(r)}}try{n[readScalar(t.K,t.K==i.w.BOOL?"true"==o||"false"!=o&&o:o,i.p.BIGINT).toString()]=a}catch(n){let r=`cannot decode map key for field ${e.typeName}.${t.name} from JSON: ${this.debug(l)}`;throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),Error(r)}}}else switch(t.kind){case"message":let c=t.T;if(null===l&&"google.protobuf.Value"!=c.typeName){if(t.oneof)throw Error(`cannot decode field ${e.typeName}.${t.name} from JSON: null is invalid for oneof field "${a}"`);continue}d[u]instanceof n.v?d[u].fromJson(l,r):(d[u]=c.fromJson(l,r),c.fieldWrapper&&!t.oneof&&(d[u]=c.fieldWrapper.unwrapField(d[u])));break;case"enum":let h=readEnum(t.T,l,r.ignoreUnknownFields);void 0!==h&&(d[u]=h);break;case"scalar":try{d[u]=readScalar(t.T,l,t.L)}catch(n){let r=`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(l)}`;throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),Error(r)}}}return o},writeMessage(e,r){let n;let i=e.getType(),o={};try{for(let s of i.fields.byMember()){let i;if("oneof"==s.kind){let o=e[s.localName];if(void 0===o.value)continue;if(!(n=s.findField(o.case)))throw"oneof case not found: "+o.case;i=t(n,o.value,r)}else n=s,i=t(n,e[n.localName],r);void 0!==i&&(o[r.useProtoFieldName?n.name:n.jsonName]=i)}}catch(r){let e=n?`cannot encode field ${i.typeName}.${n.name} to JSON`:`cannot encode message ${i.typeName} to JSON`,t=r instanceof Error?r.message:String(r);throw Error(e+(t.length>0?`: ${t}`:""))}return o},readScalar,writeScalar,debug:debugJsonValue}}function debugJsonValue(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":`"${e.split('"').join('\\"')}"`;default:return String(e)}}function readScalar(e,t,r){switch(e){case i.w.DOUBLE:case i.w.FLOAT:if(null===t)return 0;if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t||"string"==typeof t&&t.trim().length!==t.length||"string"!=typeof t&&"number"!=typeof t)break;let n=Number(t);if(Number.isNaN(n)||!Number.isFinite(n))break;return e==i.w.FLOAT&&(0,o.E_)(n),n;case i.w.INT32:case i.w.FIXED32:case i.w.SFIXED32:case i.w.SINT32:case i.w.UINT32:let l;if(null===t)return 0;if("number"==typeof t?l=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(l=Number(t)),void 0===l)break;return e==i.w.UINT32?(0,o.fp)(l):(0,o.ug)(l),l;case i.w.INT64:case i.w.SFIXED64:case i.w.SINT64:if(null===t)return s.q.zero;if("number"!=typeof t&&"string"!=typeof t)break;let u=s.q.parse(t);return r?u.toString():u;case i.w.FIXED64:case i.w.UINT64:if(null===t)return s.q.zero;if("number"!=typeof t&&"string"!=typeof t)break;let d=s.q.uParse(t);return r?d.toString():d;case i.w.BOOL:if(null===t)return!1;if("boolean"!=typeof t)break;return t;case i.w.STRING:if(null===t)return"";if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw Error("invalid UTF8")}return t;case i.w.BYTES:if(null===t||""===t)return new Uint8Array(0);if("string"!=typeof t)break;return a.W.dec(t)}throw Error()}function readEnum(e,t,r){if(null===t)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":let n=e.findName(t);if(n||r)return null==n?void 0:n.no}throw Error(`cannot decode enum ${e.typeName} from JSON: ${debugJsonValue(t)}`)}function writeEnum(e,t,r,n){var i;if(void 0===t)return t;if(0===t&&!r)return;if(n)return t;if("google.protobuf.NullValue"==e.typeName)return null;let o=e.findNumber(t);return null!==(i=null==o?void 0:o.name)&&void 0!==i?i:t}function writeScalar(e,t,r){if(void 0!==t)switch(e){case i.w.INT32:case i.w.SFIXED32:case i.w.SINT32:case i.w.FIXED32:case i.w.UINT32:return(0,o.hu)("number"==typeof t),0!=t||r?t:void 0;case i.w.FLOAT:case i.w.DOUBLE:if((0,o.hu)("number"==typeof t),Number.isNaN(t))return"NaN";if(t===Number.POSITIVE_INFINITY)return"Infinity";if(t===Number.NEGATIVE_INFINITY)return"-Infinity";return 0!==t||r?t:void 0;case i.w.STRING:return(0,o.hu)("string"==typeof t),t.length>0||r?t:void 0;case i.w.BOOL:return(0,o.hu)("boolean"==typeof t),t||r?t:void 0;case i.w.UINT64:case i.w.FIXED64:case i.w.INT64:case i.w.SFIXED64:case i.w.SINT64:return(0,o.hu)("bigint"==typeof t||"string"==typeof t||"number"==typeof t),r||0!=t?t.toString(10):void 0;case i.w.BYTES:return(0,o.hu)(t instanceof Uint8Array),r||t.byteLength>0?a.W.enc(t):void 0}}},504:(e,t,r)=>{function localName(e){switch(e.kind){case"field":return localFieldName(e.name,void 0!==e.oneof);case"oneof":return localOneofName(e.name);case"enum":case"message":case"service":{let t=e.file.proto.package,r=void 0===t?0:t.length+1,n=e.typeName.substring(r).replace(/\./g,"_");return safeObjectProperty(safeIdentifier(n))}case"enum_value":{let t=e.parent.sharedPrefix;if(void 0===t)return e.name;let r=e.name.substring(t.length);return safeObjectProperty(r)}case"rpc":{let t=e.name;if(0==t.length)return t;return safeObjectProperty(t=t[0].toLowerCase()+t.substring(1))}}}function localFieldName(e,t){let r=protoCamelCase(e);return t?r:safeObjectProperty(safeMessageProperty(r))}function localOneofName(e){return localFieldName(e,!1)}r.d(t,{GD:()=>safeIdentifier,Rz:()=>localFieldName,Sm:()=>findEnumSharedPrefix,ll:()=>safeObjectProperty,r1:()=>localName,uA:()=>localOneofName,x1:()=>n});let n=protoCamelCase;function findEnumSharedPrefix(e,t){let r=(e.substring(0,1)+e.substring(1).replace(/[A-Z]/g,e=>"_"+e)).toLowerCase()+"_";for(let e of t){if(!e.toLowerCase().startsWith(r))return;let t=e.substring(r.length);if(0==t.length||/^\d/.test(t))return}return r}function protoCamelCase(e){let t=!1,r=[];for(let n=0;n<e.length;n++){let i=e.charAt(n);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),r.push(i)}}return r.join("")}let i=new Set(["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","enum","implements","interface","let","package","private","protected","public","static","Object","bigint","number","boolean","string","object","globalThis","Uint8Array","Partial"]),o=new Set(["constructor","toString","toJSON","valueOf"]),s=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),fallback=e=>`${e}$`,safeMessageProperty=e=>s.has(e)?fallback(e):e,safeObjectProperty=e=>o.has(e)?fallback(e):e,safeIdentifier=e=>i.has(e)?fallback(e):e},493:(e,t,r)=>{r.d(t,{F:()=>makeProtoRuntime});var n=r(609),i=r(561);function makeProtoRuntime(e,t,r,o){return{syntax:e,json:t,bin:r,util:o,makeMessageType(e,t,r){return function(e,t,r,n){var o;let s=null!==(o=null==n?void 0:n.localName)&&void 0!==o?o:t.substring(t.lastIndexOf(".")+1),a={[s]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[s];return Object.setPrototypeOf(a.prototype,new i.v),Object.assign(a,{runtime:e,typeName:t,fields:e.util.newFieldList(r),fromBinary:(e,t)=>new a().fromBinary(e,t),fromJson:(e,t)=>new a().fromJson(e,t),fromJsonString:(e,t)=>new a().fromJsonString(e,t),equals:(t,r)=>e.util.equals(a,t,r)}),a}(this,e,t,r)},makeEnum:n.ut,makeEnumType:n.be,getEnumType:n.V3}}},781:(e,t,r)=>{r.d(t,{AA:()=>scalarEquals,T1:()=>scalarTypeInfo,kY:()=>scalarDefaultValue});var n=r(465),i=r(79),o=r(210);function scalarEquals(e,t,r){if(t===r)return!0;if(e==n.w.BYTES){if(!(t instanceof Uint8Array)||!(r instanceof Uint8Array)||t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==r[e])return!1;return!0}switch(e){case n.w.UINT64:case n.w.FIXED64:case n.w.INT64:case n.w.SFIXED64:case n.w.SINT64:return t==r}return!1}function scalarDefaultValue(e,t){switch(e){case n.w.BOOL:return!1;case n.w.UINT64:case n.w.FIXED64:case n.w.INT64:case n.w.SFIXED64:case n.w.SINT64:return 0==t?o.q.zero:"0";case n.w.DOUBLE:case n.w.FLOAT:return 0;case n.w.BYTES:return new Uint8Array(0);case n.w.STRING:return"";default:return 0}}function scalarTypeInfo(e,t){let r=void 0===t,o=i.TD.Varint,s=0===t;switch(e){case n.w.STRING:s=r||!t.length,o=i.TD.LengthDelimited;break;case n.w.BOOL:s=!1===t;break;case n.w.DOUBLE:o=i.TD.Bit64;break;case n.w.FLOAT:o=i.TD.Bit32;break;case n.w.INT64:case n.w.UINT64:s=r||0==t;break;case n.w.FIXED64:s=r||0==t,o=i.TD.Bit64;break;case n.w.BYTES:s=r||!t.byteLength,o=i.TD.LengthDelimited;break;case n.w.FIXED32:case n.w.SFIXED32:o=i.TD.Bit32;break;case n.w.SFIXED64:s=r||0==t,o=i.TD.Bit64;break;case n.w.SINT64:s=r||0==t}let a=n.w[e].toLowerCase();return[o,a,r||s]}},433:(e,t,r)=>{r.d(t,{f:()=>makeUtilCommon});var n=r(609),i=r(561),o=r(465),s=r(781);function makeUtilCommon(){return{setEnumType:n.zg,initPartial(e,t){if(void 0===e)return;let r=t.getType();for(let n of r.fields.byMember()){let r=n.localName;if(void 0!==e[r])switch(n.kind){case"oneof":let i=e[r].case;if(void 0===i)continue;let s=n.findField(i),a=e[r].value;!s||"message"!=s.kind||a instanceof s.T?s&&"scalar"===s.kind&&s.T===o.w.BYTES&&(a=toU8Arr(a)):a=new s.T(a),t[r]={case:i,value:a};break;case"scalar":case"enum":let l=e[r];n.T===o.w.BYTES&&(l=n.repeated?l.map(toU8Arr):toU8Arr(l)),t[r]=l;break;case"map":switch(n.V.kind){case"scalar":case"enum":if(n.V.T===o.w.BYTES)for(let[n,i]of Object.entries(e[r]))t[r][n]=toU8Arr(i);else Object.assign(t[r],e[r]);break;case"message":let u=n.V.T;for(let n of Object.keys(e[r])){let i=e[r][n];u.fieldWrapper||(i=new u(i)),t[r][n]=i}}break;case"message":let d=n.T;if(n.repeated)t[r]=e[r].map(e=>e instanceof d?e:new d(e));else if(void 0!==e[r]){let n=e[r];d.fieldWrapper?"google.protobuf.BytesValue"===d.typeName?t[r]=toU8Arr(n):t[r]=n:t[r]=n instanceof d?n:new d(n)}}}},equals:(e,t,r)=>t===r||!!t&&!!r&&e.fields.byMember().every(e=>{let n=t[e.localName],i=r[e.localName];if(e.repeated){if(n.length!==i.length)return!1;switch(e.kind){case"message":return n.every((t,r)=>e.T.equals(t,i[r]));case"scalar":return n.every((t,r)=>(0,s.AA)(e.T,t,i[r]));case"enum":return n.every((e,t)=>(0,s.AA)(o.w.INT32,e,i[t]))}throw Error(`repeated cannot contain ${e.kind}`)}switch(e.kind){case"message":return e.T.equals(n,i);case"enum":return(0,s.AA)(o.w.INT32,n,i);case"scalar":return(0,s.AA)(e.T,n,i);case"oneof":if(n.case!==i.case)return!1;let a=e.findField(n.case);if(void 0===a)return!0;switch(a.kind){case"message":return a.T.equals(n.value,i.value);case"enum":return(0,s.AA)(o.w.INT32,n.value,i.value);case"scalar":return(0,s.AA)(a.T,n.value,i.value)}throw Error(`oneof cannot contain ${a.kind}`);case"map":let l=Object.keys(n).concat(Object.keys(i));switch(e.V.kind){case"message":let u=e.V.T;return l.every(e=>u.equals(n[e],i[e]));case"enum":return l.every(e=>(0,s.AA)(o.w.INT32,n[e],i[e]));case"scalar":let d=e.V.T;return l.every(e=>(0,s.AA)(d,n[e],i[e]))}}}),clone(e){let t=e.getType(),r=new t;for(let n of t.fields.byMember()){let t;let i=e[n.localName];if(n.repeated)t=i.map(cloneSingularField);else if("map"==n.kind)for(let[e,o]of(t=r[n.localName],Object.entries(i)))t[e]=cloneSingularField(o);else if("oneof"==n.kind){let e=n.findField(i.case);t=e?{case:i.case,value:cloneSingularField(i.value)}:{case:void 0}}else t=cloneSingularField(i);r[n.localName]=t}return r}}}function cloneSingularField(e){if(void 0===e)return e;if(e instanceof i.v)return e.clone();if(e instanceof Uint8Array){let t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function toU8Arr(e){return e instanceof Uint8Array?e:new Uint8Array(e)}},236:(e,t,r)=>{r.d(t,{W:()=>o});let n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),i=[];for(let e=0;e<n.length;e++)i[n[e].charCodeAt(0)]=e;i["-".charCodeAt(0)]=n.indexOf("+"),i["_".charCodeAt(0)]=n.indexOf("/");let o={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let r=new Uint8Array(t),n=0,o=0,s,a=0;for(let t=0;t<e.length;t++){if(void 0===(s=i[e.charCodeAt(t)]))switch(e[t]){case"=":o=0;case"\n":case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:a=s,o=1;break;case 1:r[n++]=a<<2|(48&s)>>4,a=s,o=2;break;case 2:r[n++]=(15&a)<<4|(60&s)>>2,a=s,o=3;break;case 3:r[n++]=(3&a)<<6|s,o=0}}if(1==o)throw Error("invalid base64 string.");return r.subarray(0,n)},enc(e){let t="",r=0,i,o=0;for(let s=0;s<e.length;s++)switch(i=e[s],r){case 0:t+=n[i>>2],o=(3&i)<<4,r=1;break;case 1:t+=n[o|i>>4],o=(15&i)<<2,r=2;break;case 2:t+=n[o|i>>6]+n[63&i],r=0}return r&&(t+=n[o]+"=",1==r&&(t+="=")),t}}},210:(e,t,r)=>{r.d(t,{q:()=>s});var i=r(120),o=r(818);let s=function(){let e=new DataView(new ArrayBuffer(8)),t="function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof n||"object"!=typeof n.env||"1"!==n.env.BUF_BIGINT_DISABLE);if(t){let t=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),n=BigInt("0"),i=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){let n="bigint"==typeof e?e:BigInt(e);if(n>r||n<t)throw Error(`int64 invalid: ${e}`);return n},uParse(e){let t="bigint"==typeof e?e:BigInt(e);if(t>i||t<n)throw Error(`uint64 invalid: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigInt64(0,!0)),uDec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigUint64(0,!0))}}let assertInt64String=e=>(0,i.hu)(/^-?[0-9]+$/.test(e),`int64 invalid: ${e}`),assertUInt64String=e=>(0,i.hu)(/^[0-9]+$/.test(e),`uint64 invalid: ${e}`);return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),assertInt64String(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),assertUInt64String(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),assertInt64String(e),(0,o.CZ)(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),assertUInt64String(e),(0,o.CZ)(e)),dec:(e,t)=>(0,o.Ak)(e,t),uDec:(e,t)=>(0,o.Fd)(e,t)}}()},850:(e,t,r)=>{r.d(t,{w:()=>f});var n=r(493),i=r(465),o=r(744),s=r(432),a=r(120),l=r(814),u=r(433),d=r(501),c=r(781),h=r(215),m=r(504);let f=(0,n.F)("proto3",(0,l.b)((e,t)=>function(r,n,i){if("map"==r.kind){let o={};switch(r.V.kind){case"scalar":for(let[e,i]of Object.entries(n)){let n=t(r.V.T,i,!0);(0,a.hu)(void 0!==n),o[e.toString()]=n}break;case"message":for(let[e,t]of Object.entries(n))o[e.toString()]=t.toJson(i);break;case"enum":let s=r.V.T;for(let[t,r]of Object.entries(n)){(0,a.hu)(void 0===r||"number"==typeof r);let n=e(s,r,!0,i.enumAsInteger);(0,a.hu)(void 0!==n),o[t.toString()]=n}}return i.emitDefaultValues||Object.keys(o).length>0?o:void 0}if(r.repeated){let o=[];switch(r.kind){case"scalar":for(let e=0;e<n.length;e++)o.push(t(r.T,n[e],!0));break;case"enum":for(let t=0;t<n.length;t++)o.push(e(r.T,n[t],!0,i.enumAsInteger));break;case"message":for(let e=0;e<n.length;e++)o.push((0,s.E)(r.T,n[e]).toJson(i))}return i.emitDefaultValues||o.length>0?o:void 0}switch(r.kind){case"scalar":return t(r.T,n,!!r.oneof||r.opt||i.emitDefaultValues);case"enum":return e(r.T,n,!!r.oneof||r.opt||i.emitDefaultValues,i.enumAsInteger);case"message":return void 0!==n?(0,s.E)(r.T,n).toJson(i):void 0}}),Object.assign(Object.assign({},(0,o.gY)()),{writeMessage(e,t,r){let n=e.getType();for(let s of n.fields.byNumber()){let n,a=s.repeated,l=s.localName;if(s.oneof){let t=e[s.oneof.localName];if(t.case!==l)continue;n=t.value}else n=e[l];switch(s.kind){case"scalar":case"enum":let u="enum"==s.kind?i.w.INT32:s.T;if(a){if(s.packed)(0,o.Jj)(t,u,s.no,n);else for(let e of n)(0,o.NN)(t,u,s.no,e,!0)}else void 0!==n&&(0,o.NN)(t,u,s.no,n,!!s.oneof||s.opt);break;case"message":if(a)for(let e of n)(0,o.oQ)(t,r,s,e);else(0,o.oQ)(t,r,s,n);break;case"map":for(let[e,i]of Object.entries(n))(0,o.gQ)(t,r,s,e,i)}}return r.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),Object.assign(Object.assign({},(0,u.f)()),{newFieldList:e=>new d.i(e,normalizeFieldInfosProto3),initFields(e){for(let t of e.getType().fields.byMember()){if(t.opt)continue;let r=t.localName;if(t.repeated){e[r]=[];continue}switch(t.kind){case"oneof":e[r]={case:void 0};break;case"enum":e[r]=0;break;case"map":e[r]={};break;case"scalar":e[r]=(0,c.kY)(t.T,t.L)}}}}));function normalizeFieldInfosProto3(e){var t,r,n,o;let s;let a=[];for(let l of"function"==typeof e?e():e){if(l.localName=(0,m.Rz)(l.name,void 0!==l.oneof),l.jsonName=null!==(t=l.jsonName)&&void 0!==t?t:(0,m.x1)(l.name),l.repeated=null!==(r=l.repeated)&&void 0!==r&&r,"scalar"==l.kind&&(l.L=null!==(n=l.L)&&void 0!==n?n:i.p.BIGINT),void 0!==l.oneof){let e="string"==typeof l.oneof?l.oneof:l.oneof.name;s&&s.name==e||(s=new h.o(e)),l.oneof=s,s.addField(l)}"message"==l.kind&&(l.delimited=!1),l.packed=null!==(o=l.packed)&&void 0!==o?o:"enum"==l.kind||"scalar"==l.kind&&l.T!=i.w.BYTES&&l.T!=i.w.STRING,a.push(l)}return a}},328:(e,t,r)=>{var n,i,o,s;r.d(t,{t:()=>n,w:()=>i}),(o=n||(n={}))[o.Unary=0]="Unary",o[o.ServerStreaming=1]="ServerStreaming",o[o.ClientStreaming=2]="ClientStreaming",o[o.BiDiStreaming=3]="BiDiStreaming",(s=i||(i={}))[s.NoSideEffects=1]="NoSideEffects",s[s.Idempotent=2]="Idempotent"}},t={};function __nested_webpack_require_489521__(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,__nested_webpack_require_489521__),i.exports}__nested_webpack_require_489521__.d=(e,t)=>{for(var r in t)__nested_webpack_require_489521__.o(t,r)&&!__nested_webpack_require_489521__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__nested_webpack_require_489521__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__nested_webpack_require_489521__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{__nested_webpack_require_489521__.r(r),__nested_webpack_require_489521__.d(r,{Change:()=>Change,Client:()=>Client,ClientEventType:()=>L,ClientStatus:()=>R,Counter:()=>Counter,DocEventType:()=>P,Document:()=>Document,DocumentSyncResultType:()=>F,EventSourceDevPanel:()=>ey,EventSourceSDK:()=>ev,Primitive:()=>Primitive,StreamConnectionStatus:()=>x,SyncMode:()=>C,Text:()=>Text,TimeTicket:()=>TimeTicket,Tree:()=>Tree,converter:()=>eT,default:()=>eN}),(v=S||(S={}))[v.Trivial=0]="Trivial",v[v.Debug=1]="Debug",v[v.Info=2]="Info",v[v.Warn=3]="Warn",v[v.Error=4]="Error",v[v.Fatal=5]="Fatal";let e=S.Info,t={trivial:(...t)=>{e>S.Trivial||"undefined"==typeof console||console.log("YORKIE T:",...t)},debug:(...t)=>{e>S.Debug||"undefined"==typeof console||console.log("YORKIE D:",...t)},info:(...t)=>{e>S.Info||"undefined"==typeof console||console.log("YORKIE I:",...t)},warn:(...t)=>{e>S.Warn||"undefined"==typeof console||(void 0!==console.warn?console.warn("YORKIE W:",...t):console.log("YORKIE W:",...t))},error:(...t)=>{e>S.Error||"undefined"==typeof console||(void 0!==console.error?console.error("YORKIE E:",...t):console.log("YORKIE E:",...t))},fatal:(e,...t)=>{throw"undefined"!=typeof console&&(void 0!==console.error?console.error("YORKIE F:",...t):console.log("YORKIE F:",...t)),Error(`YORKIE F: ${e}`)},isEnabled:t=>e<=t};function uuid(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}let Noop=()=>{};let ObserverProxy=class ObserverProxy{constructor(e){this.finalized=!1,this.observers=[];try{e(this)}catch(e){this.error(e)}}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;e||t.fatal("missing observer"),this.finalized&&t.fatal("observable is finalized due to previous error"),void 0===(i="object"==typeof e?e:{next:e,error:r,complete:n}).next&&(i.next=Noop),void 0===i.error&&(i.error=Noop),void 0===i.complete&&(i.complete=Noop);let o=uuid(),s=this.unsubscribeOne.bind(this,o);if(this.observers.push({subscriptionID:o,observer:i}),this.finalized)try{this.finalError?i.error(this.finalError):i.complete()}catch(e){t.warn(e)}return s}unsubscribeOne(e){var t;this.observers=null===(t=this.observers)||void 0===t?void 0:t.filter(t=>t.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,r){if(void 0!==this.observers&&void 0!==this.observers[e])try{r(this.observers[e].observer)}catch(e){t.error(e)}}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.observers=void 0)}};function createObservable(e){let t=new ObserverProxy(e);return{subscribe:t.subscribe.bind(t),getProxy:()=>t}}var n,i,o,s,a,l,u,d,c,h,m,f,p,g,T,y,v,S,E,w,N,b,I,k,O,D,A,_,P,C,R,x,F,L,B=__nested_webpack_require_489521__(328);(n=E||(E={}))[n.Canceled=1]="Canceled",n[n.Unknown=2]="Unknown",n[n.InvalidArgument=3]="InvalidArgument",n[n.DeadlineExceeded=4]="DeadlineExceeded",n[n.NotFound=5]="NotFound",n[n.AlreadyExists=6]="AlreadyExists",n[n.PermissionDenied=7]="PermissionDenied",n[n.ResourceExhausted=8]="ResourceExhausted",n[n.FailedPrecondition=9]="FailedPrecondition",n[n.Aborted=10]="Aborted",n[n.OutOfRange=11]="OutOfRange",n[n.Unimplemented=12]="Unimplemented",n[n.Internal=13]="Internal",n[n.Unavailable=14]="Unavailable",n[n.DataLoss=15]="DataLoss",n[n.Unauthenticated=16]="Unauthenticated";var V=__nested_webpack_require_489521__(561);function codeToString(e){let t=E[e];return"string"!=typeof t?e.toString():t[0].toLowerCase()+t.substring(1).replace(/[A-Z]/g,e=>"_"+e.toLowerCase())}let connect_error_ConnectError=class connect_error_ConnectError extends Error{constructor(e,t=E.Unknown,r,n,i){super(e.length?`[${codeToString(t)}] ${e}`:`[${codeToString(t)}]`),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(null!=r?r:{}),this.details=null!=n?n:[],this.cause=i}static from(e,t=E.Unknown){return e instanceof connect_error_ConnectError?e:e instanceof Error?"AbortError"==e.name?new connect_error_ConnectError(e.message,E.Canceled):new connect_error_ConnectError(e.message,t,void 0,void 0,e):new connect_error_ConnectError(String(e),t,void 0,void 0,e)}findDetails(e){let t="typeName"in e?{findMessage:t=>t===e.typeName?e:void 0}:e,r=[];for(let e of this.details){if(e instanceof V.v){t.findMessage(e.getType().typeName)&&r.push(e);continue}let n=t.findMessage(e.type);if(n)try{r.push(n.fromBinary(e.value))}catch(e){}}return r}};var __asyncValues=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,i,(t=e[r](t)).done,t.value)})}}},__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)},__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},verb("next"),verb("throw"),verb("return"),n[Symbol.asyncIterator]=function(){return this},n;function verb(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||resume(e,t)})})}function resume(e,t){try{var r;(r=i[e](t)).value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(o[0][2],r)}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}},__asyncDelegator=function(e){var t,r;return t={},verb("next"),verb("throw",function(e){throw e}),verb("return"),t[Symbol.iterator]=function(){return this},t;function verb(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:__await(e[n](t)),done:!1}:i?i(t):t}:i}},promise_client_asyncValues=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,i,(t=e[r](t)).done,t.value)})}}},promise_client_await=function(e){return this instanceof promise_client_await?(this.v=e,this):new promise_client_await(e)},promise_client_asyncDelegator=function(e){var t,r;return t={},verb("next"),verb("throw",function(e){throw e}),verb("return"),t[Symbol.iterator]=function(){return this},t;function verb(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:promise_client_await(e[n](t)),done:!1}:i?i(t):t}:i}},promise_client_asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},verb("next"),verb("throw"),verb("return"),n[Symbol.asyncIterator]=function(){return this},n;function verb(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||resume(e,t)})})}function resume(e,t){try{var r;(r=i[e](t)).value instanceof promise_client_await?Promise.resolve(r.value.v).then(fulfill,reject):settle(o[0][2],r)}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}};function handleStreamResponse(e,t){let r=(function(){var r,n;return promise_client_asyncGenerator(this,arguments,function*(){let i=yield promise_client_await(e);null===(r=null==t?void 0:t.onHeader)||void 0===r||r.call(t,i.header),yield promise_client_await((yield*promise_client_asyncDelegator(promise_client_asyncValues(i.message)))),null===(n=null==t?void 0:t.onTrailer)||void 0===n||n.call(t,i.trailer)})})()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>r.next()})}}function createContextValues(){return{get(e){return e.id in this?this[e.id]:e.defaultValue},set(e,t){return this[e.id]=t,this},delete(e){return delete this[e.id],this}}}function createClientMethodSerializers(e,t,r,n){let i=t?createBinarySerialization(e.I,n):createJsonSerialization(e.I,r),o=t?createBinarySerialization(e.O,n):createJsonSerialization(e.O,r);return{parse:o.parse,serialize:i.serialize}}function createBinarySerialization(e,t){return{parse(r){try{return e.fromBinary(r,t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new connect_error_ConnectError(`parse binary: ${e}`,E.InvalidArgument)}},serialize(e){try{return e.toBinary(t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new connect_error_ConnectError(`serialize binary: ${e}`,E.Internal)}}}}function createJsonSerialization(e,t){var r,n;let i=null!==(r=null==t?void 0:t.textEncoder)&&void 0!==r?r:new TextEncoder,o=null!==(n=null==t?void 0:t.textDecoder)&&void 0!==n?n:new TextDecoder,s=function(e){var t;let r=Object.assign({},e);return null!==(t=r.ignoreUnknownFields)&&void 0!==t||(r.ignoreUnknownFields=!0),r}(t);return{parse(t){try{let r=o.decode(t);return e.fromJsonString(r,s)}catch(e){throw connect_error_ConnectError.from(e,E.InvalidArgument)}},serialize(e){try{let t=e.toJsonString(s);return i.encode(t)}catch(e){throw connect_error_ConnectError.from(e,E.Internal)}}}}function getAbortSignalReason(e){if(!e.aborted)return;if(void 0!==e.reason)return e.reason;let t=Error("This operation was aborted");return t.name="AbortError",t}function normalize(e,t){return t instanceof V.v?t:new e(t)}function setupSignal(e){let{signal:t,cleanup:r}=function(e){let t;let r=new AbortController,listener=()=>{r.abort(new connect_error_ConnectError("the operation timed out",E.DeadlineExceeded))};return void 0!==e&&(e<=0?listener():t=setTimeout(listener,e)),{signal:r.signal,cleanup:()=>clearTimeout(t)}}(e.timeoutMs),n=function(...e){let t=new AbortController,r=e.filter(e=>void 0!==e).concat(t.signal);for(let e of r){if(e.aborted){onAbort.apply(e);break}e.addEventListener("abort",onAbort)}function onAbort(){for(let e of(t.signal.aborted||t.abort(getAbortSignalReason(this)),r))e.removeEventListener("abort",onAbort)}return t}(e.signal,t);return[n.signal,function(e){let i=connect_error_ConnectError.from(t.aborted?getAbortSignalReason(t):e);return n.abort(i),r(),Promise.reject(i)},function(){r(),n.abort()}]}function applyInterceptors(e,t){var r;return null!==(r=null==t?void 0:t.concat().reverse().reduce((e,t)=>t(e),e))&&void 0!==r?r:e}function createMethodUrl(e,t,r){let n="string"==typeof t?t:t.typeName,i="string"==typeof r?r:r.name;return e.toString().replace(/\/?$/,`/${n}/${i}`)}function createEnvelopeReadableStream(e){let t;let r=new Uint8Array(0);return new ReadableStream({start(){t=e.getReader()},async pull(e){let n;for(;;){if(void 0===n&&r.byteLength>=5){let e=0;for(let t=1;t<5;t++)e=(e<<8)+r[t];n={flags:r[0],length:e}}if(void 0!==n&&r.byteLength>=n.length+5)break;let e=await t.read();if(e.done)break;!function(e){let t=new Uint8Array(r.length+e.length);t.set(r),t.set(e,r.length),r=t}(e.value)}if(void 0===n){if(0==r.byteLength){e.close();return}e.error(new connect_error_ConnectError("premature end of stream",E.DataLoss));return}let i=r.subarray(5,5+n.length);r=r.subarray(5+n.length),e.enqueue({flags:n.flags,data:i})}})}function envelope_encodeEnvelope(e,t){let r=new Uint8Array(t.length+5);r.set(t,5);let n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.setUint8(0,e),n.setUint32(1,t.length),r}let M="Grpc-Status",J="Grpc-Message";function requestHeader(e,t,r,n){let i=new Headers(null!=r?r:{});return i.set("Content-Type",e?"application/grpc-web+proto":"application/grpc-web+json"),i.set("X-Grpc-Web","1"),i.set("X-User-Agent","connect-es/1.2.0"),n&&i.set("User-Agent","connect-es/1.2.0"),void 0!==t&&i.set("Grpc-Timeout",`${t}m`),i}var U=__nested_webpack_require_489521__(850),j=__nested_webpack_require_489521__(733);let status_pb_Status=class status_pb_Status extends V.v{constructor(e){super(),this.code=0,this.message="",this.details=[],U.w.util.initPartial(e,this)}static fromBinary(e,t){return new status_pb_Status().fromBinary(e,t)}static fromJson(e,t){return new status_pb_Status().fromJson(e,t)}static fromJsonString(e,t){return new status_pb_Status().fromJsonString(e,t)}static equals(e,t){return U.w.util.equals(status_pb_Status,e,t)}};status_pb_Status.runtime=U.w,status_pb_Status.typeName="google.rpc.Status",status_pb_Status.fields=U.w.util.newFieldList(()=>[{no:1,name:"code",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"details",kind:"message",T:j.I,repeated:!0}]);var $=__nested_webpack_require_489521__(236);function findTrailerError(e){var t;let r=e.get("Grpc-Status-Details-Bin");if(null!=r){let t=function(e,t,r){try{let r=$.W.dec(e);if(t)return t.fromBinary(r,void 0);return r}catch(e){throw connect_error_ConnectError.from(e,E.DataLoss)}}(r,status_pb_Status);if(0==t.code)return;let n=new connect_error_ConnectError(t.message,t.code,e);return n.details=t.details.map(e=>({type:e.typeUrl.substring(e.typeUrl.lastIndexOf("/")+1),value:e.value})),n}let n=e.get(M);if(null!=n){if("0"===n)return;let r=parseInt(n,10);return r in E?new connect_error_ConnectError(decodeURIComponent(null!==(t=e.get(J))&&void 0!==t?t:""),r,e):new connect_error_ConnectError(`invalid grpc-status: ${n}`,E.Internal,e)}}function validateResponse(e,t){var r;if(e>=200&&e<300){let e=findTrailerError(t);if(e)throw e;return{foundStatus:t.has(M)}}throw new connect_error_ConnectError(decodeURIComponent(null!==(r=t.get(J))&&void 0!==r?r:`HTTP ${e}`),function(e){switch(e){case 400:return E.Internal;case 401:return E.Unauthenticated;case 403:return E.PermissionDenied;case 404:return E.Unimplemented;case 429:case 502:case 503:case 504:return E.Unavailable;default:return E.Unknown}}(e),t)}function trailerParse(e){let t=new Headers,r=new TextDecoder().decode(e).split("\r\n");for(let e of r){if(""===e)continue;let r=e.indexOf(":");if(r>0){let n=e.substring(0,r).trim(),i=e.substring(r+1).trim();t.append(n,i)}}return t}function validateTrailer(e,t){let r=findTrailerError(e);if(r)throw t.forEach((e,t)=>{r.metadata.append(t,e)}),r}var grpc_web_transport_await=function(e){return this instanceof grpc_web_transport_await?(this.v=e,this):new grpc_web_transport_await(e)},grpc_web_transport_asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},verb("next"),verb("throw"),verb("return"),n[Symbol.asyncIterator]=function(){return this},n;function verb(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||resume(e,t)})})}function resume(e,t){try{var r;(r=i[e](t)).value instanceof grpc_web_transport_await?Promise.resolve(r.value.v).then(fulfill,reject):settle(o[0][2],r)}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}},q=__nested_webpack_require_489521__(295),G=__nested_webpack_require_489521__(646),Y=null;try{Y=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function isLong(e){return!0===(e&&e.__isLong__)}function ctz32(e){var t=Math.clz32(e&-e);return e?31-t:t}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var K={},z={};function fromInt(e,t){var r,n,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(n=z[e]))?n:(r=fromBits(e,0,!0),i&&(z[e]=r),r):(e|=0,(i=-128<=e&&e<128)&&(n=K[e]))?n:(r=fromBits(e,e<0?-1:0,!1),i&&(K[e]=r),r)}function fromNumber(e,t){if(isNaN(e))return t?et:ee;if(t){if(e<0)return et;if(e>=X)return es}else{if(e<=-Z)return ea;if(e+1>=Z)return eo}return e<0?fromNumber(-e,t).neg():fromBits(e%H|0,e/H|0,t)}function fromBits(e,t,r){return new Long(e,t,r)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var W=Math.pow;function fromString(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?et:ee;if((r=r||10)<2||36<r)throw RangeError("radix");if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return fromString(e.substring(1),t,r).neg();for(var n,i=fromNumber(W(r,8)),o=ee,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+a),r);if(a<8){var u=fromNumber(W(r,a));o=o.mul(u).add(fromNumber(l))}else o=(o=o.mul(i)).add(fromNumber(l))}return o.unsigned=t,o}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var H=4294967296,X=18446744073709552e3,Z=0x7fffffffffffffff,Q=fromInt(16777216),ee=fromInt(0);Long.ZERO=ee;var et=fromInt(0,!0);Long.UZERO=et;var er=fromInt(1);Long.ONE=er;var en=fromInt(1,!0);Long.UONE=en;var ei=fromInt(-1);Long.NEG_ONE=ei;var eo=fromBits(-1,2147483647,!1);Long.MAX_VALUE=eo;var es=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=es;var ea=fromBits(0,-2147483648,!1);Long.MIN_VALUE=ea;var el=Long.prototype;el.toInt=function(){return this.unsigned?this.low>>>0:this.low},el.toNumber=function(){return this.unsigned?(this.high>>>0)*H+(this.low>>>0):this.high*H+(this.low>>>0)},el.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(ea))return"-"+this.neg().toString(e);var t=fromNumber(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}for(var i=fromNumber(W(e,6),this.unsigned),o=this,s="";;){var a=o.div(i),l=(o.sub(a.mul(i)).toInt()>>>0).toString(e);if((o=a).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},el.getHighBits=function(){return this.high},el.getHighBitsUnsigned=function(){return this.high>>>0},el.getLowBits=function(){return this.low},el.getLowBitsUnsigned=function(){return this.low>>>0},el.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ea)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},el.isZero=function(){return 0===this.high&&0===this.low},el.eqz=el.isZero,el.isNegative=function(){return!this.unsigned&&this.high<0},el.isPositive=function(){return this.unsigned||this.high>=0},el.isOdd=function(){return(1&this.low)==1},el.isEven=function(){return(1&this.low)==0},el.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},el.eq=el.equals,el.notEquals=function(e){return!this.eq(e)},el.neq=el.notEquals,el.ne=el.notEquals,el.lessThan=function(e){return 0>this.comp(e)},el.lt=el.lessThan,el.lessThanOrEqual=function(e){return 0>=this.comp(e)},el.lte=el.lessThanOrEqual,el.le=el.lessThanOrEqual,el.greaterThan=function(e){return this.comp(e)>0},el.gt=el.greaterThan,el.greaterThanOrEqual=function(e){return this.comp(e)>=0},el.gte=el.greaterThanOrEqual,el.ge=el.greaterThanOrEqual,el.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},el.comp=el.compare,el.negate=function(){return!this.unsigned&&this.eq(ea)?ea:this.not().add(er)},el.neg=el.negate,el.add=function(e){isLong(e)||(e=fromValue(e));var t,r,n=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,l=65535&e.high,u=e.low>>>16,d=65535&e.low,c=0,h=0;return t=0+((r=0+(s+d))>>>16),r&=65535,t+=o+u,h+=t>>>16,t&=65535,h+=i+l,c+=h>>>16,h&=65535,c+=n+a,fromBits(t<<16|r,(c&=65535)<<16|h,this.unsigned)},el.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},el.sub=el.subtract,el.multiply=function(e){if(this.isZero())return this;if(isLong(e)||(e=fromValue(e)),Y)return fromBits(Y.mul(this.low,this.high,e.low,e.high),Y.get_high(),this.unsigned);if(e.isZero())return this.unsigned?et:ee;if(this.eq(ea))return e.isOdd()?ea:ee;if(e.eq(ea))return this.isOdd()?ea:ee;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Q)&&e.lt(Q))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t,r,n=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,l=65535&e.high,u=e.low>>>16,d=65535&e.low,c=0,h=0;return t=0+((r=0+s*d)>>>16),r&=65535,t+=o*d,h+=t>>>16,t&=65535,t+=s*u,h+=t>>>16,t&=65535,h+=i*d,c+=h>>>16,h&=65535,h+=o*u,c+=h>>>16,h&=65535,h+=s*l,c+=h>>>16,h&=65535,c+=n*d+i*u+o*l+s*a,fromBits(t<<16|r,(c&=65535)<<16|h,this.unsigned)},el.mul=el.multiply,el.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");if(Y){var t,r,n;return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?fromBits((this.unsigned?Y.div_u:Y.div_s)(this.low,this.high,e.low,e.high),Y.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?et:ee;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return et;if(e.gt(this.shru(1)))return en;n=et}else{if(this.eq(ea))return e.eq(er)||e.eq(ei)?ea:e.eq(ea)?er:(t=this.shr(1).div(e).shl(1)).eq(ee)?e.isNegative()?er:ei:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(ea))return this.unsigned?et:ee;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=ee}for(r=this;r.gte(e);){for(var i=Math.ceil(Math.log(t=Math.max(1,Math.floor(r.toNumber()/e.toNumber())))/Math.LN2),o=i<=48?1:W(2,i-48),s=fromNumber(t),a=s.mul(e);a.isNegative()||a.gt(r);)t-=o,a=(s=fromNumber(t,this.unsigned)).mul(e);s.isZero()&&(s=er),n=n.add(s),r=r.sub(a)}return n},el.div=el.divide,el.modulo=function(e){return(isLong(e)||(e=fromValue(e)),Y)?fromBits((this.unsigned?Y.rem_u:Y.rem_s)(this.low,this.high,e.low,e.high),Y.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},el.mod=el.modulo,el.rem=el.modulo,el.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},el.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},el.clz=el.countLeadingZeros,el.countTrailingZeros=function(){return this.low?ctz32(this.low):ctz32(this.high)+32},el.ctz=el.countTrailingZeros,el.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},el.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},el.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},el.shiftLeft=function(e){return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},el.shl=el.shiftLeft,el.shiftRight=function(e){return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},el.shr=el.shiftRight,el.shiftRightUnsigned=function(e){return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):32===e?fromBits(this.high,0,this.unsigned):fromBits(this.high>>>e-32,0,this.unsigned)},el.shru=el.shiftRightUnsigned,el.shr_u=el.shiftRightUnsigned,el.rotateLeft=function(e){var t;return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?fromBits(this.high,this.low,this.unsigned):e<32?(t=32-e,fromBits(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,fromBits(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},el.rotl=el.rotateLeft,el.rotateRight=function(e){var t;return(isLong(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?fromBits(this.high,this.low,this.unsigned):e<32?(t=32-e,fromBits(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,fromBits(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},el.rotr=el.rotateRight,el.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},el.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},el.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},el.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},el.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function(e,t,r){return r?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},(i=w||(w={})).Ok="ok",i.ClientNotActive="client-not-active",i.Unimplemented="unimplemented",i.Unsupported="unsupported",i.DocumentNotAttached="document-not-attached",i.DocumentNotDetached="document-not-detached",i.DocumentRemoved="document-removed",i.InvalidObjectKey="invalid-object-key",i.InvalidArgument="invalid-argument";let YorkieError=class YorkieError extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="YorkieError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};function deepcopy(e){if(e instanceof Map){let t=Array.from(e);return new Map(JSON.parse(JSON.stringify(t)))}return JSON.parse(JSON.stringify(e))}let isEmpty=e=>!e||0===Object.entries(e).length,stringifyObjectValues=e=>{let t={};for(let[r,n]of Object.entries(e))t[r]=JSON.stringify(n);return t},parseObjectValues=e=>{let t={};for(let[r,n]of Object.entries(e))t[r]=JSON.parse(n);return t};(o=N||(N={})).Put="put",o.Clear="clear";let Presence=class Presence{constructor(e,t){this.context=e,this.presence=t}set(e,t){for(let t of Object.keys(e))this.presence[t]=e[t];this.context.setPresenceChange({type:N.Put,presence:deepcopy(this.presence)}),this.context.setReversePresence(e,t)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:N.Clear})}};let eu="000000000000000000000000";let TimeTicket=class TimeTicket{constructor(e,t,r){this.lamport=e,this.delimiter=t,this.actorID=r}static of(e,t,r){return new TimeTicket(e,t,r)}static fromStruct(e){return TimeTicket.of(Long.fromString(e.lamport,!0),e.delimiter,e.actorID)}toIDString(){return this.actorID?`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`:`${this.lamport.toString()}:nil:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return this.actorID?`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`:`${this.lamport.toString()}:nil:${this.delimiter}`}setActor(e){return new TimeTicket(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return 0===this.compare(e)}compare(e){if(this.lamport.greaterThan(e.lamport))return 1;if(e.lamport.greaterThan(this.lamport))return -1;let t=this.actorID.localeCompare(e.actorID);return 0!==t?t:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}};let ed=Long.MAX_VALUE,ec=new TimeTicket(Long.fromNumber(0),0,eu),eh=new TimeTicket(ed,4294967295,"FFFFFFFFFFFFFFFFFFFFFFFF");function escapeString(e){return e.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case"\n":return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}let CRDTElement=class CRDTElement{constructor(e){this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setMovedAt(e){return!!(!this.movedAt||e&&e.after(this.movedAt))&&(this.movedAt=e,!0)}setRemovedAt(e){this.removedAt=e}remove(e){return!!(e&&e.after(this.getPositionedAt())&&(!this.removedAt||e.after(this.removedAt)))&&(this.removedAt=e,!0)}isRemoved(){return!!this.removedAt}};let CRDTContainer=class CRDTContainer extends CRDTElement{constructor(e){super(e)}};let CRDTGCElement=class CRDTGCElement extends CRDTElement{};let ElementRHTNode=class ElementRHTNode{constructor(e,t){this.strKey=e,this.value=t}static of(e,t){return new ElementRHTNode(e,t)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}};let ElementRHT=class ElementRHT{constructor(){this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new ElementRHT}set(e,t,r){let n;let i=this.nodeMapByKey.get(e);null!=i&&!i.isRemoved()&&i.remove(r)&&(n=i.getValue());let o=ElementRHTNode.of(e,t);return this.nodeMapByCreatedAt.set(t.getCreatedAt().toIDString(),o),(null==i||r.after(i.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,o),t.setMovedAt(r)),n}delete(e,r){this.nodeMapByCreatedAt.has(e.toIDString())||t.fatal(`fail to find ${e.toIDString()}`);let n=this.nodeMapByCreatedAt.get(e.toIDString());return n.remove(r),n.getValue()}subPathOf(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return t.getStrKey()}purge(e){let r=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!r){t.fatal(`fail to find ${e.getCreatedAt().toIDString()}`);return}let n=this.nodeMapByKey.get(r.getStrKey());r===n&&this.nodeMapByKey.delete(n.getStrKey()),this.nodeMapByCreatedAt.delete(r.getValue().getCreatedAt().toIDString())}deleteByKey(e,t){let r=this.nodeMapByKey.get(e);if(null!=r&&r.remove(t))return r.getValue()}has(e){let t=this.nodeMapByKey.get(e);return null!=t&&!t.isRemoved()}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){let t=this.nodeMapByKey.get(e);if(!(!t||t.isRemoved()))return t}*[Symbol.iterator](){for(let[,e]of this.nodeMapByKey)yield e}};let CRDTObject=class CRDTObject extends CRDTContainer{constructor(e,t){super(e),this.memberNodes=t}static create(e,t){if(!t)return new CRDTObject(e,ElementRHT.create());let r=ElementRHT.create();for(let[e,n]of Object.entries(t))r.set(e,n.deepcopy(),n.getCreatedAt());return new CRDTObject(e,r)}subPathOf(e){return this.memberNodes.subPathOf(e)}purge(e){this.memberNodes.purge(e)}set(e,t,r){return this.memberNodes.set(e,t,r)}delete(e,t){return this.memberNodes.delete(e,t)}deleteByKey(e,t){return this.memberNodes.deleteByKey(e,t)}get(e){let t=this.memberNodes.get(e);return null==t?void 0:t.getValue()}getByID(e){let t=this.memberNodes.getByID(e);return null==t?void 0:t.getValue()}has(e){return this.memberNodes.has(e)}toJSON(){let e=[];for(let[t,r]of this)e.push(`"${escapeString(t)}":${r.toJSON()}`);return`{${e.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){let e={};for(let[t,r]of this){let{createdAt:n,value:i,type:o}=r.toJSForTest();e[t]={key:t,createdAt:n,value:i,type:o}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_OBJECT"}}getKeys(){let e=[];for(let[t]of this)e.push(t);return e}toSortedJSON(){var e;let t=[];for(let[e]of this)t.push(e);let r=[];for(let n of t.sort()){let t=null===(e=this.memberNodes.get(n))||void 0===e?void 0:e.getValue();r.push(`"${escapeString(n)}":${t.toSortedJSON()}`)}return`{${r.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){let e=CRDTObject.create(this.getCreatedAt());for(let t of this.memberNodes)e.memberNodes.set(t.getStrKey(),t.getValue().deepcopy(),this.getPositionedAt());return e.remove(this.getRemovedAt()),e}getDescendants(e){for(let t of this.memberNodes){let r=t.getValue();if(e(r,this))return;r instanceof CRDTContainer&&r.getDescendants(e)}}*[Symbol.iterator](){let e=new Set;for(let t of this.memberNodes)e.has(t.getStrKey())||(e.add(t.getStrKey()),t.isRemoved()||(yield[t.getStrKey(),t.getValue()]))}};(s=b||(b={})).Local="local",s.Remote="remote",s.UndoRedo="undoredo";let Operation=class Operation{constructor(e,t){this.parentCreatedAt=e,this.executedAt=t}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw Error("executedAt has not been set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}};let SplayNode=class SplayNode{constructor(e){this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}};let SplayTree=class SplayTree{constructor(e){this.root=e}get length(){return this.root?this.root.getWeight():0}find(e){if(!this.root||e<0)return[void 0,0];let r=this.root;for(;;)if(r.hasLeft()&&e<=r.getLeftWeight())r=r.getLeft();else if(r.hasRight()&&r.getLeftWeight()+r.getLength()<e)e-=r.getLeftWeight()+r.getLength(),r=r.getRight();else{e-=r.getLeftWeight();break}return e>r.getLength()&&t.fatal(`out of index range: pos: ${e} > node.length: ${r.getLength()}`),[r,e]}indexOf(e){let t;if(!e||e!==this.root&&!e.hasLinks())return -1;let r=0,n=e;for(;n;)t&&t!==n.getRight()||(r+=n.getLength()+(n.hasLeft()?n.getLeftWeight():0)),t=n,n=n.getParent();return r-e.getLength()}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,t){return e?(this.splayNode(e),this.root=t,t.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(t),t.setLeft(e),e.setParent(t),e.setRight(),this.updateWeight(e),this.updateWeight(t)):this.root=t,t}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);let t=new SplayTree(e.getLeft());t.root&&t.root.setParent();let r=new SplayTree(e.getRight());if(r.root&&r.root.setParent(),t.root){let e=t.getRightmost();t.splayNode(e),t.root.setRight(r.root),r.root&&r.root.setParent(t.root),this.root=t.root}else this.root=r.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,t){if(!t){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(t),t.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){let t=[];for(let r of(this.traversePostorder(e.getRight(),t),t))r.initWeight();this.updateTreeWeight(e)}toTestString(){let e=[];return this.traverseInorder(this.root,e),e.map(e=>`[${e.getWeight()},${e.getLength()}]${e.getValue()||""}`).join("")}checkWeight(){let e=[];for(let t of(this.traverseInorder(this.root,e),e))if(t.getWeight()!=t.getLength()+t.getLeftWeight()+t.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,t){e&&(this.traverseInorder(e.getLeft(),t),t.push(e),this.traverseInorder(e.getRight(),t))}traversePostorder(e,t){e&&(this.traversePostorder(e.getLeft(),t),this.traversePostorder(e.getRight(),t),t.push(e))}rotateLeft(e){let t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setRight(e.getLeft()),t.hasRight()&&t.getRight().setParent(t),e.setLeft(t),e.getLeft().setParent(e),this.updateWeight(t),this.updateWeight(e)}rotateRight(e){let t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setLeft(e.getRight()),t.hasLeft()&&t.getLeft().setParent(t),e.setRight(t),e.getRight().setParent(e),this.updateWeight(t),this.updateWeight(e)}isLeftChild(e){return!!(e&&e.hasParent())&&e.getParent().getLeft()===e}isRightChild(e){return!!(e&&e.hasParent())&&e.getParent().getRight()===e}};(a=I||(I={}))[a.Null=0]="Null",a[a.Boolean=1]="Boolean",a[a.Integer=2]="Integer",a[a.Long=3]="Long",a[a.Double=4]="Double",a[a.String=5]="String",a[a.Bytes=6]="Bytes",a[a.Date=7]="Date";let Primitive=class Primitive extends CRDTElement{constructor(e,t){super(t),this.valueType=Primitive.getPrimitiveType(e),this.value=void 0===e?null:e}static of(e,t){return new Primitive(e,t)}static valueFromBytes(e,t){switch(e){case I.Null:return null;case I.Boolean:return!!t[0];case I.Integer:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case I.Double:{let e=new DataView(t.buffer);return t.forEach(function(t,r){e.setUint8(r,t)}),e.getFloat64(0,!0)}case I.String:return new TextDecoder("utf-8").decode(t);case I.Long:return Long.fromBytesLE(Array.from(t));case I.Bytes:return t;case I.Date:return new Date(Long.fromBytesLE(Array.from(t),!0).toNumber());default:throw new YorkieError(w.Unimplemented,`unimplemented type: ${e}`)}}toJSON(){return this.valueType===I.String?`"${escapeString(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){let e=Primitive.of(this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e.setRemovedAt(this.getRemovedAt()),e}getType(){return this.valueType}static getPrimitiveType(e){switch(typeof e){case"undefined":return I.Null;case"boolean":return I.Boolean;case"number":if(this.isInteger(e))return I.Integer;return I.Double;case"string":return I.String;case"object":if(null===e)return I.Null;if(e instanceof Long)return I.Long;if(e instanceof Uint8Array)return I.Bytes;if(e instanceof Date)return I.Date}}static isSupport(e){let t=Primitive.getPrimitiveType(e);return void 0!==t}static isInteger(e){return e%1==0}isNumericType(){let e=this.valueType;return e===I.Integer||e===I.Long||e===I.Double}getValue(){return this.value}toBytes(){switch(this.valueType){case I.Null:return new Uint8Array;case I.Boolean:{let e=this.value;return new Uint8Array(e?[1]:[0])}case I.Integer:{let e=this.value;return new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24&255])}case I.Double:{let e=this.value,t=new Uint8Array(8),r=new DataView(t.buffer);return r.setFloat64(0,e,!0),t}case I.String:return new TextEncoder().encode(this.value);case I.Long:{let e=this.value,t=e.toBytesLE();return Uint8Array.from(t)}case I.Bytes:{let e=this.value;return e}case I.Date:{let e=this.value,t=Long.fromNumber(e.getTime(),!0).toBytesLE();return Uint8Array.from(t)}default:throw new YorkieError(w.Unimplemented,`unimplemented type: ${this.valueType}`)}}};let RGATreeListNode=class RGATreeListNode extends SplayNode{constructor(e){super(e),this.value=e}static createAfter(e,t){let r=new RGATreeListNode(t),n=e.next;return e.next=r,r.prev=e,r.next=n,n&&(n.prev=r),r}remove(e){return this.value.remove(e)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}};let RGATreeList=class RGATreeList{constructor(){let e=Primitive.of(0,ec);e.setRemovedAt(ec),this.dummyHead=new RGATreeListNode(e),this.last=this.dummyHead,this.nodeMapByIndex=new SplayTree,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new RGATreeList}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,r){let n=this.nodeMapByCreatedAt.get(e.toIDString());for(n||t.fatal(`cant find the given node: ${e.toIDString()}`);n.getNext()&&n.getNext().getPositionedAt().after(r);)n=n.getNext();return n}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,t,r=t.getCreatedAt()){let n=this.findNextBeforeExecutedAt(e,r),i=RGATreeListNode.createAfter(n,t);n===this.last&&(this.last=i),this.nodeMapByIndex.insertAfter(n,i),this.nodeMapByCreatedAt.set(i.getCreatedAt().toIDString(),i)}moveAfter(e,r,n){let i=this.nodeMapByCreatedAt.get(e.toIDString());i||t.fatal(`cant find the given node: ${e.toIDString()}`);let o=this.nodeMapByCreatedAt.get(r.toIDString());o||t.fatal(`cant find the given node: ${r.toIDString()}`),i!==o&&(!o.getValue().getMovedAt()||n.after(o.getValue().getMovedAt()))&&(this.release(o),this.insertAfter(i.getCreatedAt(),o.getValue(),n),o.getValue().setMovedAt(n))}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return String(this.nodeMapByIndex.indexOf(t))}purge(e){let r=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());r||t.fatal(`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`),this.release(r)}getByIndex(e){if(e>=this.length)return;let[t,r]=this.nodeMapByIndex.find(e),n=t;if(0===e&&t===this.dummyHead||r>0)do n&&(n=n.getNext());while(n&&n.isRemoved());return n}getPrevCreatedAt(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());do t=t.getPrev();while(this.dummyHead!==t&&t.isRemoved());return t.getValue().getCreatedAt()}delete(e,t){let r=this.nodeMapByCreatedAt.get(e.toIDString()),n=r.isRemoved();return r.remove(t)&&!n&&this.nodeMapByIndex.splayNode(r),r.getValue()}deleteByIndex(e,t){let r=this.getByIndex(e);if(r)return r.remove(t)&&this.nodeMapByIndex.splayNode(r),r.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){let e=[];for(let t of this){let r=`${t.getCreatedAt().toIDString()}:${t.getValue().toJSON()}`;t.isRemoved()?e.push(`{${r}}`):e.push(`[${r}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}};let CRDTArray=class CRDTArray extends CRDTContainer{constructor(e,t){super(e),this.elements=t}static create(e,t){if(!t)return new CRDTArray(e,RGATreeList.create());let r=RGATreeList.create();for(let e of t)r.insertAfter(r.getLastCreatedAt(),e.deepcopy());return new CRDTArray(e,r)}subPathOf(e){return this.elements.subPathOf(e)}purge(e){this.elements.purge(e)}insertAfter(e,t){this.elements.insertAfter(e,t)}moveAfter(e,t,r){this.elements.moveAfter(e,t,r)}get(e){let t=this.elements.getByIndex(e);return null==t?void 0:t.getValue()}getByID(e){let t=this.elements.getByID(e);return null==t?void 0:t.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(e){return this.elements.getPrevCreatedAt(e)}delete(e,t){return this.elements.delete(e,t)}deleteByIndex(e,t){return this.elements.deleteByIndex(e,t)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(let e of this.elements)e.isRemoved()||(yield e.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(e){for(let t of this.elements){let r=t.getValue();if(e(r,this))return;r instanceof CRDTContainer&&r.getDescendants(e)}}toJSON(){let e=[];for(let t of this)e.push(t.toJSON());return`[${e.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){let e={};for(let t=0;t<this.length;t++){let{createdAt:r,value:n,type:i}=this.get(t).toJSForTest();e[t]={key:String(t),createdAt:r,value:n,type:i}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){let e=CRDTArray.create(this.getCreatedAt());for(let t of this.elements)e.elements.insertAfter(e.getLastCreatedAt(),t.getValue().deepcopy());return e.remove(this.getRemovedAt()),e}};let RemoveOperation=class RemoveOperation extends Operation{constructor(e,t,r){super(e,r),this.createdAt=t}static create(e,t,r){return new RemoveOperation(e,t,r)}execute(e,r){var n;let i=e.findByCreatedAt(this.getParentCreatedAt());if(i||t.fatal(`fail to find ${this.getParentCreatedAt()}`),i instanceof CRDTContainer||t.fatal(`only object and array can execute remove: ${i}`),r===b.UndoRedo){let t=i.getByID(this.createdAt);for(;t;){if(t.getRemovedAt())return;t=null===(n=e.findElementPairByCreatedAt(t.getCreatedAt()))||void 0===n?void 0:n.parent}}let o=i.subPathOf(this.createdAt),s=this.toReverseOperation(i),a=i.delete(this.createdAt,this.getExecutedAt());e.registerRemovedElement(a);let l=i instanceof CRDTArray?[{type:"remove",path:e.createPath(this.getParentCreatedAt()),index:Number(o)}]:[{type:"remove",path:e.createPath(this.getParentCreatedAt()),key:o}];return{opInfos:l,reverseOp:s}}toReverseOperation(e){if(e instanceof CRDTObject){let t=e.subPathOf(this.createdAt);if(void 0!==t){let r=e.get(t);if(void 0!==r)return SetOperation.create(t,r.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}};let SetOperation=class SetOperation extends Operation{constructor(e,t,r,n){super(r,n),this.key=e,this.value=t}static create(e,t,r,n){return new SetOperation(e,t,r,n)}execute(e,r){var n;let i=e.findByCreatedAt(this.getParentCreatedAt());if(i||t.fatal(`fail to find ${this.getParentCreatedAt()}`),i instanceof CRDTObject||t.fatal("fail to execute, only object can execute set"),r===b.UndoRedo){let t=i;for(;t;){if(t.getRemovedAt())return;t=null===(n=e.findElementPairByCreatedAt(t.getCreatedAt()))||void 0===n?void 0:n.parent}}let o=i.get(this.key),s=this.toReverseOperation(o),a=this.value.deepcopy(),l=i.set(this.key,a,this.getExecutedAt());return r===b.UndoRedo&&e.findByCreatedAt(a.getCreatedAt())&&e.deregisterElement(a),e.registerElement(a,i),l&&e.registerRemovedElement(l),{opInfos:[{type:"set",path:e.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:s}}toReverseOperation(e){let t=RemoveOperation.create(this.getParentCreatedAt(),this.value.getCreatedAt());return void 0===e||e.isRemoved()||(t=SetOperation.create(this.key,e.deepcopy(),this.getParentCreatedAt())),t}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}};let AddOperation=class AddOperation extends Operation{constructor(e,t,r,n){super(e,n),this.prevCreatedAt=t,this.value=r}static create(e,t,r,n){return new AddOperation(e,t,r,n)}execute(e){let r=e.findByCreatedAt(this.getParentCreatedAt());r||t.fatal(`fail to find ${this.getParentCreatedAt()}`),r instanceof CRDTArray||t.fatal("fail to execute, only array can execute add");let n=this.value.deepcopy();return r.insertAfter(this.prevCreatedAt,n),e.registerElement(n,r),{opInfos:[{type:"add",path:e.createPath(this.getParentCreatedAt()),index:Number(r.subPathOf(this.getEffectedCreatedAt()))}]}}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}};let MoveOperation=class MoveOperation extends Operation{constructor(e,t,r,n){super(e,n),this.prevCreatedAt=t,this.createdAt=r}static create(e,t,r,n){return new MoveOperation(e,t,r,n)}execute(e){let r=e.findByCreatedAt(this.getParentCreatedAt());r||t.fatal(`fail to find ${this.getParentCreatedAt()}`),r instanceof CRDTArray||t.fatal("fail to execute, only array can execute move");let n=Number(r.subPathOf(this.createdAt));r.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());let i=Number(r.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:e.createPath(this.getParentCreatedAt()),index:i,previousIndex:n}]}}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}};let RHTNode=class RHTNode{constructor(e,t,r){this.key=e,this.value=t,this.updatedAt=r}static of(e,t,r){return new RHTNode(e,t,r)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}};let RHT=class RHT{constructor(){this.nodeMapByKey=new Map}static create(){return new RHT}set(e,t,r){let n=this.nodeMapByKey.get(e);if(void 0===n||r.after(n.getUpdatedAt())){let n=RHTNode.of(e,t,r);this.nodeMapByKey.set(e,n)}}has(e){return this.nodeMapByKey.has(e)}get(e){if(this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){let e=new RHT;for(let[,t]of this.nodeMapByKey)e.set(t.getKey(),t.getValue(),t.getUpdatedAt());return e}toJSON(){let e=[];for(let[t,r]of this.nodeMapByKey)e.push(`"${escapeString(t)}":"${escapeString(r.getValue())}"`);return`{${e.join(",")}}`}toXML(){return this.size()?` ${[...this.nodeMapByKey].map(([e,t])=>`${e}="${JSON.parse(t.getValue())}"`).join(" ")}`:""}size(){return this.nodeMapByKey.size}toObject(){let e={};for(let[t,r]of this.nodeMapByKey)e[t]=r.getValue();return e}*[Symbol.iterator](){for(let[,e]of this.nodeMapByKey)yield e}};(l=k||(k={})).Content="content",l.Style="style";let CRDTTextValue=class CRDTTextValue{constructor(e){this.attributes=RHT.create(),this.content=e}static create(e){return new CRDTTextValue(e)}get length(){return this.content.length}substring(e,t){let r=new CRDTTextValue(this.content.substring(e,t));return r.attributes=this.attributes.deepcopy(),r}setAttr(e,t,r){this.attributes.set(e,t,r)}getAttrs(){return this.attributes}toString(){return this.content}toJSON(){let e=escapeString(this.content),t=this.attributes.toObject(),r=[];for(let[e,n]of Object.entries(t)){let t=JSON.parse(n),i="string"==typeof t?`"${escapeString(e)}":"${escapeString(t)}"`:`"${escapeString(e)}":${String(t)}`;r.push(i)}return(r.sort(),0===r.length)?`{"val":"${e}"}`:`{"attrs":{${r.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}};let CRDTText=class CRDTText extends CRDTGCElement{constructor(e,t){super(t),this.rgaTreeSplit=e}static create(e,t){return new CRDTText(e,t)}edit(e,t,r,n,i){let o=t?CRDTTextValue.create(t):void 0;if(o&&n)for(let[e,t]of Object.entries(n))o.setAttr(e,t,r);let[s,a,l]=this.rgaTreeSplit.edit(e,r,o,i),u=l.map(e=>({...e,value:e.value?{attributes:parseObjectValues(e.value.getAttributes()),content:e.value.getContent()}:{attributes:void 0,content:""},type:k.Content}));return[a,u,[s,s]]}setStyle(e,t,r,n){let[,i]=this.rgaTreeSplit.findNodeWithSplit(e[1],r),[,o]=this.rgaTreeSplit.findNodeWithSplit(e[0],r),s=[],a=this.rgaTreeSplit.findBetween(o,i),l=new Map,u=[];for(let e of a){let t=e.getCreatedAt().getActorID(),i=(null==n?void 0:n.size)?n.has(t)?n.get(t):ec:eh;if(e.canStyle(r,i)){let r=l.get(t),n=e.getCreatedAt();(!r||n.after(r))&&l.set(t,n),u.push(e)}}for(let e of u){if(e.isRemoved())continue;let[n,i]=this.rgaTreeSplit.findIndexesFromRange(e.createPosRange());for(let[o,a]of(s.push({type:k.Style,actor:r.getActorID(),from:n,to:i,value:{attributes:parseObjectValues(t)}}),Object.entries(t)))e.getValue().setAttr(o,a,r)}return[l,s]}indexRangeToPosRange(e,t){let r=this.rgaTreeSplit.indexToPos(e);return e===t?[r,r]:[r,this.rgaTreeSplit.indexToPos(t)]}get length(){return this.rgaTreeSplit.length}checkWeight(){return this.rgaTreeSplit.checkWeight()}toJSON(){let e=[];for(let t of this.rgaTreeSplit)t.isRemoved()||e.push(t.getValue().toJSON());return`[${e.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){let e=[];for(let t of this.rgaTreeSplit)if(!t.isRemoved()){let r=t.getValue();e.push({attributes:parseObjectValues(r.getAttributes()),content:r.getContent()})}return e}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}getRemovedNodesLen(){return this.rgaTreeSplit.getRemovedNodesLen()}purgeRemovedNodesBefore(e){return this.rgaTreeSplit.purgeRemovedNodesBefore(e)}deepcopy(){let e=new CRDTText(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return e.remove(this.getRemovedAt()),e}findIndexesFromRange(e){return this.rgaTreeSplit.findIndexesFromRange(e)}};let EditOperation=class EditOperation extends Operation{constructor(e,t,r,n,i,o,s){super(e,s),this.fromPos=t,this.toPos=r,this.maxCreatedAtMapByActor=n,this.content=i,this.attributes=o}static create(e,t,r,n,i,o,s){return new EditOperation(e,t,r,n,i,o,s)}execute(e){let r=e.findByCreatedAt(this.getParentCreatedAt());r||t.fatal(`fail to find ${this.getParentCreatedAt()}`),r instanceof CRDTText||t.fatal("fail to execute, only Text can execute edit");let[,n]=r.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),this.maxCreatedAtMapByActor);return this.fromPos.equals(this.toPos)||e.registerElementHasRemovedNodes(r),{opInfos:n.map(({from:t,to:r,value:n})=>({type:"edit",from:t,to:r,value:n,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),r=this.toPos.toTestString(),n=this.content;return`${e}.EDIT(${t},${r},${n})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}};let StyleOperation=class StyleOperation extends Operation{constructor(e,t,r,n,i,o){super(e,o),this.fromPos=t,this.toPos=r,this.maxCreatedAtMapByActor=n,this.attributes=i}static create(e,t,r,n,i,o){return new StyleOperation(e,t,r,n,i,o)}execute(e){let r=e.findByCreatedAt(this.getParentCreatedAt());r||t.fatal(`fail to find ${this.getParentCreatedAt()}`),r instanceof CRDTText||t.fatal("fail to execute, only Text can execute edit");let[,n]=r.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),this.maxCreatedAtMapByActor);return{opInfos:n.map(({from:t,to:r,value:n})=>({type:"style",from:t,to:r,value:n,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),r=this.toPos.toTestString(),n=this.attributes;return`${e}.STYL(${t},${r},${JSON.stringify(n)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}};let em="text";function addSizeOfLeftSiblings(e,t){let r=0,n=e.children;for(let e=0;e<t;e++){let t=n[e];!t||t.isRemoved||(r+=t.paddedSize)}return r}let IndexTreeNode=class IndexTreeNode{constructor(e,t=[]){if(this.type=e,this.size=0,this._children=t,this.isText&&this._children.length>0)throw Error(`Text node cannot have children: ${this.type}`)}updateAncestorsSize(){let e=this.parent,t=this.isRemoved?-1:1;for(;e;)e.size+=this.paddedSize*t,e=e.parent}get isText(){return this.type===em}get paddedSize(){return this.size+(this.isText?0:2)}isAncestorOf(e){return function(e,t){if(e===t)return!1;for(;t.parent;){if(t.parent===e)return!0;t=t.parent}return!1}(this,e)}get nextSibling(){let e=this.parent.findOffset(this),t=this.parent.children[e+1];if(t)return t}splitText(e,t){if(0===e||e===this.size)return;let r=this.value.slice(0,e),n=this.value.slice(e);if(!n.length)return;this.value=r;let i=this.cloneText(e+t);return i.value=n,this.parent.insertAfterInternal(i,this),i}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.some(e=>e.isText)}append(...e){if(this.isText)throw Error("Text node cannot have children");for(let t of(this._children.push(...e),e))t.parent=this,t.updateAncestorsSize()}prepend(...e){if(this.isText)throw Error("Text node cannot have children");for(let t of(this._children.unshift(...e),e))t.parent=this,t.isRemoved||t.updateAncestorsSize()}insertBefore(e,t){if(this.isText)throw Error("Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw Error("child not found");this.insertAtInternal(e,r),e.updateAncestorsSize()}insertAfter(e,t){if(this.isText)throw Error("Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw Error("child not found");this.insertAtInternal(e,r+1),e.updateAncestorsSize()}insertAt(e,t){if(this.isText)throw Error("Text node cannot have children");this.insertAtInternal(e,t),e.updateAncestorsSize()}removeChild(e){if(this.isText)throw Error("Text node cannot have children");let t=this._children.indexOf(e);if(-1===t)throw Error("child not found");this._children.splice(t,1),e.parent=void 0}splitElement(e,t){let r=this.cloneElement(t);this.parent.insertAfterInternal(r,this),r.updateAncestorsSize();let n=this.children.slice(0,e),i=this.children.slice(e);for(let e of(this._children=n,r._children=i,this.size=this._children.reduce((e,t)=>e+t.paddedSize,0),r.size=r._children.reduce((e,t)=>e+t.paddedSize,0),r._children))e.parent=r;return r}insertAfterInternal(e,t){if(this.isText)throw Error("Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw Error("child not found");this.insertAtInternal(e,r+1)}insertAtInternal(e,t){if(this.isText)throw Error("Text node cannot have children");this._children.splice(t,0,e),e.parent=this}findOffset(e){if(this.isText)throw Error("Text node cannot have children");if(e.isRemoved){let t=this._children.indexOf(e),r=this.allChildren.splice(0,t).filter(e=>!e.isRemoved).length;return r}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw Error("Text node cannot have children");let t=e;for(;t;){let e=this._children.indexOf(t);if(-1!==e)return e;t=t.parent}return -1}};function traverse(e,t,r=0){for(let n of e.children)traverse(n,t,r+1);t(e,r)}function traverseAll(e,t,r=0){for(let n of e._children)traverseAll(n,t,r+1);t(e,r)}(u=O||(O={})).Start="Start",u.End="End",u.Text="Text";let IndexTree=class IndexTree{constructor(e){this.root=e}tokensBetween(e,t,r){!function tokensBetween(e,t,r,n){if(t>r)throw Error(`from is greater than to: ${t} > ${r}`);if(t>e.size)throw Error(`from is out of range: ${t} > ${e.size}`);if(r>e.size)throw Error(`to is out of range: ${r} > ${e.size}`);if(t===r)return;let i=0;for(let o of e.children){if(t-o.paddedSize<i&&i<r){let e=o.isText?t-i:t-i-1,s=o.isText?r-i:r-i-1,a=!o.isText&&e<0,l=!o.isText&&s>o.size;(o.isText||a)&&n([o,o.isText?O.Text:O.Start],l),tokensBetween(o,Math.max(0,e),Math.min(s,o.size),n),l&&n([o,O.End],l)}i+=o.paddedSize}}(this.root,e,t,r)}traverse(e){traverse(this.root,e,0)}traverseAll(e){traverseAll(this.root,e,0)}findTreePos(e,t=!0){return function findTreePos(e,t,r=!0){if(t>e.size)throw Error(`index is out of range: ${t} > ${e.size}`);if(e.isText)return{node:e,offset:t};let n=0,i=0;for(let o of e.children){if(r&&o.isText&&o.size>=t-i)return findTreePos(o,t-i,r);if(t===i)break;if(!r&&o.paddedSize===t-i)return{node:e,offset:n+1};if(o.paddedSize>t-i)return findTreePos(o,t-i-1,r);i+=o.paddedSize,n+=1}return{node:e,offset:n}}(this.root,e,t)}treePosToPath(e){let t=[],r=e.node;if(r.isText){let n=r.parent.findOffset(r);if(-1===n)throw Error("invalid treePos");let i=addSizeOfLeftSiblings(r.parent,n);r=r.parent,t.push(i+e.offset)}else t.push(e.offset);for(;r.parent;){let e=r.parent.findOffset(r);if(-1===e)throw Error("invalid treePos");t.push(e),r=r.parent}return t.reverse()}pathToIndex(e){let t=this.pathToTreePos(e);return this.indexOf(t)}pathToTreePos(e){if(!e.length)throw Error("unacceptable path");let t=this.root;for(let r=0;r<e.length-1;r++){let n=e[r];if(!(t=t.children[n]))throw Error("unacceptable path")}if(t.hasTextChild())return function(e,t){if(e.size<t)throw Error("unacceptable path");for(let r=0;r<e.children.length;r++){let n=e.children[r];if(n.size<t)t-=n.size;else{e=n;break}}return{node:e,offset:t}}(t,e[e.length-1]);if(t.children.length<e[e.length-1])throw Error("unacceptable path");return{node:t,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.size}findPostorderRight(e){let{node:t,offset:r}=e;if(t.isText){if(t.size===r){let e=t.nextSibling;return e||t.parent}return t}return t.children.length===r?t:function findLeftmost(e){return e.isText||0===e.children.length?e:findLeftmost(e.children[0])}(t.children[r])}indexOf(e){let{node:t}=e,{offset:r}=e,n=0,i=1;if(t.isText){n+=r;let e=t.parent,i=e.findOffset(t);if(-1===i)throw Error("invalid pos");n+=addSizeOfLeftSiblings(e,i),t=t.parent}else n+=addSizeOfLeftSiblings(t,r);for(;null==t?void 0:t.parent;){let e=t.parent,r=e.findOffset(t);if(-1===r)throw Error("invalid pos");n+=addSizeOfLeftSiblings(e,r),i++,t=t.parent}return n+i-1}indexToPath(e){let t=this.findTreePos(e);return this.treePosToPath(t)}};let DefaultComparator=(e,t)=>e===t?0:e<t?-1:1;let LLRBNode=class LLRBNode{constructor(e,t,r){this.key=e,this.value=t,this.isRed=r}};let SortedMapIterator=class SortedMapIterator{constructor(e){this.stack=[],this.traverseInorder(e)}traverseInorder(e){e&&(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}};let LLRBTree=class LLRBTree{constructor(e){this.comparator=void 0!==e?e:DefaultComparator,this.counter=0}put(e,t){return this.root=this.putInternal(e,t,this.root),this.root.isRed=!1,t}get(e){let t=this.getInternal(e,this.root);return t?t.value:void 0}remove(e){this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new SortedMapIterator(this.root)}values(){let e=[];for(let t of this.getIterator().stack)e.push(t.value);return e}floorEntry(e){let t=this.root;for(;t;){let r=this.comparator(e,t.key);if(r>0){if(!t.right)return t;t.right.parent=t,t=t.right}else if(!(r<0))return t;else if(t.left)t.left.parent=t,t=t.left;else{let e=t.parent,r=t;for(;e&&r===e.left;)r=e,e=e.parent;return e}}}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return 0===this.counter}getInternal(e,t){for(;t;){let r=this.comparator(e,t.key);if(0===r)return t;r<0?t=t.left:r>0&&(t=t.right)}}putInternal(e,t,r){if(!r)return this.counter+=1,new LLRBNode(e,t,!0);let n=this.comparator(e,r.key);return n<0?r.left=this.putInternal(e,t,r.left):n>0?r.right=this.putInternal(e,t,r.right):r.value=t,this.isRed(r.right)&&!this.isRed(r.left)&&(r=this.rotateLeft(r)),this.isRed(r.left)&&this.isRed(r.left.left)&&(r=this.rotateRight(r)),this.isRed(r.left)&&this.isRed(r.right)&&this.flipColors(r),r}removeInternal(e,t){if(0>this.comparator(t,e.key))this.isRed(e.left)||this.isRed(e.left.left)||(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),0===this.comparator(t,e.key)&&!e.right){this.counter-=1;return}if(this.isRed(e.right)||this.isRed(e.right.left)||(e=this.moveRedRight(e)),0===this.comparator(t,e.key)){this.counter-=1;let t=this.min(e.right);e.value=t.value,e.key=t.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,t)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(e.left)return this.isRed(e.left)||this.isRed(e.left.left)||(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){let t=e.right;return e.right=t.left,t.left=e,t.isRed=t.left.isRed,t.left.isRed=!0,t}rotateRight(e){let t=e.left;return e.left=t.right,t.right=e,t.isRed=t.right.isRed,t.right.isRed=!0,t}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}};(d=D||(D={})).Content="content",d.Style="style";let CRDTTreePos=class CRDTTreePos{constructor(e,t){this.parentID=e,this.leftSiblingID=t}static of(e,t){return new CRDTTreePos(e,t)}static fromTreePos(e){let t;let{offset:r}=e,{node:n}=e;return n.isText?(t=n.parent.children[0]===n&&0===r?n.parent:n,n=n.parent):t=0===r?n:n.children[r-1],CRDTTreePos.of(n.id,CRDTTreeNodeID.of(t.getCreatedAt(),t.getOffset()+r))}getParentID(){return this.parentID}static fromStruct(e){return CRDTTreePos.of(CRDTTreeNodeID.of(TimeTicket.fromStruct(e.parentID.createdAt),e.parentID.offset),CRDTTreeNodeID.of(TimeTicket.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodes(e){let t=this.getParentID(),r=this.getLeftSiblingID(),n=e.findFloorNode(t),i=e.findFloorNode(r);if(!n||!i)throw Error(`cannot find node at ${this}`);return!r.equals(t)&&r.getOffset()>0&&r.getOffset()===i.id.getOffset()&&i.insPrevID&&(i=e.findFloorNode(i.insPrevID)),[n,i]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}};let CRDTTreeNodeID=class CRDTTreeNodeID{constructor(e,t){this.createdAt=e,this.offset=t}static of(e,t){return new CRDTTreeNodeID(e,t)}static fromStruct(e){return CRDTTreeNodeID.of(TimeTicket.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,t)=>{let r=e.getCreatedAt().compare(t.getCreatedAt());return 0!==r?r:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return 0===this.createdAt.compare(e.createdAt)&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}};let CRDTTreeNode=class CRDTTreeNode extends IndexTreeNode{constructor(e,t,r,n,i){super(t),this._value="",this.id=e,this.removedAt=i,n&&(this.attrs=n),"string"==typeof r?this.value=r:Array.isArray(r)&&(this._children=r)}static create(e,t,r,n){return new CRDTTreeNode(e,t,r,n)}deepcopy(){var e;let t=new CRDTTreeNode(this.id,this.type);return t.removedAt=this.removedAt,t._value=this._value,t.size=this.size,t.attrs=null===(e=this.attrs)||void 0===e?void 0:e.deepcopy(),t._children=this._children.map(e=>{let r=e.deepcopy();return r.parent=t,r}),t}get value(){if(!this.isText)throw Error(`cannot get value of element node: ${this.type}`);return this._value}set value(e){if(!this.isText)throw Error(`cannot set value of element node: ${this.type}`);this._value=e,this.size=e.length}get isRemoved(){return!!this.removedAt}remove(e){let t=!this.removedAt;(!this.removedAt||this.removedAt.compare(e)>0)&&(this.removedAt=e),t&&(this.parent.removedAt?this.parent.size-=this.paddedSize:this.updateAncestorsSize())}cloneText(e){return new CRDTTreeNode(CRDTTreeNodeID.of(this.id.getCreatedAt(),e),this.type,void 0,void 0,this.removedAt)}cloneElement(e){return new CRDTTreeNode(CRDTTreeNodeID.of(e(),0),this.type,void 0,void 0,this.removedAt)}split(e,t,r){let n=this.isText?this.splitText(t,this.id.getOffset()):this.splitElement(t,r);if(n){if(n.insPrevID=this.id,this.insNextID){let t=e.findFloorNode(this.insNextID);t.insPrevID=n.id,n.insNextID=this.insNextID}this.insNextID=n.id,e.registerNode(n)}return n}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}};function toTreeNode(e){var t;return e.isText?{type:e.type,value:e.value}:{type:e.type,children:e.children.map(toTreeNode),attributes:e.attrs?parseObjectValues(null===(t=e.attrs)||void 0===t?void 0:t.toObject()):void 0}}let CRDTTree=class CRDTTree extends CRDTGCElement{constructor(e,t){super(t),this.indexTree=new IndexTree(e),this.nodeMapByID=new LLRBTree(CRDTTreeNodeID.createComparator()),this.removedNodeMap=new Map,this.indexTree.traverse(e=>{this.nodeMapByID.put(e.id,e)})}static create(e,t){return new CRDTTree(e,t)}findFloorNode(e){let t=this.nodeMapByID.floorEntry(e);if(t&&t.key.getCreatedAt().equals(e.getCreatedAt()))return t.value}registerNode(e){this.nodeMapByID.put(e.id,e)}findNodesAndSplitText(e,t){let[r,n]=e.toTreeNodes(this),i=n,o=r===i,s=i.parent&&!o?i.parent:r;i.isText&&i.split(this,e.getLeftSiblingID().getOffset()-i.id.getOffset());let a=s.allChildren,l=o?0:a.indexOf(i)+1;for(let e=l;e<a.length;e++){let r=a[e];if(!r.id.getCreatedAt().after(t))break;i=r}return[s,i]}style(e,t,r){let[n,i]=this.findNodesAndSplitText(e[0],r),[o,s]=this.findNodesAndSplitText(e[1],r),a=[];return a.push({type:D.Style,from:this.toIndex(n,i),to:this.toIndex(o,s),fromPath:this.toPath(n,i),toPath:this.toPath(o,s),actor:r.getActorID(),value:t?parseObjectValues(t):void 0}),this.traverseInPosRange(n,i,o,s,([e])=>{if(!e.isRemoved&&!e.isText&&t)for(let[n,i]of(e.attrs||(e.attrs=new RHT),Object.entries(t)))e.attrs.set(n,i,r)}),a}edit(e,t,r,n,i,o){let[s,a]=this.findNodesAndSplitText(e[0],n),[l,u]=this.findNodesAndSplitText(e[1],n),d=this.toIndex(s,a),c=this.toPath(s,a),h=[],m=[],f=[],p=new Map;this.traverseInPosRange(s,a,l,u,([e,t],r)=>{if(t===O.Start&&!r)for(let t of e.children)f.push(t);let i=e.getCreatedAt().getActorID(),s=o?o.has(i)?o.get(i):ec:eh;if(e.canDelete(n,s)||h.includes(e.parent)){let r=p.get(i),n=e.getCreatedAt();(!r||n.after(r))&&p.set(i,n),(t===O.Text||t===O.Start)&&h.push(e),m.push([e,t])}});let g=this.makeDeletionChanges(m,n);for(let e of h)e.remove(n),e.isRemoved&&this.removedNodeMap.set(e.id.toIDString(),e);for(let e of f)e.removedAt||s.append(e);if(r>0){let e=0,t=s,o=a;for(;e<r;)t.split(this,t.findOffset(o)+1,i),o=t,t=t.parent,e++;g.push({type:D.Content,from:d,to:d,fromPath:c,toPath:c,actor:n.getActorID()})}if(null==t?void 0:t.length){let e=[],r=a;for(let i of t)r===s?s.insertAt(i,0):s.insertAfter(i,r),r=i,traverseAll(i,e=>{s.isRemoved&&(e.remove(n),this.removedNodeMap.set(e.id.toIDString(),e)),this.nodeMapByID.put(e.id,e)}),i.isRemoved||e.push(i);if(e.length){let t=e.map(e=>toTreeNode(e));g.length&&g[g.length-1].from===d?g[g.length-1].value=t:g.push({type:D.Content,from:d,to:d,fromPath:c,toPath:c,actor:n.getActorID(),value:t})}}return[g,p]}editT(e,t,r,n,i){let o=this.findPos(e[0]),s=this.findPos(e[1]);this.edit([o,s],t,r,n,i)}move(e,t,r){throw Error(`not implemented: ${e}, ${t}, ${r}`)}purgeRemovedNodesBefore(e){var t;let r=new Set,n=0;for(let[,t]of this.removedNodeMap)t.removedAt&&e.compare(t.removedAt)>=0&&(r.add(t),n++);for(let e of r)null===(t=e.parent)||void 0===t||t.removeChild(e),this.nodeMapByID.remove(e.id),this.purge(e),this.removedNodeMap.delete(e.id.toIDString());return n}purge(e){let t=e.insPrevID,r=e.insNextID;if(t){let e=this.findFloorNode(t);e.insNextID=r}if(r){let e=this.findFloorNode(r);e.insPrevID=t}e.insPrevID=void 0,e.insNextID=void 0}findPos(e,t=!0){let r=this.indexTree.findTreePos(e,t);return CRDTTreePos.fromTreePos(r)}getRemovedNodesLen(){return this.removedNodeMap.size}pathToPosRange(e){let t=this.pathToIndex(e);return[this.findPos(t),this.findPos(t+1)]}pathToPos(e){let t=this.indexTree.pathToIndex(e);return this.findPos(t)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getIndexTree(){return this.indexTree}toXML(){return function toXML(e){var t;return e.isText?e.value:`<${e.type}${(null===(t=e.attrs)||void 0===t?void 0:t.toXML())||""}>${e.children.map(e=>toXML(e)).join("")}</${e.type}>`}(this.indexTree.getRoot())}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){let e=this.indexTree.getRoot(),toTreeNodeInfo=(e,t,r=0)=>{var n,i,o;let s={type:e.type,parent:t,size:e.size,id:e.id.toTestString(),removedAt:null===(n=e.removedAt)||void 0===n?void 0:n.toTestString(),insPrev:null===(i=e.insPrevID)||void 0===i?void 0:i.toTestString(),insNext:null===(o=e.insNextID)||void 0===o?void 0:o.toTestString(),value:e.isText?e.value:void 0,isRemoved:e.isRemoved,children:[],depth:r};for(let t of e.children)s.children.push(toTreeNodeInfo(t,s.id,r+1));return s};return toTreeNodeInfo(e)}getRootTreeNode(){return toTreeNode(this.indexTree.getRoot())}toTestTreeNode(){return function toTestTreeNode(e){return e.isText?{type:e.type,value:e.value,size:e.size,isRemoved:e.isRemoved}:{type:e.type,children:e.children.map(toTestTreeNode),size:e.size,isRemoved:e.isRemoved}}(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){let e=this.getRoot();return new CRDTTree(e.deepcopy(),this.getCreatedAt())}toPath(e,t){let r=this.toTreePos(e,t);return r?this.indexTree.treePosToPath(r):[]}toIndex(e,t){let r=this.toTreePos(e,t);return r?this.indexTree.indexOf(r):-1}indexToPath(e){return this.indexTree.indexToPath(e)}pathToIndex(e){return this.indexTree.pathToIndex(e)}indexRangeToPosRange(e){let t=this.findPos(e[0]);return e[0]===e[1]?[t,t]:[t,this.findPos(e[1])]}indexRangeToPosStructRange(e){let[t,r]=e,n=this.findPos(t);return t===r?[n.toStruct(),n.toStruct()]:[n.toStruct(),this.findPos(r).toStruct()]}posRangeToPathRange(e,t){let[r,n]=this.findNodesAndSplitText(e[0],t),[i,o]=this.findNodesAndSplitText(e[1],t);return[this.toPath(r,n),this.toPath(i,o)]}posRangeToIndexRange(e,t){let[r,n]=this.findNodesAndSplitText(e[0],t),[i,o]=this.findNodesAndSplitText(e[1],t);return[this.toIndex(r,n),this.toIndex(i,o)]}traverseInPosRange(e,t,r,n,i){let o=this.toIndex(e,t),s=this.toIndex(r,n);return this.indexTree.tokensBetween(o,s,i)}toTreePos(e,t){if(!e||!t)return;if(e.isRemoved){let t;for(;e.isRemoved;)e=(t=e).parent;let r=e.findOffset(t);return{node:e,offset:r}}if(e===t)return{node:e,offset:0};let r=e.findOffset(t);if(!t.isRemoved){if(t.isText)return{node:t,offset:t.paddedSize};r++}return{node:e,offset:r}}makeDeletionChanges(e,t){let r=[],n=[],i=null,o=null;for(let t=0;t<e.length;t++){let r=e[t],s=e[t+1];i||(i=r),o=r;let a=this.findRightToken(r);a&&s&&a[0]===s[0]&&a[1]===s[1]||(n.push([i,o]),i=null,o=null)}for(let e of n){let[n,i]=e,[o,s]=this.findLeftToken(n),[a,l]=i,u=s===O.Start?o:o.parent,d=l===O.Start?a:a.parent,c=this.toIndex(u,o),h=this.toIndex(d,a);c<h&&(r.length>0&&c===r[r.length-1].to?(r[r.length-1].to=h,r[r.length-1].toPath=this.toPath(d,a)):r.push({type:D.Content,from:c,to:h,fromPath:this.toPath(u,o),toPath:this.toPath(d,a),actor:t.getActorID()}))}return r}findRightToken([e,t]){if(t===O.Start){let t=e.allChildren;return t.length>0?[t[0],t[0].isText?O.Text:O.Start]:[e,O.End]}let r=e.parent,n=r.allChildren,i=n.indexOf(e);if(r&&i===n.length-1)return[r,O.End];let o=n[i+1];return[o,o.isText?O.Text:O.Start]}findLeftToken([e,t]){if(t===O.End){let t=e.allChildren;if(t.length>0){let e=t[t.length-1];return[e,e.isText?O.Text:O.End]}return[e,O.Start]}let r=e.parent,n=r.allChildren,i=n.indexOf(e);if(r&&0===i)return[r,O.Start];let o=n[i-1];return[o,o.isText?O.Text:O.End]}};let TreeEditOperation=class TreeEditOperation extends Operation{constructor(e,t,r,n,i,o,s){super(e,s),this.fromPos=t,this.toPos=r,this.contents=n,this.splitLevel=i,this.maxCreatedAtMapByActor=o}static create(e,t,r,n,i,o,s){return new TreeEditOperation(e,t,r,n,i,o,s)}execute(e){var r;let n=e.findByCreatedAt(this.getParentCreatedAt());n||t.fatal(`fail to find ${this.getParentCreatedAt()}`),n instanceof CRDTTree||t.fatal("fail to execute, only Tree can execute edit");let i=this.getExecutedAt(),[o]=n.edit([this.fromPos,this.toPos],null===(r=this.contents)||void 0===r?void 0:r.map(e=>e.deepcopy()),this.splitLevel,i,(()=>{let e=i.getDelimiter();return void 0!==this.contents&&(e+=this.contents.length),()=>TimeTicket.of(i.getLamport(),++e,i.getActorID())})(),this.maxCreatedAtMapByActor);return this.fromPos.equals(this.toPos)||e.registerElementHasRemovedNodes(n),{opInfos:o.map(({from:t,to:r,value:n,splitLevel:i,fromPath:o,toPath:s})=>({type:"tree-edit",path:e.createPath(this.getParentCreatedAt()),from:t,to:r,value:n,splitLevel:i,fromPath:o,toPath:s}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`,n=this.contents;return`${e}.EDIT(${t},${r},${null==n?void 0:n.join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}};let ChangeID=class ChangeID{constructor(e,t,r){this.clientSeq=e,this.lamport=t,this.actor=r}static of(e,t,r){return new ChangeID(e,t,r)}next(){return new ChangeID(this.clientSeq+1,this.lamport.add(1),this.actor)}syncLamport(e){return e.greaterThan(this.lamport)?new ChangeID(this.clientSeq,e,this.actor):new ChangeID(this.clientSeq,this.lamport.add(1),this.actor)}createTimeTicket(e){return TimeTicket.of(this.lamport,e,this.actor)}setActor(e){return new ChangeID(this.clientSeq,this.lamport,e)}getClientSeq(){return this.clientSeq}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}toTestString(){return this.actor?`${this.lamport.toString()}:${this.actor.substring(22,24)}:${this.clientSeq}`:`${this.lamport.toString()}:nil:${this.clientSeq}`}};let ef=new ChangeID(0,Long.fromInt(0,!0),eu);let Change=class Change{constructor({id:e,operations:t,presenceChange:r,message:n}){this.id=e,this.operations=t||[],this.presenceChange=r,this.message=n}static create({id:e,operations:t,presenceChange:r,message:n}){return new Change({id:e,operations:t,presenceChange:r,message:n})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(let t of this.operations)t.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return void 0!==this.presenceChange}getPresenceChange(){return this.presenceChange}execute(e,t,r){let n=[],i=[];for(let t of this.operations){let o=t.execute(e,r);if(!o)continue;let{opInfos:s,reverseOp:a}=o;n.push(...s),a&&i.unshift(a)}return this.presenceChange&&(this.presenceChange.type===N.Put?t.set(this.id.getActorID(),deepcopy(this.presenceChange.presence)):t.delete(this.id.getActorID())),{opInfos:n,reverseOps:i}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}};let ChangePack=class ChangePack{constructor(e,t,r,n,i,o){this.documentKey=e,this.checkpoint=t,this.isRemoved=r,this.changes=n,this.snapshot=i,this.minSyncedTicket=o}static create(e,t,r,n,i,o){return new ChangePack(e,t,r,n,i,o)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getMinSyncedTicket(){return this.minSyncedTicket}};let Checkpoint=class Checkpoint{constructor(e,t){this.serverSeq=e,this.clientSeq=t}static of(e,t){return new Checkpoint(e,t)}increaseClientSeq(e){return 0===e?this:new Checkpoint(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;let t=this.serverSeq.greaterThan(e.serverSeq)?this.serverSeq:e.serverSeq,r=Math.max(this.clientSeq,e.clientSeq);return Checkpoint.of(t,r)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq.equals(e.serverSeq)}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}};let ep=new Checkpoint(Long.fromInt(0,!0),0);let RGATreeSplitNodeID=class RGATreeSplitNodeID{constructor(e,t){this.createdAt=e,this.offset=t}static of(e,t){return new RGATreeSplitNodeID(e,t)}static fromStruct(e){return RGATreeSplitNodeID.of(TimeTicket.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return 0===this.createdAt.compare(e.createdAt)&&this.offset===e.offset}hasSameCreatedAt(e){return 0===this.createdAt.compare(e.createdAt)}split(e){return new RGATreeSplitNodeID(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}};let eg=RGATreeSplitNodeID.of(ec,0);let RGATreeSplitPos=class RGATreeSplitPos{constructor(e,t){this.id=e,this.relativeOffset=t}static of(e,t){return new RGATreeSplitPos(e,t)}static fromStruct(e){let t=RGATreeSplitNodeID.fromStruct(e.id);return RGATreeSplitPos.of(t,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return RGATreeSplitNodeID.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return!!this.id.equals(e.id)&&this.relativeOffset===e.relativeOffset}};let RGATreeSplitNode=class RGATreeSplitNode extends SplayNode{constructor(e,t,r){super(t),this.id=e,this.removedAt=r}static create(e,t){return new RGATreeSplitNode(e,t)}static createComparator(){return(e,t)=>{let r=e.getCreatedAt().compare(t.getCreatedAt());return 0!==r?r:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(e){this.prev=e,e&&(e.next=this)}setNext(e){this.next=e,e&&(e.prev=this)}setInsPrev(e){this.insPrev=e,e&&(e.insNext=this)}setInsNext(e){this.insNext=e,e&&(e.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(e){return new RGATreeSplitNode(this.id.split(e),this.splitValue(e),this.removedAt)}canDelete(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}canStyle(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}remove(e){this.removedAt=e}createPosRange(){return[RGATreeSplitPos.of(this.id,0),RGATreeSplitPos.of(this.id,this.getLength())]}deepcopy(){return new RGATreeSplitNode(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(e){let t=this.value;return this.value=t.substring(0,e),t.substring(e,t.length)}};let RGATreeSplit=class RGATreeSplit{constructor(){this.head=RGATreeSplitNode.create(eg),this.treeByIndex=new SplayTree,this.treeByID=new LLRBTree(RGATreeSplitNode.createComparator()),this.removedNodeMap=new Map,this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new RGATreeSplit}edit(e,t,r,n){let[i,o]=this.findNodeWithSplit(e[1],t),[s,a]=this.findNodeWithSplit(e[0],t),l=this.findBetween(a,o),[u,d,c]=this.deleteNodes(l,t,n),h=o?o.getID():i.getID(),m=RGATreeSplitPos.of(h,0);if(r){let e=this.posToIndex(s.createPosRange()[1],!0),n=this.insertAfter(s,RGATreeSplitNode.create(RGATreeSplitNodeID.of(t,0),r));u.length&&u[u.length-1].from===e?u[u.length-1].value=r:u.push({actor:t.getActorID(),from:e,to:e,value:r}),m=RGATreeSplitPos.of(n.getID(),n.getContentLength())}for(let[e,t]of c)this.removedNodeMap.set(e,t);return[m,d,u]}indexToPos(e){let[t,r]=this.treeByIndex.find(e);return RGATreeSplitPos.of(t.getID(),r)}findIndexesFromRange(e){let[t,r]=e;return[this.posToIndex(t,!1),this.posToIndex(r,!0)]}posToIndex(e,r){let n=e.getAbsoluteID(),i=r?this.findFloorNodePreferToLeft(n):this.findFloorNode(n);i||t.fatal(`the node of the given id should be found: ${n.toTestString()}`);let o=this.treeByIndex.indexOf(i),s=i.isRemoved()?0:n.getOffset()-i.getID().getOffset();return o+s}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}checkWeight(){return this.treeByIndex.checkWeight()}toString(){let e=[];for(let t of this)t.isRemoved()||e.push(t.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){let e;let t=new RGATreeSplit,r=this.head.getNext(),n=t.head;for(;r;){if(e=t.insertAfter(n,r.deepcopy()),r.hasInsPrev()){let n=t.findNode(r.getInsPrevID());e.setInsPrev(n)}n=e,r=r.getNext()}return t}toTestString(){let e=[],t=this.head;for(;t;)t.isRemoved()?e.push(`{${t.toTestString()}}`):e.push(`[${t.toTestString()}]`),t=t.getNext();return e.join("")}insertAfter(e,t){let r=e.getNext();return t.setPrev(e),r&&r.setPrev(t),this.treeByID.put(t.getID(),t),this.treeByIndex.insertAfter(e,t),t}findNodeWithSplit(e,t){let r=e.getAbsoluteID(),n=this.findFloorNodePreferToLeft(r),i=r.getOffset()-n.getID().getOffset();for(this.splitNode(n,i);n.hasNext()&&n.getNext().getCreatedAt().after(t);)n=n.getNext();return[n,n.getNext()]}findFloorNodePreferToLeft(e){let r=this.findFloorNode(e);if(r||t.fatal(`the node of the given id should be found: ${e.toTestString()}`),e.getOffset()>0&&r.getID().getOffset()==e.getOffset()){if(!r.hasInsPrev())return r;r=r.getInsPrev()}return r}findFloorNode(e){let t=this.treeByID.floorEntry(e);if(t&&(t.key.equals(e)||t.key.hasSameCreatedAt(e)))return t.value}findBetween(e,t){let r=[],n=e;for(;n&&n!==t;)r.push(n),n=n.getNext();return r}splitNode(e,r){if(r>e.getContentLength()&&t.fatal("offset should be less than or equal to length"),0===r)return e;if(r===e.getContentLength())return e.getNext();let n=e.split(r);this.treeByIndex.updateWeight(n),this.insertAfter(e,n);let i=e.getInsNext();return i&&i.setInsPrev(n),n.setInsPrev(e),n}deleteNodes(e,t,r){if(!e.length)return[[],new Map,new Map];let[n,i]=this.filterNodes(e,t,r),o=new Map,s=new Map,a=this.makeChanges(i,t);for(let e of n){let r=e.getCreatedAt().getActorID();(!o.has(r)||e.getID().getCreatedAt().after(o.get(r)))&&o.set(r,e.getID().getCreatedAt()),s.set(e.getID().toIDString(),e),e.remove(t)}return this.deleteIndexNodes(i),[a,o,s]}filterNodes(e,t,r){let n=!!r,i=[],o=[],[s,a]=this.findEdgesOfCandidates(e);for(let a of(o.push(s),e)){let e=a.getCreatedAt().getActorID(),s=n?r.has(e)?r.get(e):ec:eh;a.canDelete(t,s)?i.push(a):o.push(a)}return o.push(a),[i,o]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,t){let r,n;let i=[];for(let o=0;o<e.length-1;o++){let s=e[o],a=e[o+1];s.getNext()!=a&&([r]=this.findIndexesFromRange(s.getNext().createPosRange()),a?[,n]=this.findIndexesFromRange(a.getPrev().createPosRange()):n=this.treeByIndex.length,r<n&&i.push({actor:t.getActorID(),from:r,to:n}))}return i.reverse()}deleteIndexNodes(e){for(let t=0;t<e.length-1;t++){let r=e[t],n=e[t+1];r.getNext()!=n&&this.treeByIndex.deleteRange(r,n)}}getRemovedNodesLen(){return this.removedNodeMap.size}purgeRemovedNodesBefore(e){let t=0;for(let[,r]of this.removedNodeMap)r.getRemovedAt()&&e.compare(r.getRemovedAt())>=0&&(this.treeByIndex.delete(r),this.purge(r),this.treeByID.remove(r.getID()),this.removedNodeMap.delete(r.getID().toIDString()),t++);return t}purge(e){let t=e.getPrev(),r=e.getNext(),n=e.getInsPrev(),i=e.getInsNext();t&&t.setNext(r),r&&r.setPrev(t),e.setPrev(void 0),e.setNext(void 0),n&&n.setInsNext(i),i&&i.setInsPrev(n),e.setInsPrev(void 0),e.setInsNext(void 0)}};let removeDecimal=e=>e<0?Math.ceil(e):Math.floor(e);(c=A||(A={}))[c.IntegerCnt=0]="IntegerCnt",c[c.LongCnt=1]="LongCnt";let CRDTCounter=class CRDTCounter extends CRDTElement{constructor(e,t,r){switch(super(r),this.valueType=e,e){case A.IntegerCnt:"number"==typeof t?t>2147483647||t<-2147483648?this.value=Long.fromNumber(t).toInt():this.value=removeDecimal(t):this.value=t.toInt();break;case A.LongCnt:"number"==typeof t?this.value=Long.fromNumber(t):this.value=t;break;default:throw new YorkieError(w.Unimplemented,`unimplemented type: ${e}`)}}static create(e,t,r){return new CRDTCounter(e,t,r)}static valueFromBytes(e,t){switch(e){case A.IntegerCnt:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case A.LongCnt:return Long.fromBytesLE(Array.from(t));default:throw new YorkieError(w.Unimplemented,`unimplemented type: ${e}`)}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){let e=CRDTCounter.create(this.valueType,this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e}getType(){return this.valueType}static getCounterType(e){switch(typeof e){case"object":if(e instanceof Long)return A.LongCnt;return;case"number":if(e>2147483647||e<-2147483648)return A.LongCnt;return A.IntegerCnt;default:return}}static isSupport(e){return!!CRDTCounter.getCounterType(e)}static isInteger(e){return e%1==0}isNumericType(){let e=this.valueType;return e===A.IntegerCnt||e===A.LongCnt}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case A.IntegerCnt:{let e=this.value;return new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24&255])}case A.LongCnt:{let e=this.value,t=e.toBytesLE();return Uint8Array.from(t)}default:throw new YorkieError(w.Unimplemented,`unimplemented type: ${this.valueType}`)}}increase(e){function checkNumericType(e){if(!e.isNumericType())throw TypeError(`Unsupported type of value: ${typeof e.getValue()}`)}return checkNumericType(this),checkNumericType(e),this.valueType===A.LongCnt?this.value=this.value.add(e.getValue()):e.getType()===I.Long?this.value=this.value+e.getValue().toInt():this.value=Long.fromNumber(this.value+removeDecimal(e.getValue())).toInt(),this}};let IncreaseOperation=class IncreaseOperation extends Operation{constructor(e,t,r){super(e,r),this.value=t}static create(e,t,r){return new IncreaseOperation(e,t,r)}execute(e){let r=e.findByCreatedAt(this.getParentCreatedAt());r||t.fatal(`fail to find ${this.getParentCreatedAt()}`),r instanceof CRDTCounter||t.fatal("fail to execute, only Counter can execute increase");let n=this.value.deepcopy();return r.increase(n),{opInfos:[{type:"increase",path:e.createPath(this.getParentCreatedAt()),value:n.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){let e=this.value.deepcopy(),t=e.getType(),r=t===I.Long?e.getValue().multiply(-1):-1*e.getValue(),n=IncreaseOperation.create(this.getParentCreatedAt(),Primitive.of(r,e.getCreatedAt()));return n}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}};let TreeStyleOperation=class TreeStyleOperation extends Operation{constructor(e,t,r,n,i){super(e,i),this.fromPos=t,this.toPos=r,this.attributes=n}static create(e,t,r,n,i){return new TreeStyleOperation(e,t,r,n,i)}execute(e){let r=e.findByCreatedAt(this.getParentCreatedAt());r||t.fatal(`fail to find ${this.getParentCreatedAt()}`),r instanceof CRDTTree||t.fatal("fail to execute, only Tree can execute edit");let n={};[...this.attributes].forEach(([e,t])=>n[e]=t);let i=r.style([this.fromPos,this.toPos],n,this.getExecutedAt());return{opInfos:i.map(({from:t,to:r,value:n,fromPath:i})=>({type:"tree-style",from:t,to:r,value:n,fromPath:i,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${e}.STYLE(${t},${r},${Object.entries(this.attributes||{}).map(([e,t])=>`${e}:"${t}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}};function toTimeTicket(e){if(e)return new G.TimeTicket({lamport:e.getLamportAsString(),delimiter:e.getDelimiter(),actorId:toUint8Array(e.getActorID())})}function toValueType(e){switch(e){case I.Null:return G.ValueType.NULL;case I.Boolean:return G.ValueType.BOOLEAN;case I.Integer:return G.ValueType.INTEGER;case I.Long:return G.ValueType.LONG;case I.Double:return G.ValueType.DOUBLE;case I.String:return G.ValueType.STRING;case I.Bytes:return G.ValueType.BYTES;case I.Date:return G.ValueType.DATE;default:throw new YorkieError(w.Unsupported,`unsupported type: ${e}`)}}function toCounterType(e){switch(e){case A.IntegerCnt:return G.ValueType.INTEGER_CNT;case A.LongCnt:return G.ValueType.LONG_CNT;default:throw new YorkieError(w.Unsupported,`unsupported type: ${e}`)}}function toElementSimple(e){if(e instanceof CRDTObject)return new G.JSONElementSimple({type:G.ValueType.JSON_OBJECT,createdAt:toTimeTicket(e.getCreatedAt()),value:objectToBytes(e)});if(e instanceof CRDTArray)return new G.JSONElementSimple({type:G.ValueType.JSON_ARRAY,createdAt:toTimeTicket(e.getCreatedAt()),value:toArray(e).toBinary()});if(e instanceof CRDTText)return new G.JSONElementSimple({type:G.ValueType.TEXT,createdAt:toTimeTicket(e.getCreatedAt())});if(e instanceof Primitive)return new G.JSONElementSimple({type:toValueType(e.getType()),createdAt:toTimeTicket(e.getCreatedAt()),value:e.toBytes()});if(e instanceof CRDTCounter)return new G.JSONElementSimple({type:toCounterType(e.getType()),createdAt:toTimeTicket(e.getCreatedAt()),value:e.toBytes()});if(e instanceof CRDTTree)return new G.JSONElementSimple({type:G.ValueType.TREE,createdAt:toTimeTicket(e.getCreatedAt()),value:toTree(e).toBinary()});throw new YorkieError(w.Unimplemented,"unimplemented element")}function toTextNodePos(e){return new G.TextNodePos({createdAt:toTimeTicket(e.getID().getCreatedAt()),offset:e.getID().getOffset(),relativeOffset:e.getRelativeOffset()})}function toTreePos(e){return new G.TreePos({parentId:toTreeNodeID(e.getParentID()),leftSiblingId:toTreeNodeID(e.getLeftSiblingID())})}function toTreeNodeID(e){return new G.TreeNodeID({createdAt:toTimeTicket(e.getCreatedAt()),offset:e.getOffset()})}function toTreeNodes(e){if(!e)return[];let t=[];return traverse(e,(e,r)=>{let n=new G.TreeNode({id:toTreeNodeID(e.id),type:e.type,removedAt:toTimeTicket(e.removedAt),depth:r});if(e.isText&&(n.value=e.value),e.insPrevID&&(n.insPrevId=toTreeNodeID(e.insPrevID)),e.insNextID&&(n.insNextId=toTreeNodeID(e.insNextID)),e.attrs)for(let t of e.attrs)n.attributes[t.getKey()]=new G.NodeAttr({value:t.getValue(),updatedAt:toTimeTicket(t.getUpdatedAt())});t.push(n)}),t}function toArray(e){let t=new G.JSONElement;return t.body.case="jsonArray",t.body.value=new G.JSONElement_JSONArray({nodes:function(e){let t=[];for(let r of e)t.push(new G.RGANode({element:toElement(r.getValue())}));return t}(e.getElements()),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}function toTree(e){let t=new G.JSONElement;return t.body.case="tree",t.body.value=new G.JSONElement_Tree({nodes:toTreeNodes(e.getRoot()),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}function toElement(e){if(e instanceof CRDTObject)return function(e){let t=new G.JSONElement;return t.body.case="jsonObject",t.body.value=new G.JSONElement_JSONObject({nodes:function(e){let t=[];for(let r of e)t.push(new G.RHTNode({key:r.getStrKey(),element:toElement(r.getValue())}));return t}(e.getRHT()),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}(e);if(e instanceof CRDTArray)return toArray(e);if(e instanceof Primitive)return function(e){let t=new G.JSONElement;return t.body.case="primitive",t.body.value=new G.JSONElement_Primitive({type:toValueType(e.getType()),value:e.toBytes(),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}(e);if(e instanceof CRDTText)return function(e){let t=new G.JSONElement;return t.body.case="text",t.body.value=new G.JSONElement_Text({nodes:function(e){let t=[];for(let n of e){var r;let e=new G.TextNode;e.id=(r=n.getID(),new G.TextNodeID({createdAt:toTimeTicket(r.getCreatedAt()),offset:r.getOffset()})),e.value=n.getValue().getContent(),e.removedAt=toTimeTicket(n.getRemovedAt());let i=e.attributes,o=n.getValue().getAttrs();for(let e of o){let t=new G.NodeAttr;t.value=e.getValue(),t.updatedAt=toTimeTicket(e.getUpdatedAt()),i[e.getKey()]=t}t.push(e)}return t}(e.getRGATreeSplit()),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}(e);if(e instanceof CRDTCounter)return function(e){let t=new G.JSONElement;return t.body.case="counter",t.body.value=new G.JSONElement_Counter({type:toCounterType(e.getType()),value:e.toBytes(),createdAt:toTimeTicket(e.getCreatedAt()),movedAt:toTimeTicket(e.getMovedAt()),removedAt:toTimeTicket(e.getRemovedAt())}),t}(e);if(e instanceof CRDTTree)return toTree(e);throw new YorkieError(w.Unimplemented,"unimplemented element")}function fromTimeTicket(e){if(e)return TimeTicket.of(Long.fromString(e.lamport,!0),e.delimiter,toHexString(e.actorId))}function fromPresence(e){let t={};return Object.entries(e.data).forEach(([e,r])=>{t[e]=JSON.parse(r)}),t}function fromValueType(e){switch(e){case G.ValueType.NULL:return I.Null;case G.ValueType.BOOLEAN:return I.Boolean;case G.ValueType.INTEGER:return I.Integer;case G.ValueType.LONG:return I.Long;case G.ValueType.DOUBLE:return I.Double;case G.ValueType.STRING:return I.String;case G.ValueType.BYTES:return I.Bytes;case G.ValueType.DATE:return I.Date}throw new YorkieError(w.Unimplemented,`unimplemented value type: ${e}`)}function fromCounterType(e){switch(e){case G.ValueType.INTEGER_CNT:return A.IntegerCnt;case G.ValueType.LONG_CNT:return A.LongCnt}throw new YorkieError(w.Unimplemented,`unimplemented value type: ${e}`)}function fromElementSimple(e){switch(e.type){case G.ValueType.JSON_OBJECT:if(!e.value)return CRDTObject.create(fromTimeTicket(e.createdAt));return bytesToObject(e.value);case G.ValueType.JSON_ARRAY:if(!e.value)return CRDTArray.create(fromTimeTicket(e.createdAt));return function(e){if(!e)throw Error("bytes is empty");let t=G.JSONElement.fromBinary(e);return fromArray(t.body.value)}(e.value);case G.ValueType.TEXT:return CRDTText.create(RGATreeSplit.create(),fromTimeTicket(e.createdAt));case G.ValueType.TREE:return function(e){if(!e)throw Error("bytes is empty");let t=G.JSONElement.fromBinary(e);return fromTree(t.body.value)}(e.value);case G.ValueType.NULL:case G.ValueType.BOOLEAN:case G.ValueType.INTEGER:case G.ValueType.LONG:case G.ValueType.DOUBLE:case G.ValueType.STRING:case G.ValueType.BYTES:case G.ValueType.DATE:return Primitive.of(Primitive.valueFromBytes(fromValueType(e.type),e.value),fromTimeTicket(e.createdAt));case G.ValueType.INTEGER_CNT:case G.ValueType.LONG_CNT:return CRDTCounter.create(fromCounterType(e.type),CRDTCounter.valueFromBytes(fromCounterType(e.type),e.value),fromTimeTicket(e.createdAt))}}function fromTextNodePos(e){return RGATreeSplitPos.of(RGATreeSplitNodeID.of(fromTimeTicket(e.createdAt),e.offset),e.relativeOffset)}function fromTextNodeID(e){return RGATreeSplitNodeID.of(fromTimeTicket(e.createdAt),e.offset)}function fromTreePos(e){return CRDTTreePos.of(fromTreeNodeID(e.parentId),fromTreeNodeID(e.leftSiblingId))}function fromTreeNodeID(e){return CRDTTreeNodeID.of(fromTimeTicket(e.createdAt),e.offset)}function fromTreeNodes(e){if(0===e.length)return;let t=[];for(let r of e)t.push(function(e){let t=fromTreeNodeID(e.id),r=CRDTTreeNode.create(t,e.type);if(r.isText)r.value=e.value;else{let t=RHT.create();Object.entries(e.attributes).forEach(([e,r])=>{t.set(e,r.value,fromTimeTicket(r.updatedAt))}),r.attrs=t}return e.insPrevId&&(r.insPrevID=fromTreeNodeID(e.insPrevId)),e.insNextId&&(r.insNextID=fromTreeNodeID(e.insNextId)),r.removedAt=fromTimeTicket(e.removedAt),r}(r));let r=t[t.length-1];for(let r=t.length-2;r>=0;r--){let n;for(let i=r+1;i<t.length;i++)if(e[r].depth-1===e[i].depth){n=t[i];break}n.prepend(t[r])}return CRDTTree.create(r,ec).getRoot()}function fromChanges(e){let t=[];for(let n of e){var r;t.push(Change.create({id:(r=n.id,ChangeID.of(r.clientSeq,Long.fromString(r.lamport,!0),toHexString(r.actorId))),operations:function(e){let t=[];for(let r of e){let e;if("set"===r.body.case){let t=r.body.value;e=SetOperation.create(t.key,fromElementSimple(t.value),fromTimeTicket(t.parentCreatedAt),fromTimeTicket(t.executedAt))}else if("add"===r.body.case){let t=r.body.value;e=AddOperation.create(fromTimeTicket(t.parentCreatedAt),fromTimeTicket(t.prevCreatedAt),fromElementSimple(t.value),fromTimeTicket(t.executedAt))}else if("move"===r.body.case){let t=r.body.value;e=MoveOperation.create(fromTimeTicket(t.parentCreatedAt),fromTimeTicket(t.prevCreatedAt),fromTimeTicket(t.createdAt),fromTimeTicket(t.executedAt))}else if("remove"===r.body.case){let t=r.body.value;e=RemoveOperation.create(fromTimeTicket(t.parentCreatedAt),fromTimeTicket(t.createdAt),fromTimeTicket(t.executedAt))}else if("edit"===r.body.case){let t=r.body.value,n=new Map;Object.entries(t.createdAtMapByActor).forEach(([e,t])=>{n.set(e,fromTimeTicket(t))});let i=new Map;Object.entries(t.attributes).forEach(([e,t])=>{i.set(e,t)}),e=EditOperation.create(fromTimeTicket(t.parentCreatedAt),fromTextNodePos(t.from),fromTextNodePos(t.to),n,t.content,i,fromTimeTicket(t.executedAt))}else if("style"===r.body.case){let t=r.body.value,n=new Map;Object.entries(t.createdAtMapByActor).forEach(([e,t])=>{n.set(e,fromTimeTicket(t))});let i=new Map;Object.entries(t.attributes).forEach(([e,t])=>{i.set(e,t)}),e=StyleOperation.create(fromTimeTicket(t.parentCreatedAt),fromTextNodePos(t.from),fromTextNodePos(t.to),n,i,fromTimeTicket(t.executedAt))}else if("select"===r.body.case)continue;else if("increase"===r.body.case){let t=r.body.value;e=IncreaseOperation.create(fromTimeTicket(t.parentCreatedAt),fromElementSimple(t.value),fromTimeTicket(t.executedAt))}else if("treeEdit"===r.body.case){let t=r.body.value,n=new Map;Object.entries(t.createdAtMapByActor).forEach(([e,t])=>{n.set(e,fromTimeTicket(t))}),e=TreeEditOperation.create(fromTimeTicket(t.parentCreatedAt),fromTreePos(t.from),fromTreePos(t.to),function(e){if(!e.length)return;let t=[];return e.forEach(e=>{let r=fromTreeNodes(e.content);t.push(r)}),t}(t.contents),t.splitLevel,n,fromTimeTicket(t.executedAt))}else if("treeStyle"===r.body.case){let t=r.body.value,n=new Map;Object.entries(t.attributes).forEach(([e,t])=>{n.set(e,t)}),e=TreeStyleOperation.create(fromTimeTicket(t.parentCreatedAt),fromTreePos(t.from),fromTreePos(t.to),n,fromTimeTicket(t.executedAt))}else throw new YorkieError(w.Unimplemented,"unimplemented operation");t.push(e)}return t}(n.operations),presenceChange:n.presenceChange?function(e){let t=e.type;if(t===G.PresenceChange_ChangeType.PUT){let t=fromPresence(e.presence);return{type:N.Put,presence:t}}if(t===G.PresenceChange_ChangeType.CLEAR)return{type:N.Clear};throw new YorkieError(w.Unsupported,`unsupported type: ${t}`)}(n.presenceChange):void 0,message:n.message}))}return t}function fromObject(e){let t=new ElementRHT;for(let r of e.nodes){let e=fromElement(r.element);t.set(r.key,e,e.getPositionedAt())}let r=new CRDTObject(fromTimeTicket(e.createdAt),t);return r.setMovedAt(fromTimeTicket(e.movedAt)),r.setRemovedAt(fromTimeTicket(e.removedAt)),r}function fromArray(e){let t=new RGATreeList;for(let r of e.nodes)t.insert(fromElement(r.element));let r=new CRDTArray(fromTimeTicket(e.createdAt),t);return r.setMovedAt(fromTimeTicket(e.movedAt)),r.setRemovedAt(fromTimeTicket(e.removedAt)),r}function fromTree(e){let t=fromTreeNodes(e.nodes);return CRDTTree.create(t,fromTimeTicket(e.createdAt))}function fromElement(e){if("jsonObject"===e.body.case)return fromObject(e.body.value);if("jsonArray"===e.body.case)return fromArray(e.body.value);if("primitive"===e.body.case)return function(e){let t=Primitive.of(Primitive.valueFromBytes(fromValueType(e.type),e.value),fromTimeTicket(e.createdAt));return t.setMovedAt(fromTimeTicket(e.movedAt)),t.setRemovedAt(fromTimeTicket(e.removedAt)),t}(e.body.value);if("text"===e.body.case)return function(e){let t=new RGATreeSplit,r=t.getHead();for(let n of e.nodes){let e=t.insertAfter(r,function(e){let t=CRDTTextValue.create(e.value);Object.entries(e.attributes).forEach(([e,r])=>{t.setAttr(e,r.value,fromTimeTicket(r.updatedAt))});let r=RGATreeSplitNode.create(fromTextNodeID(e.id),t);return r.remove(fromTimeTicket(e.removedAt)),r}(n));n.insPrevId&&e.setInsPrev(t.findNode(fromTextNodeID(n.insPrevId))),r=e}let n=new CRDTText(t,fromTimeTicket(e.createdAt));return n.setMovedAt(fromTimeTicket(e.movedAt)),n.setRemovedAt(fromTimeTicket(e.removedAt)),n}(e.body.value);if("counter"===e.body.case)return function(e){let t=CRDTCounter.create(fromCounterType(e.type),CRDTCounter.valueFromBytes(fromCounterType(e.type),e.value),fromTimeTicket(e.createdAt));return t.setMovedAt(fromTimeTicket(e.movedAt)),t.setRemovedAt(fromTimeTicket(e.removedAt)),t}(e.body.value);if("tree"===e.body.case)return fromTree(e.body.value);throw new YorkieError(w.Unimplemented,"unimplemented element")}function bytesToObject(e){if(!e)throw Error("bytes is empty");let t=G.JSONElement.fromBinary(e);return fromObject(t.body.value)}function objectToBytes(e){return toElement(e).toBinary()}function toHexString(e){return e?Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function toUint8Array(e){return new Uint8Array(e.match(/.{1,2}/g).map(e=>parseInt(e,16)))}let eT={fromPresence,toChangePack:function(e){var t;return new G.ChangePack({documentKey:e.getDocumentKey(),checkpoint:(t=e.getCheckpoint(),new G.Checkpoint({serverSeq:t.getServerSeqAsString(),clientSeq:t.getClientSeq()})),isRemoved:e.getIsRemoved(),changes:function(e){let t=[];for(let r of e)t.push(function(e){var t;let r=new G.Change({id:(t=e.getID(),new G.ChangeID({clientSeq:t.getClientSeq(),lamport:t.getLamportAsString(),actorId:toUint8Array(t.getActorID())})),message:e.getMessage()});return e.hasOperations()&&(r.operations=function(e){let t=[];for(let r of e)t.push(function(e){let t=new G.Operation;if(e instanceof SetOperation){let r=new G.Operation_Set;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.key=e.getKey(),r.value=toElementSimple(e.getValue()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="set",t.body.value=r}else if(e instanceof AddOperation){let r=new G.Operation_Add;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.prevCreatedAt=toTimeTicket(e.getPrevCreatedAt()),r.value=toElementSimple(e.getValue()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="add",t.body.value=r}else if(e instanceof MoveOperation){let r=new G.Operation_Move;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.prevCreatedAt=toTimeTicket(e.getPrevCreatedAt()),r.createdAt=toTimeTicket(e.getCreatedAt()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="move",t.body.value=r}else if(e instanceof RemoveOperation){let r=new G.Operation_Remove;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.createdAt=toTimeTicket(e.getCreatedAt()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="remove",t.body.value=r}else if(e instanceof EditOperation){let r=new G.Operation_Edit;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.from=toTextNodePos(e.getFromPos()),r.to=toTextNodePos(e.getToPos());let n=r.createdAtMapByActor;for(let[t,r]of e.getMaxCreatedAtMapByActor())n[t]=toTimeTicket(r);r.content=e.getContent();let i=r.attributes;for(let[t,r]of e.getAttributes())i[t]=r;r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="edit",t.body.value=r}else if(e instanceof StyleOperation){let r=new G.Operation_Style;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.from=toTextNodePos(e.getFromPos()),r.to=toTextNodePos(e.getToPos());let n=r.createdAtMapByActor;for(let[t,r]of e.getMaxCreatedAtMapByActor())n[t]=toTimeTicket(r);let i=r.attributes;for(let[t,r]of e.getAttributes())i[t]=r;r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="style",t.body.value=r}else if(e instanceof IncreaseOperation){let r=new G.Operation_Increase;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.value=toElementSimple(e.getValue()),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="increase",t.body.value=r}else if(e instanceof TreeEditOperation){let r=new G.Operation_TreeEdit,n=r.createdAtMapByActor;for(let[t,r]of e.getMaxCreatedAtMapByActor())n[t]=toTimeTicket(r);r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.from=toTreePos(e.getFromPos()),r.to=toTreePos(e.getToPos()),r.contents=function(e){let t=[];if(!e||!e.length)return t;for(let r of e)t.push(new G.TreeNodes({content:toTreeNodes(r)}));return t}(e.getContents()),r.splitLevel=e.getSplitLevel(),r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="treeEdit",t.body.value=r}else if(e instanceof TreeStyleOperation){let r=new G.Operation_TreeStyle;r.parentCreatedAt=toTimeTicket(e.getParentCreatedAt()),r.from=toTreePos(e.getFromPos()),r.to=toTreePos(e.getToPos());let n=r.attributes;for(let[t,r]of e.getAttributes())n[t]=r;r.executedAt=toTimeTicket(e.getExecutedAt()),t.body.case="treeStyle",t.body.value=r}else throw new YorkieError(w.Unimplemented,"unimplemented operation");return t}(r));return t}(e.getOperations())),e.hasPresenceChange()&&(r.presenceChange=function(e){if(e.type===N.Put)return new G.PresenceChange({type:G.PresenceChange_ChangeType.PUT,presence:function(e){let t=new G.Presence,r=t.data;for(let[t,n]of Object.entries(e))r[t]=JSON.stringify(n);return t}(e.presence)});if(e.type===N.Clear)return new G.PresenceChange({type:G.PresenceChange_ChangeType.CLEAR});throw new YorkieError(w.Unimplemented,"unimplemented type")}(e.getPresenceChange())),r}(r));return t}(e.getChanges()),snapshot:e.getSnapshot(),minSyncedTicket:toTimeTicket(e.getMinSyncedTicket())})},fromChangePack:function(e){var t;return ChangePack.create(e.documentKey,(t=e.checkpoint,Checkpoint.of(Long.fromString(t.serverSeq,!0),t.clientSeq)),e.isRemoved,fromChanges(e.changes),e.snapshot,fromTimeTicket(e.minSyncedTicket))},fromChanges,objectToBytes,bytesToObject,bytesToSnapshot:function(e){if(!e)return{root:CRDTObject.create(ec),presences:new Map};let t=G.Snapshot.fromBinary(e);return{root:fromElement(t.root),presences:function(e){let t=new Map;return Object.entries(e).forEach(([e,r])=>{t.set(e,fromPresence(r))}),t}(t.presences)}},toHexString,toUint8Array};let Attachment=class Attachment{constructor(e,t,r,n){this.reconnectStreamDelay=e,this.doc=t,this.docID=r,this.isRealtimeSync=n,this.syncMode=C.PushPull,this.remoteChangeEventReceived=!1}changeRealtimeSync(e){return this.isRealtimeSync!==e&&(e?this.isRealtimeSync=!0:(this.cancelWatchStream(),this.isRealtimeSync=!1),!0)}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.isRealtimeSync&&(this.doc.hasLocalChanges()||this.remoteChangeEventReceived)}async runWatchLoop(e){let doLoop=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.watchLoopTimerID=setTimeout(doLoop,this.reconnectStreamDelay)})}catch(e){}};await doLoop()}cancelWatchStream(){this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}};let ChangeContext=class ChangeContext{constructor(e,t,r,n){this.id=e,this.delimiter=0,this.root=t,this.operations=[],this.previousPresence=deepcopy(r),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=n}static create(e,t,r,n){return new ChangeContext(e,t,r,n)}push(e){this.operations.push(e)}registerElement(e,t){this.root.registerElement(e,t)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerElementHasRemovedNodes(e){this.root.registerElementHasRemovedNodes(e)}getChange(){return Change.create({id:this.id,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}hasChange(){return this.operations.length>0||void 0!==this.presenceChange}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,t){for(let r of Object.keys(e))(null==t?void 0:t.addToHistory)?this.reversePresenceKeys.add(r):this.reversePresenceKeys.delete(r)}getReversePresence(){if(0===this.reversePresenceKeys.size)return;let e={};for(let t of this.reversePresenceKeys)e[t]=this.previousPresence[t];return e}issueTimeTicket(){return this.delimiter+=1,this.id.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.id.createTimeTicket(this.delimiter)}};let CRDTRoot=class CRDTRoot{constructor(e){this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.removedElementSetByCreatedAt=new Set,this.elementHasRemovedNodesSetByCreatedAt=new Set,this.opsForTest=[],this.registerElement(e,void 0)}static create(){return new CRDTRoot(CRDTObject.create(ec))}findByCreatedAt(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(t)return t.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let r=this.elementPairMapByCreatedAt.get(e.toIDString());if(!r)return[];let n=[];for(;r.parent;){let e=r.element.getCreatedAt(),i=r.parent.subPathOf(e);void 0===i&&t.fatal(`cant find the given element: ${e.toIDString()}`),n.unshift(i),r=this.elementPairMapByCreatedAt.get(r.parent.getCreatedAt().toIDString())}return n.unshift("$"),n}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,t){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),e instanceof CRDTContainer&&e.getDescendants((e,t)=>(this.registerElement(e,t),!1))}deregisterElement(e){let t=0,deregisterElementInternal=e=>{let r=e.getCreatedAt().toIDString();this.elementPairMapByCreatedAt.delete(r),this.removedElementSetByCreatedAt.delete(r),t++};return deregisterElementInternal(e),e instanceof CRDTContainer&&e.getDescendants(e=>(deregisterElementInternal(e),!1)),t}registerRemovedElement(e){this.removedElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerElementHasRemovedNodes(e){this.elementHasRemovedNodesSetByCreatedAt.add(e.getCreatedAt().toIDString())}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getRemovedElementSetSize(){return this.removedElementSetByCreatedAt.size}getObject(){return this.rootObject}getGarbageLen(){let e=0,t=new Set;for(let e of this.removedElementSetByCreatedAt){t.add(e);let r=this.elementPairMapByCreatedAt.get(e);r.element instanceof CRDTContainer&&r.element.getDescendants(e=>(t.add(e.getCreatedAt().toIDString()),!1))}for(let r of(e+=t.size,this.elementHasRemovedNodesSetByCreatedAt)){let t=this.elementPairMapByCreatedAt.get(r),n=t.element;e+=n.getRemovedNodesLen()}return e}deepcopy(){return new CRDTRoot(this.rootObject.deepcopy())}garbageCollect(e){let t=0;for(let r of this.removedElementSetByCreatedAt){let n=this.elementPairMapByCreatedAt.get(r);n.element.getRemovedAt()&&e.compare(n.element.getRemovedAt())>=0&&(n.parent.purge(n.element),t+=this.deregisterElement(n.element))}for(let r of this.elementHasRemovedNodesSetByCreatedAt){let n=this.elementPairMapByCreatedAt.get(r),i=n.element,o=i.purgeRemovedNodesBefore(e);o>0&&this.elementHasRemovedNodesSetByCreatedAt.delete(i.getCreatedAt().toIDString()),t+=o}return t}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}};function createJSONObject(e,t){let r=new ObjectProxy(e);return new Proxy(t,r.getHandlers())}let ObjectProxy=class ObjectProxy{constructor(e){this.context=e,this.handlers={set:(r,n,i)=>(t.isEnabled(S.Trivial)&&t.trivial(`obj[${n}]=${JSON.stringify(i)}`),ObjectProxy.setInternal(e,r,n,i),!0),get:(r,n)=>(t.isEnabled(S.Trivial)&&t.trivial(`obj[${n}]`),"getID"===n)?()=>r.getCreatedAt():"toJSON"===n||"toString"===n?()=>r.toJSON():"toJS"===n?()=>r.toJS():"toJSForTest"===n?()=>r.toJSForTest():toJSONElement(e,r.get(n)),ownKeys:e=>e.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(r,n)=>(t.isEnabled(S.Trivial)&&t.trivial(`obj[${n}]`),ObjectProxy.deleteInternal(e,r,n),!0)}}static setInternal(e,t,r,n){if(r.includes("."))throw new YorkieError(w.InvalidObjectKey,"key must not contain the '.'.");let i=e.issueTimeTicket(),o=buildCRDTElement(e,n,i),s=t.set(r,o,i);e.registerElement(o,t),s&&e.registerRemovedElement(s),e.push(SetOperation.create(r,o.deepcopy(),t.getCreatedAt(),i))}static buildObjectMembers(e,t){let r={};for(let[n,i]of Object.entries(t)){if(n.includes("."))throw new YorkieError(w.InvalidObjectKey,"key must not contain the '.'.");let t=e.issueTimeTicket(),o=buildCRDTElement(e,i,t);r[n]=o}return r}static deleteInternal(e,t,r){let n=e.issueTimeTicket(),i=t.deleteByKey(r,n);i&&(e.push(RemoveOperation.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i))}getHandlers(){return this.handlers}};let ArrayProxy=class ArrayProxy{constructor(e,r){this.context=e,this.array=r,this.handlers={get:(t,r,n)=>"getID"===r?()=>t.getCreatedAt():"getElementByID"===r?r=>{let n=t.getByID(r);if(!(!n||n.isRemoved()))return toWrappedElement(e,n)}:"getElementByIndex"===r?r=>{let n=t.get(r);return toWrappedElement(e,n)}:"getLast"===r?()=>toWrappedElement(e,t.getLast()):"deleteByID"===r?r=>{let n=ArrayProxy.deleteInternalByID(e,t,r);return toWrappedElement(e,n)}:"insertAfter"===r?(r,n)=>{let i=ArrayProxy.insertAfterInternal(e,t,r,n);return toWrappedElement(e,i)}:"insertBefore"===r?(r,n)=>{let i=ArrayProxy.insertBeforeInternal(e,t,r,n);return toWrappedElement(e,i)}:"moveBefore"===r?(r,n)=>{ArrayProxy.moveBeforeInternal(e,t,r,n)}:"moveAfter"===r?(r,n)=>{ArrayProxy.moveAfterInternal(e,t,r,n)}:"moveFront"===r?r=>{ArrayProxy.moveFrontInternal(e,t,r)}:"moveLast"===r?r=>{ArrayProxy.moveLastInternal(e,t,r)}:("string"==typeof r||r instanceof String)&&!isNaN(r)?toJSONElement(e,t.get(Number(r))):"push"===r?r=>ArrayProxy.pushInternal(e,t,r):"splice"===r?(r,n,...i)=>ArrayProxy.splice(e,t,r,n,...i):"length"===r?t.length:"symbol"==typeof r&&r===Symbol.iterator?ArrayProxy.iteratorInternal.bind(this,e,t):"includes"===r?(r,n)=>ArrayProxy.includes(e,t,r,n):"indexOf"===r?(r,n)=>ArrayProxy.indexOf(e,t,r,n):"lastIndexOf"===r?(r,n)=>ArrayProxy.lastIndexOf(e,t,r,n):"toTestString"===r?()=>ArrayProxy.toTestString(t):"string"==typeof r&&["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(r)?(...n)=>{let i=Array.from(t).map(t=>toJSONElement(e,t));return Array.prototype[r].apply(i,n)}:Reflect.get(t,r,n),deleteProperty:(r,n)=>(t.isEnabled(S.Trivial)&&t.trivial(`array[${n}]`),ArrayProxy.deleteInternalByIndex(e,r,Number.parseInt(n)),!0)}}static*iteratorInternal(e,t){for(let r of t)yield toWrappedElement(e,r)}static buildArrayElements(e,t){let r=[];for(let n of t){let t=e.issueTimeTicket(),i=buildCRDTElement(e,n,t);r.push(i)}return r}static pushInternal(e,t,r){return ArrayProxy.insertAfterInternal(e,t,t.getLastCreatedAt(),r),t.length}static moveBeforeInternal(e,t,r,n){let i=e.issueTimeTicket(),o=t.getPrevCreatedAt(r);t.moveAfter(o,n,i),e.push(MoveOperation.create(t.getCreatedAt(),o,n,i))}static moveAfterInternal(e,t,r,n){let i=e.issueTimeTicket();t.moveAfter(r,n,i),e.push(MoveOperation.create(t.getCreatedAt(),r,n,i))}static moveFrontInternal(e,t,r){let n=e.issueTimeTicket(),i=t.getHead();t.moveAfter(i.getCreatedAt(),r,n),e.push(MoveOperation.create(t.getCreatedAt(),i.getCreatedAt(),r,n))}static moveLastInternal(e,t,r){let n=e.issueTimeTicket(),i=t.getLastCreatedAt();t.moveAfter(i,r,n),e.push(MoveOperation.create(t.getCreatedAt(),i,r,n))}static insertAfterInternal(e,t,r,n){let i=e.issueTimeTicket(),o=buildCRDTElement(e,n,i);return t.insertAfter(r,o),e.registerElement(o,t),e.push(AddOperation.create(t.getCreatedAt(),r,o.deepcopy(),i)),o}static insertBeforeInternal(e,t,r,n){return ArrayProxy.insertAfterInternal(e,t,t.getPrevCreatedAt(r),n)}static deleteInternalByIndex(e,t,r){let n=e.issueTimeTicket(),i=t.deleteByIndex(r,n);if(i)return e.push(RemoveOperation.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i),i}static deleteInternalByID(e,t,r){let n=e.issueTimeTicket(),i=t.delete(r,n);return e.push(RemoveOperation.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i),i}static splice(e,t,r,n,...i){let o=t.length,s=r>=0?Math.min(r,o):Math.max(o+r,0),a=void 0===n?o:n<0?s:Math.min(s+n,o),l=[];for(let r=s;r<a;r++){let r=ArrayProxy.deleteInternalByIndex(e,t,s);if(r){let t=r.deepcopy();t.setRemovedAt(),l.push(toJSONElement(e,t))}}if(i){let r=0===s?t.getHead().getID():t.get(s-1).getID();for(let n of i){let i=ArrayProxy.insertAfterInternal(e,t,r,n);r=i.getID()}}return l}static includes(e,t,r,n){var i;let o=t.length,s=void 0===n?0:n<0?Math.max(n+o,0):n;if(s>=o)return!1;if(Primitive.isSupport(r)){let n=Array.from(t).map(t=>toJSONElement(e,t));return n.includes(r,s)}for(let e=s;e<o;e++)if((null===(i=t.get(e))||void 0===i?void 0:i.getID())===r.getID())return!0;return!1}static indexOf(e,t,r,n){var i;let o=t.length,s=void 0===n?0:n<0?Math.max(n+o,0):n;if(s>=o)return -1;if(Primitive.isSupport(r)){let n=Array.from(t).map(t=>toJSONElement(e,t));return n.indexOf(r,s)}for(let e=s;e<o;e++)if((null===(i=t.get(e))||void 0===i?void 0:i.getID())===r.getID())return e;return -1}static lastIndexOf(e,t,r,n){var i;let o=t.length,s=void 0===n||n>=o?o-1:n<0?n+o:n;if(s<0)return -1;if(Primitive.isSupport(r)){let n=Array.from(t).map(t=>toJSONElement(e,t));return n.lastIndexOf(r,s)}for(let e=s;e>0;e--)if((null===(i=t.get(e))||void 0===i?void 0:i.getID())===r.getID())return e;return -1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}};let Text=class Text{constructor(e,t){this.context=e,this.text=t}initialize(e,t){this.context=e,this.text=t}getID(){return this.text.getID()}edit(e,r,n,i){if(!this.context||!this.text){t.fatal("it is not initialized yet");return}if(e>r){t.fatal("from should be less than or equal to to");return}let o=this.text.indexRangeToPosRange(e,r);t.isEnabled(S.Debug)&&t.debug(`EDIT: f:${e}->${o[0].toTestString()}, t:${r}->${o[1].toTestString()} c:${n}`);let s=i?stringifyObjectValues(i):void 0,a=this.context.issueTimeTicket(),[l,,u]=this.text.edit(o,n,a,s);return this.context.push(new EditOperation(this.text.getCreatedAt(),o[0],o[1],l,n,s?new Map(Object.entries(s)):new Map,a)),o[0].equals(o[1])||this.context.registerElementHasRemovedNodes(this.text),this.text.findIndexesFromRange(u)}delete(e,t){return this.edit(e,t,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,r,n){if(!this.context||!this.text)return t.fatal("it is not initialized yet"),!1;if(e>r)return t.fatal("from should be less than or equal to to"),!1;let i=this.text.indexRangeToPosRange(e,r);t.isEnabled(S.Debug)&&t.debug(`STYL: f:${e}->${i[0].toTestString()}, t:${r}->${i[1].toTestString()} a:${JSON.stringify(n)}`);let o=stringifyObjectValues(n),s=this.context.issueTimeTicket(),[a]=this.text.setStyle(i,o,s);return this.context.push(new StyleOperation(this.text.getCreatedAt(),i[0],i[1],a,new Map(Object.entries(o)),s)),!0}indexRangeToPosRange(e){if(!this.context||!this.text){t.fatal("it is not initialized yet");return}let r=this.text.indexRangeToPosRange(e[0],e[1]);return[r[0].toStruct(),r[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text){t.fatal("it is not initialized yet");return}let r=this.text.findIndexesFromRange([RGATreeSplitPos.fromStruct(e[0]),RGATreeSplitPos.fromStruct(e[1])]);return[r[0],r[1]]}toTestString(){if(!this.context||!this.text){t.fatal("it is not initialized yet");return}return this.text.toTestString()}values(){if(!this.context||!this.text){t.fatal("it is not initialized yet");return}return this.text.values()}get length(){return this.text.length}checkWeight(){return this.text.checkWeight()}toString(){return this.context&&this.text?this.text.toString():(t.fatal("it is not initialized yet"),"")}createRangeForTest(e,r){if(!this.context||!this.text){t.fatal("it is not initialized yet");return}return this.text.indexRangeToPosRange(e,r)}};let Counter=class Counter{constructor(e,t){this.valueType=e,this.value=t}initialize(e,t){this.valueType=t.getValueType(),this.context=e,this.counter=t,this.value=t.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter){t.fatal("it is not initialized yet");return}let r=this.context.issueTimeTicket(),n=Primitive.of(e,r);if(!n.isNumericType())throw TypeError(`Unsupported type of value: ${typeof n.getValue()}`);return this.counter.increase(n),this.context.push(IncreaseOperation.create(this.counter.getCreatedAt(),n,r)),this}};function buildDescendants(e,t,r){let{type:n}=e,i=r.issueTimeTicket();if(n===em){validateTextNode(e);let{value:r}=e,o=CRDTTreeNode.create(CRDTTreeNodeID.of(i,0),n,r);t.append(o)}else{let o;let{children:s=[]}=e,{attributes:a}=e;if("object"==typeof a&&!isEmpty(a))for(let[e,t]of(a=stringifyObjectValues(a),o=new RHT,Object.entries(a)))o.set(e,t,i);let l=CRDTTreeNode.create(CRDTTreeNodeID.of(i,0),n,void 0,o);for(let e of(t.append(l),s))buildDescendants(e,l,r)}}function validateTextNode(e){if(!e.value.length)throw Error("text node cannot have empty value");return!0}function validateTreeNodes(e){if(!e.length)return!0;let t=e[0].type;if(t===em)for(let t of e){let{type:e}=t;if(e!==em)throw Error("element node and text node cannot be passed together");validateTextNode(t)}else for(let t of e){let{type:e}=t;if(e===em)throw Error("element node and text node cannot be passed together")}return!0}let Tree=class Tree{constructor(e){this.initialRoot=e}initialize(e,t){this.context=e,this.tree=t}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return CRDTTreeNode.create(CRDTTreeNodeID.of(e.issueTimeTicket(),0),"root");let t=CRDTTreeNode.create(CRDTTreeNodeID.of(e.issueTimeTicket(),0),this.initialRoot.type);for(let r of this.initialRoot.children)buildDescendants(r,t,e);return t}getSize(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.getSize()}getIndexTree(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.getIndexTree()}styleByPath(e,t){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(!e.length)throw Error("path should not be empty");let[r,n]=this.tree.pathToPosRange(e),i=this.context.issueTimeTicket(),o=t?stringifyObjectValues(t):void 0;this.tree.style([r,n],o,i),this.context.push(TreeStyleOperation.create(this.tree.getCreatedAt(),r,n,o?new Map(Object.entries(o)):new Map,i))}style(e,t,r){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e>t)throw Error("from should be less than or equal to to");let n=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),s=r?stringifyObjectValues(r):void 0;this.tree.style([n,i],s,o),this.context.push(TreeStyleOperation.create(this.tree.getCreatedAt(),n,i,s?new Map(Object.entries(s)):new Map,o))}editInternal(e,t,r,n=0){var i;if(0!==r.length&&r[0]&&(validateTreeNodes(r),r[0].type!==em))for(let e of r){let{children:t=[]}=e;validateTreeNodes(t)}let o=this.context.getLastTimeTicket(),s=[];if((null===(i=r[0])||void 0===i?void 0:i.type)===em){let e="";for(let t of r){let{value:r}=t;e+=r}s.push(CRDTTreeNode.create(CRDTTreeNodeID.of(this.context.issueTimeTicket(),0),em,e))}else s=r.map(e=>e&&function(e,t){let r;let{type:n}=t,i=e.issueTimeTicket();if(t.type===em){let{value:e}=t;r=CRDTTreeNode.create(CRDTTreeNodeID.of(i,0),n,e)}else if(t){let o;let{children:s=[]}=t,{attributes:a}=t;if("object"==typeof a&&!isEmpty(a))for(let[e,t]of(a=stringifyObjectValues(a),o=new RHT,Object.entries(a)))o.set(e,t,i);for(let t of(r=CRDTTreeNode.create(CRDTTreeNodeID.of(e.issueTimeTicket(),0),n,void 0,o),s))buildDescendants(t,r,e)}return r}(this.context,e)).filter(e=>e);let[,a]=this.tree.edit([e,t],s.length?s.map(e=>null==e?void 0:e.deepcopy()):void 0,n,o,()=>this.context.issueTimeTicket());return this.context.push(TreeEditOperation.create(this.tree.getCreatedAt(),e,t,s.length?s:void 0,n,a,o)),e.equals(t)||this.context.registerElementHasRemovedNodes(this.tree),!0}editByPath(e,t,r,n=0){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e.length!==t.length)throw Error("path length should be equal");if(!e.length||!t.length)throw Error("path should not be empty");let i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,r?[r]:[],n)}editBulkByPath(e,t,r,n=0){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e.length!==t.length)throw Error("path length should be equal");if(!e.length||!t.length)throw Error("path should not be empty");let i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,r,n)}edit(e,t,r,n=0){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e>t)throw Error("from should be less than or equal to to");let i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,r?[r]:[],n)}editBulk(e,t,r,n=0){if(!this.context||!this.tree)throw Error("it is not initialized yet");if(e>t)throw Error("from should be less than or equal to to");let i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,r,n)}toXML(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.toJSON()}toJSInfoForTest(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw Error("it is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree){t.fatal("it is not initialized yet");return}let r=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],n=this.tree.indexRangeToPosRange(r);return[n[0].toStruct(),n[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree){t.fatal("it is not initialized yet");return}return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree){t.fatal("it is not initialized yet");return}let r=[CRDTTreePos.fromStruct(e[0]),CRDTTreePos.fromStruct(e[1])];return this.tree.posRangeToIndexRange(r,this.context.getLastTimeTicket())}posRangeToPathRange(e){if(!this.context||!this.tree){t.fatal("it is not initialized yet");return}let r=[CRDTTreePos.fromStruct(e[0]),CRDTTreePos.fromStruct(e[1])];return this.tree.posRangeToPathRange(r,this.context.getLastTimeTicket())}};function toWrappedElement(e,t){if(t){if(t instanceof Primitive)return t;if(t instanceof CRDTObject)return createJSONObject(e,t);if(t instanceof CRDTArray)return function(e,t){let r=new ArrayProxy(e,t);return new Proxy(t,r.getHandlers())}(e,t);if(t instanceof CRDTText)return new Text(e,t);if(t instanceof CRDTCounter){let r=new Counter(A.IntegerCnt,0);return r.initialize(e,t),r}else if(t instanceof CRDTTree){let r=new Tree;return r.initialize(e,t),r}throw TypeError(`Unsupported type of element: ${typeof t}`)}}function toJSONElement(e,t){let r=toWrappedElement(e,t);return r instanceof Primitive?r.getValue():r}function buildCRDTElement(e,t,r){let n;if(Primitive.isSupport(t))n=Primitive.of(t,r);else if(Array.isArray(t))n=CRDTArray.create(r,ArrayProxy.buildArrayElements(e,t));else if("object"==typeof t)t instanceof Text?(n=CRDTText.create(RGATreeSplit.create(),r),t.initialize(e,n)):t instanceof Counter?(n=CRDTCounter.create(t.getValueType(),t.getValue(),r),t.initialize(e,n)):t instanceof Tree?(n=CRDTTree.create(t.buildRoot(e),r),t.initialize(e,n)):n=CRDTObject.create(r,ObjectProxy.buildObjectMembers(e,t));else throw TypeError(`Unsupported type of value: ${typeof t}`);return n}let History=class History{constructor(){this.undoStack=[],this.redoStack=[]}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=50&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=50&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}};let ey="yorkie-devtools-panel",ev="yorkie-devtools-sdk";(h=_||(_={})).Detached="detached",h.Attached="attached",h.Removed="removed",(m=P||(P={})).Snapshot="snapshot",m.LocalChange="local-change",m.RemoteChange="remote-change",m.Initialized="initialized",m.Watched="watched",m.Unwatched="unwatched",m.PresenceChanged="presence-changed";let Document=class Document{constructor(e,t){this.opts=t||{},this.key=e,this.status=_.Detached,this.root=CRDTRoot.create(),this.changeID=ef,this.checkpoint=ep,this.localChanges=[],this.eventStream=createObservable(e=>{this.eventStreamObserver=e}),this.onlineClients=new Set,this.presences=new Map,this.isUpdating=!1,this.internalHistory=new History,this.history={canUndo:this.canUndo.bind(this),canRedo:this.canRedo.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this)}}update(e,r){if(this.getStatus()===_.Removed)throw new YorkieError(w.DocumentRemoved,`${this.key} is removed`);this.ensureClone();let n=this.changeID.getActorID(),i=ChangeContext.create(this.changeID.next(),this.clone.root,this.clone.presences.get(n)||{},r);try{var o;let t=(o=this.clone.root.getObject(),createJSONObject(i,o));this.presences.has(n)||this.clone.presences.set(n,{}),this.isUpdating=!0,e(t,new Presence(i,this.clone.presences.get(n)))}catch(e){throw this.clone=void 0,t.error(e),e}finally{this.isUpdating=!1}if(i.hasChange()){t.isEnabled(S.Trivial)&&t.trivial(`trying to update a local change: ${this.toJSON()}`);let e=i.getChange(),{opInfos:r,reverseOps:o}=e.execute(this.root,this.presences,b.Local),s=i.getReversePresence();s&&o.push({type:"presence",value:s}),this.localChanges.push(e),o.length>0&&this.internalHistory.pushUndo(o),r.length>0&&this.internalHistory.clearRedo(),this.changeID=e.getID(),r.length>0&&this.publish({type:P.LocalChange,value:{message:e.getMessage()||"",operations:r,actor:n}}),e.hasPresenceChange()&&this.publish({type:P.PresenceChanged,value:{clientID:n,presence:this.getPresence(n)}}),t.isEnabled(S.Trivial)&&t.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(e,t,r,n){if("string"==typeof e){if("function"!=typeof t)throw Error("Second argument must be a callback function");return"presence"===e?this.eventStream.subscribe(e=>{(e.type===P.Initialized||e.type===P.Watched||e.type===P.Unwatched||e.type===P.PresenceChanged)&&t(e)},r,n):"my-presence"===e?this.eventStream.subscribe(e=>{(e.type===P.Initialized||e.type===P.Watched||e.type===P.Unwatched||e.type===P.PresenceChanged)&&(e.type===P.Initialized||e.value.clientID===this.changeID.getActorID())&&t(e)},r,n):"others"===e?this.eventStream.subscribe(e=>{(e.type===P.Watched||e.type===P.Unwatched||e.type===P.PresenceChanged)&&e.value.clientID!==this.changeID.getActorID()&&t(e)},r,n):this.eventStream.subscribe(r=>{if(r.type===P.Initialized||r.type===P.Watched||r.type===P.Unwatched||r.type===P.PresenceChanged)return;if(r.type===P.Snapshot){"$"===e&&t(r);return}let{message:n,operations:i,actor:o}=r.value,s=[];for(let t of i)this.isSameElementOrChildOf(t.path,e)&&s.push(t);s.length&&t({type:r.type,value:{message:n,operations:s,actor:o}})},r,n)}if("function"==typeof e)return this.eventStream.subscribe(t=>{t.type!==P.Initialized&&t.type!==P.Watched&&t.type!==P.Unwatched&&t.type!==P.PresenceChanged&&e(t)},t,r);throw Error(`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}isSameElementOrChildOf(e,t){if(t===e)return!0;let r=e.split("."),n=t.split(".");return n.every((e,t)=>e===r[t])}applyChangePack(e){for(e.hasSnapshot()?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getSnapshot()):e.hasChanges()&&this.applyChanges(e.getChanges());this.localChanges.length;){let t=this.localChanges[0];if(t.getID().getClientSeq()>e.getCheckpoint().getClientSeq())break;this.localChanges.shift()}this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),this.garbageCollect(e.getMinSyncedTicket()),e.getIsRemoved()&&this.setStatus(_.Removed),t.isEnabled(S.Trivial)&&t.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:deepcopy(this.presences)})}createChangePack(){let e=Array.from(this.localChanges),t=this.checkpoint.increaseClientSeq(e.length);return ChangePack.create(this.key,t,!1,e)}setActor(e){for(let t of this.localChanges)t.setActor(e);this.changeID=this.changeID.setActor(e)}getKey(){return this.key}setStatus(e){this.status=e}getStatus(){return this.status}getCloneRoot(){if(this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();let e=ChangeContext.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return createJSONObject(e,this.clone.root.getObject())}getOpsForTest(){return this.root.opsForTest}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(e,t){let{root:r,presences:n}=eT.bytesToSnapshot(t);this.root=new CRDTRoot(r),this.presences=n,this.changeID=this.changeID.syncLamport(e),this.clone=void 0,this.publish({type:P.Snapshot,value:t})}applyChanges(e){for(let r of(t.isEnabled(S.Debug)&&t.debug(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getRemovedElementSetSize()}`),t.isEnabled(S.Trivial)&&t.trivial(e.map(e=>`${e.getID().toTestString()}	${e.toTestString()}`).join("\n")),this.ensureClone(),e)){let e;r.execute(this.clone.root,this.clone.presences,b.Remote);let t=r.getID().getActorID();if(r.hasPresenceChange()&&this.onlineClients.has(t)){let n=r.getPresenceChange();switch(n.type){case N.Put:e={type:this.presences.has(t)?P.PresenceChanged:P.Watched,value:{clientID:t,presence:n.presence}};break;case N.Clear:e={type:P.Unwatched,value:{clientID:t,presence:this.getPresence(t)}},this.removeOnlineClient(t)}}let{opInfos:n}=r.execute(this.root,this.presences,b.Remote);n.length>0&&this.publish({type:P.RemoteChange,value:{actor:t,message:r.getMessage()||"",operations:n}}),e&&this.publish(e),this.changeID=this.changeID.syncLamport(r.getID().getLamport())}t.isEnabled(S.Debug)&&t.debug(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getRemovedElementSetSize()}`)}getValueByPath(e){if(!e.startsWith("$"))throw new YorkieError(w.InvalidArgument,'path must start with "$"');let t=e.split(".");t.shift();let r=this.getRoot();for(let e of t)if(void 0===(r=r[e]))return;return r}setOnlineClients(e){this.onlineClients=e}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if(this.status!==_.Attached)return{};let e=this.presences.get(this.changeID.getActorID());return deepcopy(e)}getPresence(e){if(!this.onlineClients.has(e))return;let t=this.presences.get(e);return t?deepcopy(t):void 0}getPresenceForTest(e){let t=this.presences.get(e);return t?deepcopy(t):void 0}getPresences(){let e=[];for(let t of this.onlineClients)this.presences.has(t)&&e.push({clientID:t,presence:deepcopy(this.presences.get(t))});return e}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){let e=this.getChangeID().getActorID();return this.getPresences().filter(t=>t.clientID!==e).sort((e,t)=>e.clientID>t.clientID?1:-1)}canUndo(){return this.internalHistory.hasUndo()&&!this.isUpdating}canRedo(){return this.internalHistory.hasRedo()&&!this.isUpdating}undo(){if(this.isUpdating)throw Error("Undo is not allowed during an update");let e=this.internalHistory.popUndo();if(void 0===e)throw Error("There is no operation to be undone");this.ensureClone();let t=ChangeContext.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(let r of e){if(!(r instanceof Operation)){let e=new Presence(t,deepcopy(this.clone.presences.get(this.changeID.getActorID())));e.set(r.value,{addToHistory:!0});continue}let e=t.issueTimeTicket();r.setExecutedAt(e),t.push(r)}let r=t.getChange();r.execute(this.clone.root,this.clone.presences,b.UndoRedo);let{opInfos:n,reverseOps:i}=r.execute(this.root,this.presences,b.UndoRedo),o=t.getReversePresence();if(o&&i.push({type:"presence",value:o}),i.length>0&&this.internalHistory.pushRedo(i),!r.hasPresenceChange()&&0===n.length)return;this.localChanges.push(r),this.changeID=r.getID();let s=this.changeID.getActorID();n.length>0&&this.publish({type:P.LocalChange,value:{message:r.getMessage()||"",operations:n,actor:s}}),r.hasPresenceChange()&&this.publish({type:P.PresenceChanged,value:{clientID:s,presence:this.getPresence(s)}})}redo(){if(this.isUpdating)throw Error("Redo is not allowed during an update");let e=this.internalHistory.popRedo();if(void 0===e)throw Error("There is no operation to be redone");this.ensureClone();let t=ChangeContext.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(let r of e){if(!(r instanceof Operation)){let e=new Presence(t,deepcopy(this.clone.presences.get(this.changeID.getActorID())));e.set(r.value,{addToHistory:!0});continue}let e=t.issueTimeTicket();r.setExecutedAt(e),t.push(r)}let r=t.getChange();r.execute(this.clone.root,this.clone.presences,b.UndoRedo);let{opInfos:n,reverseOps:i}=r.execute(this.root,this.presences,b.UndoRedo),o=t.getReversePresence();if(o&&i.push({type:"presence",value:o}),i.length>0&&this.internalHistory.pushUndo(i),!r.hasPresenceChange()&&0===n.length)return;this.localChanges.push(r),this.changeID=r.getID();let s=this.changeID.getActorID();n.length>0&&this.publish({type:P.LocalChange,value:{message:r.getMessage()||"",operations:n,actor:s}}),r.hasPresenceChange()&&this.publish({type:P.PresenceChanged,value:{clientID:s,presence:this.getPresence(s)}})}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}};let eS=JSON.parse('{"u2":"yorkie-js-sdk","i8":"0.4.13"}');(f=C||(C={})).PushPull="pushpull",f.PushOnly="pushonly",(p=R||(R={})).Deactivated="deactivated",p.Activated="activated",(g=x||(x={})).Connected="connected",g.Disconnected="disconnected",(T=F||(F={})).Synced="synced",T.SyncFailed="sync-failed",(y=L||(L={})).StatusChanged="status-changed",y.DocumentChanged="document-changed",y.StreamConnectionStatusChanged="stream-connection-status-changed",y.DocumentSynced="document-synced";let eE={syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3};let Client=class Client{constructor(e,t){var r,n,i,o;t=t||eE,this.key=t.key?t.key:uuid(),this.status=R.Deactivated,this.attachmentMap=new Map,this.apiKey=t.apiKey||"",this.syncLoopDuration=t.syncLoopDuration||eE.syncLoopDuration,this.reconnectStreamDelay=t.reconnectStreamDelay||eE.reconnectStreamDelay,this.retrySyncLoopDelay=t.retrySyncLoopDelay||eE.retrySyncLoopDelay,this.rpcClient=(i=q.V,o=function(e){var t;!function(){try{new Headers}catch(e){throw Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}();let r=null===(t=e.useBinaryFormat)||void 0===t||t;return{async unary(t,n,i,o,s,a,l){var u;let{serialize:d,parse:c}=createClientMethodSerializers(n,r,e.jsonOptions,e.binaryOptions);return o=void 0===o?e.defaultTimeoutMs:o<=0?void 0:o,await function(e){let t=applyInterceptors(e.next,e.interceptors),[r,n,i]=setupSignal(e),o=Object.assign(Object.assign({},e.req),{message:normalize(e.req.method.I,e.req.message),signal:r});return t(o).then(e=>(i(),e),n)}({interceptors:e.interceptors,signal:i,timeoutMs:o,req:{stream:!1,service:t,method:n,url:createMethodUrl(e.baseUrl,t,n),init:{method:"POST",credentials:null!==(u=e.credentials)&&void 0!==u?u:"same-origin",redirect:"error",mode:"cors"},header:requestHeader(r,o,s,!1),contextValues:null!=l?l:createContextValues(),message:a},next:async t=>{var r;let n,i;let o=null!==(r=e.fetch)&&void 0!==r?r:globalThis.fetch,s=await o(t.url,Object.assign(Object.assign({},t.init),{headers:t.header,signal:t.signal,body:envelope_encodeEnvelope(0,d(t.message))}));if(validateResponse(s.status,s.headers),!s.body)throw"missing response body";let a=createEnvelopeReadableStream(s.body).getReader();for(;;){let e=await a.read();if(e.done)break;let{flags:t,data:r}=e.value;if(128===t){if(void 0!==n)throw"extra trailer";n=trailerParse(r);continue}if(void 0!==i)throw"extra message";i=c(r)}if(void 0===n)throw"missing trailer";if(validateTrailer(n,s.headers),void 0===i)throw"missing message";return{stream:!1,header:s.headers,message:i,trailer:n}}})},async stream(t,n,i,o,s,a,l){var u;let{serialize:d,parse:c}=createClientMethodSerializers(n,r,e.jsonOptions,e.binaryOptions);async function createRequestBody(e){if(n.kind!=B.t.ServerStreaming)throw"The fetch API does not support streaming request bodies";let t=await e[Symbol.asyncIterator]().next();if(!0==t.done)throw"missing request message";return envelope_encodeEnvelope(0,d(t.value))}return o=void 0===o?e.defaultTimeoutMs:o<=0?void 0:o,function(e){let t=applyInterceptors(e.next,e.interceptors),[r,n,i]=setupSignal(e),o=Object.assign(Object.assign({},e.req),{message:function(e,t){function transform(t){return!0===t.done?t:{done:t.done,value:normalize(e,t.value)}}return{[Symbol.asyncIterator](){let e=t[Symbol.asyncIterator](),r={next:()=>e.next().then(transform)};return void 0!==e.throw&&(r.throw=t=>e.throw(t).then(transform)),void 0!==e.return&&(r.return=t=>e.return(t).then(transform)),r}}}(e.req.method.I,e.req.message),signal:r}),s=!1;return r.addEventListener("abort",function(){var t,r;let n=e.req.message[Symbol.asyncIterator]();s||null===(t=n.throw)||void 0===t||t.call(n,this.reason).catch(()=>{}),null===(r=n.return)||void 0===r||r.call(n).catch(()=>{})}),t(o).then(e=>Object.assign(Object.assign({},e),{message:{[Symbol.asyncIterator](){let t=e.message[Symbol.asyncIterator]();return{next:()=>t.next().then(e=>(!0==e.done&&(s=!0,i()),e),n)}}}}),n)}({interceptors:e.interceptors,signal:i,timeoutMs:o,req:{stream:!0,service:t,method:n,url:createMethodUrl(e.baseUrl,t,n),init:{method:"POST",credentials:null!==(u=e.credentials)&&void 0!==u?u:"same-origin",redirect:"error",mode:"cors"},header:requestHeader(r,o,s,!1),contextValues:null!=l?l:createContextValues(),message:a},next:async t=>{var r;let n=null!==(r=e.fetch)&&void 0!==r?r:globalThis.fetch,i=await n(t.url,Object.assign(Object.assign({},t.init),{headers:t.header,signal:t.signal,body:await createRequestBody(t.message)})),{foundStatus:o}=validateResponse(i.status,i.headers);if(!i.body)throw"missing response body";let s=new Headers,a=Object.assign(Object.assign({},t),{header:i.headers,trailer:s,message:function(e,t,r,n){return grpc_web_transport_asyncGenerator(this,arguments,function*(){let i=createEnvelopeReadableStream(e).getReader();if(t){if(!(yield grpc_web_transport_await(i.read())).done)throw"extra data for trailers-only";return yield grpc_web_transport_await(void 0)}let o=!1;for(;;){let e=yield grpc_web_transport_await(i.read());if(e.done)break;let{flags:t,data:s}=e.value;if((128&t)==128){if(o)throw"extra trailer";o=!0;let e=trailerParse(s);validateTrailer(e,n),e.forEach((e,t)=>r.set(t,e));continue}if(o)throw"extra message";yield yield grpc_web_transport_await(c(s))}if(!o)throw"missing trailer"})}(i.body,o,s,i.headers)});return a}})}}}({baseUrl:e,interceptors:[(r=t.apiKey,n=t.token,e=>async t=>(r&&t.header.set("x-api-key",r),n&&t.header.set("authorization",n),await e(t))),e=>async t=>(t.header.set("x-yorkie-user-agent",eS.u2+"/"+eS.i8),await e(t))]}),function(e,t){let r={};for(let[n,i]of Object.entries(e.methods)){let o=t(Object.assign(Object.assign({},i),{localName:n,service:e}));null!=o&&(r[n]=o)}return r}(i,e=>{switch(e.kind){case B.t.Unary:return async function(t,r){var n,s;let a=await o.unary(i,e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,t,null==r?void 0:r.contextValues);return null===(n=null==r?void 0:r.onHeader)||void 0===n||n.call(r,a.header),null===(s=null==r?void 0:r.onTrailer)||void 0===s||s.call(r,a.trailer),a.message};case B.t.ServerStreaming:return function(t,r){return handleStreamResponse(o.stream(i,e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,function(e){return __asyncGenerator(this,arguments,function*(){yield __await((yield*__asyncDelegator(__asyncValues(e))))})}([t]),null==r?void 0:r.contextValues),r)};case B.t.ClientStreaming:return async function(t,r){let n;let s=await o.stream(i,e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,t,null==r?void 0:r.contextValues);null===(c=null==r?void 0:r.onHeader)||void 0===c||c.call(r,s.header);try{for(var a,l,u,d,c,h,m,f=!0,p=promise_client_asyncValues(s.message);!(a=(m=await p.next()).done);f=!0)d=m.value,f=!1,n=d}catch(e){l={error:e}}finally{try{!f&&!a&&(u=p.return)&&await u.call(p)}finally{if(l)throw l.error}}if(!n)throw new connect_error_ConnectError("protocol error: missing response message",E.Internal);return null===(h=null==r?void 0:r.onTrailer)||void 0===h||h.call(r,s.trailer),n};case B.t.BiDiStreaming:return function(t,r){return handleStreamResponse(o.stream(i,e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,t,null==r?void 0:r.contextValues),r)};default:return null}})),this.eventStream=createObservable(e=>{this.eventStreamObserver=e})}activate(){return this.isActive()?Promise.resolve():this.rpcClient.activateClient({clientKey:this.key},{headers:{"x-shard-key":this.apiKey}}).then(e=>{this.id=e.clientId,this.status=R.Activated,this.runSyncLoop(),this.eventStreamObserver.next({type:L.StatusChanged,value:this.status}),t.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`)}).catch(e=>{throw t.error(`[AC] c:"${this.getKey()}" err :`,e),e})}deactivate(){if(this.status===R.Deactivated)return Promise.resolve();for(let[e]of this.attachmentMap)this.detachInternal(e);return this.rpcClient.deactivateClient({clientKey:this.key,clientId:this.id},{headers:{"x-shard-key":this.apiKey}}).then(()=>{this.status=R.Deactivated,this.eventStreamObserver.next({type:L.StatusChanged,value:this.status}),t.info(`[DC] c"${this.getKey()}" deactivated`)}).catch(e=>{throw t.error(`[DC] c:"${this.getKey()}" err :`,e),e})}attach(e,r={}){var n;if(!this.isActive())throw new YorkieError(w.ClientNotActive,`${this.key} is not active`);if(e.getStatus()!==_.Detached)throw new YorkieError(w.DocumentNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((e,t)=>t.set(r.initialPresence||{}));let i=null===(n=r.isRealtimeSync)||void 0===n||n;return this.rpcClient.attachDocument({clientKey:this.key,clientId:this.id,changePack:eT.toChangePack(e.createChangePack())},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(async r=>{let n=eT.fromChangePack(r.changePack);return e.applyChangePack(n),e.getStatus()===_.Removed||(e.setStatus(_.Attached),this.attachmentMap.set(e.getKey(),new Attachment(this.reconnectStreamDelay,e,r.documentId,i)),i&&await this.runWatchLoop(e.getKey()),t.info(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`)),e}).catch(e=>{throw t.error(`[AD] c:"${this.getKey()}" err :`,e),e})}detach(e,r={}){var n;if(!this.isActive())throw new YorkieError(w.ClientNotActive,`${this.key} is not active`);let i=this.attachmentMap.get(e.getKey());if(!i)throw new YorkieError(w.DocumentNotAttached,`${e.getKey()} is not attached`);return e.update((e,t)=>t.clear()),this.rpcClient.detachDocument({clientKey:this.key,clientId:this.id,documentId:i.docID,changePack:eT.toChangePack(e.createChangePack()),removeIfNotAttached:null!==(n=r.removeIfNotAttached)&&void 0!==n&&n},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(r=>{let n=eT.fromChangePack(r.changePack);return e.applyChangePack(n),e.getStatus()!==_.Removed&&e.setStatus(_.Detached),this.detachInternal(e.getKey()),t.info(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}).catch(e=>{throw t.error(`[DD] c:"${this.getKey()}" err :`,e),e})}pause(e){if(!this.isActive())throw new YorkieError(w.ClientNotActive,`${this.key} is not active`);return this.changeRealtimeSync(e,!1)}resume(e){if(!this.isActive())throw new YorkieError(w.ClientNotActive,`${this.key} is not active`);return this.changeRealtimeSync(e,!0)}pauseRemoteChanges(e){if(!this.isActive())throw new YorkieError(w.ClientNotActive,`${this.key} is not active`);let t=this.attachmentMap.get(e.getKey());if(!t)throw new YorkieError(w.DocumentNotAttached,`${e.getKey()} is not attached`);t.changeSyncMode(C.PushOnly)}resumeRemoteChanges(e){if(!this.isActive())throw new YorkieError(w.ClientNotActive,`${this.key} is not active`);let t=this.attachmentMap.get(e.getKey());if(!t)throw new YorkieError(w.DocumentNotAttached,`${e.getKey()} is not attached`);t.changeSyncMode(C.PushPull),t.remoteChangeEventReceived=!0}async changeRealtimeSync(e,r){let n=this.attachmentMap.get(e.getKey());if(!n)throw new YorkieError(w.DocumentNotAttached,`${e.getKey()} is not attached`);return n.changeRealtimeSync(r)&&(r?(n.remoteChangeEventReceived=!0,await this.runWatchLoop(e.getKey())):(this.eventStreamObserver.next({type:L.StreamConnectionStatusChanged,value:x.Disconnected}),t.debug(`[WD] c:"${this.getKey()}" unwatches`))),e}sync(e,t=C.PushPull){if(!this.isActive())throw new YorkieError(w.ClientNotActive,`${this.key} is not active`);let r=[];if(e){let n=this.attachmentMap.get(e.getKey());if(!n)throw new YorkieError(w.DocumentNotAttached,`${e.getKey()} is not attached`);r.push(this.syncInternal(n,t))}else this.attachmentMap.forEach(e=>{r.push(this.syncInternal(e,e.syncMode))});return Promise.all(r).catch(e=>{throw this.eventStreamObserver.next({type:L.DocumentSynced,value:F.SyncFailed}),e})}remove(e){if(!this.isActive())throw new YorkieError(w.ClientNotActive,`${this.key} is not active`);let r=this.attachmentMap.get(e.getKey());if(!r)throw new YorkieError(w.DocumentNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);let n=eT.toChangePack(e.createChangePack());return n.isRemoved=!0,this.rpcClient.removeDocument({clientKey:this.key,clientId:this.id,documentId:r.docID,changePack:n},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(r=>{let n=eT.fromChangePack(r.changePack);e.applyChangePack(n),this.detachInternal(e.getKey()),t.info(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}).catch(e=>{throw t.error(`[RD] c:"${this.getKey()}" err :`,e),e})}subscribe(e,t,r){return this.eventStream.subscribe(e,t,r)}getID(){return this.id}getKey(){return this.key}isActive(){return this.status===R.Activated}getStatus(){return this.status}runSyncLoop(){let doLoop=()=>{if(!this.isActive()){t.debug(`[SL] c:"${this.getKey()}" exit sync loop`);return}let e=[];for(let[,t]of this.attachmentMap)t.needRealtimeSync()&&(t.remoteChangeEventReceived=!1,e.push(this.syncInternal(t,t.syncMode)));Promise.all(e).then(()=>setTimeout(doLoop,this.syncLoopDuration)).catch(e=>{t.error(`[SL] c:"${this.getKey()}" sync failed:`,e),this.eventStreamObserver.next({type:L.DocumentSynced,value:F.SyncFailed}),setTimeout(doLoop,this.retrySyncLoopDelay)})};t.debug(`[SL] c:"${this.getKey()}" run sync loop`),doLoop()}async runWatchLoop(e){let r=this.attachmentMap.get(e);if(!r)throw new YorkieError(w.DocumentNotAttached,`${e} is not attached`);return r.runWatchLoop(n=>{if(!this.isActive())return Promise.reject(new YorkieError(w.ClientNotActive,`${this.key} is not active`));let i=new AbortController,o=this.rpcClient.watchDocument({clientKey:this.key,clientId:this.id,documentKey:e,documentId:r.docID},{headers:{"x-shard-key":`${this.apiKey}/${e}`},signal:i.signal});return this.eventStreamObserver.next({type:L.StreamConnectionStatusChanged,value:x.Connected}),t.info(`[WD] c:"${this.getKey()}" watches d:"${e}"`),new Promise((e,s)=>{let handleStream=async()=>{try{for await(let t of o)this.handleWatchDocumentsResponse(r,t),"initialization"===t.body.case&&e([o,i])}catch(e){this.eventStreamObserver.next({type:L.StreamConnectionStatusChanged,value:x.Disconnected}),t.debug(`[WD] c:"${this.getKey()}" unwatches`),n(),s(e)}};handleStream()})})}handleWatchDocumentsResponse(e,t){let r=e.doc.getKey();if("initialization"===t.body.case){let r=t.body.value.clientIds,n=new Set;for(let e of r)n.add(e);e.doc.setOnlineClients(n),e.doc.publish({type:P.Initialized,value:e.doc.getPresences()});return}if("event"===t.body.case){let n=t.body.value,i=n.type,o=n.publisher;switch(i){case G.DocEventType.DOCUMENT_CHANGED:e.remoteChangeEventReceived=!0,this.eventStreamObserver.next({type:L.DocumentChanged,value:[r]});break;case G.DocEventType.DOCUMENT_WATCHED:e.doc.addOnlineClient(o),e.doc.hasPresence(o)&&e.doc.publish({type:P.Watched,value:{clientID:o,presence:e.doc.getPresence(o)}});break;case G.DocEventType.DOCUMENT_UNWATCHED:{let t=e.doc.getPresence(o);e.doc.removeOnlineClient(o),t&&e.doc.publish({type:P.Unwatched,value:{clientID:o,presence:t}})}}}}detachInternal(e){let r=this.attachmentMap.get(e);r&&(r.cancelWatchStream(),t.debug(`[WD] c:"${this.getKey()}" unwatches`),this.eventStreamObserver.next({type:L.StreamConnectionStatusChanged,value:x.Disconnected}),this.attachmentMap.delete(e))}syncInternal(e,r){let{doc:n,docID:i}=e,o=n.createChangePack();return this.rpcClient.pushPullChanges({clientKey:this.key,clientId:this.id,documentId:i,changePack:eT.toChangePack(o),pushOnly:r===C.PushOnly},{headers:{"x-shard-key":`${this.apiKey}/${n.getKey()}`}}).then(e=>{let i=eT.fromChangePack(e.changePack);if(i.hasChanges()&&r===C.PushOnly)return n;n.applyChangePack(i),this.eventStreamObserver.next({type:L.DocumentSynced,value:F.Synced}),n.getStatus()===_.Removed&&this.detachInternal(n.getKey());let s=n.getKey(),a=i.getChangeSize();return t.info(`[PP] c:"${this.getKey()}" sync d:"${s}", push:${o.getChangeSize()} pull:${a} cp:${i.getCheckpoint().toTestString()}`),n}).catch(e=>{throw t.error(`[PP] c:"${this.getKey()}" err :`,e),e})}};let ew={Client:Client,Document:Document,Primitive:Primitive,Text:Text,Counter:Counter,Tree:Tree,IntType:A.IntegerCnt,LongType:A.LongCnt},eN=ew})(),r})()}}]);