(function(){const Dt=document.createElement("link").relList;if(Dt&&Dt.supports&&Dt.supports("modulepreload"))return;for(const we of document.querySelectorAll('link[rel="modulepreload"]'))Ct(we);new MutationObserver(we=>{for(const Ge of we)if(Ge.type==="childList")for(const ce of Ge.addedNodes)ce.tagName==="LINK"&&ce.rel==="modulepreload"&&Ct(ce)}).observe(document,{childList:!0,subtree:!0});function zt(we){const Ge={};return we.integrity&&(Ge.integrity=we.integrity),we.referrerpolicy&&(Ge.referrerPolicy=we.referrerpolicy),we.crossorigin==="use-credentials"?Ge.credentials="include":we.crossorigin==="anonymous"?Ge.credentials="omit":Ge.credentials="same-origin",Ge}function Ct(we){if(we.ep)return;we.ep=!0;const Ge=zt(we);fetch(we.href,Ge)}})();var Ni=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bi(Je){return Je&&Je.__esModule&&Object.prototype.hasOwnProperty.call(Je,"default")?Je.default:Je}var Yr={exports:{}};/*!
 * 
 * yorkie-js-sdk for building collaborative editing applications.
 *  - Version: v0.4.18
 *  - Date: 2024-04-23T11:39Z
 *  - Homepage: https://yorkie.dev
 *
 * Copyright 2020 The Yorkie Authors. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */(function(Je,Dt){(function(Ct,we){Je.exports=we()})(Ni,()=>(()=>{var zt={646:(ce,A,D)=>{Object.defineProperty(A,"__esModule",{value:!0});const{proto3:l,StringValue:g,Timestamp:m}=D(532),x=l.makeEnum("yorkie.v1.ValueType",[{no:0,name:"VALUE_TYPE_NULL",localName:"NULL"},{no:1,name:"VALUE_TYPE_BOOLEAN",localName:"BOOLEAN"},{no:2,name:"VALUE_TYPE_INTEGER",localName:"INTEGER"},{no:3,name:"VALUE_TYPE_LONG",localName:"LONG"},{no:4,name:"VALUE_TYPE_DOUBLE",localName:"DOUBLE"},{no:5,name:"VALUE_TYPE_STRING",localName:"STRING"},{no:6,name:"VALUE_TYPE_BYTES",localName:"BYTES"},{no:7,name:"VALUE_TYPE_DATE",localName:"DATE"},{no:8,name:"VALUE_TYPE_JSON_OBJECT",localName:"JSON_OBJECT"},{no:9,name:"VALUE_TYPE_JSON_ARRAY",localName:"JSON_ARRAY"},{no:10,name:"VALUE_TYPE_TEXT",localName:"TEXT"},{no:11,name:"VALUE_TYPE_INTEGER_CNT",localName:"INTEGER_CNT"},{no:12,name:"VALUE_TYPE_LONG_CNT",localName:"LONG_CNT"},{no:13,name:"VALUE_TYPE_TREE",localName:"TREE"}]),b=l.makeEnum("yorkie.v1.DocEventType",[{no:0,name:"DOC_EVENT_TYPE_DOCUMENT_CHANGED",localName:"DOCUMENT_CHANGED"},{no:1,name:"DOC_EVENT_TYPE_DOCUMENT_WATCHED",localName:"DOCUMENT_WATCHED"},{no:2,name:"DOC_EVENT_TYPE_DOCUMENT_UNWATCHED",localName:"DOCUMENT_UNWATCHED"},{no:3,name:"DOC_EVENT_TYPE_DOCUMENT_BROADCAST",localName:"DOCUMENT_BROADCAST"}]),_=l.makeMessageType("yorkie.v1.Snapshot",()=>[{no:1,name:"root",kind:"message",T:V},{no:2,name:"presences",kind:"map",K:9,V:{kind:"message",T:lt}}]),B=l.makeMessageType("yorkie.v1.ChangePack",()=>[{no:1,name:"document_key",kind:"scalar",T:9},{no:2,name:"checkpoint",kind:"message",T:St},{no:3,name:"snapshot",kind:"scalar",T:12},{no:4,name:"changes",kind:"message",T,repeated:!0},{no:5,name:"min_synced_ticket",kind:"message",T:ee},{no:6,name:"is_removed",kind:"scalar",T:8}]),T=l.makeMessageType("yorkie.v1.Change",()=>[{no:1,name:"id",kind:"message",T:y},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"operations",kind:"message",T:C,repeated:!0},{no:4,name:"presence_change",kind:"message",T:ct}]),y=l.makeMessageType("yorkie.v1.ChangeID",()=>[{no:1,name:"client_seq",kind:"scalar",T:13},{no:2,name:"server_seq",kind:"scalar",T:3,L:1},{no:3,name:"lamport",kind:"scalar",T:3,L:1},{no:4,name:"actor_id",kind:"scalar",T:12}]),C=l.makeMessageType("yorkie.v1.Operation",()=>[{no:1,name:"set",kind:"message",T:k,oneof:"body"},{no:2,name:"add",kind:"message",T:L,oneof:"body"},{no:3,name:"move",kind:"message",T:S,oneof:"body"},{no:4,name:"remove",kind:"message",T:f,oneof:"body"},{no:5,name:"edit",kind:"message",T:U,oneof:"body"},{no:6,name:"select",kind:"message",T:R,oneof:"body"},{no:7,name:"style",kind:"message",T:w,oneof:"body"},{no:8,name:"increase",kind:"message",T:$,oneof:"body"},{no:9,name:"tree_edit",kind:"message",T:Y,oneof:"body"},{no:10,name:"tree_style",kind:"message",T:q,oneof:"body"}]),k=l.makeMessageType("yorkie.v1.Operation.Set",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"value",kind:"message",T:O},{no:4,name:"executed_at",kind:"message",T:ee}],{localName:"Operation_Set"}),L=l.makeMessageType("yorkie.v1.Operation.Add",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"prev_created_at",kind:"message",T:ee},{no:3,name:"value",kind:"message",T:O},{no:4,name:"executed_at",kind:"message",T:ee}],{localName:"Operation_Add"}),S=l.makeMessageType("yorkie.v1.Operation.Move",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"prev_created_at",kind:"message",T:ee},{no:3,name:"created_at",kind:"message",T:ee},{no:4,name:"executed_at",kind:"message",T:ee}],{localName:"Operation_Move"}),f=l.makeMessageType("yorkie.v1.Operation.Remove",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"created_at",kind:"message",T:ee},{no:3,name:"executed_at",kind:"message",T:ee}],{localName:"Operation_Remove"}),U=l.makeMessageType("yorkie.v1.Operation.Edit",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"from",kind:"message",T:Xe},{no:3,name:"to",kind:"message",T:Xe},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:ee}},{no:5,name:"content",kind:"scalar",T:9},{no:6,name:"executed_at",kind:"message",T:ee},{no:7,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"Operation_Edit"}),R=l.makeMessageType("yorkie.v1.Operation.Select",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"from",kind:"message",T:Xe},{no:3,name:"to",kind:"message",T:Xe},{no:4,name:"executed_at",kind:"message",T:ee}],{localName:"Operation_Select"}),w=l.makeMessageType("yorkie.v1.Operation.Style",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"from",kind:"message",T:Xe},{no:3,name:"to",kind:"message",T:Xe},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:ee},{no:6,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:ee}}],{localName:"Operation_Style"}),$=l.makeMessageType("yorkie.v1.Operation.Increase",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"value",kind:"message",T:O},{no:3,name:"executed_at",kind:"message",T:ee}],{localName:"Operation_Increase"}),Y=l.makeMessageType("yorkie.v1.Operation.TreeEdit",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"from",kind:"message",T:ut},{no:3,name:"to",kind:"message",T:ut},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:ee}},{no:5,name:"contents",kind:"message",T:ze,repeated:!0},{no:7,name:"split_level",kind:"scalar",T:5},{no:6,name:"executed_at",kind:"message",T:ee}],{localName:"Operation_TreeEdit"}),q=l.makeMessageType("yorkie.v1.Operation.TreeStyle",()=>[{no:1,name:"parent_created_at",kind:"message",T:ee},{no:2,name:"from",kind:"message",T:ut},{no:3,name:"to",kind:"message",T:ut},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:ee},{no:6,name:"attributes_to_remove",kind:"scalar",T:9,repeated:!0}],{localName:"Operation_TreeStyle"}),O=l.makeMessageType("yorkie.v1.JSONElementSimple",()=>[{no:1,name:"created_at",kind:"message",T:ee},{no:2,name:"moved_at",kind:"message",T:ee},{no:3,name:"removed_at",kind:"message",T:ee},{no:4,name:"type",kind:"enum",T:l.getEnumType(x)},{no:5,name:"value",kind:"scalar",T:12}]),V=l.makeMessageType("yorkie.v1.JSONElement",()=>[{no:1,name:"json_object",kind:"message",T:z,oneof:"body"},{no:2,name:"json_array",kind:"message",T:Z,oneof:"body"},{no:3,name:"primitive",kind:"message",T:K,oneof:"body"},{no:5,name:"text",kind:"message",T:te,oneof:"body"},{no:6,name:"counter",kind:"message",T:Ae,oneof:"body"},{no:7,name:"tree",kind:"message",T:W,oneof:"body"}]),z=l.makeMessageType("yorkie.v1.JSONElement.JSONObject",()=>[{no:1,name:"nodes",kind:"message",T:Ee,repeated:!0},{no:2,name:"created_at",kind:"message",T:ee},{no:3,name:"moved_at",kind:"message",T:ee},{no:4,name:"removed_at",kind:"message",T:ee}],{localName:"JSONElement_JSONObject"}),Z=l.makeMessageType("yorkie.v1.JSONElement.JSONArray",()=>[{no:1,name:"nodes",kind:"message",T:ne,repeated:!0},{no:2,name:"created_at",kind:"message",T:ee},{no:3,name:"moved_at",kind:"message",T:ee},{no:4,name:"removed_at",kind:"message",T:ee}],{localName:"JSONElement_JSONArray"}),K=l.makeMessageType("yorkie.v1.JSONElement.Primitive",()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(x)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:ee},{no:4,name:"moved_at",kind:"message",T:ee},{no:5,name:"removed_at",kind:"message",T:ee}],{localName:"JSONElement_Primitive"}),te=l.makeMessageType("yorkie.v1.JSONElement.Text",()=>[{no:1,name:"nodes",kind:"message",T:ke,repeated:!0},{no:2,name:"created_at",kind:"message",T:ee},{no:3,name:"moved_at",kind:"message",T:ee},{no:4,name:"removed_at",kind:"message",T:ee}],{localName:"JSONElement_Text"}),Ae=l.makeMessageType("yorkie.v1.JSONElement.Counter",()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(x)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:ee},{no:4,name:"moved_at",kind:"message",T:ee},{no:5,name:"removed_at",kind:"message",T:ee}],{localName:"JSONElement_Counter"}),W=l.makeMessageType("yorkie.v1.JSONElement.Tree",()=>[{no:1,name:"nodes",kind:"message",T:Le,repeated:!0},{no:2,name:"created_at",kind:"message",T:ee},{no:3,name:"moved_at",kind:"message",T:ee},{no:4,name:"removed_at",kind:"message",T:ee}],{localName:"JSONElement_Tree"}),Ee=l.makeMessageType("yorkie.v1.RHTNode",()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"element",kind:"message",T:V}]),ne=l.makeMessageType("yorkie.v1.RGANode",()=>[{no:1,name:"next",kind:"message",T:ne},{no:2,name:"element",kind:"message",T:V}]),ue=l.makeMessageType("yorkie.v1.NodeAttr",()=>[{no:1,name:"value",kind:"scalar",T:9},{no:2,name:"updated_at",kind:"message",T:ee}]),ke=l.makeMessageType("yorkie.v1.TextNode",()=>[{no:1,name:"id",kind:"message",T:pe},{no:2,name:"value",kind:"scalar",T:9},{no:3,name:"removed_at",kind:"message",T:ee},{no:4,name:"ins_prev_id",kind:"message",T:pe},{no:5,name:"attributes",kind:"map",K:9,V:{kind:"message",T:ue}}]),pe=l.makeMessageType("yorkie.v1.TextNodeID",()=>[{no:1,name:"created_at",kind:"message",T:ee},{no:2,name:"offset",kind:"scalar",T:5}]),Le=l.makeMessageType("yorkie.v1.TreeNode",()=>[{no:1,name:"id",kind:"message",T:Re},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9},{no:4,name:"removed_at",kind:"message",T:ee},{no:5,name:"ins_prev_id",kind:"message",T:Re},{no:6,name:"ins_next_id",kind:"message",T:Re},{no:7,name:"depth",kind:"scalar",T:5},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:ue}}]),ze=l.makeMessageType("yorkie.v1.TreeNodes",()=>[{no:1,name:"content",kind:"message",T:Le,repeated:!0}]),Re=l.makeMessageType("yorkie.v1.TreeNodeID",()=>[{no:1,name:"created_at",kind:"message",T:ee},{no:2,name:"offset",kind:"scalar",T:5}]),ut=l.makeMessageType("yorkie.v1.TreePos",()=>[{no:1,name:"parent_id",kind:"message",T:Re},{no:2,name:"left_sibling_id",kind:"message",T:Re}]),ht=l.makeMessageType("yorkie.v1.User",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"created_at",kind:"message",T:m}]),tt=l.makeMessageType("yorkie.v1.Project",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"public_key",kind:"scalar",T:9},{no:4,name:"secret_key",kind:"scalar",T:9},{no:5,name:"auth_webhook_url",kind:"scalar",T:9},{no:6,name:"auth_webhook_methods",kind:"scalar",T:9,repeated:!0},{no:7,name:"client_deactivate_threshold",kind:"scalar",T:9},{no:8,name:"created_at",kind:"message",T:m},{no:9,name:"updated_at",kind:"message",T:m}]),de=l.makeMessageType("yorkie.v1.UpdatableProjectFields",()=>[{no:1,name:"name",kind:"message",T:g},{no:2,name:"auth_webhook_url",kind:"message",T:g},{no:3,name:"auth_webhook_methods",kind:"message",T:Rt},{no:4,name:"client_deactivate_threshold",kind:"message",T:g}]),Rt=l.makeMessageType("yorkie.v1.UpdatableProjectFields.AuthWebhookMethods",()=>[{no:1,name:"methods",kind:"scalar",T:9,repeated:!0}],{localName:"UpdatableProjectFields_AuthWebhookMethods"}),bt=l.makeMessageType("yorkie.v1.DocumentSummary",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"snapshot",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:m},{no:5,name:"accessed_at",kind:"message",T:m},{no:6,name:"updated_at",kind:"message",T:m}]),ct=l.makeMessageType("yorkie.v1.PresenceChange",()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(mt)},{no:2,name:"presence",kind:"message",T:lt}]),mt=l.makeEnum("yorkie.v1.PresenceChange.ChangeType",[{no:0,name:"CHANGE_TYPE_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"CHANGE_TYPE_PUT",localName:"PUT"},{no:2,name:"CHANGE_TYPE_DELETE",localName:"DELETE"},{no:3,name:"CHANGE_TYPE_CLEAR",localName:"CLEAR"}]),lt=l.makeMessageType("yorkie.v1.Presence",()=>[{no:1,name:"data",kind:"map",K:9,V:{kind:"scalar",T:9}}]),St=l.makeMessageType("yorkie.v1.Checkpoint",()=>[{no:1,name:"server_seq",kind:"scalar",T:3,L:1},{no:2,name:"client_seq",kind:"scalar",T:13}]),Xe=l.makeMessageType("yorkie.v1.TextNodePos",()=>[{no:1,name:"created_at",kind:"message",T:ee},{no:2,name:"offset",kind:"scalar",T:5},{no:3,name:"relative_offset",kind:"scalar",T:5}]),ee=l.makeMessageType("yorkie.v1.TimeTicket",()=>[{no:1,name:"lamport",kind:"scalar",T:3,L:1},{no:2,name:"delimiter",kind:"scalar",T:13},{no:3,name:"actor_id",kind:"scalar",T:12}]),Xt=l.makeMessageType("yorkie.v1.DocEventBody",()=>[{no:1,name:"topic",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12}]),xt=l.makeMessageType("yorkie.v1.DocEvent",()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(b)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"body",kind:"message",T:Xt}]);A.ValueType=x,A.DocEventType=b,A.Snapshot=_,A.ChangePack=B,A.Change=T,A.ChangeID=y,A.Operation=C,A.Operation_Set=k,A.Operation_Add=L,A.Operation_Move=S,A.Operation_Remove=f,A.Operation_Edit=U,A.Operation_Select=R,A.Operation_Style=w,A.Operation_Increase=$,A.Operation_TreeEdit=Y,A.Operation_TreeStyle=q,A.JSONElementSimple=O,A.JSONElement=V,A.JSONElement_JSONObject=z,A.JSONElement_JSONArray=Z,A.JSONElement_Primitive=K,A.JSONElement_Text=te,A.JSONElement_Counter=Ae,A.JSONElement_Tree=W,A.RHTNode=Ee,A.RGANode=ne,A.NodeAttr=ue,A.TextNode=ke,A.TextNodeID=pe,A.TreeNode=Le,A.TreeNodes=ze,A.TreeNodeID=Re,A.TreePos=ut,A.User=ht,A.Project=tt,A.UpdatableProjectFields=de,A.UpdatableProjectFields_AuthWebhookMethods=Rt,A.DocumentSummary=bt,A.PresenceChange=ct,A.PresenceChange_ChangeType=mt,A.Presence=lt,A.Checkpoint=St,A.TextNodePos=Xe,A.TimeTicket=ee,A.DocEventBody=Xt,A.DocEvent=xt},295:(ce,A,D)=>{const{ActivateClientRequest:l,ActivateClientResponse:g,AttachDocumentRequest:m,AttachDocumentResponse:x,BroadcastRequest:b,BroadcastResponse:_,DeactivateClientRequest:B,DeactivateClientResponse:T,DetachDocumentRequest:y,DetachDocumentResponse:C,PushPullChangesRequest:k,PushPullChangesResponse:L,RemoveDocumentRequest:S,RemoveDocumentResponse:f,WatchDocumentRequest:U,WatchDocumentResponse:R}=D(176),{MethodKind:w}=D(532),$={typeName:"yorkie.v1.YorkieService",methods:{activateClient:{name:"ActivateClient",I:l,O:g,kind:w.Unary},deactivateClient:{name:"DeactivateClient",I:B,O:T,kind:w.Unary},attachDocument:{name:"AttachDocument",I:m,O:x,kind:w.Unary},detachDocument:{name:"DetachDocument",I:y,O:C,kind:w.Unary},removeDocument:{name:"RemoveDocument",I:S,O:f,kind:w.Unary},pushPullChanges:{name:"PushPullChanges",I:k,O:L,kind:w.Unary},watchDocument:{name:"WatchDocument",I:U,O:R,kind:w.ServerStreaming},broadcast:{name:"Broadcast",I:b,O:_,kind:w.Unary}}};A.V=$},176:(ce,A,D)=>{Object.defineProperty(A,"__esModule",{value:!0});const{proto3:l}=D(532),{ChangePack:g,DocEvent:m}=D(646),x=l.makeMessageType("yorkie.v1.ActivateClientRequest",()=>[{no:1,name:"client_key",kind:"scalar",T:9}]),b=l.makeMessageType("yorkie.v1.ActivateClientResponse",()=>[{no:1,name:"client_id",kind:"scalar",T:9}]),_=l.makeMessageType("yorkie.v1.DeactivateClientRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9}]),B=l.makeMessageType("yorkie.v1.DeactivateClientResponse",[]),T=l.makeMessageType("yorkie.v1.AttachDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:g}]),y=l.makeMessageType("yorkie.v1.AttachDocumentResponse",()=>[{no:1,name:"document_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:g}]),C=l.makeMessageType("yorkie.v1.DetachDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:g},{no:4,name:"remove_if_not_attached",kind:"scalar",T:8}]),k=l.makeMessageType("yorkie.v1.DetachDocumentResponse",()=>[{no:2,name:"change_pack",kind:"message",T:g}]),L=l.makeMessageType("yorkie.v1.WatchDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9}]),S=l.makeMessageType("yorkie.v1.WatchDocumentResponse",()=>[{no:1,name:"initialization",kind:"message",T:f,oneof:"body"},{no:2,name:"event",kind:"message",T:m,oneof:"body"}]),f=l.makeMessageType("yorkie.v1.WatchDocumentResponse.Initialization",()=>[{no:1,name:"client_ids",kind:"scalar",T:9,repeated:!0}],{localName:"WatchDocumentResponse_Initialization"}),U=l.makeMessageType("yorkie.v1.RemoveDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:g}]),R=l.makeMessageType("yorkie.v1.RemoveDocumentResponse",()=>[{no:1,name:"change_pack",kind:"message",T:g}]),w=l.makeMessageType("yorkie.v1.PushPullChangesRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:g},{no:4,name:"push_only",kind:"scalar",T:8}]),$=l.makeMessageType("yorkie.v1.PushPullChangesResponse",()=>[{no:1,name:"change_pack",kind:"message",T:g}]),Y=l.makeMessageType("yorkie.v1.BroadcastRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}]),q=l.makeMessageType("yorkie.v1.BroadcastResponse",[]);A.ActivateClientRequest=x,A.ActivateClientResponse=b,A.DeactivateClientRequest=_,A.DeactivateClientResponse=B,A.AttachDocumentRequest=T,A.AttachDocumentResponse=y,A.DetachDocumentRequest=C,A.DetachDocumentResponse=k,A.WatchDocumentRequest=L,A.WatchDocumentResponse=S,A.WatchDocumentResponse_Initialization=f,A.RemoveDocumentRequest=U,A.RemoveDocumentResponse=R,A.PushPullChangesRequest=w,A.PushPullChangesResponse=$,A.BroadcastRequest=Y,A.BroadcastResponse=q},79:(ce,A,D)=>{D.d(A,{Lt:()=>b,TD:()=>x,oP:()=>_});var l=D(818),g=D(120),m=D(210),x;(function(B){B[B.Varint=0]="Varint",B[B.Bit64=1]="Bit64",B[B.LengthDelimited=2]="LengthDelimited",B[B.StartGroup=3]="StartGroup",B[B.EndGroup=4]="EndGroup",B[B.Bit32=5]="Bit32"})(x||(x={}));class b{constructor(T){this.stack=[],this.textEncoder=T!=null?T:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let T=0;for(let k=0;k<this.chunks.length;k++)T+=this.chunks[k].length;let y=new Uint8Array(T),C=0;for(let k=0;k<this.chunks.length;k++)y.set(this.chunks[k],C),C+=this.chunks[k].length;return this.chunks=[],y}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let T=this.finish(),y=this.stack.pop();if(!y)throw new Error("invalid state, fork stack empty");return this.chunks=y.chunks,this.buf=y.buf,this.uint32(T.byteLength),this.raw(T)}tag(T,y){return this.uint32((T<<3|y)>>>0)}raw(T){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(T),this}uint32(T){for((0,g.fp)(T);T>127;)this.buf.push(T&127|128),T=T>>>7;return this.buf.push(T),this}int32(T){return(0,g.ug)(T),(0,l.fC)(T,this.buf),this}bool(T){return this.buf.push(T?1:0),this}bytes(T){return this.uint32(T.byteLength),this.raw(T)}string(T){let y=this.textEncoder.encode(T);return this.uint32(y.byteLength),this.raw(y)}float(T){(0,g.E_)(T);let y=new Uint8Array(4);return new DataView(y.buffer).setFloat32(0,T,!0),this.raw(y)}double(T){let y=new Uint8Array(8);return new DataView(y.buffer).setFloat64(0,T,!0),this.raw(y)}fixed32(T){(0,g.fp)(T);let y=new Uint8Array(4);return new DataView(y.buffer).setUint32(0,T,!0),this.raw(y)}sfixed32(T){(0,g.ug)(T);let y=new Uint8Array(4);return new DataView(y.buffer).setInt32(0,T,!0),this.raw(y)}sint32(T){return(0,g.ug)(T),T=(T<<1^T>>31)>>>0,(0,l.fC)(T,this.buf),this}sfixed64(T){let y=new Uint8Array(8),C=new DataView(y.buffer),k=m.q.enc(T);return C.setInt32(0,k.lo,!0),C.setInt32(4,k.hi,!0),this.raw(y)}fixed64(T){let y=new Uint8Array(8),C=new DataView(y.buffer),k=m.q.uEnc(T);return C.setInt32(0,k.lo,!0),C.setInt32(4,k.hi,!0),this.raw(y)}int64(T){let y=m.q.enc(T);return(0,l._y)(y.lo,y.hi,this.buf),this}sint64(T){let y=m.q.enc(T),C=y.hi>>31,k=y.lo<<1^C,L=(y.hi<<1|y.lo>>>31)^C;return(0,l._y)(k,L,this.buf),this}uint64(T){let y=m.q.uEnc(T);return(0,l._y)(y.lo,y.hi,this.buf),this}}class _{constructor(T,y){this.varint64=l.sg,this.uint32=l.jI,this.buf=T,this.len=T.length,this.pos=0,this.view=new DataView(T.buffer,T.byteOffset,T.byteLength),this.textDecoder=y!=null?y:new TextDecoder}tag(){let T=this.uint32(),y=T>>>3,C=T&7;if(y<=0||C<0||C>5)throw new Error("illegal tag: field no "+y+" wire type "+C);return[y,C]}skip(T){let y=this.pos;switch(T){case x.Varint:for(;this.buf[this.pos++]&128;);break;case x.Bit64:this.pos+=4;case x.Bit32:this.pos+=4;break;case x.LengthDelimited:let C=this.uint32();this.pos+=C;break;case x.StartGroup:let k;for(;(k=this.tag()[1])!==x.EndGroup;)this.skip(k);break;default:throw new Error("cant skip wire type "+T)}return this.assertBounds(),this.buf.subarray(y,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let T=this.uint32();return T>>>1^-(T&1)}int64(){return m.q.dec(...this.varint64())}uint64(){return m.q.uDec(...this.varint64())}sint64(){let[T,y]=this.varint64(),C=-(T&1);return T=(T>>>1|(y&1)<<31)^C,y=y>>>1^C,m.q.dec(T,y)}bool(){let[T,y]=this.varint64();return T!==0||y!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return m.q.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return m.q.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let T=this.uint32(),y=this.pos;return this.pos+=T,this.assertBounds(),this.buf.subarray(y,y+T)}string(){return this.textDecoder.decode(this.bytes())}}},465:(ce,A,D)=>{D.d(A,{p:()=>g,w:()=>l});var l;(function(m){m[m.DOUBLE=1]="DOUBLE",m[m.FLOAT=2]="FLOAT",m[m.INT64=3]="INT64",m[m.UINT64=4]="UINT64",m[m.INT32=5]="INT32",m[m.FIXED64=6]="FIXED64",m[m.FIXED32=7]="FIXED32",m[m.BOOL=8]="BOOL",m[m.STRING=9]="STRING",m[m.BYTES=12]="BYTES",m[m.UINT32=13]="UINT32",m[m.SFIXED32=15]="SFIXED32",m[m.SFIXED64=16]="SFIXED64",m[m.SINT32=17]="SINT32",m[m.SINT64=18]="SINT64"})(l||(l={}));var g;(function(m){m[m.BIGINT=0]="BIGINT",m[m.STRING=1]="STRING"})(g||(g={}))},733:(ce,A,D)=>{D.d(A,{I:()=>m});var l=D(561),g=D(850);class m extends l.v{constructor(b){super(),this.typeUrl="",this.value=new Uint8Array(0),g.w.util.initPartial(b,this)}toJson(b){var _;if(this.typeUrl==="")return{};const B=this.typeUrlToName(this.typeUrl),T=(_=b==null?void 0:b.typeRegistry)===null||_===void 0?void 0:_.findMessage(B);if(!T)throw new Error(`cannot encode message google.protobuf.Any to JSON: "${this.typeUrl}" is not in the type registry`);let C=T.fromBinary(this.value).toJson(b);return(B.startsWith("google.protobuf.")||C===null||Array.isArray(C)||typeof C!="object")&&(C={value:C}),C["@type"]=this.typeUrl,C}fromJson(b,_){var B;if(b===null||Array.isArray(b)||typeof b!="object")throw new Error(`cannot decode message google.protobuf.Any from JSON: expected object but got ${b===null?"null":Array.isArray(b)?"array":typeof b}`);if(Object.keys(b).length==0)return this;const T=b["@type"];if(typeof T!="string"||T=="")throw new Error('cannot decode message google.protobuf.Any from JSON: "@type" is empty');const y=this.typeUrlToName(T),C=(B=_==null?void 0:_.typeRegistry)===null||B===void 0?void 0:B.findMessage(y);if(!C)throw new Error(`cannot decode message google.protobuf.Any from JSON: ${T} is not in the type registry`);let k;if(y.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(b,"value"))k=C.fromJson(b.value,_);else{const L=Object.assign({},b);delete L["@type"],k=C.fromJson(L,_)}return this.packFrom(k),this}packFrom(b){this.value=b.toBinary(),this.typeUrl=this.typeNameToUrl(b.getType().typeName)}unpackTo(b){return this.is(b.getType())?(b.fromBinary(this.value),!0):!1}unpack(b){if(this.typeUrl==="")return;const _=b.findMessage(this.typeUrlToName(this.typeUrl));if(!!_)return _.fromBinary(this.value)}is(b){if(this.typeUrl==="")return!1;const _=this.typeUrlToName(this.typeUrl);let B="";return typeof b=="string"?B=b:B=b.typeName,_===B}typeNameToUrl(b){return`type.googleapis.com/${b}`}typeUrlToName(b){if(!b.length)throw new Error(`invalid type url: ${b}`);const _=b.lastIndexOf("/"),B=_>=0?b.substring(_+1):b;if(!B.length)throw new Error(`invalid type url: ${b}`);return B}static pack(b){const _=new m;return _.packFrom(b),_}static fromBinary(b,_){return new m().fromBinary(b,_)}static fromJson(b,_){return new m().fromJson(b,_)}static fromJsonString(b,_){return new m().fromJsonString(b,_)}static equals(b,_){return g.w.util.equals(m,b,_)}}m.runtime=g.w,m.typeName="google.protobuf.Any",m.fields=g.w.util.newFieldList(()=>[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}])},818:(ce,A,D)=>{D.d(A,{Ak:()=>b,CZ:()=>x,Fd:()=>_,_y:()=>g,fC:()=>k,jI:()=>L,sg:()=>l});function l(){let S=0,f=0;for(let R=0;R<28;R+=7){let w=this.buf[this.pos++];if(S|=(w&127)<<R,(w&128)==0)return this.assertBounds(),[S,f]}let U=this.buf[this.pos++];if(S|=(U&15)<<28,f=(U&112)>>4,(U&128)==0)return this.assertBounds(),[S,f];for(let R=3;R<=31;R+=7){let w=this.buf[this.pos++];if(f|=(w&127)<<R,(w&128)==0)return this.assertBounds(),[S,f]}throw new Error("invalid varint")}function g(S,f,U){for(let $=0;$<28;$=$+7){const Y=S>>>$,q=!(Y>>>7==0&&f==0),O=(q?Y|128:Y)&255;if(U.push(O),!q)return}const R=S>>>28&15|(f&7)<<4,w=f>>3!=0;if(U.push((w?R|128:R)&255),!!w){for(let $=3;$<31;$=$+7){const Y=f>>>$,q=Y>>>7!=0,O=(q?Y|128:Y)&255;if(U.push(O),!q)return}U.push(f>>>31&1)}}const m=4294967296;function x(S){const f=S[0]==="-";f&&(S=S.slice(1));const U=1e6;let R=0,w=0;function $(Y,q){const O=Number(S.slice(Y,q));w*=U,R=R*U+O,R>=m&&(w=w+(R/m|0),R=R%m)}return $(-24,-18),$(-18,-12),$(-12,-6),$(-6),f?y(R,w):T(R,w)}function b(S,f){let U=T(S,f);const R=U.hi&2147483648;R&&(U=y(U.lo,U.hi));const w=_(U.lo,U.hi);return R?"-"+w:w}function _(S,f){if({lo:S,hi:f}=B(S,f),f<=2097151)return String(m*f+S);const U=S&16777215,R=(S>>>24|f<<8)&16777215,w=f>>16&65535;let $=U+R*6777216+w*6710656,Y=R+w*8147497,q=w*2;const O=1e7;return $>=O&&(Y+=Math.floor($/O),$%=O),Y>=O&&(q+=Math.floor(Y/O),Y%=O),q.toString()+C(Y)+C($)}function B(S,f){return{lo:S>>>0,hi:f>>>0}}function T(S,f){return{lo:S|0,hi:f|0}}function y(S,f){return f=~f,S?S=~S+1:f+=1,T(S,f)}const C=S=>{const f=String(S);return"0000000".slice(f.length)+f};function k(S,f){if(S>=0){for(;S>127;)f.push(S&127|128),S=S>>>7;f.push(S)}else{for(let U=0;U<9;U++)f.push(S&127|128),S=S>>7;f.push(1)}}function L(){let S=this.buf[this.pos++],f=S&127;if((S&128)==0)return this.assertBounds(),f;if(S=this.buf[this.pos++],f|=(S&127)<<7,(S&128)==0)return this.assertBounds(),f;if(S=this.buf[this.pos++],f|=(S&127)<<14,(S&128)==0)return this.assertBounds(),f;if(S=this.buf[this.pos++],f|=(S&127)<<21,(S&128)==0)return this.assertBounds(),f;S=this.buf[this.pos++],f|=(S&15)<<28;for(let U=5;(S&128)!==0&&U<10;U++)S=this.buf[this.pos++];if((S&128)!=0)throw new Error("invalid varint");return this.assertBounds(),f>>>0}},532:(ce,A,D)=>{D.r(A),D.d(A,{Any:()=>lr.I,Api:()=>un,BinaryReader:()=>Y.oP,BinaryWriter:()=>Y.Lt,BoolValue:()=>ge,BytesValue:()=>At,CodeGeneratorRequest:()=>nt,CodeGeneratorResponse:()=>Mt,CodeGeneratorResponse_Feature:()=>Tn,CodeGeneratorResponse_File:()=>$e,DescriptorProto:()=>pe,DescriptorProto_ExtensionRange:()=>Le,DescriptorProto_ReservedRange:()=>ze,DoubleValue:()=>ft,Duration:()=>yt,Edition:()=>ne,Empty:()=>Ce,Enum:()=>hn,EnumDescriptorProto:()=>ct,EnumDescriptorProto_EnumReservedRange:()=>mt,EnumOptions:()=>It,EnumValue:()=>an,EnumValueDescriptorProto:()=>lt,EnumValueOptions:()=>Qt,ExtensionRangeOptions:()=>Re,ExtensionRangeOptions_Declaration:()=>ht,ExtensionRangeOptions_VerificationState:()=>ut,FeatureSet:()=>xe,FeatureSetDefaults:()=>tn,FeatureSetDefaults_FeatureSetEditionDefault:()=>nn,FeatureSet_EnumType:()=>Cn,FeatureSet_FieldPresence:()=>En,FeatureSet_JsonFormat:()=>Vn,FeatureSet_MessageEncoding:()=>Vt,FeatureSet_RepeatedFieldEncoding:()=>pn,FeatureSet_Utf8Validation:()=>$n,Field:()=>sn,FieldDescriptorProto:()=>tt,FieldDescriptorProto_Label:()=>Rt,FieldDescriptorProto_Type:()=>de,FieldMask:()=>Lt,FieldOptions:()=>Ht,FieldOptions_CType:()=>Dn,FieldOptions_EditionDefault:()=>Ut,FieldOptions_JSType:()=>gn,FieldOptions_OptionRetention:()=>Fn,FieldOptions_OptionTargetType:()=>Un,Field_Cardinality:()=>on,Field_Kind:()=>wt,FileDescriptorProto:()=>ke,FileDescriptorSet:()=>ue,FileOptions:()=>ee,FileOptions_OptimizeMode:()=>Xt,FloatValue:()=>Ke,GeneratedCodeInfo:()=>ye,GeneratedCodeInfo_Annotation:()=>Oe,GeneratedCodeInfo_Annotation_Semantic:()=>Rn,Int32Value:()=>it,Int64Value:()=>kt,ListValue:()=>Tt,LongType:()=>m.p,Message:()=>W.v,MessageOptions:()=>xt,Method:()=>Jt,MethodDescriptorProto:()=>Xe,MethodIdempotency:()=>Ee.w,MethodKind:()=>Ee.t,MethodOptions:()=>en,MethodOptions_IdempotencyLevel:()=>ln,Mixin:()=>Ft,NullValue:()=>An,OneofDescriptorProto:()=>bt,OneofOptions:()=>Zt,Option:()=>me,ScalarType:()=>m.w,ServiceDescriptorProto:()=>St,ServiceOptions:()=>He,SourceCodeInfo:()=>M,SourceCodeInfo_Location:()=>Fe,SourceContext:()=>ot,StringValue:()=>Me,Struct:()=>Bt,Syntax:()=>at,Timestamp:()=>pt,Type:()=>dn,UInt32Value:()=>Pe,UInt64Value:()=>vt,UninterpretedOption:()=>Ze,UninterpretedOption_NamePart:()=>$t,Value:()=>Be,Version:()=>dt,WireType:()=>Y.TD,codegenInfo:()=>Ae,createDescriptorSet:()=>Xn,createRegistry:()=>qt,createRegistryFromDescriptors:()=>_e,proto2:()=>f,proto3:()=>l.w,protoBase64:()=>$.W,protoDelimited:()=>z,protoDouble:()=>R,protoInt64:()=>w.q,toPlainMessage:()=>Ln});var l=D(850),g=D(493),m=D(465),x=D(744);function b(){return Object.assign(Object.assign({},(0,x.gY)()),{writeMessage(a,s,o){const h=a.getType();let p;try{for(p of h.fields.byNumber()){let N,I=p.repeated,j=p.localName;if(p.oneof){const P=a[p.oneof.localName];if(P.case!==j)continue;N=P.value}else if(N=a[j],N===void 0&&!p.oneof&&!p.opt)throw new Error(`cannot encode field ${h.typeName}.${p.name} to binary: required field not set`);switch(p.kind){case"scalar":case"enum":let P=p.kind=="enum"?m.w.INT32:p.T;if(I)if(p.packed)(0,x.Jj)(s,P,p.no,N);else for(const X of N)(0,x.NN)(s,P,p.no,X,!0);else N!==void 0&&(0,x.NN)(s,P,p.no,N,!0);break;case"message":if(I)for(const X of N)(0,x.oQ)(s,o,p,X);else(0,x.oQ)(s,o,p,N);break;case"map":for(const[X,H]of Object.entries(N))(0,x.gQ)(s,o,p,X,H);break}}}catch(N){let I=p?`cannot encode field ${h.typeName}.${p==null?void 0:p.name} to binary`:`cannot encode message ${h.typeName} to binary`,j=N instanceof Error?N.message:String(N);throw new Error(I+(j.length>0?`: ${j}`:""))}return o.writeUnknownFields&&this.writeUnknownFields(a,s),s}})}var _=D(433),B=D(501),T=D(215),y=D(504),C=D(432),k=D(120),L=D(814);function S(){return(0,L.b)((a,s)=>function(h,p,N){if(h.kind=="map"){const I={};switch(h.V.kind){case"scalar":for(const[P,X]of Object.entries(p)){const H=s(h.V.T,X,!0);(0,k.hu)(H!==void 0),I[P.toString()]=H}break;case"message":for(const[P,X]of Object.entries(p))I[P.toString()]=X.toJson(N);break;case"enum":const j=h.V.T;for(const[P,X]of Object.entries(p)){(0,k.hu)(X===void 0||typeof X=="number");const H=a(j,X,!0,N.enumAsInteger);(0,k.hu)(H!==void 0),I[P.toString()]=H}break}return N.emitDefaultValues||Object.keys(I).length>0?I:void 0}else if(h.repeated){const I=[];switch(h.kind){case"scalar":for(let j=0;j<p.length;j++)I.push(s(h.T,p[j],!0));break;case"enum":for(let j=0;j<p.length;j++)I.push(a(h.T,p[j],!0,N.enumAsInteger));break;case"message":for(let j=0;j<p.length;j++)I.push(p[j].toJson(N));break}return N.emitDefaultValues||I.length>0?I:void 0}else{if(p===void 0){if(!h.oneof&&!h.opt)throw"required field not set";return}switch(h.kind){case"scalar":return s(h.T,p,!0);case"enum":return a(h.T,p,!0,N.enumAsInteger);case"message":return(0,C.E)(h.T,p).toJson(N)}}})}const f=(0,g.F)("proto2",S(),b(),Object.assign(Object.assign({},(0,_.f)()),{newFieldList(a){return new B.i(a,U)},initFields(a){for(const s of a.getType().fields.byMember()){const o=s.localName,h=a;if(s.repeated){h[o]=[];continue}switch(s.kind){case"oneof":h[o]={case:void 0};break;case"map":h[o]={};break}}}}));function U(a){var s,o,h,p,N;const I=[];let j;for(const P of typeof a=="function"?a():a){const X=P;if(X.localName=(0,y.Rz)(P.name,P.oneof!==void 0),X.jsonName=(s=P.jsonName)!==null&&s!==void 0?s:(0,y.x1)(P.name),X.repeated=(o=P.repeated)!==null&&o!==void 0?o:!1,P.kind=="scalar"&&(X.L=(h=P.L)!==null&&h!==void 0?h:m.p.BIGINT),P.oneof!==void 0){const H=typeof P.oneof=="string"?P.oneof:P.oneof.name;(!j||j.name!=H)&&(j=new T.o(H)),X.oneof=j,j.addField(X)}P.kind=="message"&&(X.delimited=(p=P.delimited)!==null&&p!==void 0?p:!1),X.packed=(N=P.packed)!==null&&N!==void 0?N:!1,I.push(X)}return I}const R={NaN:Number.NaN,POSITIVE_INFINITY:Number.POSITIVE_INFINITY,NEGATIVE_INFINITY:Number.NEGATIVE_INFINITY};var w=D(210),$=D(236),Y=D(79),q=function(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=a[Symbol.asyncIterator],o;return s?s.call(a):(a=typeof __values=="function"?__values(a):a[Symbol.iterator](),o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o);function h(N){o[N]=a[N]&&function(I){return new Promise(function(j,P){I=a[N](I),p(j,P,I.done,I.value)})}}function p(N,I,j,P){Promise.resolve(P).then(function(X){N({value:X,done:j})},I)}},O=function(a){return this instanceof O?(this.v=a,this):new O(a)},V=function(a,s,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=o.apply(a,s||[]),p,N=[];return p={},j("next"),j("throw"),j("return",I),p[Symbol.asyncIterator]=function(){return this},p;function I(be){return function(Pt){return Promise.resolve(Pt).then(be,se)}}function j(be,Pt){h[be]&&(p[be]=function(Et){return new Promise(function(qn,vn){N.push([be,Et,qn,vn])>1||P(be,Et)})},Pt&&(p[be]=Pt(p[be])))}function P(be,Pt){try{X(h[be](Pt))}catch(Et){De(N[0][3],Et)}}function X(be){be.value instanceof O?Promise.resolve(be.value.v).then(H,se):De(N[0][2],be)}function H(be){P("next",be)}function se(be){P("throw",be)}function De(be,Pt){be(Pt),N.shift(),N.length&&P(N[0][0],N[0][1])}};const z={enc(a,s){const o=(0,x.gY)().makeWriteOptions(s);return o.writerFactory().bytes(a.toBinary(o)).finish()},dec(a,s,o){const h=(0,x.gY)().makeReadOptions(o);return a.fromBinary(h.readerFactory(s).bytes(),h)},decStream(a,s){return V(this,arguments,function*(){var h,p,N,I;function j(De,be){const Pt=new Uint8Array(De.byteLength+be.byteLength);return Pt.set(De),Pt.set(be,De.length),Pt}let P=new Uint8Array(0);try{for(var X=!0,H=q(s),se;se=yield O(H.next()),h=se.done,!h;X=!0)for(I=se.value,X=!1,P=j(P,I);;){const be=z.peekSize(P);if(be.eof||be.offset+be.size>P.byteLength)break;yield yield O(z.dec(a,P)),P=P.subarray(be.offset+be.size)}}catch(De){p={error:De}}finally{try{!X&&!h&&(N=H.return)&&(yield O(N.call(H)))}finally{if(p)throw p.error}}if(P.byteLength>0)throw new Error("incomplete data")})},peekSize(a){const s={eof:!0,size:null,offset:null};for(let o=0;o<10;o++){if(o>a.byteLength)return s;if((a[o]&128)==0){const h=new Y.oP(a);let p;try{p=h.uint32()}catch(N){if(N instanceof RangeError)return s;throw N}return{eof:!1,size:p,offset:h.pos}}}throw new Error("invalid varint")}};var Z=D(781);function K(a){switch(a.typeName){case"google.protobuf.Any":{const s=a.fields.find(h=>h.number==1&&h.fieldKind=="scalar"&&h.scalar===m.w.STRING),o=a.fields.find(h=>h.number==2&&h.fieldKind=="scalar"&&h.scalar===m.w.BYTES);if(s&&o)return{typeName:a.typeName,typeUrl:s,value:o};break}case"google.protobuf.Timestamp":{const s=a.fields.find(h=>h.number==1&&h.fieldKind=="scalar"&&h.scalar===m.w.INT64),o=a.fields.find(h=>h.number==2&&h.fieldKind=="scalar"&&h.scalar===m.w.INT32);if(s&&o)return{typeName:a.typeName,seconds:s,nanos:o};break}case"google.protobuf.Duration":{const s=a.fields.find(h=>h.number==1&&h.fieldKind=="scalar"&&h.scalar===m.w.INT64),o=a.fields.find(h=>h.number==2&&h.fieldKind=="scalar"&&h.scalar===m.w.INT32);if(s&&o)return{typeName:a.typeName,seconds:s,nanos:o};break}case"google.protobuf.Struct":{const s=a.fields.find(o=>o.number==1&&!o.repeated);if((s==null?void 0:s.fieldKind)!=="map"||s.mapValue.kind!=="message"||s.mapValue.message.typeName!=="google.protobuf.Value")break;return{typeName:a.typeName,fields:s}}case"google.protobuf.Value":{const s=a.oneofs.find(P=>P.name==="kind"),o=a.fields.find(P=>P.number==1&&P.oneof===s);if((o==null?void 0:o.fieldKind)!=="enum"||o.enum.typeName!=="google.protobuf.NullValue")return;const h=a.fields.find(P=>P.number==2&&P.fieldKind=="scalar"&&P.scalar===m.w.DOUBLE&&P.oneof===s),p=a.fields.find(P=>P.number==3&&P.fieldKind=="scalar"&&P.scalar===m.w.STRING&&P.oneof===s),N=a.fields.find(P=>P.number==4&&P.fieldKind=="scalar"&&P.scalar===m.w.BOOL&&P.oneof===s),I=a.fields.find(P=>P.number==5&&P.oneof===s);if((I==null?void 0:I.fieldKind)!=="message"||I.message.typeName!=="google.protobuf.Struct")return;const j=a.fields.find(P=>P.number==6&&P.oneof===s);if((j==null?void 0:j.fieldKind)!=="message"||j.message.typeName!=="google.protobuf.ListValue")return;if(s&&h&&p&&N)return{typeName:a.typeName,kind:s,nullValue:o,numberValue:h,stringValue:p,boolValue:N,structValue:I,listValue:j};break}case"google.protobuf.ListValue":{const s=a.fields.find(o=>o.number==1&&o.repeated);if((s==null?void 0:s.fieldKind)!="message"||s.message.typeName!=="google.protobuf.Value")break;return{typeName:a.typeName,values:s}}case"google.protobuf.FieldMask":{const s=a.fields.find(o=>o.number==1&&o.fieldKind=="scalar"&&o.scalar===m.w.STRING&&o.repeated);if(s)return{typeName:a.typeName,paths:s};break}case"google.protobuf.DoubleValue":case"google.protobuf.FloatValue":case"google.protobuf.Int64Value":case"google.protobuf.UInt64Value":case"google.protobuf.Int32Value":case"google.protobuf.UInt32Value":case"google.protobuf.BoolValue":case"google.protobuf.StringValue":case"google.protobuf.BytesValue":{const s=a.fields.find(o=>o.number==1&&o.name=="value");if(!s||s.fieldKind!=="scalar")break;return{typeName:a.typeName,value:s}}}}const te="@bufbuild/protobuf",Ae={packageName:"@bufbuild/protobuf",localName:y.r1,reifyWkt:K,getUnwrappedFieldType:C.w,scalarDefaultValue:Z.kY,safeIdentifier:y.GD,safeObjectProperty:y.ll,symbols:{proto2:{typeOnly:!1,privateImportPath:"./proto2.js",publicImportPath:te},proto3:{typeOnly:!1,privateImportPath:"./proto3.js",publicImportPath:te},Message:{typeOnly:!1,privateImportPath:"./message.js",publicImportPath:te},PartialMessage:{typeOnly:!0,privateImportPath:"./message.js",publicImportPath:te},PlainMessage:{typeOnly:!0,privateImportPath:"./message.js",publicImportPath:te},FieldList:{typeOnly:!0,privateImportPath:"./field-list.js",publicImportPath:te},MessageType:{typeOnly:!0,privateImportPath:"./message-type.js",publicImportPath:te},BinaryReadOptions:{typeOnly:!0,privateImportPath:"./binary-format.js",publicImportPath:te},BinaryWriteOptions:{typeOnly:!0,privateImportPath:"./binary-format.js",publicImportPath:te},JsonReadOptions:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:te},JsonWriteOptions:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:te},JsonValue:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:te},JsonObject:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:te},protoDouble:{typeOnly:!1,privateImportPath:"./proto-double.js",publicImportPath:te},protoInt64:{typeOnly:!1,privateImportPath:"./proto-int64.js",publicImportPath:te},ScalarType:{typeOnly:!1,privateImportPath:"./field.js",publicImportPath:te},LongType:{typeOnly:!1,privateImportPath:"./field.js",publicImportPath:te},MethodKind:{typeOnly:!1,privateImportPath:"./service-type.js",publicImportPath:te},MethodIdempotency:{typeOnly:!1,privateImportPath:"./service-type.js",publicImportPath:te},IMessageTypeRegistry:{typeOnly:!0,privateImportPath:"./type-registry.js",publicImportPath:te}},wktSourceFiles:["google/protobuf/compiler/plugin.proto","google/protobuf/any.proto","google/protobuf/api.proto","google/protobuf/descriptor.proto","google/protobuf/duration.proto","google/protobuf/empty.proto","google/protobuf/field_mask.proto","google/protobuf/source_context.proto","google/protobuf/struct.proto","google/protobuf/timestamp.proto","google/protobuf/type.proto","google/protobuf/wrappers.proto"]};var W=D(561),Ee=D(328),ne;(function(a){a[a.EDITION_UNKNOWN=0]="EDITION_UNKNOWN",a[a.EDITION_PROTO2=998]="EDITION_PROTO2",a[a.EDITION_PROTO3=999]="EDITION_PROTO3",a[a.EDITION_2023=1e3]="EDITION_2023",a[a.EDITION_1_TEST_ONLY=1]="EDITION_1_TEST_ONLY",a[a.EDITION_2_TEST_ONLY=2]="EDITION_2_TEST_ONLY",a[a.EDITION_99997_TEST_ONLY=99997]="EDITION_99997_TEST_ONLY",a[a.EDITION_99998_TEST_ONLY=99998]="EDITION_99998_TEST_ONLY",a[a.EDITION_99999_TEST_ONLY=99999]="EDITION_99999_TEST_ONLY"})(ne||(ne={})),f.util.setEnumType(ne,"google.protobuf.Edition",[{no:0,name:"EDITION_UNKNOWN"},{no:998,name:"EDITION_PROTO2"},{no:999,name:"EDITION_PROTO3"},{no:1e3,name:"EDITION_2023"},{no:1,name:"EDITION_1_TEST_ONLY"},{no:2,name:"EDITION_2_TEST_ONLY"},{no:99997,name:"EDITION_99997_TEST_ONLY"},{no:99998,name:"EDITION_99998_TEST_ONLY"},{no:99999,name:"EDITION_99999_TEST_ONLY"}]);class ue extends W.v{constructor(s){super(),this.file=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new ue().fromBinary(s,o)}static fromJson(s,o){return new ue().fromJson(s,o)}static fromJsonString(s,o){return new ue().fromJsonString(s,o)}static equals(s,o){return f.util.equals(ue,s,o)}}ue.runtime=f,ue.typeName="google.protobuf.FileDescriptorSet",ue.fields=f.util.newFieldList(()=>[{no:1,name:"file",kind:"message",T:ke,repeated:!0}]);class ke extends W.v{constructor(s){super(),this.dependency=[],this.publicDependency=[],this.weakDependency=[],this.messageType=[],this.enumType=[],this.service=[],this.extension=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new ke().fromBinary(s,o)}static fromJson(s,o){return new ke().fromJson(s,o)}static fromJsonString(s,o){return new ke().fromJsonString(s,o)}static equals(s,o){return f.util.equals(ke,s,o)}}ke.runtime=f,ke.typeName="google.protobuf.FileDescriptorProto",ke.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"package",kind:"scalar",T:9,opt:!0},{no:3,name:"dependency",kind:"scalar",T:9,repeated:!0},{no:10,name:"public_dependency",kind:"scalar",T:5,repeated:!0},{no:11,name:"weak_dependency",kind:"scalar",T:5,repeated:!0},{no:4,name:"message_type",kind:"message",T:pe,repeated:!0},{no:5,name:"enum_type",kind:"message",T:ct,repeated:!0},{no:6,name:"service",kind:"message",T:St,repeated:!0},{no:7,name:"extension",kind:"message",T:tt,repeated:!0},{no:8,name:"options",kind:"message",T:ee,opt:!0},{no:9,name:"source_code_info",kind:"message",T:M,opt:!0},{no:12,name:"syntax",kind:"scalar",T:9,opt:!0},{no:14,name:"edition",kind:"enum",T:f.getEnumType(ne),opt:!0}]);class pe extends W.v{constructor(s){super(),this.field=[],this.extension=[],this.nestedType=[],this.enumType=[],this.extensionRange=[],this.oneofDecl=[],this.reservedRange=[],this.reservedName=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new pe().fromBinary(s,o)}static fromJson(s,o){return new pe().fromJson(s,o)}static fromJsonString(s,o){return new pe().fromJsonString(s,o)}static equals(s,o){return f.util.equals(pe,s,o)}}pe.runtime=f,pe.typeName="google.protobuf.DescriptorProto",pe.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"field",kind:"message",T:tt,repeated:!0},{no:6,name:"extension",kind:"message",T:tt,repeated:!0},{no:3,name:"nested_type",kind:"message",T:pe,repeated:!0},{no:4,name:"enum_type",kind:"message",T:ct,repeated:!0},{no:5,name:"extension_range",kind:"message",T:Le,repeated:!0},{no:8,name:"oneof_decl",kind:"message",T:bt,repeated:!0},{no:7,name:"options",kind:"message",T:xt,opt:!0},{no:9,name:"reserved_range",kind:"message",T:ze,repeated:!0},{no:10,name:"reserved_name",kind:"scalar",T:9,repeated:!0}]);class Le extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new Le().fromBinary(s,o)}static fromJson(s,o){return new Le().fromJson(s,o)}static fromJsonString(s,o){return new Le().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Le,s,o)}}Le.runtime=f,Le.typeName="google.protobuf.DescriptorProto.ExtensionRange",Le.fields=f.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0},{no:3,name:"options",kind:"message",T:Re,opt:!0}]);class ze extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new ze().fromBinary(s,o)}static fromJson(s,o){return new ze().fromJson(s,o)}static fromJsonString(s,o){return new ze().fromJsonString(s,o)}static equals(s,o){return f.util.equals(ze,s,o)}}ze.runtime=f,ze.typeName="google.protobuf.DescriptorProto.ReservedRange",ze.fields=f.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0}]);class Re extends W.v{constructor(s){super(),this.uninterpretedOption=[],this.declaration=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new Re().fromBinary(s,o)}static fromJson(s,o){return new Re().fromJson(s,o)}static fromJsonString(s,o){return new Re().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Re,s,o)}}Re.runtime=f,Re.typeName="google.protobuf.ExtensionRangeOptions",Re.fields=f.util.newFieldList(()=>[{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0},{no:2,name:"declaration",kind:"message",T:ht,repeated:!0},{no:50,name:"features",kind:"message",T:xe,opt:!0},{no:3,name:"verification",kind:"enum",T:f.getEnumType(ut),opt:!0,default:ut.UNVERIFIED}]);var ut;(function(a){a[a.DECLARATION=0]="DECLARATION",a[a.UNVERIFIED=1]="UNVERIFIED"})(ut||(ut={})),f.util.setEnumType(ut,"google.protobuf.ExtensionRangeOptions.VerificationState",[{no:0,name:"DECLARATION"},{no:1,name:"UNVERIFIED"}]);class ht extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new ht().fromBinary(s,o)}static fromJson(s,o){return new ht().fromJson(s,o)}static fromJsonString(s,o){return new ht().fromJsonString(s,o)}static equals(s,o){return f.util.equals(ht,s,o)}}ht.runtime=f,ht.typeName="google.protobuf.ExtensionRangeOptions.Declaration",ht.fields=f.util.newFieldList(()=>[{no:1,name:"number",kind:"scalar",T:5,opt:!0},{no:2,name:"full_name",kind:"scalar",T:9,opt:!0},{no:3,name:"type",kind:"scalar",T:9,opt:!0},{no:5,name:"reserved",kind:"scalar",T:8,opt:!0},{no:6,name:"repeated",kind:"scalar",T:8,opt:!0}]);class tt extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new tt().fromBinary(s,o)}static fromJson(s,o){return new tt().fromJson(s,o)}static fromJsonString(s,o){return new tt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(tt,s,o)}}tt.runtime=f,tt.typeName="google.protobuf.FieldDescriptorProto",tt.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:3,name:"number",kind:"scalar",T:5,opt:!0},{no:4,name:"label",kind:"enum",T:f.getEnumType(Rt),opt:!0},{no:5,name:"type",kind:"enum",T:f.getEnumType(de),opt:!0},{no:6,name:"type_name",kind:"scalar",T:9,opt:!0},{no:2,name:"extendee",kind:"scalar",T:9,opt:!0},{no:7,name:"default_value",kind:"scalar",T:9,opt:!0},{no:9,name:"oneof_index",kind:"scalar",T:5,opt:!0},{no:10,name:"json_name",kind:"scalar",T:9,opt:!0},{no:8,name:"options",kind:"message",T:Ht,opt:!0},{no:17,name:"proto3_optional",kind:"scalar",T:8,opt:!0}]);var de;(function(a){a[a.DOUBLE=1]="DOUBLE",a[a.FLOAT=2]="FLOAT",a[a.INT64=3]="INT64",a[a.UINT64=4]="UINT64",a[a.INT32=5]="INT32",a[a.FIXED64=6]="FIXED64",a[a.FIXED32=7]="FIXED32",a[a.BOOL=8]="BOOL",a[a.STRING=9]="STRING",a[a.GROUP=10]="GROUP",a[a.MESSAGE=11]="MESSAGE",a[a.BYTES=12]="BYTES",a[a.UINT32=13]="UINT32",a[a.ENUM=14]="ENUM",a[a.SFIXED32=15]="SFIXED32",a[a.SFIXED64=16]="SFIXED64",a[a.SINT32=17]="SINT32",a[a.SINT64=18]="SINT64"})(de||(de={})),f.util.setEnumType(de,"google.protobuf.FieldDescriptorProto.Type",[{no:1,name:"TYPE_DOUBLE"},{no:2,name:"TYPE_FLOAT"},{no:3,name:"TYPE_INT64"},{no:4,name:"TYPE_UINT64"},{no:5,name:"TYPE_INT32"},{no:6,name:"TYPE_FIXED64"},{no:7,name:"TYPE_FIXED32"},{no:8,name:"TYPE_BOOL"},{no:9,name:"TYPE_STRING"},{no:10,name:"TYPE_GROUP"},{no:11,name:"TYPE_MESSAGE"},{no:12,name:"TYPE_BYTES"},{no:13,name:"TYPE_UINT32"},{no:14,name:"TYPE_ENUM"},{no:15,name:"TYPE_SFIXED32"},{no:16,name:"TYPE_SFIXED64"},{no:17,name:"TYPE_SINT32"},{no:18,name:"TYPE_SINT64"}]);var Rt;(function(a){a[a.OPTIONAL=1]="OPTIONAL",a[a.REPEATED=3]="REPEATED",a[a.REQUIRED=2]="REQUIRED"})(Rt||(Rt={})),f.util.setEnumType(Rt,"google.protobuf.FieldDescriptorProto.Label",[{no:1,name:"LABEL_OPTIONAL"},{no:3,name:"LABEL_REPEATED"},{no:2,name:"LABEL_REQUIRED"}]);class bt extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new bt().fromBinary(s,o)}static fromJson(s,o){return new bt().fromJson(s,o)}static fromJsonString(s,o){return new bt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(bt,s,o)}}bt.runtime=f,bt.typeName="google.protobuf.OneofDescriptorProto",bt.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"options",kind:"message",T:Zt,opt:!0}]);class ct extends W.v{constructor(s){super(),this.value=[],this.reservedRange=[],this.reservedName=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new ct().fromBinary(s,o)}static fromJson(s,o){return new ct().fromJson(s,o)}static fromJsonString(s,o){return new ct().fromJsonString(s,o)}static equals(s,o){return f.util.equals(ct,s,o)}}ct.runtime=f,ct.typeName="google.protobuf.EnumDescriptorProto",ct.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"value",kind:"message",T:lt,repeated:!0},{no:3,name:"options",kind:"message",T:It,opt:!0},{no:4,name:"reserved_range",kind:"message",T:mt,repeated:!0},{no:5,name:"reserved_name",kind:"scalar",T:9,repeated:!0}]);class mt extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new mt().fromBinary(s,o)}static fromJson(s,o){return new mt().fromJson(s,o)}static fromJsonString(s,o){return new mt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(mt,s,o)}}mt.runtime=f,mt.typeName="google.protobuf.EnumDescriptorProto.EnumReservedRange",mt.fields=f.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0}]);class lt extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new lt().fromBinary(s,o)}static fromJson(s,o){return new lt().fromJson(s,o)}static fromJsonString(s,o){return new lt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(lt,s,o)}}lt.runtime=f,lt.typeName="google.protobuf.EnumValueDescriptorProto",lt.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"number",kind:"scalar",T:5,opt:!0},{no:3,name:"options",kind:"message",T:Qt,opt:!0}]);class St extends W.v{constructor(s){super(),this.method=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new St().fromBinary(s,o)}static fromJson(s,o){return new St().fromJson(s,o)}static fromJsonString(s,o){return new St().fromJsonString(s,o)}static equals(s,o){return f.util.equals(St,s,o)}}St.runtime=f,St.typeName="google.protobuf.ServiceDescriptorProto",St.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"method",kind:"message",T:Xe,repeated:!0},{no:3,name:"options",kind:"message",T:He,opt:!0}]);class Xe extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new Xe().fromBinary(s,o)}static fromJson(s,o){return new Xe().fromJson(s,o)}static fromJsonString(s,o){return new Xe().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Xe,s,o)}}Xe.runtime=f,Xe.typeName="google.protobuf.MethodDescriptorProto",Xe.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"input_type",kind:"scalar",T:9,opt:!0},{no:3,name:"output_type",kind:"scalar",T:9,opt:!0},{no:4,name:"options",kind:"message",T:en,opt:!0},{no:5,name:"client_streaming",kind:"scalar",T:8,opt:!0,default:!1},{no:6,name:"server_streaming",kind:"scalar",T:8,opt:!0,default:!1}]);class ee extends W.v{constructor(s){super(),this.uninterpretedOption=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new ee().fromBinary(s,o)}static fromJson(s,o){return new ee().fromJson(s,o)}static fromJsonString(s,o){return new ee().fromJsonString(s,o)}static equals(s,o){return f.util.equals(ee,s,o)}}ee.runtime=f,ee.typeName="google.protobuf.FileOptions",ee.fields=f.util.newFieldList(()=>[{no:1,name:"java_package",kind:"scalar",T:9,opt:!0},{no:8,name:"java_outer_classname",kind:"scalar",T:9,opt:!0},{no:10,name:"java_multiple_files",kind:"scalar",T:8,opt:!0,default:!1},{no:20,name:"java_generate_equals_and_hash",kind:"scalar",T:8,opt:!0},{no:27,name:"java_string_check_utf8",kind:"scalar",T:8,opt:!0,default:!1},{no:9,name:"optimize_for",kind:"enum",T:f.getEnumType(Xt),opt:!0,default:Xt.SPEED},{no:11,name:"go_package",kind:"scalar",T:9,opt:!0},{no:16,name:"cc_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:17,name:"java_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:18,name:"py_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:42,name:"php_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:23,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:31,name:"cc_enable_arenas",kind:"scalar",T:8,opt:!0,default:!0},{no:36,name:"objc_class_prefix",kind:"scalar",T:9,opt:!0},{no:37,name:"csharp_namespace",kind:"scalar",T:9,opt:!0},{no:39,name:"swift_prefix",kind:"scalar",T:9,opt:!0},{no:40,name:"php_class_prefix",kind:"scalar",T:9,opt:!0},{no:41,name:"php_namespace",kind:"scalar",T:9,opt:!0},{no:44,name:"php_metadata_namespace",kind:"scalar",T:9,opt:!0},{no:45,name:"ruby_package",kind:"scalar",T:9,opt:!0},{no:50,name:"features",kind:"message",T:xe,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0}]);var Xt;(function(a){a[a.SPEED=1]="SPEED",a[a.CODE_SIZE=2]="CODE_SIZE",a[a.LITE_RUNTIME=3]="LITE_RUNTIME"})(Xt||(Xt={})),f.util.setEnumType(Xt,"google.protobuf.FileOptions.OptimizeMode",[{no:1,name:"SPEED"},{no:2,name:"CODE_SIZE"},{no:3,name:"LITE_RUNTIME"}]);class xt extends W.v{constructor(s){super(),this.uninterpretedOption=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new xt().fromBinary(s,o)}static fromJson(s,o){return new xt().fromJson(s,o)}static fromJsonString(s,o){return new xt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(xt,s,o)}}xt.runtime=f,xt.typeName="google.protobuf.MessageOptions",xt.fields=f.util.newFieldList(()=>[{no:1,name:"message_set_wire_format",kind:"scalar",T:8,opt:!0,default:!1},{no:2,name:"no_standard_descriptor_accessor",kind:"scalar",T:8,opt:!0,default:!1},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:7,name:"map_entry",kind:"scalar",T:8,opt:!0},{no:11,name:"deprecated_legacy_json_field_conflicts",kind:"scalar",T:8,opt:!0},{no:12,name:"features",kind:"message",T:xe,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0}]);class Ht extends W.v{constructor(s){super(),this.targets=[],this.editionDefaults=[],this.uninterpretedOption=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new Ht().fromBinary(s,o)}static fromJson(s,o){return new Ht().fromJson(s,o)}static fromJsonString(s,o){return new Ht().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Ht,s,o)}}Ht.runtime=f,Ht.typeName="google.protobuf.FieldOptions",Ht.fields=f.util.newFieldList(()=>[{no:1,name:"ctype",kind:"enum",T:f.getEnumType(Dn),opt:!0,default:Dn.STRING},{no:2,name:"packed",kind:"scalar",T:8,opt:!0},{no:6,name:"jstype",kind:"enum",T:f.getEnumType(gn),opt:!0,default:gn.JS_NORMAL},{no:5,name:"lazy",kind:"scalar",T:8,opt:!0,default:!1},{no:15,name:"unverified_lazy",kind:"scalar",T:8,opt:!0,default:!1},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:10,name:"weak",kind:"scalar",T:8,opt:!0,default:!1},{no:16,name:"debug_redact",kind:"scalar",T:8,opt:!0,default:!1},{no:17,name:"retention",kind:"enum",T:f.getEnumType(Fn),opt:!0},{no:19,name:"targets",kind:"enum",T:f.getEnumType(Un),repeated:!0},{no:20,name:"edition_defaults",kind:"message",T:Ut,repeated:!0},{no:21,name:"features",kind:"message",T:xe,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0}]);var Dn;(function(a){a[a.STRING=0]="STRING",a[a.CORD=1]="CORD",a[a.STRING_PIECE=2]="STRING_PIECE"})(Dn||(Dn={})),f.util.setEnumType(Dn,"google.protobuf.FieldOptions.CType",[{no:0,name:"STRING"},{no:1,name:"CORD"},{no:2,name:"STRING_PIECE"}]);var gn;(function(a){a[a.JS_NORMAL=0]="JS_NORMAL",a[a.JS_STRING=1]="JS_STRING",a[a.JS_NUMBER=2]="JS_NUMBER"})(gn||(gn={})),f.util.setEnumType(gn,"google.protobuf.FieldOptions.JSType",[{no:0,name:"JS_NORMAL"},{no:1,name:"JS_STRING"},{no:2,name:"JS_NUMBER"}]);var Fn;(function(a){a[a.RETENTION_UNKNOWN=0]="RETENTION_UNKNOWN",a[a.RETENTION_RUNTIME=1]="RETENTION_RUNTIME",a[a.RETENTION_SOURCE=2]="RETENTION_SOURCE"})(Fn||(Fn={})),f.util.setEnumType(Fn,"google.protobuf.FieldOptions.OptionRetention",[{no:0,name:"RETENTION_UNKNOWN"},{no:1,name:"RETENTION_RUNTIME"},{no:2,name:"RETENTION_SOURCE"}]);var Un;(function(a){a[a.TARGET_TYPE_UNKNOWN=0]="TARGET_TYPE_UNKNOWN",a[a.TARGET_TYPE_FILE=1]="TARGET_TYPE_FILE",a[a.TARGET_TYPE_EXTENSION_RANGE=2]="TARGET_TYPE_EXTENSION_RANGE",a[a.TARGET_TYPE_MESSAGE=3]="TARGET_TYPE_MESSAGE",a[a.TARGET_TYPE_FIELD=4]="TARGET_TYPE_FIELD",a[a.TARGET_TYPE_ONEOF=5]="TARGET_TYPE_ONEOF",a[a.TARGET_TYPE_ENUM=6]="TARGET_TYPE_ENUM",a[a.TARGET_TYPE_ENUM_ENTRY=7]="TARGET_TYPE_ENUM_ENTRY",a[a.TARGET_TYPE_SERVICE=8]="TARGET_TYPE_SERVICE",a[a.TARGET_TYPE_METHOD=9]="TARGET_TYPE_METHOD"})(Un||(Un={})),f.util.setEnumType(Un,"google.protobuf.FieldOptions.OptionTargetType",[{no:0,name:"TARGET_TYPE_UNKNOWN"},{no:1,name:"TARGET_TYPE_FILE"},{no:2,name:"TARGET_TYPE_EXTENSION_RANGE"},{no:3,name:"TARGET_TYPE_MESSAGE"},{no:4,name:"TARGET_TYPE_FIELD"},{no:5,name:"TARGET_TYPE_ONEOF"},{no:6,name:"TARGET_TYPE_ENUM"},{no:7,name:"TARGET_TYPE_ENUM_ENTRY"},{no:8,name:"TARGET_TYPE_SERVICE"},{no:9,name:"TARGET_TYPE_METHOD"}]);class Ut extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new Ut().fromBinary(s,o)}static fromJson(s,o){return new Ut().fromJson(s,o)}static fromJsonString(s,o){return new Ut().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Ut,s,o)}}Ut.runtime=f,Ut.typeName="google.protobuf.FieldOptions.EditionDefault",Ut.fields=f.util.newFieldList(()=>[{no:3,name:"edition",kind:"enum",T:f.getEnumType(ne),opt:!0},{no:2,name:"value",kind:"scalar",T:9,opt:!0}]);class Zt extends W.v{constructor(s){super(),this.uninterpretedOption=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new Zt().fromBinary(s,o)}static fromJson(s,o){return new Zt().fromJson(s,o)}static fromJsonString(s,o){return new Zt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Zt,s,o)}}Zt.runtime=f,Zt.typeName="google.protobuf.OneofOptions",Zt.fields=f.util.newFieldList(()=>[{no:1,name:"features",kind:"message",T:xe,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0}]);class It extends W.v{constructor(s){super(),this.uninterpretedOption=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new It().fromBinary(s,o)}static fromJson(s,o){return new It().fromJson(s,o)}static fromJsonString(s,o){return new It().fromJsonString(s,o)}static equals(s,o){return f.util.equals(It,s,o)}}It.runtime=f,It.typeName="google.protobuf.EnumOptions",It.fields=f.util.newFieldList(()=>[{no:2,name:"allow_alias",kind:"scalar",T:8,opt:!0},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:6,name:"deprecated_legacy_json_field_conflicts",kind:"scalar",T:8,opt:!0},{no:7,name:"features",kind:"message",T:xe,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0}]);class Qt extends W.v{constructor(s){super(),this.uninterpretedOption=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new Qt().fromBinary(s,o)}static fromJson(s,o){return new Qt().fromJson(s,o)}static fromJsonString(s,o){return new Qt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Qt,s,o)}}Qt.runtime=f,Qt.typeName="google.protobuf.EnumValueOptions",Qt.fields=f.util.newFieldList(()=>[{no:1,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:2,name:"features",kind:"message",T:xe,opt:!0},{no:3,name:"debug_redact",kind:"scalar",T:8,opt:!0,default:!1},{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0}]);class He extends W.v{constructor(s){super(),this.uninterpretedOption=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new He().fromBinary(s,o)}static fromJson(s,o){return new He().fromJson(s,o)}static fromJsonString(s,o){return new He().fromJsonString(s,o)}static equals(s,o){return f.util.equals(He,s,o)}}He.runtime=f,He.typeName="google.protobuf.ServiceOptions",He.fields=f.util.newFieldList(()=>[{no:34,name:"features",kind:"message",T:xe,opt:!0},{no:33,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0}]);class en extends W.v{constructor(s){super(),this.uninterpretedOption=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new en().fromBinary(s,o)}static fromJson(s,o){return new en().fromJson(s,o)}static fromJsonString(s,o){return new en().fromJsonString(s,o)}static equals(s,o){return f.util.equals(en,s,o)}}en.runtime=f,en.typeName="google.protobuf.MethodOptions",en.fields=f.util.newFieldList(()=>[{no:33,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:34,name:"idempotency_level",kind:"enum",T:f.getEnumType(ln),opt:!0,default:ln.IDEMPOTENCY_UNKNOWN},{no:35,name:"features",kind:"message",T:xe,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ze,repeated:!0}]);var ln;(function(a){a[a.IDEMPOTENCY_UNKNOWN=0]="IDEMPOTENCY_UNKNOWN",a[a.NO_SIDE_EFFECTS=1]="NO_SIDE_EFFECTS",a[a.IDEMPOTENT=2]="IDEMPOTENT"})(ln||(ln={})),f.util.setEnumType(ln,"google.protobuf.MethodOptions.IdempotencyLevel",[{no:0,name:"IDEMPOTENCY_UNKNOWN"},{no:1,name:"NO_SIDE_EFFECTS"},{no:2,name:"IDEMPOTENT"}]);class Ze extends W.v{constructor(s){super(),this.name=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new Ze().fromBinary(s,o)}static fromJson(s,o){return new Ze().fromJson(s,o)}static fromJsonString(s,o){return new Ze().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Ze,s,o)}}Ze.runtime=f,Ze.typeName="google.protobuf.UninterpretedOption",Ze.fields=f.util.newFieldList(()=>[{no:2,name:"name",kind:"message",T:$t,repeated:!0},{no:3,name:"identifier_value",kind:"scalar",T:9,opt:!0},{no:4,name:"positive_int_value",kind:"scalar",T:4,opt:!0},{no:5,name:"negative_int_value",kind:"scalar",T:3,opt:!0},{no:6,name:"double_value",kind:"scalar",T:1,opt:!0},{no:7,name:"string_value",kind:"scalar",T:12,opt:!0},{no:8,name:"aggregate_value",kind:"scalar",T:9,opt:!0}]);class $t extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new $t().fromBinary(s,o)}static fromJson(s,o){return new $t().fromJson(s,o)}static fromJsonString(s,o){return new $t().fromJsonString(s,o)}static equals(s,o){return f.util.equals($t,s,o)}}$t.runtime=f,$t.typeName="google.protobuf.UninterpretedOption.NamePart",$t.fields=f.util.newFieldList(()=>[{no:1,name:"name_part",kind:"scalar",T:9},{no:2,name:"is_extension",kind:"scalar",T:8}]);class xe extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new xe().fromBinary(s,o)}static fromJson(s,o){return new xe().fromJson(s,o)}static fromJsonString(s,o){return new xe().fromJsonString(s,o)}static equals(s,o){return f.util.equals(xe,s,o)}}xe.runtime=f,xe.typeName="google.protobuf.FeatureSet",xe.fields=f.util.newFieldList(()=>[{no:1,name:"field_presence",kind:"enum",T:f.getEnumType(En),opt:!0},{no:2,name:"enum_type",kind:"enum",T:f.getEnumType(Cn),opt:!0},{no:3,name:"repeated_field_encoding",kind:"enum",T:f.getEnumType(pn),opt:!0},{no:4,name:"utf8_validation",kind:"enum",T:f.getEnumType($n),opt:!0},{no:5,name:"message_encoding",kind:"enum",T:f.getEnumType(Vt),opt:!0},{no:6,name:"json_format",kind:"enum",T:f.getEnumType(Vn),opt:!0}]);var En;(function(a){a[a.FIELD_PRESENCE_UNKNOWN=0]="FIELD_PRESENCE_UNKNOWN",a[a.EXPLICIT=1]="EXPLICIT",a[a.IMPLICIT=2]="IMPLICIT",a[a.LEGACY_REQUIRED=3]="LEGACY_REQUIRED"})(En||(En={})),f.util.setEnumType(En,"google.protobuf.FeatureSet.FieldPresence",[{no:0,name:"FIELD_PRESENCE_UNKNOWN"},{no:1,name:"EXPLICIT"},{no:2,name:"IMPLICIT"},{no:3,name:"LEGACY_REQUIRED"}]);var Cn;(function(a){a[a.ENUM_TYPE_UNKNOWN=0]="ENUM_TYPE_UNKNOWN",a[a.OPEN=1]="OPEN",a[a.CLOSED=2]="CLOSED"})(Cn||(Cn={})),f.util.setEnumType(Cn,"google.protobuf.FeatureSet.EnumType",[{no:0,name:"ENUM_TYPE_UNKNOWN"},{no:1,name:"OPEN"},{no:2,name:"CLOSED"}]);var pn;(function(a){a[a.REPEATED_FIELD_ENCODING_UNKNOWN=0]="REPEATED_FIELD_ENCODING_UNKNOWN",a[a.PACKED=1]="PACKED",a[a.EXPANDED=2]="EXPANDED"})(pn||(pn={})),f.util.setEnumType(pn,"google.protobuf.FeatureSet.RepeatedFieldEncoding",[{no:0,name:"REPEATED_FIELD_ENCODING_UNKNOWN"},{no:1,name:"PACKED"},{no:2,name:"EXPANDED"}]);var $n;(function(a){a[a.UTF8_VALIDATION_UNKNOWN=0]="UTF8_VALIDATION_UNKNOWN",a[a.NONE=1]="NONE",a[a.VERIFY=2]="VERIFY"})($n||($n={})),f.util.setEnumType($n,"google.protobuf.FeatureSet.Utf8Validation",[{no:0,name:"UTF8_VALIDATION_UNKNOWN"},{no:1,name:"NONE"},{no:2,name:"VERIFY"}]);var Vt;(function(a){a[a.MESSAGE_ENCODING_UNKNOWN=0]="MESSAGE_ENCODING_UNKNOWN",a[a.LENGTH_PREFIXED=1]="LENGTH_PREFIXED",a[a.DELIMITED=2]="DELIMITED"})(Vt||(Vt={})),f.util.setEnumType(Vt,"google.protobuf.FeatureSet.MessageEncoding",[{no:0,name:"MESSAGE_ENCODING_UNKNOWN"},{no:1,name:"LENGTH_PREFIXED"},{no:2,name:"DELIMITED"}]);var Vn;(function(a){a[a.JSON_FORMAT_UNKNOWN=0]="JSON_FORMAT_UNKNOWN",a[a.ALLOW=1]="ALLOW",a[a.LEGACY_BEST_EFFORT=2]="LEGACY_BEST_EFFORT"})(Vn||(Vn={})),f.util.setEnumType(Vn,"google.protobuf.FeatureSet.JsonFormat",[{no:0,name:"JSON_FORMAT_UNKNOWN"},{no:1,name:"ALLOW"},{no:2,name:"LEGACY_BEST_EFFORT"}]);class tn extends W.v{constructor(s){super(),this.defaults=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new tn().fromBinary(s,o)}static fromJson(s,o){return new tn().fromJson(s,o)}static fromJsonString(s,o){return new tn().fromJsonString(s,o)}static equals(s,o){return f.util.equals(tn,s,o)}}tn.runtime=f,tn.typeName="google.protobuf.FeatureSetDefaults",tn.fields=f.util.newFieldList(()=>[{no:1,name:"defaults",kind:"message",T:nn,repeated:!0},{no:4,name:"minimum_edition",kind:"enum",T:f.getEnumType(ne),opt:!0},{no:5,name:"maximum_edition",kind:"enum",T:f.getEnumType(ne),opt:!0}]);class nn extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new nn().fromBinary(s,o)}static fromJson(s,o){return new nn().fromJson(s,o)}static fromJsonString(s,o){return new nn().fromJsonString(s,o)}static equals(s,o){return f.util.equals(nn,s,o)}}nn.runtime=f,nn.typeName="google.protobuf.FeatureSetDefaults.FeatureSetEditionDefault",nn.fields=f.util.newFieldList(()=>[{no:3,name:"edition",kind:"enum",T:f.getEnumType(ne),opt:!0},{no:2,name:"features",kind:"message",T:xe,opt:!0}]);class M extends W.v{constructor(s){super(),this.location=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new M().fromBinary(s,o)}static fromJson(s,o){return new M().fromJson(s,o)}static fromJsonString(s,o){return new M().fromJsonString(s,o)}static equals(s,o){return f.util.equals(M,s,o)}}M.runtime=f,M.typeName="google.protobuf.SourceCodeInfo",M.fields=f.util.newFieldList(()=>[{no:1,name:"location",kind:"message",T:Fe,repeated:!0}]);class Fe extends W.v{constructor(s){super(),this.path=[],this.span=[],this.leadingDetachedComments=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new Fe().fromBinary(s,o)}static fromJson(s,o){return new Fe().fromJson(s,o)}static fromJsonString(s,o){return new Fe().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Fe,s,o)}}Fe.runtime=f,Fe.typeName="google.protobuf.SourceCodeInfo.Location",Fe.fields=f.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:5,repeated:!0,packed:!0},{no:2,name:"span",kind:"scalar",T:5,repeated:!0,packed:!0},{no:3,name:"leading_comments",kind:"scalar",T:9,opt:!0},{no:4,name:"trailing_comments",kind:"scalar",T:9,opt:!0},{no:6,name:"leading_detached_comments",kind:"scalar",T:9,repeated:!0}]);class ye extends W.v{constructor(s){super(),this.annotation=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new ye().fromBinary(s,o)}static fromJson(s,o){return new ye().fromJson(s,o)}static fromJsonString(s,o){return new ye().fromJsonString(s,o)}static equals(s,o){return f.util.equals(ye,s,o)}}ye.runtime=f,ye.typeName="google.protobuf.GeneratedCodeInfo",ye.fields=f.util.newFieldList(()=>[{no:1,name:"annotation",kind:"message",T:Oe,repeated:!0}]);class Oe extends W.v{constructor(s){super(),this.path=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new Oe().fromBinary(s,o)}static fromJson(s,o){return new Oe().fromJson(s,o)}static fromJsonString(s,o){return new Oe().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Oe,s,o)}}Oe.runtime=f,Oe.typeName="google.protobuf.GeneratedCodeInfo.Annotation",Oe.fields=f.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:5,repeated:!0,packed:!0},{no:2,name:"source_file",kind:"scalar",T:9,opt:!0},{no:3,name:"begin",kind:"scalar",T:5,opt:!0},{no:4,name:"end",kind:"scalar",T:5,opt:!0},{no:5,name:"semantic",kind:"enum",T:f.getEnumType(Rn),opt:!0}]);var Rn;(function(a){a[a.NONE=0]="NONE",a[a.SET=1]="SET",a[a.ALIAS=2]="ALIAS"})(Rn||(Rn={})),f.util.setEnumType(Rn,"google.protobuf.GeneratedCodeInfo.Annotation.Semantic",[{no:0,name:"NONE"},{no:1,name:"SET"},{no:2,name:"ALIAS"}]);function pr(a,s){const o=a.values.find(h=>h.name===s);return(0,k.hu)(o,`cannot parse ${a.name} default value: ${s}`),o.number}function yr(a,s){switch(a){case m.w.STRING:return s;case m.w.BYTES:{const o=Nn(s);if(o===!1)throw new Error(`cannot parse ${m.w[a]} default value: ${s}`);return o}case m.w.INT64:case m.w.SFIXED64:case m.w.SINT64:return w.q.parse(s);case m.w.UINT64:case m.w.FIXED64:return w.q.uParse(s);case m.w.DOUBLE:case m.w.FLOAT:switch(s){case"inf":return Number.POSITIVE_INFINITY;case"-inf":return Number.NEGATIVE_INFINITY;case"nan":return Number.NaN;default:return parseFloat(s)}case m.w.BOOL:return s==="true";case m.w.INT32:case m.w.UINT32:case m.w.SINT32:case m.w.FIXED32:case m.w.SFIXED32:return parseInt(s,10)}}function Nn(a){const s=[],o={tail:a,c:"",next(){return this.tail.length==0?!1:(this.c=this.tail[0],this.tail=this.tail.substring(1),!0)},take(h){if(this.tail.length>=h){const p=this.tail.substring(0,h);return this.tail=this.tail.substring(h),p}return!1}};for(;o.next();)switch(o.c){case"\\":if(o.next())switch(o.c){case"\\":s.push(o.c.charCodeAt(0));break;case"b":s.push(8);break;case"f":s.push(12);break;case"n":s.push(10);break;case"r":s.push(13);break;case"t":s.push(9);break;case"v":s.push(11);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":{const h=o.c,p=o.take(2);if(p===!1)return!1;const N=parseInt(h+p,8);if(isNaN(N))return!1;s.push(N);break}case"x":{const h=o.c,p=o.take(2);if(p===!1)return!1;const N=parseInt(h+p,16);if(isNaN(N))return!1;s.push(N);break}case"u":{const h=o.c,p=o.take(4);if(p===!1)return!1;const N=parseInt(h+p,16);if(isNaN(N))return!1;const I=new Uint8Array(4);new DataView(I.buffer).setInt32(0,N,!0),s.push(I[0],I[1],I[2],I[3]);break}case"U":{const h=o.c,p=o.take(8);if(p===!1)return!1;const N=w.q.uEnc(h+p),I=new Uint8Array(8),j=new DataView(I.buffer);j.setInt32(0,N.lo,!0),j.setInt32(4,N.hi,!0),s.push(I[0],I[1],I[2],I[3],I[4],I[5],I[6],I[7]);break}}break;default:s.push(o.c.charCodeAt(0))}return new Uint8Array(s)}const _t=tn.fromBinary($.W.dec("ChESDAgBEAIYAiABKAEwAhjmBwoREgwIAhABGAEgAigBMAEY5wcKERIMCAEQARgBIAIoATABGOgHIOYHKOgH"));function Se(a){const s=a.minimumEdition,o=a.maximumEdition;if(s===void 0||o===void 0||a.defaults.some(p=>p.edition===void 0))throw new Error("Invalid FeatureSetDefaults");const h=new Map;return(p,...N)=>{var I,j;let P=h.get(p);if(P===void 0){if(p<s)throw new Error(`Edition ${ne[p]} is earlier than the minimum supported edition ${ne[s]}`);if(o<p)throw new Error(`Edition ${ne[p]} is later than the maximum supported edition ${ne[o]}`);let H;for(const se of a.defaults){const De=(I=se.edition)!==null&&I!==void 0?I:0;De>p||H!==void 0&&H.e>De||(H={e:De,f:(j=se.features)!==null&&j!==void 0?j:new xe})}if(H===void 0)throw new Error(`No valid default found for edition ${ne[p]}`);P=H.f.toBinary(),h.set(p,P)}const X=xe.fromBinary(P);for(const H of N)H!==void 0&&X.fromBinary(H.toBinary());if(!zn(X))throw new Error(`Invalid FeatureSet for edition ${ne[p]}`);return X}}function zn(a){for(const s of xe.fields.list()){const o=a[s.localName];if(o===void 0||s.kind=="enum"&&o===0)return!1}return!0}function Xn(a,s){var o;const h={enums:new Map,messages:new Map,services:new Map,extensions:new Map,mapEntries:new Map,resolveFeatures:Se((o=s==null?void 0:s.featureSetDefaults)!==null&&o!==void 0?o:_t)},N=(a instanceof ue?a.file:a instanceof Uint8Array?ue.fromBinary(a).file:a).map(I=>jt(I,h));return Object.assign({files:N},h)}function jt(a,s){var o,h;(0,k.hu)(a.name,"invalid FileDescriptorProto: missing name");const p=Object.assign(Object.assign({kind:"file",proto:a,deprecated:(h=(o=a.options)===null||o===void 0?void 0:o.deprecated)!==null&&h!==void 0?h:!1},wr(a.syntax,a.edition)),{name:a.name.replace(/\.proto/,""),enums:[],messages:[],extensions:[],services:[],toString(){return`file ${this.proto.name}`},getSyntaxComments(){return qe(this.proto.sourceCodeInfo,[st.FileDescriptorProto_Syntax])},getPackageComments(){return qe(this.proto.sourceCodeInfo,[st.FileDescriptorProto_Package])},getFeatures(){var N;return s.resolveFeatures(this.edition,(N=this.proto.options)===null||N===void 0?void 0:N.features)}});s.mapEntries.clear();for(const N of a.enumType)bn(N,p,void 0,s);for(const N of a.messageType)cr(N,p,void 0,s);for(const N of a.service)Tr(N,p,s);Hn(p,s);for(const N of s.mapEntries.values())ur(N,s);for(const N of p.messages)ur(N,s),Hn(N,s);return s.mapEntries.clear(),p}function Hn(a,s){switch(a.kind){case"file":for(const o of a.proto.extension){const h=Sn(o,a,void 0,s);a.extensions.push(h),s.extensions.set(h.typeName,h)}break;case"message":for(const o of a.proto.extension){const h=Sn(o,a.file,a,s);a.nestedExtensions.push(h),s.extensions.set(h.typeName,h)}for(const o of a.nestedMessages)Hn(o,s);break}}function ur(a,s){const o=a.proto.oneofDecl.map(p=>Yt(p,a,s)),h=new Set;for(const p of a.proto.field){const N=gt(p,o),I=rn(p,a.file,a,N,s);a.fields.push(I),N===void 0?a.members.push(I):(N.fields.push(I),h.has(N)||(h.add(N),a.members.push(N)))}for(const p of o.filter(N=>h.has(N)))a.oneofs.push(p);for(const p of a.nestedMessages)ur(p,s)}function bn(a,s,o,h){var p,N,I;(0,k.hu)(a.name,"invalid EnumDescriptorProto: missing name");const j={kind:"enum",proto:a,deprecated:(N=(p=a.options)===null||p===void 0?void 0:p.deprecated)!==null&&N!==void 0?N:!1,file:s,parent:o,name:a.name,typeName:xn(a,o,s),values:[],sharedPrefix:(0,y.Sm)(a.name,a.value.map(P=>{var X;return(X=P.name)!==null&&X!==void 0?X:""})),toString(){return`enum ${this.typeName}`},getComments(){const P=this.parent?[...this.parent.getComments().sourcePath,st.DescriptorProto_EnumType,this.parent.proto.enumType.indexOf(this.proto)]:[st.FileDescriptorProto_EnumType,this.file.proto.enumType.indexOf(this.proto)];return qe(s.proto.sourceCodeInfo,P)},getFeatures(){var P,X,H;const se=(X=(P=this.parent)===null||P===void 0?void 0:P.getFeatures())!==null&&X!==void 0?X:this.file.getFeatures();return h.resolveFeatures(this.file.edition,se,(H=this.proto.options)===null||H===void 0?void 0:H.features)}};h.enums.set(j.typeName,j),a.value.forEach(P=>{var X,H;(0,k.hu)(P.name,"invalid EnumValueDescriptorProto: missing name"),(0,k.hu)(P.number!==void 0,"invalid EnumValueDescriptorProto: missing number"),j.values.push({kind:"enum_value",proto:P,deprecated:(H=(X=P.options)===null||X===void 0?void 0:X.deprecated)!==null&&H!==void 0?H:!1,parent:j,name:P.name,number:P.number,toString(){return`enum value ${j.typeName}.${this.name}`},declarationString(){var se;let De=`${this.name} = ${this.number}`;return((se=this.proto.options)===null||se===void 0?void 0:se.deprecated)===!0&&(De+=" [deprecated = true]"),De},getComments(){const se=[...this.parent.getComments().sourcePath,st.EnumDescriptorProto_Value,this.parent.proto.value.indexOf(this.proto)];return qe(s.proto.sourceCodeInfo,se)},getFeatures(){var se;return h.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),(se=this.proto.options)===null||se===void 0?void 0:se.features)}})}),((I=o==null?void 0:o.nestedEnums)!==null&&I!==void 0?I:s.enums).push(j)}function cr(a,s,o,h){var p,N,I,j;(0,k.hu)(a.name,"invalid DescriptorProto: missing name");const P={kind:"message",proto:a,deprecated:(N=(p=a.options)===null||p===void 0?void 0:p.deprecated)!==null&&N!==void 0?N:!1,file:s,parent:o,name:a.name,typeName:xn(a,o,s),fields:[],oneofs:[],members:[],nestedEnums:[],nestedMessages:[],nestedExtensions:[],toString(){return`message ${this.typeName}`},getComments(){const X=this.parent?[...this.parent.getComments().sourcePath,st.DescriptorProto_NestedType,this.parent.proto.nestedType.indexOf(this.proto)]:[st.FileDescriptorProto_MessageType,this.file.proto.messageType.indexOf(this.proto)];return qe(s.proto.sourceCodeInfo,X)},getFeatures(){var X,H,se;const De=(H=(X=this.parent)===null||X===void 0?void 0:X.getFeatures())!==null&&H!==void 0?H:this.file.getFeatures();return h.resolveFeatures(this.file.edition,De,(se=this.proto.options)===null||se===void 0?void 0:se.features)}};((I=a.options)===null||I===void 0?void 0:I.mapEntry)===!0?h.mapEntries.set(P.typeName,P):(((j=o==null?void 0:o.nestedMessages)!==null&&j!==void 0?j:s.messages).push(P),h.messages.set(P.typeName,P));for(const X of a.enumType)bn(X,s,P,h);for(const X of a.nestedType)cr(X,s,P,h)}function Tr(a,s,o){var h,p;(0,k.hu)(a.name,"invalid ServiceDescriptorProto: missing name");const N={kind:"service",proto:a,deprecated:(p=(h=a.options)===null||h===void 0?void 0:h.deprecated)!==null&&p!==void 0?p:!1,file:s,name:a.name,typeName:xn(a,void 0,s),methods:[],toString(){return`service ${this.typeName}`},getComments(){const I=[st.FileDescriptorProto_Service,this.file.proto.service.indexOf(this.proto)];return qe(s.proto.sourceCodeInfo,I)},getFeatures(){var I;return o.resolveFeatures(this.file.edition,this.file.getFeatures(),(I=this.proto.options)===null||I===void 0?void 0:I.features)}};s.services.push(N),o.services.set(N.typeName,N);for(const I of a.method)N.methods.push(vr(I,N,o))}function vr(a,s,o){var h,p,N;(0,k.hu)(a.name,"invalid MethodDescriptorProto: missing name"),(0,k.hu)(a.inputType,"invalid MethodDescriptorProto: missing input_type"),(0,k.hu)(a.outputType,"invalid MethodDescriptorProto: missing output_type");let I;a.clientStreaming===!0&&a.serverStreaming===!0?I=Ee.t.BiDiStreaming:a.clientStreaming===!0?I=Ee.t.ClientStreaming:a.serverStreaming===!0?I=Ee.t.ServerStreaming:I=Ee.t.Unary;let j;switch((h=a.options)===null||h===void 0?void 0:h.idempotencyLevel){case ln.IDEMPOTENT:j=Ee.w.Idempotent;break;case ln.NO_SIDE_EFFECTS:j=Ee.w.NoSideEffects;break;case ln.IDEMPOTENCY_UNKNOWN:case void 0:j=void 0;break}const P=o.messages.get(In(a.inputType)),X=o.messages.get(In(a.outputType));(0,k.hu)(P,`invalid MethodDescriptorProto: input_type ${a.inputType} not found`),(0,k.hu)(X,`invalid MethodDescriptorProto: output_type ${a.inputType} not found`);const H=a.name;return{kind:"rpc",proto:a,deprecated:(N=(p=a.options)===null||p===void 0?void 0:p.deprecated)!==null&&N!==void 0?N:!1,parent:s,name:H,methodKind:I,input:P,output:X,idempotency:j,toString(){return`rpc ${s.typeName}.${H}`},getComments(){const se=[...this.parent.getComments().sourcePath,st.ServiceDescriptorProto_Method,this.parent.proto.method.indexOf(this.proto)];return qe(s.file.proto.sourceCodeInfo,se)},getFeatures(){var se;return o.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),(se=this.proto.options)===null||se===void 0?void 0:se.features)}}}function Yt(a,s,o){return(0,k.hu)(a.name,"invalid OneofDescriptorProto: missing name"),{kind:"oneof",proto:a,deprecated:!1,parent:s,fields:[],name:a.name,toString(){return`oneof ${s.typeName}.${this.name}`},getComments(){const h=[...this.parent.getComments().sourcePath,st.DescriptorProto_OneofDecl,this.parent.proto.oneofDecl.indexOf(this.proto)];return qe(s.file.proto.sourceCodeInfo,h)},getFeatures(){var h;return o.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),(h=this.proto.options)===null||h===void 0?void 0:h.features)}}}function rn(a,s,o,h,p){var N,I,j;(0,k.hu)(a.name,"invalid FieldDescriptorProto: missing name"),(0,k.hu)(a.number,"invalid FieldDescriptorProto: missing number"),(0,k.hu)(a.type,"invalid FieldDescriptorProto: missing type");const P={proto:a,deprecated:(I=(N=a.options)===null||N===void 0?void 0:N.deprecated)!==null&&I!==void 0?I:!1,name:a.name,number:a.number,parent:o,oneof:h,optional:G(a,s.syntax),packedByDefault:Ye(s,a,p.resolveFeatures),packed:Ne(s,o,a,p.resolveFeatures),jsonName:a.jsonName===(0,y.x1)(a.name)?void 0:a.jsonName,scalar:void 0,longType:void 0,message:void 0,enum:void 0,mapKey:void 0,mapValue:void 0,declarationString:_n,toString(){return`field ${this.parent.typeName}.${this.name}`},getComments(){const H=[...this.parent.getComments().sourcePath,st.DescriptorProto_Field,this.parent.proto.field.indexOf(this.proto)];return qe(s.proto.sourceCodeInfo,H)},getFeatures(){var H;return p.resolveFeatures(s.edition,this.parent.getFeatures(),(H=this.proto.options)===null||H===void 0?void 0:H.features)}},X=a.label===Rt.REPEATED;switch(a.type){case de.MESSAGE:case de.GROUP:{(0,k.hu)(a.typeName,"invalid FieldDescriptorProto: missing type_name");const H=p.mapEntries.get(In(a.typeName));if(H!==void 0)return(0,k.hu)(X,"invalid FieldDescriptorProto: expected map entry to be repeated"),Object.assign(Object.assign(Object.assign({},P),{kind:"field",fieldKind:"map",repeated:!1}),Er(H));const se=p.messages.get(In(a.typeName));return(0,k.hu)(se!==void 0,`invalid FieldDescriptorProto: type_name ${a.typeName} not found`),Object.assign(Object.assign({},P),{kind:"field",fieldKind:"message",repeated:X,message:se})}case de.ENUM:{(0,k.hu)(a.typeName,"invalid FieldDescriptorProto: missing type_name");const H=p.enums.get(In(a.typeName));return(0,k.hu)(H!==void 0,`invalid FieldDescriptorProto: type_name ${a.typeName} not found`),Object.assign(Object.assign({},P),{kind:"field",fieldKind:"enum",getDefaultValue:kn,repeated:X,enum:H})}default:{const H=Ie[a.type];return(0,k.hu)(H,`invalid FieldDescriptorProto: unknown type ${a.type}`),Object.assign(Object.assign({},P),{kind:"field",fieldKind:"scalar",getDefaultValue:kn,repeated:X,scalar:H,longType:((j=a.options)===null||j===void 0?void 0:j.jstype)==gn.JS_STRING?m.p.STRING:m.p.BIGINT})}}}function Sn(a,s,o,h){(0,k.hu)(a.extendee,"invalid FieldDescriptorProto: missing extendee");const p=rn(a,s,null,void 0,h),N=h.messages.get(In(a.extendee));return(0,k.hu)(N,`invalid FieldDescriptorProto: extendee ${a.extendee} not found`),Object.assign(Object.assign({},p),{kind:"extension",typeName:xn(a,o,s),parent:o,file:s,extendee:N,toString(){return`extension ${this.typeName}`},getComments(){const I=this.parent?[...this.parent.getComments().sourcePath,st.DescriptorProto_Extension,this.parent.proto.extension.indexOf(a)]:[st.FileDescriptorProto_Extension,this.file.proto.extension.indexOf(a)];return qe(s.proto.sourceCodeInfo,I)},getFeatures(){var I,j;return h.resolveFeatures(this.file.edition,((I=this.parent)!==null&&I!==void 0?I:this.file).getFeatures(),(j=this.proto.options)===null||j===void 0?void 0:j.features)}})}function wr(a,s){let o,h;switch(a){case void 0:case"proto2":h="proto2",o=ne.EDITION_PROTO2;break;case"proto3":h="proto3",o=ne.EDITION_PROTO3;break;case"editions":switch(h="editions",s){case void 0:case ne.EDITION_1_TEST_ONLY:case ne.EDITION_2_TEST_ONLY:case ne.EDITION_99997_TEST_ONLY:case ne.EDITION_99998_TEST_ONLY:case ne.EDITION_99999_TEST_ONLY:case ne.EDITION_UNKNOWN:o=ne.EDITION_UNKNOWN;break;default:o=s;break}break;default:throw new Error(`invalid FileDescriptorProto: unsupported syntax: ${a}`)}if(a==="editions"&&s===ne.EDITION_UNKNOWN)throw new Error(`invalid FileDescriptorProto: syntax ${a} cannot have edition ${String(s)}`);return{syntax:h,edition:o}}function xn(a,s,o){(0,k.hu)(a.name,`invalid ${a.getType().typeName}: missing name`);let h;return s?h=`${s.typeName}.${a.name}`:o.proto.package!==void 0?h=`${o.proto.package}.${a.name}`:h=`${a.name}`,h}function In(a){return a.startsWith(".")?a.substring(1):a}function Er(a){var s,o;(0,k.hu)((s=a.proto.options)===null||s===void 0?void 0:s.mapEntry,`invalid DescriptorProto: expected ${a.toString()} to be a map entry`),(0,k.hu)(a.fields.length===2,`invalid DescriptorProto: map entry ${a.toString()} has ${a.fields.length} fields`);const h=a.fields.find(I=>I.proto.number===1);(0,k.hu)(h,`invalid DescriptorProto: map entry ${a.toString()} is missing key field`);const p=h.scalar;(0,k.hu)(p!==void 0&&p!==m.w.BYTES&&p!==m.w.FLOAT&&p!==m.w.DOUBLE,`invalid DescriptorProto: map entry ${a.toString()} has unexpected key type ${(o=h.proto.type)!==null&&o!==void 0?o:-1}`);const N=a.fields.find(I=>I.proto.number===2);switch((0,k.hu)(N,`invalid DescriptorProto: map entry ${a.toString()} is missing value field`),N.fieldKind){case"scalar":return{mapKey:p,mapValue:Object.assign(Object.assign({},N),{kind:"scalar"})};case"message":return{mapKey:p,mapValue:Object.assign(Object.assign({},N),{kind:"message"})};case"enum":return{mapKey:p,mapValue:Object.assign(Object.assign({},N),{kind:"enum"})};default:throw new Error("invalid DescriptorProto: unsupported map entry value field")}}function gt(a,s){var o;const h=a.oneofIndex;if(h===void 0)return;let p;return a.proto3Optional!==!0&&(p=s[h],(0,k.hu)(p,`invalid FieldDescriptorProto: oneof #${h} for field #${(o=a.number)!==null&&o!==void 0?o:-1} not found`)),p}function G(a,s){switch(s){case"proto2":return a.oneofIndex===void 0&&a.label===Rt.OPTIONAL;case"proto3":return a.proto3Optional===!0;case"editions":return!1}}function Ye(a,s,o){const{repeatedFieldEncoding:h}=o(a.edition);if(h!=pn.PACKED)return!1;switch(s.type){case de.STRING:case de.BYTES:case de.GROUP:case de.MESSAGE:return!1;default:return!0}}function Ne(a,s,o,h){var p,N,I,j,P,X;switch(o.type){case de.STRING:case de.BYTES:case de.GROUP:case de.MESSAGE:return!1;default:switch(a.edition){case ne.EDITION_PROTO2:return(N=(p=o.options)===null||p===void 0?void 0:p.packed)!==null&&N!==void 0?N:!1;case ne.EDITION_PROTO3:return(j=(I=o.options)===null||I===void 0?void 0:I.packed)!==null&&j!==void 0?j:!0;default:{const{repeatedFieldEncoding:H}=h(a.edition,(P=s==null?void 0:s.getFeatures())!==null&&P!==void 0?P:a.getFeatures(),(X=o.options)===null||X===void 0?void 0:X.features);return H==pn.PACKED}}}}const Ie={[de.DOUBLE]:m.w.DOUBLE,[de.FLOAT]:m.w.FLOAT,[de.INT64]:m.w.INT64,[de.UINT64]:m.w.UINT64,[de.INT32]:m.w.INT32,[de.FIXED64]:m.w.FIXED64,[de.FIXED32]:m.w.FIXED32,[de.BOOL]:m.w.BOOL,[de.STRING]:m.w.STRING,[de.GROUP]:void 0,[de.MESSAGE]:void 0,[de.BYTES]:m.w.BYTES,[de.UINT32]:m.w.UINT32,[de.ENUM]:void 0,[de.SFIXED32]:m.w.SFIXED32,[de.SFIXED64]:m.w.SFIXED64,[de.SINT32]:m.w.SINT32,[de.SINT64]:m.w.SINT64};function qe(a,s){if(!a)return{leadingDetached:[],sourcePath:s};for(const o of a.location)if(o.path.length===s.length&&!o.path.some((h,p)=>s[p]!==h))return{leadingDetached:o.leadingDetachedComments,leading:o.leadingComments,trailing:o.trailingComments,sourcePath:s};return{leadingDetached:[],sourcePath:s}}var st;(function(a){a[a.FileDescriptorProto_Package=2]="FileDescriptorProto_Package",a[a.FileDescriptorProto_MessageType=4]="FileDescriptorProto_MessageType",a[a.FileDescriptorProto_EnumType=5]="FileDescriptorProto_EnumType",a[a.FileDescriptorProto_Service=6]="FileDescriptorProto_Service",a[a.FileDescriptorProto_Extension=7]="FileDescriptorProto_Extension",a[a.FileDescriptorProto_Syntax=12]="FileDescriptorProto_Syntax",a[a.DescriptorProto_Field=2]="DescriptorProto_Field",a[a.DescriptorProto_NestedType=3]="DescriptorProto_NestedType",a[a.DescriptorProto_EnumType=4]="DescriptorProto_EnumType",a[a.DescriptorProto_Extension=6]="DescriptorProto_Extension",a[a.DescriptorProto_OneofDecl=8]="DescriptorProto_OneofDecl",a[a.EnumDescriptorProto_Value=2]="EnumDescriptorProto_Value",a[a.ServiceDescriptorProto_Method=2]="ServiceDescriptorProto_Method"})(st||(st={}));function _n(){var a,s,o;const h=[];this.repeated&&h.push("repeated"),this.optional&&h.push("optional"),(this.kind==="extension"?this.file:this.parent.file).syntax=="proto2"&&this.proto.label===Rt.REQUIRED&&h.push("required");let N;switch(this.fieldKind){case"scalar":N=m.w[this.scalar].toLowerCase();break;case"enum":N=this.enum.typeName;break;case"message":N=this.message.typeName;break;case"map":{const P=m.w[this.mapKey].toLowerCase();let X;switch(this.mapValue.kind){case"scalar":X=m.w[this.mapValue.scalar].toLowerCase();break;case"enum":X=this.mapValue.enum.typeName;break;case"message":X=this.mapValue.message.typeName;break}N=`map<${P}, ${X}>`;break}}h.push(`${N} ${this.name} = ${this.number}`);const I=[];((a=this.proto.options)===null||a===void 0?void 0:a.packed)!==void 0&&I.push(`packed = ${this.proto.options.packed.toString()}`);let j=this.proto.defaultValue;return j!==void 0&&((this.proto.type==de.BYTES||this.proto.type==de.STRING)&&(j='"'+j.replace('"','\\"')+'"'),I.push(`default = ${j}`)),this.jsonName!==void 0&&I.push(`json_name = "${this.jsonName}"`),((s=this.proto.options)===null||s===void 0?void 0:s.jstype)!==void 0&&I.push(`jstype = ${gn[this.proto.options.jstype]}`),((o=this.proto.options)===null||o===void 0?void 0:o.deprecated)===!0&&I.push("deprecated = true"),I.length>0&&h.push("["+I.join(", ")+"]"),h.join(" ")}function kn(){const a=this.proto.defaultValue;if(a!==void 0)switch(this.fieldKind){case"enum":return pr(this.enum,a);case"scalar":return yr(this.scalar,a);default:return}}function qt(...a){const s={},o={},h={},p={add(N){if("fields"in N){if(!this.findMessage(N.typeName)){s[N.typeName]=N;for(const I of N.fields.list())I.kind=="message"?this.add(I.T):I.kind=="map"&&I.V.kind=="message"?this.add(I.V.T):I.kind=="enum"&&this.add(I.T)}}else if("methods"in N){if(!this.findService(N.typeName)){h[N.typeName]=N;for(const I of Object.values(N.methods))this.add(I.I),this.add(I.O)}}else o[N.typeName]=N},findMessage(N){return s[N]},findEnum(N){return o[N]},findService(N){return h[N]}};for(const N of a)p.add(N);return p}class pt extends W.v{constructor(s){super(),this.seconds=w.q.zero,this.nanos=0,l.w.util.initPartial(s,this)}fromJson(s,o){if(typeof s!="string")throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${l.w.json.debug(s)}`);const h=s.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!h)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const p=Date.parse(h[1]+"-"+h[2]+"-"+h[3]+"T"+h[4]+":"+h[5]+":"+h[6]+(h[8]?h[8]:"Z"));if(Number.isNaN(p))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(p<Date.parse("0001-01-01T00:00:00Z")||p>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=w.q.parse(p/1e3),this.nanos=0,h[7]&&(this.nanos=parseInt("1"+h[7]+"0".repeat(9-h[7].length))-1e9),this}toJson(s){const o=Number(this.seconds)*1e3;if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let h="Z";if(this.nanos>0){const p=(this.nanos+1e9).toString().substring(1);p.substring(3)==="000000"?h="."+p.substring(0,3)+"Z":p.substring(6)==="000"?h="."+p.substring(0,6)+"Z":h="."+p+"Z"}return new Date(o).toISOString().replace(".000Z",h)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return pt.fromDate(new Date)}static fromDate(s){const o=s.getTime();return new pt({seconds:w.q.parse(Math.floor(o/1e3)),nanos:o%1e3*1e6})}static fromBinary(s,o){return new pt().fromBinary(s,o)}static fromJson(s,o){return new pt().fromJson(s,o)}static fromJsonString(s,o){return new pt().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(pt,s,o)}}pt.runtime=l.w,pt.typeName="google.protobuf.Timestamp",pt.fields=l.w.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class yt extends W.v{constructor(s){super(),this.seconds=w.q.zero,this.nanos=0,l.w.util.initPartial(s,this)}fromJson(s,o){if(typeof s!="string")throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.w.json.debug(s)}`);const h=s.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(h===null)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.w.json.debug(s)}`);const p=Number(h[1]);if(p>315576e6||p<-315576e6)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.w.json.debug(s)}`);if(this.seconds=w.q.parse(p),typeof h[2]=="string"){const N=h[2]+"0".repeat(9-h[2].length);this.nanos=parseInt(N),(p<0||Object.is(p,-0))&&(this.nanos=-this.nanos)}return this}toJson(s){if(Number(this.seconds)>315576e6||Number(this.seconds)<-315576e6)throw new Error("cannot encode google.protobuf.Duration to JSON: value out of range");let o=this.seconds.toString();if(this.nanos!==0){let h=Math.abs(this.nanos).toString();h="0".repeat(9-h.length)+h,h.substring(3)==="000000"?h=h.substring(0,3):h.substring(6)==="000"&&(h=h.substring(0,6)),o+="."+h,this.nanos<0&&Number(this.seconds)==0&&(o="-"+o)}return o+"s"}static fromBinary(s,o){return new yt().fromBinary(s,o)}static fromJson(s,o){return new yt().fromJson(s,o)}static fromJsonString(s,o){return new yt().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(yt,s,o)}}yt.runtime=l.w,yt.typeName="google.protobuf.Duration",yt.fields=l.w.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var lr=D(733);class Ce extends W.v{constructor(s){super(),l.w.util.initPartial(s,this)}static fromBinary(s,o){return new Ce().fromBinary(s,o)}static fromJson(s,o){return new Ce().fromJson(s,o)}static fromJsonString(s,o){return new Ce().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Ce,s,o)}}Ce.runtime=l.w,Ce.typeName="google.protobuf.Empty",Ce.fields=l.w.util.newFieldList(()=>[]);class Lt extends W.v{constructor(s){super(),this.paths=[],l.w.util.initPartial(s,this)}toJson(s){function o(h){let p=!1;const N=[];for(let I=0;I<h.length;I++){let j=h.charAt(I);switch(j){case"_":p=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":N.push(j),p=!1;break;default:p&&(p=!1,j=j.toUpperCase()),N.push(j);break}}return N.join("")}return this.paths.map(h=>{if(h.match(/_[0-9]?_/g)||h.match(/[A-Z]/g))throw new Error('cannot encode google.protobuf.FieldMask to JSON: lowerCamelCase of path name "'+h+'" is irreversible');return o(h)}).join(",")}fromJson(s,o){if(typeof s!="string")throw new Error("cannot decode google.protobuf.FieldMask from JSON: "+l.w.json.debug(s));if(s==="")return this;function h(p){if(p.includes("_"))throw new Error("cannot decode google.protobuf.FieldMask from JSON: path names must be lowerCamelCase");const N=p.replace(/[A-Z]/g,I=>"_"+I.toLowerCase());return N[0]==="_"?N.substring(1):N}return this.paths=s.split(",").map(h),this}static fromBinary(s,o){return new Lt().fromBinary(s,o)}static fromJson(s,o){return new Lt().fromJson(s,o)}static fromJsonString(s,o){return new Lt().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Lt,s,o)}}Lt.runtime=l.w,Lt.typeName="google.protobuf.FieldMask",Lt.fields=l.w.util.newFieldList(()=>[{no:1,name:"paths",kind:"scalar",T:9,repeated:!0}]);var An;(function(a){a[a.NULL_VALUE=0]="NULL_VALUE"})(An||(An={})),l.w.util.setEnumType(An,"google.protobuf.NullValue",[{no:0,name:"NULL_VALUE"}]);class Bt extends W.v{constructor(s){super(),this.fields={},l.w.util.initPartial(s,this)}toJson(s){const o={};for(const[h,p]of Object.entries(this.fields))o[h]=p.toJson(s);return o}fromJson(s,o){if(typeof s!="object"||s==null||Array.isArray(s))throw new Error("cannot decode google.protobuf.Struct from JSON "+l.w.json.debug(s));for(const[h,p]of Object.entries(s))this.fields[h]=Be.fromJson(p);return this}static fromBinary(s,o){return new Bt().fromBinary(s,o)}static fromJson(s,o){return new Bt().fromJson(s,o)}static fromJsonString(s,o){return new Bt().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Bt,s,o)}}Bt.runtime=l.w,Bt.typeName="google.protobuf.Struct",Bt.fields=l.w.util.newFieldList(()=>[{no:1,name:"fields",kind:"map",K:9,V:{kind:"message",T:Be}}]);class Be extends W.v{constructor(s){super(),this.kind={case:void 0},l.w.util.initPartial(s,this)}toJson(s){switch(this.kind.case){case"nullValue":return null;case"numberValue":if(!Number.isFinite(this.kind.value))throw new Error("google.protobuf.Value cannot be NaN or Infinity");return this.kind.value;case"boolValue":return this.kind.value;case"stringValue":return this.kind.value;case"structValue":case"listValue":return this.kind.value.toJson(Object.assign(Object.assign({},s),{emitDefaultValues:!0}))}throw new Error("google.protobuf.Value must have a value")}fromJson(s,o){switch(typeof s){case"number":this.kind={case:"numberValue",value:s};break;case"string":this.kind={case:"stringValue",value:s};break;case"boolean":this.kind={case:"boolValue",value:s};break;case"object":s===null?this.kind={case:"nullValue",value:An.NULL_VALUE}:Array.isArray(s)?this.kind={case:"listValue",value:Tt.fromJson(s)}:this.kind={case:"structValue",value:Bt.fromJson(s)};break;default:throw new Error("cannot decode google.protobuf.Value from JSON "+l.w.json.debug(s))}return this}static fromBinary(s,o){return new Be().fromBinary(s,o)}static fromJson(s,o){return new Be().fromJson(s,o)}static fromJsonString(s,o){return new Be().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Be,s,o)}}Be.runtime=l.w,Be.typeName="google.protobuf.Value",Be.fields=l.w.util.newFieldList(()=>[{no:1,name:"null_value",kind:"enum",T:l.w.getEnumType(An),oneof:"kind"},{no:2,name:"number_value",kind:"scalar",T:1,oneof:"kind"},{no:3,name:"string_value",kind:"scalar",T:9,oneof:"kind"},{no:4,name:"bool_value",kind:"scalar",T:8,oneof:"kind"},{no:5,name:"struct_value",kind:"message",T:Bt,oneof:"kind"},{no:6,name:"list_value",kind:"message",T:Tt,oneof:"kind"}]);class Tt extends W.v{constructor(s){super(),this.values=[],l.w.util.initPartial(s,this)}toJson(s){return this.values.map(o=>o.toJson())}fromJson(s,o){if(!Array.isArray(s))throw new Error("cannot decode google.protobuf.ListValue from JSON "+l.w.json.debug(s));for(let h of s)this.values.push(Be.fromJson(h));return this}static fromBinary(s,o){return new Tt().fromBinary(s,o)}static fromJson(s,o){return new Tt().fromJson(s,o)}static fromJsonString(s,o){return new Tt().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Tt,s,o)}}Tt.runtime=l.w,Tt.typeName="google.protobuf.ListValue",Tt.fields=l.w.util.newFieldList(()=>[{no:1,name:"values",kind:"message",T:Be,repeated:!0}]);var fn=D(609);class ft extends W.v{constructor(s){super(),this.value=0,l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.DOUBLE,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.DOUBLE,s)}catch(h){let p='cannot decode message google.protobuf.DoubleValue from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new ft().fromBinary(s,o)}static fromJson(s,o){return new ft().fromJson(s,o)}static fromJsonString(s,o){return new ft().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(ft,s,o)}}ft.runtime=l.w,ft.typeName="google.protobuf.DoubleValue",ft.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:1}]),ft.fieldWrapper={wrapField(a){return new ft({value:a})},unwrapField(a){return a.value}};class Ke extends W.v{constructor(s){super(),this.value=0,l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.FLOAT,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.FLOAT,s)}catch(h){let p='cannot decode message google.protobuf.FloatValue from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new Ke().fromBinary(s,o)}static fromJson(s,o){return new Ke().fromJson(s,o)}static fromJsonString(s,o){return new Ke().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Ke,s,o)}}Ke.runtime=l.w,Ke.typeName="google.protobuf.FloatValue",Ke.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:2}]),Ke.fieldWrapper={wrapField(a){return new Ke({value:a})},unwrapField(a){return a.value}};class kt extends W.v{constructor(s){super(),this.value=w.q.zero,l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.INT64,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.INT64,s)}catch(h){let p='cannot decode message google.protobuf.Int64Value from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new kt().fromBinary(s,o)}static fromJson(s,o){return new kt().fromJson(s,o)}static fromJsonString(s,o){return new kt().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(kt,s,o)}}kt.runtime=l.w,kt.typeName="google.protobuf.Int64Value",kt.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:3}]),kt.fieldWrapper={wrapField(a){return new kt({value:a})},unwrapField(a){return a.value}};class vt extends W.v{constructor(s){super(),this.value=w.q.zero,l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.UINT64,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.UINT64,s)}catch(h){let p='cannot decode message google.protobuf.UInt64Value from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new vt().fromBinary(s,o)}static fromJson(s,o){return new vt().fromJson(s,o)}static fromJsonString(s,o){return new vt().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(vt,s,o)}}vt.runtime=l.w,vt.typeName="google.protobuf.UInt64Value",vt.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:4}]),vt.fieldWrapper={wrapField(a){return new vt({value:a})},unwrapField(a){return a.value}};class it extends W.v{constructor(s){super(),this.value=0,l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.INT32,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.INT32,s)}catch(h){let p='cannot decode message google.protobuf.Int32Value from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new it().fromBinary(s,o)}static fromJson(s,o){return new it().fromJson(s,o)}static fromJsonString(s,o){return new it().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(it,s,o)}}it.runtime=l.w,it.typeName="google.protobuf.Int32Value",it.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:5}]),it.fieldWrapper={wrapField(a){return new it({value:a})},unwrapField(a){return a.value}};class Pe extends W.v{constructor(s){super(),this.value=0,l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.UINT32,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.UINT32,s)}catch(h){let p='cannot decode message google.protobuf.UInt32Value from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new Pe().fromBinary(s,o)}static fromJson(s,o){return new Pe().fromJson(s,o)}static fromJsonString(s,o){return new Pe().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Pe,s,o)}}Pe.runtime=l.w,Pe.typeName="google.protobuf.UInt32Value",Pe.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:13}]),Pe.fieldWrapper={wrapField(a){return new Pe({value:a})},unwrapField(a){return a.value}};class ge extends W.v{constructor(s){super(),this.value=!1,l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.BOOL,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.BOOL,s)}catch(h){let p='cannot decode message google.protobuf.BoolValue from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new ge().fromBinary(s,o)}static fromJson(s,o){return new ge().fromJson(s,o)}static fromJsonString(s,o){return new ge().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(ge,s,o)}}ge.runtime=l.w,ge.typeName="google.protobuf.BoolValue",ge.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:8}]),ge.fieldWrapper={wrapField(a){return new ge({value:a})},unwrapField(a){return a.value}};class Me extends W.v{constructor(s){super(),this.value="",l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.STRING,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.STRING,s)}catch(h){let p='cannot decode message google.protobuf.StringValue from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new Me().fromBinary(s,o)}static fromJson(s,o){return new Me().fromJson(s,o)}static fromJsonString(s,o){return new Me().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Me,s,o)}}Me.runtime=l.w,Me.typeName="google.protobuf.StringValue",Me.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9}]),Me.fieldWrapper={wrapField(a){return new Me({value:a})},unwrapField(a){return a.value}};class At extends W.v{constructor(s){super(),this.value=new Uint8Array(0),l.w.util.initPartial(s,this)}toJson(s){return l.w.json.writeScalar(m.w.BYTES,this.value,!0)}fromJson(s,o){try{this.value=l.w.json.readScalar(m.w.BYTES,s)}catch(h){let p='cannot decode message google.protobuf.BytesValue from JSON"';throw h instanceof Error&&h.message.length>0&&(p+=`: ${h.message}`),new Error(p)}return this}static fromBinary(s,o){return new At().fromBinary(s,o)}static fromJson(s,o){return new At().fromJson(s,o)}static fromJsonString(s,o){return new At().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(At,s,o)}}At.runtime=l.w,At.typeName="google.protobuf.BytesValue",At.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:12}]),At.fieldWrapper={wrapField(a){return new At({value:a})},unwrapField(a){return a.value}};const jn=[lr.I,yt,Ce,Lt,Bt,Be,Tt,pt,yt,ft,Ke,kt,it,Pe,vt,ge,Me,At],ae=[(0,fn.V3)(An)];function _e(a,s=!0){const o=a instanceof Uint8Array||a instanceof ue?Xn(a):a,h={},p={},N={};if(s){for(const I of jn)p[I.typeName]=I;for(const I of ae)h[I.typeName]=I}return{findEnum(I){const j=h[I];if(j)return j;const P=o.enums.get(I);if(!P)return;const H=(P.file.syntax=="proto3"?l.w:f).makeEnumType(I,P.values.map(se=>({no:se.number,name:se.name,localName:(0,y.r1)(se)})),{});return h[I]=H,H},findMessage(I){const j=p[I];if(j)return j;const P=o.messages.get(I);if(!P)return;const X=P.file.syntax=="proto3"?l.w:f,H=[],se=X.makeMessageType(I,()=>H,{localName:(0,y.r1)(P)});p[I]=se;for(const De of P.fields){const be=Zn(De,this);H.push(be)}return se},findService(I){const j=N[I];if(j)return j;const P=o.services.get(I);if(!P)return;const X={};for(const H of P.methods){const se=this.findMessage(H.input.typeName),De=this.findMessage(H.output.typeName);(0,k.hu)(se,`message "${H.input.typeName}" for ${H.toString()} not found`),(0,k.hu)(De,`output message "${H.output.typeName}" for ${H.toString()} not found`),X[(0,y.r1)(H)]={name:H.name,I:se,O:De,kind:H.methodKind,idempotency:H.idempotency}}return N[I]={typeName:P.typeName,methods:X}}}}function Zn(a,s){switch(a.fieldKind){case"map":return Yn(a,s);case"message":return yn(a,s);case"enum":{const o=On(a,s);return o.default=a.getDefaultValue(),o}case"scalar":{const o=Ot(a);return o.default=a.getDefaultValue(),o}}}function Yn(a,s){const o={kind:"map",no:a.number,name:a.name,jsonName:a.jsonName,K:a.mapKey};if(a.mapValue.message){const h=s.findMessage(a.mapValue.message.typeName);return(0,k.hu)(h,`message "${a.mapValue.message.typeName}" for ${a.toString()} not found`),Object.assign(Object.assign({},o),{V:{kind:"message",T:h}})}if(a.mapValue.enum){const h=s.findEnum(a.mapValue.enum.typeName);return(0,k.hu)(h,`enum "${a.mapValue.enum.typeName}" for ${a.toString()} not found`),Object.assign(Object.assign({},o),{V:{kind:"enum",T:h}})}return Object.assign(Object.assign({},o),{V:{kind:"scalar",T:a.mapValue.scalar}})}function Ot(a){const s=a.longType==m.p.STRING?{L:m.p.STRING}:{},o=Object.assign({kind:"scalar",no:a.number,name:a.name,jsonName:a.jsonName,T:a.scalar},s);return a.repeated?Object.assign(Object.assign({},o),{repeated:!0,packed:a.packed,oneof:void 0,T:a.scalar}):a.oneof?Object.assign(Object.assign({},o),{oneof:a.oneof.name}):a.optional?Object.assign(Object.assign({},o),{opt:!0}):o}function yn(a,s){const o=s.findMessage(a.message.typeName);(0,k.hu)(o,`message "${a.message.typeName}" for ${a.toString()} not found`);const h={kind:"message",no:a.number,name:a.name,jsonName:a.jsonName,T:o,delimited:a.proto.type==de.GROUP};return a.repeated?Object.assign(Object.assign({},h),{repeated:!0,packed:a.packed,oneof:void 0}):a.oneof?Object.assign(Object.assign({},h),{oneof:a.oneof.name}):a.optional?Object.assign(Object.assign({},h),{opt:!0}):h}function On(a,s){const o=s.findEnum(a.enum.typeName);(0,k.hu)(o,`enum "${a.enum.typeName}" for ${a.toString()} not found`);const h={kind:"enum",no:a.number,name:a.name,jsonName:a.jsonName,T:o};return a.repeated?Object.assign(Object.assign({},h),{repeated:!0,packed:a.packed,oneof:void 0}):a.oneof?Object.assign(Object.assign({},h),{oneof:a.oneof.name}):a.optional?Object.assign(Object.assign({},h),{opt:!0}):h}function Ln(a){if(!(a instanceof W.v))return a;const s=a.getType(),o={};for(const h of s.fields.byMember()){const p=a[h.localName];let N;if(h.repeated)N=p.map(I=>Kt(I));else if(h.kind=="map"){N={};for(const[I,j]of Object.entries(p))N[I]=Kt(j)}else h.kind=="oneof"?N=h.findField(p.case)?{case:p.case,value:Kt(p.value)}:{case:void 0}:N=Kt(p);o[h.localName]=N}return o}function Kt(a){if(a===void 0)return a;if(a instanceof W.v)return Ln(a);if(a instanceof Uint8Array){const s=new Uint8Array(a.byteLength);return s.set(a),s}return a}class dt extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new dt().fromBinary(s,o)}static fromJson(s,o){return new dt().fromJson(s,o)}static fromJsonString(s,o){return new dt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(dt,s,o)}}dt.runtime=f,dt.typeName="google.protobuf.compiler.Version",dt.fields=f.util.newFieldList(()=>[{no:1,name:"major",kind:"scalar",T:5,opt:!0},{no:2,name:"minor",kind:"scalar",T:5,opt:!0},{no:3,name:"patch",kind:"scalar",T:5,opt:!0},{no:4,name:"suffix",kind:"scalar",T:9,opt:!0}]);class nt extends W.v{constructor(s){super(),this.fileToGenerate=[],this.protoFile=[],this.sourceFileDescriptors=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new nt().fromBinary(s,o)}static fromJson(s,o){return new nt().fromJson(s,o)}static fromJsonString(s,o){return new nt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(nt,s,o)}}nt.runtime=f,nt.typeName="google.protobuf.compiler.CodeGeneratorRequest",nt.fields=f.util.newFieldList(()=>[{no:1,name:"file_to_generate",kind:"scalar",T:9,repeated:!0},{no:2,name:"parameter",kind:"scalar",T:9,opt:!0},{no:15,name:"proto_file",kind:"message",T:ke,repeated:!0},{no:17,name:"source_file_descriptors",kind:"message",T:ke,repeated:!0},{no:3,name:"compiler_version",kind:"message",T:dt,opt:!0}]);class Mt extends W.v{constructor(s){super(),this.file=[],f.util.initPartial(s,this)}static fromBinary(s,o){return new Mt().fromBinary(s,o)}static fromJson(s,o){return new Mt().fromJson(s,o)}static fromJsonString(s,o){return new Mt().fromJsonString(s,o)}static equals(s,o){return f.util.equals(Mt,s,o)}}Mt.runtime=f,Mt.typeName="google.protobuf.compiler.CodeGeneratorResponse",Mt.fields=f.util.newFieldList(()=>[{no:1,name:"error",kind:"scalar",T:9,opt:!0},{no:2,name:"supported_features",kind:"scalar",T:4,opt:!0},{no:15,name:"file",kind:"message",T:$e,repeated:!0}]);var Tn;(function(a){a[a.NONE=0]="NONE",a[a.PROTO3_OPTIONAL=1]="PROTO3_OPTIONAL",a[a.SUPPORTS_EDITIONS=2]="SUPPORTS_EDITIONS"})(Tn||(Tn={})),f.util.setEnumType(Tn,"google.protobuf.compiler.CodeGeneratorResponse.Feature",[{no:0,name:"FEATURE_NONE"},{no:1,name:"FEATURE_PROTO3_OPTIONAL"},{no:2,name:"FEATURE_SUPPORTS_EDITIONS"}]);class $e extends W.v{constructor(s){super(),f.util.initPartial(s,this)}static fromBinary(s,o){return new $e().fromBinary(s,o)}static fromJson(s,o){return new $e().fromJson(s,o)}static fromJsonString(s,o){return new $e().fromJsonString(s,o)}static equals(s,o){return f.util.equals($e,s,o)}}$e.runtime=f,$e.typeName="google.protobuf.compiler.CodeGeneratorResponse.File",$e.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"insertion_point",kind:"scalar",T:9,opt:!0},{no:15,name:"content",kind:"scalar",T:9,opt:!0},{no:16,name:"generated_code_info",kind:"message",T:ye,opt:!0}]);class ot extends W.v{constructor(s){super(),this.fileName="",l.w.util.initPartial(s,this)}static fromBinary(s,o){return new ot().fromBinary(s,o)}static fromJson(s,o){return new ot().fromJson(s,o)}static fromJsonString(s,o){return new ot().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(ot,s,o)}}ot.runtime=l.w,ot.typeName="google.protobuf.SourceContext",ot.fields=l.w.util.newFieldList(()=>[{no:1,name:"file_name",kind:"scalar",T:9}]);var at;(function(a){a[a.PROTO2=0]="PROTO2",a[a.PROTO3=1]="PROTO3",a[a.EDITIONS=2]="EDITIONS"})(at||(at={})),l.w.util.setEnumType(at,"google.protobuf.Syntax",[{no:0,name:"SYNTAX_PROTO2"},{no:1,name:"SYNTAX_PROTO3"},{no:2,name:"SYNTAX_EDITIONS"}]);class dn extends W.v{constructor(s){super(),this.name="",this.fields=[],this.oneofs=[],this.options=[],this.syntax=at.PROTO2,this.edition="",l.w.util.initPartial(s,this)}static fromBinary(s,o){return new dn().fromBinary(s,o)}static fromJson(s,o){return new dn().fromJson(s,o)}static fromJsonString(s,o){return new dn().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(dn,s,o)}}dn.runtime=l.w,dn.typeName="google.protobuf.Type",dn.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"fields",kind:"message",T:sn,repeated:!0},{no:3,name:"oneofs",kind:"scalar",T:9,repeated:!0},{no:4,name:"options",kind:"message",T:me,repeated:!0},{no:5,name:"source_context",kind:"message",T:ot},{no:6,name:"syntax",kind:"enum",T:l.w.getEnumType(at)},{no:7,name:"edition",kind:"scalar",T:9}]);class sn extends W.v{constructor(s){super(),this.kind=wt.TYPE_UNKNOWN,this.cardinality=on.UNKNOWN,this.number=0,this.name="",this.typeUrl="",this.oneofIndex=0,this.packed=!1,this.options=[],this.jsonName="",this.defaultValue="",l.w.util.initPartial(s,this)}static fromBinary(s,o){return new sn().fromBinary(s,o)}static fromJson(s,o){return new sn().fromJson(s,o)}static fromJsonString(s,o){return new sn().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(sn,s,o)}}sn.runtime=l.w,sn.typeName="google.protobuf.Field",sn.fields=l.w.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:l.w.getEnumType(wt)},{no:2,name:"cardinality",kind:"enum",T:l.w.getEnumType(on)},{no:3,name:"number",kind:"scalar",T:5},{no:4,name:"name",kind:"scalar",T:9},{no:6,name:"type_url",kind:"scalar",T:9},{no:7,name:"oneof_index",kind:"scalar",T:5},{no:8,name:"packed",kind:"scalar",T:8},{no:9,name:"options",kind:"message",T:me,repeated:!0},{no:10,name:"json_name",kind:"scalar",T:9},{no:11,name:"default_value",kind:"scalar",T:9}]);var wt;(function(a){a[a.TYPE_UNKNOWN=0]="TYPE_UNKNOWN",a[a.TYPE_DOUBLE=1]="TYPE_DOUBLE",a[a.TYPE_FLOAT=2]="TYPE_FLOAT",a[a.TYPE_INT64=3]="TYPE_INT64",a[a.TYPE_UINT64=4]="TYPE_UINT64",a[a.TYPE_INT32=5]="TYPE_INT32",a[a.TYPE_FIXED64=6]="TYPE_FIXED64",a[a.TYPE_FIXED32=7]="TYPE_FIXED32",a[a.TYPE_BOOL=8]="TYPE_BOOL",a[a.TYPE_STRING=9]="TYPE_STRING",a[a.TYPE_GROUP=10]="TYPE_GROUP",a[a.TYPE_MESSAGE=11]="TYPE_MESSAGE",a[a.TYPE_BYTES=12]="TYPE_BYTES",a[a.TYPE_UINT32=13]="TYPE_UINT32",a[a.TYPE_ENUM=14]="TYPE_ENUM",a[a.TYPE_SFIXED32=15]="TYPE_SFIXED32",a[a.TYPE_SFIXED64=16]="TYPE_SFIXED64",a[a.TYPE_SINT32=17]="TYPE_SINT32",a[a.TYPE_SINT64=18]="TYPE_SINT64"})(wt||(wt={})),l.w.util.setEnumType(wt,"google.protobuf.Field.Kind",[{no:0,name:"TYPE_UNKNOWN"},{no:1,name:"TYPE_DOUBLE"},{no:2,name:"TYPE_FLOAT"},{no:3,name:"TYPE_INT64"},{no:4,name:"TYPE_UINT64"},{no:5,name:"TYPE_INT32"},{no:6,name:"TYPE_FIXED64"},{no:7,name:"TYPE_FIXED32"},{no:8,name:"TYPE_BOOL"},{no:9,name:"TYPE_STRING"},{no:10,name:"TYPE_GROUP"},{no:11,name:"TYPE_MESSAGE"},{no:12,name:"TYPE_BYTES"},{no:13,name:"TYPE_UINT32"},{no:14,name:"TYPE_ENUM"},{no:15,name:"TYPE_SFIXED32"},{no:16,name:"TYPE_SFIXED64"},{no:17,name:"TYPE_SINT32"},{no:18,name:"TYPE_SINT64"}]);var on;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.OPTIONAL=1]="OPTIONAL",a[a.REQUIRED=2]="REQUIRED",a[a.REPEATED=3]="REPEATED"})(on||(on={})),l.w.util.setEnumType(on,"google.protobuf.Field.Cardinality",[{no:0,name:"CARDINALITY_UNKNOWN"},{no:1,name:"CARDINALITY_OPTIONAL"},{no:2,name:"CARDINALITY_REQUIRED"},{no:3,name:"CARDINALITY_REPEATED"}]);class hn extends W.v{constructor(s){super(),this.name="",this.enumvalue=[],this.options=[],this.syntax=at.PROTO2,this.edition="",l.w.util.initPartial(s,this)}static fromBinary(s,o){return new hn().fromBinary(s,o)}static fromJson(s,o){return new hn().fromJson(s,o)}static fromJsonString(s,o){return new hn().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(hn,s,o)}}hn.runtime=l.w,hn.typeName="google.protobuf.Enum",hn.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"enumvalue",kind:"message",T:an,repeated:!0},{no:3,name:"options",kind:"message",T:me,repeated:!0},{no:4,name:"source_context",kind:"message",T:ot},{no:5,name:"syntax",kind:"enum",T:l.w.getEnumType(at)},{no:6,name:"edition",kind:"scalar",T:9}]);class an extends W.v{constructor(s){super(),this.name="",this.number=0,this.options=[],l.w.util.initPartial(s,this)}static fromBinary(s,o){return new an().fromBinary(s,o)}static fromJson(s,o){return new an().fromJson(s,o)}static fromJsonString(s,o){return new an().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(an,s,o)}}an.runtime=l.w,an.typeName="google.protobuf.EnumValue",an.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"number",kind:"scalar",T:5},{no:3,name:"options",kind:"message",T:me,repeated:!0}]);class me extends W.v{constructor(s){super(),this.name="",l.w.util.initPartial(s,this)}static fromBinary(s,o){return new me().fromBinary(s,o)}static fromJson(s,o){return new me().fromJson(s,o)}static fromJsonString(s,o){return new me().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(me,s,o)}}me.runtime=l.w,me.typeName="google.protobuf.Option",me.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"value",kind:"message",T:lr.I}]);class un extends W.v{constructor(s){super(),this.name="",this.methods=[],this.options=[],this.version="",this.mixins=[],this.syntax=at.PROTO2,l.w.util.initPartial(s,this)}static fromBinary(s,o){return new un().fromBinary(s,o)}static fromJson(s,o){return new un().fromJson(s,o)}static fromJsonString(s,o){return new un().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(un,s,o)}}un.runtime=l.w,un.typeName="google.protobuf.Api",un.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"methods",kind:"message",T:Jt,repeated:!0},{no:3,name:"options",kind:"message",T:me,repeated:!0},{no:4,name:"version",kind:"scalar",T:9},{no:5,name:"source_context",kind:"message",T:ot},{no:6,name:"mixins",kind:"message",T:Ft,repeated:!0},{no:7,name:"syntax",kind:"enum",T:l.w.getEnumType(at)}]);class Jt extends W.v{constructor(s){super(),this.name="",this.requestTypeUrl="",this.requestStreaming=!1,this.responseTypeUrl="",this.responseStreaming=!1,this.options=[],this.syntax=at.PROTO2,l.w.util.initPartial(s,this)}static fromBinary(s,o){return new Jt().fromBinary(s,o)}static fromJson(s,o){return new Jt().fromJson(s,o)}static fromJsonString(s,o){return new Jt().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Jt,s,o)}}Jt.runtime=l.w,Jt.typeName="google.protobuf.Method",Jt.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"request_type_url",kind:"scalar",T:9},{no:3,name:"request_streaming",kind:"scalar",T:8},{no:4,name:"response_type_url",kind:"scalar",T:9},{no:5,name:"response_streaming",kind:"scalar",T:8},{no:6,name:"options",kind:"message",T:me,repeated:!0},{no:7,name:"syntax",kind:"enum",T:l.w.getEnumType(at)}]);class Ft extends W.v{constructor(s){super(),this.name="",this.root="",l.w.util.initPartial(s,this)}static fromBinary(s,o){return new Ft().fromBinary(s,o)}static fromJson(s,o){return new Ft().fromJson(s,o)}static fromJsonString(s,o){return new Ft().fromJsonString(s,o)}static equals(s,o){return l.w.util.equals(Ft,s,o)}}Ft.runtime=l.w,Ft.typeName="google.protobuf.Mixin",Ft.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"root",kind:"scalar",T:9}])},561:(ce,A,D)=>{D.d(A,{v:()=>l});class l{equals(m){return this.getType().runtime.util.equals(this.getType(),this,m)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(m,x){const b=this.getType(),_=b.runtime.bin,B=_.makeReadOptions(x);return _.readMessage(this,B.readerFactory(m),m.byteLength,B),this}fromJson(m,x){const b=this.getType(),_=b.runtime.json,B=_.makeReadOptions(x);return _.readMessage(b,m,B,this),this}fromJsonString(m,x){let b;try{b=JSON.parse(m)}catch(_){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${_ instanceof Error?_.message:String(_)}`)}return this.fromJson(b,x)}toBinary(m){const x=this.getType(),b=x.runtime.bin,_=b.makeWriteOptions(m),B=_.writerFactory();return b.writeMessage(this,B,_),B.finish()}toJson(m){const x=this.getType(),b=x.runtime.json,_=b.makeWriteOptions(m);return b.writeMessage(this,_)}toJsonString(m){var x;const b=this.toJson(m);return JSON.stringify(b,null,(x=m==null?void 0:m.prettySpaces)!==null&&x!==void 0?x:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}},120:(ce,A,D)=>{D.d(A,{E_:()=>y,fp:()=>T,hu:()=>l,ug:()=>B});function l(C,k){if(!C)throw new Error(k)}const g=34028234663852886e22,m=-34028234663852886e22,x=4294967295,b=2147483647,_=-2147483648;function B(C){if(typeof C!="number")throw new Error("invalid int 32: "+typeof C);if(!Number.isInteger(C)||C>b||C<_)throw new Error("invalid int 32: "+C)}function T(C){if(typeof C!="number")throw new Error("invalid uint 32: "+typeof C);if(!Number.isInteger(C)||C>x||C<0)throw new Error("invalid uint 32: "+C)}function y(C){if(typeof C!="number")throw new Error("invalid float 32: "+typeof C);if(!!Number.isFinite(C)&&(C>g||C<m))throw new Error("invalid float 32: "+C)}},744:(ce,A,D)=>{D.d(A,{Jj:()=>q,NN:()=>Y,gQ:()=>w,gY:()=>L,oQ:()=>$});var l=D(79),g=D(561),m=D(465),x=D(432),b=D(781),_=D(120);const B=Symbol("@bufbuild/protobuf/unknown-fields"),T={readUnknownFields:!0,readerFactory:O=>new l.oP(O)},y={writeUnknownFields:!0,writerFactory:()=>new l.Lt};function C(O){return O?Object.assign(Object.assign({},T),O):T}function k(O){return O?Object.assign(Object.assign({},y),O):y}function L(){return{makeReadOptions:C,makeWriteOptions:k,listUnknownFields(O){var V;return(V=O[B])!==null&&V!==void 0?V:[]},discardUnknownFields(O){delete O[B]},writeUnknownFields(O,V){const Z=O[B];if(Z)for(const K of Z)V.tag(K.no,K.wireType).raw(K.data)},onUnknownField(O,V,z,Z){const K=O;Array.isArray(K[B])||(K[B]=[]),K[B].push({no:V,wireType:z,data:Z})},readMessage(O,V,z,Z,K){const te=O.getType(),Ae=K?V.len:V.pos+z;let W,Ee;for(;V.pos<Ae&&([W,Ee]=V.tag(),Ee!=l.TD.EndGroup);){const ne=te.fields.find(W);if(!ne){const Le=V.skip(Ee);Z.readUnknownFields&&this.onUnknownField(O,W,Ee,Le);continue}let ue=O,ke=ne.repeated,pe=ne.localName;switch(ne.oneof&&(ue=ue[ne.oneof.localName],ue.case!=pe&&delete ue.value,ue.case=pe,pe="value"),ne.kind){case"scalar":case"enum":const Le=ne.kind=="enum"?m.w.INT32:ne.T;let ze=R;if(ne.kind=="scalar"&&ne.L>0&&(ze=U),ke){let tt=ue[pe];if(Ee==l.TD.LengthDelimited&&Le!=m.w.STRING&&Le!=m.w.BYTES){let de=V.uint32()+V.pos;for(;V.pos<de;)tt.push(ze(V,Le))}else tt.push(ze(V,Le))}else ue[pe]=ze(V,Le);break;case"message":const Re=ne.T;ke?ue[pe].push(S(V,new Re,Z,ne)):ue[pe]instanceof g.v?S(V,ue[pe],Z,ne):(ue[pe]=S(V,new Re,Z,ne),Re.fieldWrapper&&!ne.oneof&&!ne.repeated&&(ue[pe]=Re.fieldWrapper.unwrapField(ue[pe])));break;case"map":let[ut,ht]=f(ne,V,Z);ue[pe][ut]=ht;break}}if(K&&(Ee!=l.TD.EndGroup||W!==z))throw new Error("invalid end group tag")}}}function S(O,V,z,Z){const K=V.getType().runtime.bin,te=Z==null?void 0:Z.delimited;return K.readMessage(V,O,te?Z==null?void 0:Z.no:O.uint32(),z,te),V}function f(O,V,z){const Z=V.uint32(),K=V.pos+Z;let te,Ae;for(;V.pos<K;){let[W]=V.tag();switch(W){case 1:te=R(V,O.K);break;case 2:switch(O.V.kind){case"scalar":Ae=R(V,O.V.T);break;case"enum":Ae=V.int32();break;case"message":Ae=S(V,new O.V.T,z,void 0);break}break}}if(te===void 0){let W=(0,b.kY)(O.K,m.p.BIGINT);te=O.K==m.w.BOOL?W.toString():W}if(typeof te!="string"&&typeof te!="number"&&(te=te.toString()),Ae===void 0)switch(O.V.kind){case"scalar":Ae=(0,b.kY)(O.V.T,m.p.BIGINT);break;case"enum":Ae=0;break;case"message":Ae=new O.V.T;break}return[te,Ae]}function U(O,V){const z=R(O,V);return typeof z=="bigint"?z.toString():z}function R(O,V){switch(V){case m.w.STRING:return O.string();case m.w.BOOL:return O.bool();case m.w.DOUBLE:return O.double();case m.w.FLOAT:return O.float();case m.w.INT32:return O.int32();case m.w.INT64:return O.int64();case m.w.UINT64:return O.uint64();case m.w.FIXED64:return O.fixed64();case m.w.BYTES:return O.bytes();case m.w.FIXED32:return O.fixed32();case m.w.SFIXED32:return O.sfixed32();case m.w.SFIXED64:return O.sfixed64();case m.w.SINT64:return O.sint64();case m.w.UINT32:return O.uint32();case m.w.SINT32:return O.sint32()}}function w(O,V,z,Z,K){O.tag(z.no,l.TD.LengthDelimited),O.fork();let te=Z;switch(z.K){case m.w.INT32:case m.w.FIXED32:case m.w.UINT32:case m.w.SFIXED32:case m.w.SINT32:te=Number.parseInt(Z);break;case m.w.BOOL:(0,_.hu)(Z=="true"||Z=="false"),te=Z=="true";break}switch(Y(O,z.K,1,te,!0),z.V.kind){case"scalar":Y(O,z.V.T,2,K,!0);break;case"enum":Y(O,m.w.INT32,2,K,!0);break;case"message":O.tag(2,l.TD.LengthDelimited).bytes(K.toBinary(V));break}O.join()}function $(O,V,z,Z){if(Z!==void 0){const K=(0,x.E)(z.T,Z);z!=null&&z.delimited?O.tag(z.no,l.TD.StartGroup).raw(K.toBinary(V)).tag(z.no,l.TD.EndGroup):O.tag(z.no,l.TD.LengthDelimited).bytes(K.toBinary(V))}}function Y(O,V,z,Z,K){let[te,Ae,W]=(0,b.T1)(V,Z);(!W||K)&&O.tag(z,te)[Ae](Z)}function q(O,V,z,Z){if(!Z.length)return;O.tag(z,l.TD.LengthDelimited).fork();let[,K]=(0,b.T1)(V);for(let te=0;te<Z.length;te++)O[K](Z[te]);O.join()}},609:(ce,A,D)=>{D.d(A,{V3:()=>m,be:()=>b,ut:()=>_,zg:()=>x});var l=D(120);const g=Symbol("@bufbuild/protobuf/enum-type");function m(T){const y=T[g];return(0,l.hu)(y,"missing enum type on enum object"),y}function x(T,y,C,k){T[g]=b(y,C.map(L=>({no:L.no,name:L.name,localName:T[L.no]})))}function b(T,y,C){const k=Object.create(null),L=Object.create(null),S=[];for(const f of y){const U=B(f);S.push(U),k[f.name]=U,L[f.no]=U}return{typeName:T,values:S,findName(f){return k[f]},findNumber(f){return L[f]}}}function _(T,y,C){const k={};for(const L of y){const S=B(L);k[S.localName]=S.no,k[S.no]=S.localName}return x(k,T,y),k}function B(T){return"localName"in T?T:Object.assign(Object.assign({},T),{localName:T.name})}},501:(ce,A,D)=>{D.d(A,{i:()=>l});class l{constructor(m,x){this._fields=m,this._normalizer=x}findJsonName(m){if(!this.jsonNames){const x={};for(const b of this.list())x[b.jsonName]=x[b.name]=b;this.jsonNames=x}return this.jsonNames[m]}find(m){if(!this.numbers){const x={};for(const b of this.list())x[b.no]=b;this.numbers=x}return this.numbers[m]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((m,x)=>m.no-x.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const m=this.members;let x;for(const b of this.list())b.oneof?b.oneof!==x&&(x=b.oneof,m.push(x)):m.push(b)}return this.members}}},432:(ce,A,D)=>{D.d(A,{E:()=>m,w:()=>x});var l=D(561),g=D(465);function m(_,B){return B instanceof l.v||!_.fieldWrapper?B:_.fieldWrapper.wrapField(B)}function x(_){if(_.fieldKind==="message"&&!_.repeated&&_.oneof==null)return b[_.message.typeName]}const b={"google.protobuf.DoubleValue":g.w.DOUBLE,"google.protobuf.FloatValue":g.w.FLOAT,"google.protobuf.Int64Value":g.w.INT64,"google.protobuf.UInt64Value":g.w.UINT64,"google.protobuf.Int32Value":g.w.INT32,"google.protobuf.UInt32Value":g.w.UINT32,"google.protobuf.BoolValue":g.w.BOOL,"google.protobuf.StringValue":g.w.STRING,"google.protobuf.BytesValue":g.w.BYTES}},215:(ce,A,D)=>{D.d(A,{o:()=>m});var l=D(504),g=D(120);class m{constructor(b){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=b,this.localName=(0,l.uA)(b)}addField(b){(0,g.hu)(b.oneof===this,`field ${b.name} not one of ${this.name}`),this.fields.push(b)}findField(b){if(!this._lookup){this._lookup=Object.create(null);for(let _=0;_<this.fields.length;_++)this._lookup[this.fields[_].localName]=this.fields[_]}return this._lookup[b]}}},814:(ce,A,D)=>{D.d(A,{b:()=>C});var l=D(561),g=D(465),m=D(120),x=D(210),b=D(236);const _={ignoreUnknownFields:!1},B={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function T(R){return R?Object.assign(Object.assign({},_),R):_}function y(R){return R?Object.assign(Object.assign({},B),R):B}function C(R){const w=R(f,U);return{makeReadOptions:T,makeWriteOptions:y,readMessage($,Y,q,O){if(Y==null||Array.isArray(Y)||typeof Y!="object")throw new Error(`cannot decode message ${$.typeName} from JSON: ${this.debug(Y)}`);O=O!=null?O:new $;const V={};for(const[z,Z]of Object.entries(Y)){const K=$.fields.findJsonName(z);if(!K){if(!q.ignoreUnknownFields)throw new Error(`cannot decode message ${$.typeName} from JSON: key "${z}" is unknown`);continue}let te=K.localName,Ae=O;if(K.oneof){if(Z===null&&K.kind=="scalar")continue;const W=V[K.oneof.localName];if(W)throw new Error(`cannot decode message ${$.typeName} from JSON: multiple keys for oneof "${K.oneof.name}" present: "${W}", "${z}"`);V[K.oneof.localName]=z,Ae=Ae[K.oneof.localName]={case:te},te="value"}if(K.repeated){if(Z===null)continue;if(!Array.isArray(Z))throw new Error(`cannot decode field ${$.typeName}.${K.name} from JSON: ${this.debug(Z)}`);const W=Ae[te];for(const Ee of Z){if(Ee===null)throw new Error(`cannot decode field ${$.typeName}.${K.name} from JSON: ${this.debug(Ee)}`);let ne;switch(K.kind){case"message":ne=K.T.fromJson(Ee,q);break;case"enum":if(ne=S(K.T,Ee,q.ignoreUnknownFields),ne===void 0)continue;break;case"scalar":try{ne=L(K.T,Ee,K.L)}catch(ue){let ke=`cannot decode field ${$.typeName}.${K.name} from JSON: ${this.debug(Ee)}`;throw ue instanceof Error&&ue.message.length>0&&(ke+=`: ${ue.message}`),new Error(ke)}break}W.push(ne)}}else if(K.kind=="map"){if(Z===null)continue;if(Array.isArray(Z)||typeof Z!="object")throw new Error(`cannot decode field ${$.typeName}.${K.name} from JSON: ${this.debug(Z)}`);const W=Ae[te];for(const[Ee,ne]of Object.entries(Z)){if(ne===null)throw new Error(`cannot decode field ${$.typeName}.${K.name} from JSON: map value null`);let ue;switch(K.V.kind){case"message":ue=K.V.T.fromJson(ne,q);break;case"enum":if(ue=S(K.V.T,ne,q.ignoreUnknownFields),ue===void 0)continue;break;case"scalar":try{ue=L(K.V.T,ne,g.p.BIGINT)}catch(ke){let pe=`cannot decode map value for field ${$.typeName}.${K.name} from JSON: ${this.debug(Z)}`;throw ke instanceof Error&&ke.message.length>0&&(pe+=`: ${ke.message}`),new Error(pe)}break}try{W[L(K.K,K.K==g.w.BOOL?Ee=="true"?!0:Ee=="false"?!1:Ee:Ee,g.p.BIGINT).toString()]=ue}catch(ke){let pe=`cannot decode map key for field ${$.typeName}.${K.name} from JSON: ${this.debug(Z)}`;throw ke instanceof Error&&ke.message.length>0&&(pe+=`: ${ke.message}`),new Error(pe)}}}else switch(K.kind){case"message":const W=K.T;if(Z===null&&W.typeName!="google.protobuf.Value"){if(K.oneof)throw new Error(`cannot decode field ${$.typeName}.${K.name} from JSON: null is invalid for oneof field "${z}"`);continue}Ae[te]instanceof l.v?Ae[te].fromJson(Z,q):(Ae[te]=W.fromJson(Z,q),W.fieldWrapper&&!K.oneof&&(Ae[te]=W.fieldWrapper.unwrapField(Ae[te])));break;case"enum":const Ee=S(K.T,Z,q.ignoreUnknownFields);Ee!==void 0&&(Ae[te]=Ee);break;case"scalar":try{Ae[te]=L(K.T,Z,K.L)}catch(ne){let ue=`cannot decode field ${$.typeName}.${K.name} from JSON: ${this.debug(Z)}`;throw ne instanceof Error&&ne.message.length>0&&(ue+=`: ${ne.message}`),new Error(ue)}break}}return O},writeMessage($,Y){const q=$.getType(),O={};let V;try{for(const z of q.fields.byMember()){let Z;if(z.kind=="oneof"){const K=$[z.localName];if(K.value===void 0)continue;if(V=z.findField(K.case),!V)throw"oneof case not found: "+K.case;Z=w(V,K.value,Y)}else V=z,Z=w(V,$[V.localName],Y);Z!==void 0&&(O[Y.useProtoFieldName?V.name:V.jsonName]=Z)}}catch(z){const Z=V?`cannot encode field ${q.typeName}.${V.name} to JSON`:`cannot encode message ${q.typeName} to JSON`,K=z instanceof Error?z.message:String(z);throw new Error(Z+(K.length>0?`: ${K}`:""))}return O},readScalar:L,writeScalar:U,debug:k}}function k(R){if(R===null)return"null";switch(typeof R){case"object":return Array.isArray(R)?"array":"object";case"string":return R.length>100?"string":`"${R.split('"').join('\\"')}"`;default:return String(R)}}function L(R,w,$){switch(R){case g.w.DOUBLE:case g.w.FLOAT:if(w===null)return 0;if(w==="NaN")return Number.NaN;if(w==="Infinity")return Number.POSITIVE_INFINITY;if(w==="-Infinity")return Number.NEGATIVE_INFINITY;if(w===""||typeof w=="string"&&w.trim().length!==w.length||typeof w!="string"&&typeof w!="number")break;const Y=Number(w);if(Number.isNaN(Y)||!Number.isFinite(Y))break;return R==g.w.FLOAT&&(0,m.E_)(Y),Y;case g.w.INT32:case g.w.FIXED32:case g.w.SFIXED32:case g.w.SINT32:case g.w.UINT32:if(w===null)return 0;let q;if(typeof w=="number"?q=w:typeof w=="string"&&w.length>0&&w.trim().length===w.length&&(q=Number(w)),q===void 0)break;return R==g.w.UINT32?(0,m.fp)(q):(0,m.ug)(q),q;case g.w.INT64:case g.w.SFIXED64:case g.w.SINT64:if(w===null)return x.q.zero;if(typeof w!="number"&&typeof w!="string")break;const O=x.q.parse(w);return $?O.toString():O;case g.w.FIXED64:case g.w.UINT64:if(w===null)return x.q.zero;if(typeof w!="number"&&typeof w!="string")break;const V=x.q.uParse(w);return $?V.toString():V;case g.w.BOOL:if(w===null)return!1;if(typeof w!="boolean")break;return w;case g.w.STRING:if(w===null)return"";if(typeof w!="string")break;try{encodeURIComponent(w)}catch{throw new Error("invalid UTF8")}return w;case g.w.BYTES:if(w===null||w==="")return new Uint8Array(0);if(typeof w!="string")break;return b.W.dec(w)}throw new Error}function S(R,w,$){if(w===null)return 0;switch(typeof w){case"number":if(Number.isInteger(w))return w;break;case"string":const Y=R.findName(w);if(Y||$)return Y==null?void 0:Y.no;break}throw new Error(`cannot decode enum ${R.typeName} from JSON: ${k(w)}`)}function f(R,w,$,Y){var q;if(w===void 0)return w;if(w===0&&!$)return;if(Y)return w;if(R.typeName=="google.protobuf.NullValue")return null;const O=R.findNumber(w);return(q=O==null?void 0:O.name)!==null&&q!==void 0?q:w}function U(R,w,$){if(w!==void 0)switch(R){case g.w.INT32:case g.w.SFIXED32:case g.w.SINT32:case g.w.FIXED32:case g.w.UINT32:return(0,m.hu)(typeof w=="number"),w!=0||$?w:void 0;case g.w.FLOAT:case g.w.DOUBLE:return(0,m.hu)(typeof w=="number"),Number.isNaN(w)?"NaN":w===Number.POSITIVE_INFINITY?"Infinity":w===Number.NEGATIVE_INFINITY?"-Infinity":w!==0||$?w:void 0;case g.w.STRING:return(0,m.hu)(typeof w=="string"),w.length>0||$?w:void 0;case g.w.BOOL:return(0,m.hu)(typeof w=="boolean"),w||$?w:void 0;case g.w.UINT64:case g.w.FIXED64:case g.w.INT64:case g.w.SFIXED64:case g.w.SINT64:return(0,m.hu)(typeof w=="bigint"||typeof w=="string"||typeof w=="number"),$||w!=0?w.toString(10):void 0;case g.w.BYTES:return(0,m.hu)(w instanceof Uint8Array),$||w.byteLength>0?b.W.enc(w):void 0}}},504:(ce,A,D)=>{D.d(A,{GD:()=>f,Rz:()=>g,Sm:()=>b,ll:()=>S,r1:()=>l,uA:()=>m,x1:()=>x});function l(U){switch(U.kind){case"field":return g(U.name,U.oneof!==void 0);case"oneof":return m(U.name);case"enum":case"message":case"service":{const R=U.file.proto.package,w=R===void 0?0:R.length+1,$=U.typeName.substring(w).replace(/\./g,"_");return S(f($))}case"enum_value":{const R=U.parent.sharedPrefix;if(R===void 0)return U.name;const w=U.name.substring(R.length);return S(w)}case"rpc":{let R=U.name;return R.length==0?R:(R=R[0].toLowerCase()+R.substring(1),S(R))}}}function g(U,R){const w=B(U);return R?w:S(L(w))}function m(U){return g(U,!1)}const x=B;function b(U,R){const w=_(U)+"_";for(const $ of R){if(!$.toLowerCase().startsWith(w))return;const Y=$.substring(w.length);if(Y.length==0||/^\d/.test(Y))return}return w}function _(U){return(U.substring(0,1)+U.substring(1).replace(/[A-Z]/g,R=>"_"+R)).toLowerCase()}function B(U){let R=!1;const w=[];for(let $=0;$<U.length;$++){let Y=U.charAt($);switch(Y){case"_":R=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":w.push(Y),R=!1;break;default:R&&(R=!1,Y=Y.toUpperCase()),w.push(Y);break}}return w.join("")}const T=new Set(["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","enum","implements","interface","let","package","private","protected","public","static","Object","bigint","number","boolean","string","object","globalThis","Uint8Array","Partial"]),y=new Set(["constructor","toString","toJSON","valueOf"]),C=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),k=U=>`${U}$`,L=U=>C.has(U)?k(U):U,S=U=>y.has(U)?k(U):U,f=U=>T.has(U)?k(U):U},493:(ce,A,D)=>{D.d(A,{F:()=>x});var l=D(609),g=D(561);function m(b,_,B,T){var y;const C=(y=T==null?void 0:T.localName)!==null&&y!==void 0?y:_.substring(_.lastIndexOf(".")+1),k={[C]:function(L){b.util.initFields(this),b.util.initPartial(L,this)}}[C];return Object.setPrototypeOf(k.prototype,new g.v),Object.assign(k,{runtime:b,typeName:_,fields:b.util.newFieldList(B),fromBinary(L,S){return new k().fromBinary(L,S)},fromJson(L,S){return new k().fromJson(L,S)},fromJsonString(L,S){return new k().fromJsonString(L,S)},equals(L,S){return b.util.equals(k,L,S)}}),k}function x(b,_,B,T){return{syntax:b,json:_,bin:B,util:T,makeMessageType(y,C,k){return m(this,y,C,k)},makeEnum:l.ut,makeEnumType:l.be,getEnumType:l.V3}}},781:(ce,A,D)=>{D.d(A,{AA:()=>x,T1:()=>_,kY:()=>b});var l=D(465),g=D(79),m=D(210);function x(B,T,y){if(T===y)return!0;if(B==l.w.BYTES){if(!(T instanceof Uint8Array)||!(y instanceof Uint8Array)||T.length!==y.length)return!1;for(let C=0;C<T.length;C++)if(T[C]!==y[C])return!1;return!0}switch(B){case l.w.UINT64:case l.w.FIXED64:case l.w.INT64:case l.w.SFIXED64:case l.w.SINT64:return T==y}return!1}function b(B,T){switch(B){case l.w.BOOL:return!1;case l.w.UINT64:case l.w.FIXED64:case l.w.INT64:case l.w.SFIXED64:case l.w.SINT64:return T==0?m.q.zero:"0";case l.w.DOUBLE:case l.w.FLOAT:return 0;case l.w.BYTES:return new Uint8Array(0);case l.w.STRING:return"";default:return 0}}function _(B,T){const y=T===void 0;let C=g.TD.Varint,k=T===0;switch(B){case l.w.STRING:k=y||!T.length,C=g.TD.LengthDelimited;break;case l.w.BOOL:k=T===!1;break;case l.w.DOUBLE:C=g.TD.Bit64;break;case l.w.FLOAT:C=g.TD.Bit32;break;case l.w.INT64:k=y||T==0;break;case l.w.UINT64:k=y||T==0;break;case l.w.FIXED64:k=y||T==0,C=g.TD.Bit64;break;case l.w.BYTES:k=y||!T.byteLength,C=g.TD.LengthDelimited;break;case l.w.FIXED32:C=g.TD.Bit32;break;case l.w.SFIXED32:C=g.TD.Bit32;break;case l.w.SFIXED64:k=y||T==0,C=g.TD.Bit64;break;case l.w.SINT64:k=y||T==0;break}const L=l.w[B].toLowerCase();return[C,L,y||k]}},433:(ce,A,D)=>{D.d(A,{f:()=>b});var l=D(609),g=D(561),m=D(465),x=D(781);function b(){return{setEnumType:l.zg,initPartial(T,y){if(T===void 0)return;const C=y.getType();for(const k of C.fields.byMember()){const L=k.localName,S=y,f=T;if(f[L]!==void 0)switch(k.kind){case"oneof":const U=f[L].case;if(U===void 0)continue;const R=k.findField(U);let w=f[L].value;R&&R.kind=="message"&&!(w instanceof R.T)?w=new R.T(w):R&&R.kind==="scalar"&&R.T===m.w.BYTES&&(w=B(w)),S[L]={case:U,value:w};break;case"scalar":case"enum":let $=f[L];k.T===m.w.BYTES&&($=k.repeated?$.map(B):B($)),S[L]=$;break;case"map":switch(k.V.kind){case"scalar":case"enum":if(k.V.T===m.w.BYTES)for(const[O,V]of Object.entries(f[L]))S[L][O]=B(V);else Object.assign(S[L],f[L]);break;case"message":const q=k.V.T;for(const O of Object.keys(f[L])){let V=f[L][O];q.fieldWrapper||(V=new q(V)),S[L][O]=V}break}break;case"message":const Y=k.T;if(k.repeated)S[L]=f[L].map(q=>q instanceof Y?q:new Y(q));else if(f[L]!==void 0){const q=f[L];Y.fieldWrapper?Y.typeName==="google.protobuf.BytesValue"?S[L]=B(q):S[L]=q:S[L]=q instanceof Y?q:new Y(q)}break}}},equals(T,y,C){return y===C?!0:!y||!C?!1:T.fields.byMember().every(k=>{const L=y[k.localName],S=C[k.localName];if(k.repeated){if(L.length!==S.length)return!1;switch(k.kind){case"message":return L.every((f,U)=>k.T.equals(f,S[U]));case"scalar":return L.every((f,U)=>(0,x.AA)(k.T,f,S[U]));case"enum":return L.every((f,U)=>(0,x.AA)(m.w.INT32,f,S[U]))}throw new Error(`repeated cannot contain ${k.kind}`)}switch(k.kind){case"message":return k.T.equals(L,S);case"enum":return(0,x.AA)(m.w.INT32,L,S);case"scalar":return(0,x.AA)(k.T,L,S);case"oneof":if(L.case!==S.case)return!1;const f=k.findField(L.case);if(f===void 0)return!0;switch(f.kind){case"message":return f.T.equals(L.value,S.value);case"enum":return(0,x.AA)(m.w.INT32,L.value,S.value);case"scalar":return(0,x.AA)(f.T,L.value,S.value)}throw new Error(`oneof cannot contain ${f.kind}`);case"map":const U=Object.keys(L).concat(Object.keys(S));switch(k.V.kind){case"message":const R=k.V.T;return U.every($=>R.equals(L[$],S[$]));case"enum":return U.every($=>(0,x.AA)(m.w.INT32,L[$],S[$]));case"scalar":const w=k.V.T;return U.every($=>(0,x.AA)(w,L[$],S[$]))}break}})},clone(T){const y=T.getType(),C=new y,k=C;for(const L of y.fields.byMember()){const S=T[L.localName];let f;if(L.repeated)f=S.map(_);else if(L.kind=="map"){f=k[L.localName];for(const[U,R]of Object.entries(S))f[U]=_(R)}else L.kind=="oneof"?f=L.findField(S.case)?{case:S.case,value:_(S.value)}:{case:void 0}:f=_(S);k[L.localName]=f}return C}}}function _(T){if(T===void 0)return T;if(T instanceof g.v)return T.clone();if(T instanceof Uint8Array){const y=new Uint8Array(T.byteLength);return y.set(T),y}return T}function B(T){return T instanceof Uint8Array?T:new Uint8Array(T)}},236:(ce,A,D)=>{D.d(A,{W:()=>m});let l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),g=[];for(let x=0;x<l.length;x++)g[l[x].charCodeAt(0)]=x;g["-".charCodeAt(0)]=l.indexOf("+"),g["_".charCodeAt(0)]=l.indexOf("/");const m={dec(x){let b=x.length*3/4;x[x.length-2]=="="?b-=2:x[x.length-1]=="="&&(b-=1);let _=new Uint8Array(b),B=0,T=0,y,C=0;for(let k=0;k<x.length;k++){if(y=g[x.charCodeAt(k)],y===void 0)switch(x[k]){case"=":T=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(T){case 0:C=y,T=1;break;case 1:_[B++]=C<<2|(y&48)>>4,C=y,T=2;break;case 2:_[B++]=(C&15)<<4|(y&60)>>2,C=y,T=3;break;case 3:_[B++]=(C&3)<<6|y,T=0;break}}if(T==1)throw Error("invalid base64 string.");return _.subarray(0,B)},enc(x){let b="",_=0,B,T=0;for(let y=0;y<x.length;y++)switch(B=x[y],_){case 0:b+=l[B>>2],T=(B&3)<<4,_=1;break;case 1:b+=l[T|B>>4],T=(B&15)<<2,_=2;break;case 2:b+=l[T|B>>6],b+=l[B&63],_=0;break}return _&&(b+=l[T],b+="=",_==1&&(b+="=")),b}}},210:(ce,A,D)=>{D.d(A,{q:()=>x});var l=D(120),g=D(818);function m(){const b=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof b.getBigInt64=="function"&&typeof b.getBigUint64=="function"&&typeof b.setBigInt64=="function"&&typeof b.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const y=BigInt("-9223372036854775808"),C=BigInt("9223372036854775807"),k=BigInt("0"),L=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(S){const f=typeof S=="bigint"?S:BigInt(S);if(f>C||f<y)throw new Error(`int64 invalid: ${S}`);return f},uParse(S){const f=typeof S=="bigint"?S:BigInt(S);if(f>L||f<k)throw new Error(`uint64 invalid: ${S}`);return f},enc(S){return b.setBigInt64(0,this.parse(S),!0),{lo:b.getInt32(0,!0),hi:b.getInt32(4,!0)}},uEnc(S){return b.setBigInt64(0,this.uParse(S),!0),{lo:b.getInt32(0,!0),hi:b.getInt32(4,!0)}},dec(S,f){return b.setInt32(0,S,!0),b.setInt32(4,f,!0),b.getBigInt64(0,!0)},uDec(S,f){return b.setInt32(0,S,!0),b.setInt32(4,f,!0),b.getBigUint64(0,!0)}}}const B=y=>(0,l.hu)(/^-?[0-9]+$/.test(y),`int64 invalid: ${y}`),T=y=>(0,l.hu)(/^[0-9]+$/.test(y),`uint64 invalid: ${y}`);return{zero:"0",supported:!1,parse(y){return typeof y!="string"&&(y=y.toString()),B(y),y},uParse(y){return typeof y!="string"&&(y=y.toString()),T(y),y},enc(y){return typeof y!="string"&&(y=y.toString()),B(y),(0,g.CZ)(y)},uEnc(y){return typeof y!="string"&&(y=y.toString()),T(y),(0,g.CZ)(y)},dec(y,C){return(0,g.Ak)(y,C)},uDec(y,C){return(0,g.Fd)(y,C)}}}const x=m()},850:(ce,A,D)=>{D.d(A,{w:()=>f});var l=D(493),g=D(465),m=D(744);function x(){return Object.assign(Object.assign({},(0,m.gY)()),{writeMessage(R,w,$){const Y=R.getType();for(const q of Y.fields.byNumber()){let O,V=q.repeated,z=q.localName;if(q.oneof){const Z=R[q.oneof.localName];if(Z.case!==z)continue;O=Z.value}else O=R[z];switch(q.kind){case"scalar":case"enum":let Z=q.kind=="enum"?g.w.INT32:q.T;if(V)if(q.packed)(0,m.Jj)(w,Z,q.no,O);else for(const K of O)(0,m.NN)(w,Z,q.no,K,!0);else O!==void 0&&(0,m.NN)(w,Z,q.no,O,!!q.oneof||q.opt);break;case"message":if(V)for(const K of O)(0,m.oQ)(w,$,q,K);else(0,m.oQ)(w,$,q,O);break;case"map":for(const[K,te]of Object.entries(O))(0,m.gQ)(w,$,q,K,te);break}}return $.writeUnknownFields&&this.writeUnknownFields(R,w),w}})}var b=D(432),_=D(120),B=D(814);function T(){return(0,B.b)((R,w)=>function(Y,q,O){if(Y.kind=="map"){const V={};switch(Y.V.kind){case"scalar":for(const[Z,K]of Object.entries(q)){const te=w(Y.V.T,K,!0);(0,_.hu)(te!==void 0),V[Z.toString()]=te}break;case"message":for(const[Z,K]of Object.entries(q))V[Z.toString()]=K.toJson(O);break;case"enum":const z=Y.V.T;for(const[Z,K]of Object.entries(q)){(0,_.hu)(K===void 0||typeof K=="number");const te=R(z,K,!0,O.enumAsInteger);(0,_.hu)(te!==void 0),V[Z.toString()]=te}break}return O.emitDefaultValues||Object.keys(V).length>0?V:void 0}else if(Y.repeated){const V=[];switch(Y.kind){case"scalar":for(let z=0;z<q.length;z++)V.push(w(Y.T,q[z],!0));break;case"enum":for(let z=0;z<q.length;z++)V.push(R(Y.T,q[z],!0,O.enumAsInteger));break;case"message":for(let z=0;z<q.length;z++)V.push((0,b.E)(Y.T,q[z]).toJson(O));break}return O.emitDefaultValues||V.length>0?V:void 0}else switch(Y.kind){case"scalar":return w(Y.T,q,!!Y.oneof||Y.opt||O.emitDefaultValues);case"enum":return R(Y.T,q,!!Y.oneof||Y.opt||O.emitDefaultValues,O.enumAsInteger);case"message":return q!==void 0?(0,b.E)(Y.T,q).toJson(O):void 0}})}var y=D(433),C=D(501),k=D(781),L=D(215),S=D(504);const f=(0,l.F)("proto3",T(),x(),Object.assign(Object.assign({},(0,y.f)()),{newFieldList(R){return new C.i(R,U)},initFields(R){for(const w of R.getType().fields.byMember()){if(w.opt)continue;const $=w.localName,Y=R;if(w.repeated){Y[$]=[];continue}switch(w.kind){case"oneof":Y[$]={case:void 0};break;case"enum":Y[$]=0;break;case"map":Y[$]={};break;case"scalar":Y[$]=(0,k.kY)(w.T,w.L);break}}}}));function U(R){var w,$,Y,q;const O=[];let V;for(const z of typeof R=="function"?R():R){const Z=z;if(Z.localName=(0,S.Rz)(z.name,z.oneof!==void 0),Z.jsonName=(w=z.jsonName)!==null&&w!==void 0?w:(0,S.x1)(z.name),Z.repeated=($=z.repeated)!==null&&$!==void 0?$:!1,z.kind=="scalar"&&(Z.L=(Y=z.L)!==null&&Y!==void 0?Y:g.p.BIGINT),z.oneof!==void 0){const K=typeof z.oneof=="string"?z.oneof:z.oneof.name;(!V||V.name!=K)&&(V=new L.o(K)),Z.oneof=V,V.addField(Z)}z.kind=="message"&&(Z.delimited=!1),Z.packed=(q=z.packed)!==null&&q!==void 0?q:z.kind=="enum"||z.kind=="scalar"&&z.T!=g.w.BYTES&&z.T!=g.w.STRING,O.push(Z)}return O}},328:(ce,A,D)=>{D.d(A,{t:()=>l,w:()=>g});var l;(function(m){m[m.Unary=0]="Unary",m[m.ServerStreaming=1]="ServerStreaming",m[m.ClientStreaming=2]="ClientStreaming",m[m.BiDiStreaming=3]="BiDiStreaming"})(l||(l={}));var g;(function(m){m[m.NoSideEffects=1]="NoSideEffects",m[m.Idempotent=2]="Idempotent"})(g||(g={}))}},Ct={};function we(ce){var A=Ct[ce];if(A!==void 0)return A.exports;var D=Ct[ce]={exports:{}};return zt[ce](D,D.exports,we),D.exports}we.d=(ce,A)=>{for(var D in A)we.o(A,D)&&!we.o(ce,D)&&Object.defineProperty(ce,D,{enumerable:!0,get:A[D]})},we.o=(ce,A)=>Object.prototype.hasOwnProperty.call(ce,A),we.r=ce=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(ce,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ce,"__esModule",{value:!0})};var Ge={};return(()=>{we.r(Ge),we.d(Ge,{Change:()=>Kn,Client:()=>Ns,ClientEventType:()=>cn,ClientStatus:()=>Jn,Counter:()=>Or,Devtools:()=>ce,DocEventType:()=>le,Document:()=>ws,DocumentSyncResultType:()=>or,EventSourceDevPanel:()=>ys,EventSourceSDK:()=>Ts,Primitive:()=>_e,StreamConnectionStatus:()=>ir,SyncMode:()=>Gt,Text:()=>Ar,TimeTicket:()=>Ce,Tree:()=>Pr,converter:()=>Qe,default:()=>vi,setLogLevel:()=>l});var ce={};we.r(ce);var A;(function(r){r[r.Trivial=0]="Trivial",r[r.Debug=1]="Debug",r[r.Info=2]="Info",r[r.Warn=3]="Warn",r[r.Error=4]="Error",r[r.Fatal=5]="Fatal"})(A||(A={}));let D=A.Info;function l(r){D=r}const g={trivial:(...r)=>{D>A.Trivial||typeof console<"u"&&console.log("YORKIE T:",...r)},debug:(...r)=>{D>A.Debug||typeof console<"u"&&console.log("YORKIE D:",...r)},info:(...r)=>{D>A.Info||typeof console<"u"&&console.log("YORKIE I:",...r)},warn:(...r)=>{D>A.Warn||typeof console<"u"&&(typeof console.warn<"u"?console.warn("YORKIE W:",...r):console.log("YORKIE W:",...r))},error:(...r)=>{D>A.Error||typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE E:",...r):console.log("YORKIE E:",...r))},fatal:(r,...e)=>{throw typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE F:",...e):console.log("YORKIE F:",...e)),new Error(`YORKIE F: ${r}`)},isEnabled:r=>D<=r};function m(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}const x=()=>{};class b{constructor(e){this.finalized=!1,this.observers=[];try{e(this)}catch(t){this.error(t)}}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;e||g.fatal("missing observer"),this.finalized&&g.fatal("observable is finalized due to previous error"),typeof e=="object"?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=x),i.error===void 0&&(i.error=x),i.complete===void 0&&(i.complete=x);const u=m(),c=this.unsubscribeOne.bind(this,u);if(this.observers.push({subscriptionID:u,observer:i}),this.finalized)try{this.finalError?i.error(this.finalError):i.complete()}catch(d){g.warn(d)}return c}unsubscribeOne(e){var t;this.observers=(t=this.observers)===null||t===void 0?void 0:t.filter(n=>n.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e].observer)}catch(n){g.error(n)}}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.observers=void 0)}}function _(r){const e=new b(r);return{subscribe:e.subscribe.bind(e),getProxy:()=>e}}var B=we(328);function T(r,e){const t={};for(const[n,i]of Object.entries(r.methods)){const u=e(Object.assign(Object.assign({},i),{localName:n,service:r}));u!=null&&(t[n]=u)}return t}var y;(function(r){r[r.Canceled=1]="Canceled",r[r.Unknown=2]="Unknown",r[r.InvalidArgument=3]="InvalidArgument",r[r.DeadlineExceeded=4]="DeadlineExceeded",r[r.NotFound=5]="NotFound",r[r.AlreadyExists=6]="AlreadyExists",r[r.PermissionDenied=7]="PermissionDenied",r[r.ResourceExhausted=8]="ResourceExhausted",r[r.FailedPrecondition=9]="FailedPrecondition",r[r.Aborted=10]="Aborted",r[r.OutOfRange=11]="OutOfRange",r[r.Unimplemented=12]="Unimplemented",r[r.Internal=13]="Internal",r[r.Unavailable=14]="Unavailable",r[r.DataLoss=15]="DataLoss",r[r.Unauthenticated=16]="Unauthenticated"})(y||(y={}));var C=we(561);function k(r){const e=y[r];return typeof e!="string"?r.toString():e[0].toLowerCase()+e.substring(1).replace(/[A-Z]/g,t=>"_"+t.toLowerCase())}class L extends Error{constructor(e,t=y.Unknown,n,i,u){super(S(e,t)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(n!=null?n:{}),this.details=i!=null?i:[],this.cause=u}static from(e,t=y.Unknown){return e instanceof L?e:e instanceof Error?e.name=="AbortError"?new L(e.message,y.Canceled):new L(e.message,t,void 0,void 0,e):new L(String(e),t,void 0,void 0,e)}findDetails(e){const t="typeName"in e?{findMessage:i=>i===e.typeName?e:void 0}:e,n=[];for(const i of this.details){if(i instanceof C.v){t.findMessage(i.getType().typeName)&&n.push(i);continue}const u=t.findMessage(i.type);if(u)try{n.push(u.fromBinary(i.value))}catch{}}return n}}function S(r,e){return r.length?`[${k(e)}] ${r}`:`[${k(e)}]`}var f=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(u){t[u]=r[u]&&function(c){return new Promise(function(d,E){c=r[u](c),i(d,E,c.done,c.value)})}}function i(u,c,d,E){Promise.resolve(E).then(function(v){u({value:v,done:d})},c)}},U=function(r){return this instanceof U?(this.v=r,this):new U(r)},R=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,u=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(F){n[F]&&(i[F]=function(re){return new Promise(function(fe,he){u.push([F,re,fe,he])>1||d(F,re)})})}function d(F,re){try{E(n[F](re))}catch(fe){Q(u[0][3],fe)}}function E(F){F.value instanceof U?Promise.resolve(F.value.v).then(v,J):Q(u[0][2],F)}function v(F){d("next",F)}function J(F){d("throw",F)}function Q(F,re){F(re),u.shift(),u.length&&d(u[0][0],u[0][1])}},w=function(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,u){e[i]=r[i]?function(c){return(t=!t)?{value:U(r[i](c)),done:!1}:u?u(c):c}:u}};function $(r){return R(this,arguments,function*(){yield U(yield*w(f(r)))})}var Y=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(u){t[u]=r[u]&&function(c){return new Promise(function(d,E){c=r[u](c),i(d,E,c.done,c.value)})}}function i(u,c,d,E){Promise.resolve(E).then(function(v){u({value:v,done:d})},c)}},q=function(r){return this instanceof q?(this.v=r,this):new q(r)},O=function(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,u){e[i]=r[i]?function(c){return(t=!t)?{value:q(r[i](c)),done:!1}:u?u(c):c}:u}},V=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,u=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(F){n[F]&&(i[F]=function(re){return new Promise(function(fe,he){u.push([F,re,fe,he])>1||d(F,re)})})}function d(F,re){try{E(n[F](re))}catch(fe){Q(u[0][3],fe)}}function E(F){F.value instanceof q?Promise.resolve(F.value.v).then(v,J):Q(u[0][2],F)}function v(F){d("next",F)}function J(F){d("throw",F)}function Q(F,re){F(re),u.shift(),u.length&&d(u[0][0],u[0][1])}};function z(r,e){return T(r,t=>{switch(t.kind){case B.t.Unary:return Z(e,r,t);case B.t.ServerStreaming:return K(e,r,t);case B.t.ClientStreaming:return te(e,r,t);case B.t.BiDiStreaming:return Ae(e,r,t);default:return null}})}function Z(r,e,t){return async function(n,i){var u,c;const d=await r.unary(e,t,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,n,i==null?void 0:i.contextValues);return(u=i==null?void 0:i.onHeader)===null||u===void 0||u.call(i,d.header),(c=i==null?void 0:i.onTrailer)===null||c===void 0||c.call(i,d.trailer),d.message}}function K(r,e,t){return function(n,i){return W(r.stream(e,t,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,$([n]),i==null?void 0:i.contextValues),i)}}function te(r,e,t){return async function(n,i){var u,c,d,E,v,J;const Q=await r.stream(e,t,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,n,i==null?void 0:i.contextValues);(v=i==null?void 0:i.onHeader)===null||v===void 0||v.call(i,Q.header);let F;try{for(var re=!0,fe=Y(Q.message),he;he=await fe.next(),u=he.done,!u;re=!0)E=he.value,re=!1,F=E}catch(Te){c={error:Te}}finally{try{!re&&!u&&(d=fe.return)&&await d.call(fe)}finally{if(c)throw c.error}}if(!F)throw new L("protocol error: missing response message",y.Internal);return(J=i==null?void 0:i.onTrailer)===null||J===void 0||J.call(i,Q.trailer),F}}function Ae(r,e,t){return function(n,i){return W(r.stream(e,t,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,n,i==null?void 0:i.contextValues),i)}}function W(r,e){const t=function(){var n,i;return V(this,arguments,function*(){const u=yield q(r);(n=e==null?void 0:e.onHeader)===null||n===void 0||n.call(e,u.header),yield q(yield*O(Y(u.message))),(i=e==null?void 0:e.onTrailer)===null||i===void 0||i.call(e,u.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>t.next()})}}function Ee(){return{get(r){return r.id in this?this[r.id]:r.defaultValue},set(r,e){return this[r.id]=e,this},delete(r){return delete this[r.id],this}}}function ne(r){var e;const t=Object.assign({},r);return(e=t.ignoreUnknownFields)!==null&&e!==void 0||(t.ignoreUnknownFields=!0),t}function ue(r,e,t,n){const i=e?ke(r.I,n):pe(r.I,t);return{parse:(e?ke(r.O,n):pe(r.O,t)).parse,serialize:i.serialize}}function ke(r,e){return{parse(t){try{return r.fromBinary(t,e)}catch(n){const i=n instanceof Error?n.message:String(n);throw new L(`parse binary: ${i}`,y.InvalidArgument)}},serialize(t){try{return t.toBinary(e)}catch(n){const i=n instanceof Error?n.message:String(n);throw new L(`serialize binary: ${i}`,y.Internal)}}}}function pe(r,e){var t,n;const i=(t=e==null?void 0:e.textEncoder)!==null&&t!==void 0?t:new TextEncoder,u=(n=e==null?void 0:e.textDecoder)!==null&&n!==void 0?n:new TextDecoder,c=ne(e);return{parse(d){try{const E=u.decode(d);return r.fromJsonString(E,c)}catch(E){throw L.from(E,y.InvalidArgument)}},serialize(d){try{const E=d.toJsonString(c);return i.encode(E)}catch(E){throw L.from(E,y.Internal)}}}}function Le(...r){const e=new AbortController,t=r.filter(i=>i!==void 0).concat(e.signal);for(const i of t){if(i.aborted){n.apply(i);break}i.addEventListener("abort",n)}function n(){e.signal.aborted||e.abort(Re(this));for(const i of t)i.removeEventListener("abort",n)}return e}function ze(r){const e=new AbortController,t=()=>{e.abort(new L("the operation timed out",y.DeadlineExceeded))};let n;return r!==void 0&&(r<=0?t():n=setTimeout(t,r)),{signal:e.signal,cleanup:()=>clearTimeout(n)}}function Re(r){if(!r.aborted)return;if(r.reason!==void 0)return r.reason;const e=new Error("This operation was aborted");return e.name="AbortError",e}function ut(r,e){return e instanceof C.v?e:new r(e)}function ht(r,e){function t(n){return n.done===!0?n:{done:n.done,value:ut(r,n.value)}}return{[Symbol.asyncIterator](){const n=e[Symbol.asyncIterator](),i={next:()=>n.next().then(t)};return n.throw!==void 0&&(i.throw=u=>n.throw(u).then(t)),n.return!==void 0&&(i.return=u=>n.return(u).then(t)),i}}}function tt(r){const e=bt(r.next,r.interceptors),[t,n,i]=Rt(r),u=Object.assign(Object.assign({},r.req),{message:ut(r.req.method.I,r.req.message),signal:t});return e(u).then(c=>(i(),c),n)}function de(r){const e=bt(r.next,r.interceptors),[t,n,i]=Rt(r),u=Object.assign(Object.assign({},r.req),{message:ht(r.req.method.I,r.req.message),signal:t});let c=!1;return t.addEventListener("abort",function(){var d,E;const v=r.req.message[Symbol.asyncIterator]();c||(d=v.throw)===null||d===void 0||d.call(v,this.reason).catch(()=>{}),(E=v.return)===null||E===void 0||E.call(v).catch(()=>{})}),e(u).then(d=>Object.assign(Object.assign({},d),{message:{[Symbol.asyncIterator](){const E=d.message[Symbol.asyncIterator]();return{next(){return E.next().then(v=>(v.done==!0&&(c=!0,i()),v),n)}}}}}),n)}function Rt(r){const{signal:e,cleanup:t}=ze(r.timeoutMs),n=Le(r.signal,e);return[n.signal,function(u){const c=L.from(e.aborted?Re(e):u);return n.abort(c),t(),Promise.reject(c)},function(){t(),n.abort()}]}function bt(r,e){var t;return(t=e==null?void 0:e.concat().reverse().reduce((n,i)=>i(n),r))!==null&&t!==void 0?t:r}function ct(r,e,t){const n=typeof e=="string"?e:e.typeName,i=typeof t=="string"?t:t.name;return r.toString().replace(/\/?$/,`/${n}/${i}`)}function mt(r){let e,t=new Uint8Array(0);function n(i){const u=new Uint8Array(t.length+i.length);u.set(t),u.set(i,t.length),t=u}return new ReadableStream({start(){e=r.getReader()},async pull(i){let u;for(;;){if(u===void 0&&t.byteLength>=5){let E=0;for(let v=1;v<5;v++)E=(E<<8)+t[v];u={flags:t[0],length:E}}if(u!==void 0&&t.byteLength>=u.length+5)break;const d=await e.read();if(d.done)break;n(d.value)}if(u===void 0){if(t.byteLength==0){i.close();return}i.error(new L("premature end of stream",y.DataLoss));return}const c=t.subarray(5,5+u.length);t=t.subarray(5+u.length),i.enqueue({flags:u.flags,data:c})}})}function lt(r,e){const t=new Uint8Array(e.length+5);t.set(e,5);const n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setUint8(0,r),n.setUint32(1,e.length),t}const St="Content-Type",Xe="Grpc-Timeout",ee="Grpc-Status",Xt="Grpc-Message",xt="Grpc-Status-Details-Bin",Ht="User-Agent",Dn="X-User-Agent",gn="X-Grpc-Web",Fn="application/grpc-web+proto",Un="application/grpc-web+json";function Ut(r,e,t,n){const i=new Headers(t!=null?t:{});return i.set(St,r?Fn:Un),i.set(gn,"1"),i.set(Dn,"connect-es/1.2.0"),n&&i.set(Ht,"connect-es/1.2.0"),e!==void 0&&i.set(Xe,`${e}m`),i}function Zt(r){switch(r){case 400:return y.Internal;case 401:return y.Unauthenticated;case 403:return y.PermissionDenied;case 404:return y.Unimplemented;case 429:return y.Unavailable;case 502:return y.Unavailable;case 503:return y.Unavailable;case 504:return y.Unavailable;default:return y.Unknown}}var It=we(850),Qt=we(733);class He extends C.v{constructor(e){super(),this.code=0,this.message="",this.details=[],It.w.util.initPartial(e,this)}static fromBinary(e,t){return new He().fromBinary(e,t)}static fromJson(e,t){return new He().fromJson(e,t)}static fromJsonString(e,t){return new He().fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(He,e,t)}}He.runtime=It.w,He.typeName="google.rpc.Status",He.fields=It.w.util.newFieldList(()=>[{no:1,name:"code",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"details",kind:"message",T:Qt.I,repeated:!0}]);var en=we(236);function ln(r,e,t){try{const n=en.W.dec(r);return e?e.fromBinary(n,t):n}catch(n){throw L.from(n,y.DataLoss)}}const Ze="0";function $t(r){var e;const t=r.get(xt);if(t!=null){const i=ln(t,He);if(i.code==0)return;const u=new L(i.message,i.code,r);return u.details=i.details.map(c=>({type:c.typeUrl.substring(c.typeUrl.lastIndexOf("/")+1),value:c.value})),u}const n=r.get(ee);if(n!=null){if(n===Ze)return;const i=parseInt(n,10);return i in y?new L(decodeURIComponent((e=r.get(Xt))!==null&&e!==void 0?e:""),i,r):new L(`invalid grpc-status: ${n}`,y.Internal,r)}}function xe(r,e){var t;if(r>=200&&r<300){const n=$t(e);if(n)throw n;return{foundStatus:e.has(ee)}}throw new L(decodeURIComponent((t=e.get(Xt))!==null&&t!==void 0?t:`HTTP ${r}`),Zt(r),e)}const En=128;function Cn(r){const e=new Headers,t=new TextDecoder().decode(r).split(`\r
`);for(const n of t){if(n==="")continue;const i=n.indexOf(":");if(i>0){const u=n.substring(0,i).trim(),c=n.substring(i+1).trim();e.append(u,c)}}return e}function pn(r,e){const t=$t(r);if(t)throw e.forEach((n,i)=>{t.metadata.append(i,n)}),t}function $n(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}var Vt=function(r){return this instanceof Vt?(this.v=r,this):new Vt(r)},Vn=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,u=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(F){n[F]&&(i[F]=function(re){return new Promise(function(fe,he){u.push([F,re,fe,he])>1||d(F,re)})})}function d(F,re){try{E(n[F](re))}catch(fe){Q(u[0][3],fe)}}function E(F){F.value instanceof Vt?Promise.resolve(F.value.v).then(v,J):Q(u[0][2],F)}function v(F){d("next",F)}function J(F){d("throw",F)}function Q(F,re){F(re),u.shift(),u.length&&d(u[0][0],u[0][1])}};function tn(r){var e;$n();const t=(e=r.useBinaryFormat)!==null&&e!==void 0?e:!0;return{async unary(n,i,u,c,d,E,v){var J;const{serialize:Q,parse:F}=ue(i,t,r.jsonOptions,r.binaryOptions);return c=c===void 0?r.defaultTimeoutMs:c<=0?void 0:c,await tt({interceptors:r.interceptors,signal:u,timeoutMs:c,req:{stream:!1,service:n,method:i,url:ct(r.baseUrl,n,i),init:{method:"POST",credentials:(J=r.credentials)!==null&&J!==void 0?J:"same-origin",redirect:"error",mode:"cors"},header:Ut(t,c,d,!1),contextValues:v!=null?v:Ee(),message:E},next:async re=>{var fe;const Te=await((fe=r.fetch)!==null&&fe!==void 0?fe:globalThis.fetch)(re.url,Object.assign(Object.assign({},re.init),{headers:re.header,signal:re.signal,body:lt(0,Q(re.message))}));if(xe(Te.status,Te.headers),!Te.body)throw"missing response body";const rt=mt(Te.body).getReader();let ve,je;for(;;){const Ue=await rt.read();if(Ue.done)break;const{flags:et,data:Gn}=Ue.value;if(et===En){if(ve!==void 0)throw"extra trailer";ve=Cn(Gn);continue}if(je!==void 0)throw"extra message";je=F(Gn)}if(ve===void 0)throw"missing trailer";if(pn(ve,Te.headers),je===void 0)throw"missing message";return{stream:!1,header:Te.headers,message:je,trailer:ve}}})},async stream(n,i,u,c,d,E,v){var J;const{serialize:Q,parse:F}=ue(i,t,r.jsonOptions,r.binaryOptions);function re(he,Te,rt,ve){return Vn(this,arguments,function*(){const Ue=mt(he).getReader();if(Te){if(!(yield Vt(Ue.read())).done)throw"extra data for trailers-only";return yield Vt(void 0)}let et=!1;for(;;){const Gn=yield Vt(Ue.read());if(Gn.done)break;const{flags:ar,data:gr}=Gn.value;if((ar&En)===En){if(et)throw"extra trailer";et=!0;const bs=Cn(gr);pn(bs,ve),bs.forEach((wi,Ei)=>rt.set(Ei,wi));continue}if(et)throw"extra message";yield yield Vt(F(gr))}if(!et)throw"missing trailer"})}async function fe(he){if(i.kind!=B.t.ServerStreaming)throw"The fetch API does not support streaming request bodies";const Te=await he[Symbol.asyncIterator]().next();if(Te.done==!0)throw"missing request message";return lt(0,Q(Te.value))}return c=c===void 0?r.defaultTimeoutMs:c<=0?void 0:c,de({interceptors:r.interceptors,signal:u,timeoutMs:c,req:{stream:!0,service:n,method:i,url:ct(r.baseUrl,n,i),init:{method:"POST",credentials:(J=r.credentials)!==null&&J!==void 0?J:"same-origin",redirect:"error",mode:"cors"},header:Ut(t,c,d,!1),contextValues:v!=null?v:Ee(),message:E},next:async he=>{var Te;const ve=await((Te=r.fetch)!==null&&Te!==void 0?Te:globalThis.fetch)(he.url,Object.assign(Object.assign({},he.init),{headers:he.header,signal:he.signal,body:await fe(he.message)})),{foundStatus:je}=xe(ve.status,ve.headers);if(!ve.body)throw"missing response body";const Ue=new Headers;return Object.assign(Object.assign({},he),{header:ve.headers,trailer:Ue,message:re(ve.body,je,Ue,ve.headers)})}})}}}var nn=we(295),M=we(646);/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var Fe=null;try{Fe=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ye(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}ye.prototype.__isLong__,Object.defineProperty(ye.prototype,"__isLong__",{value:!0});function Oe(r){return(r&&r.__isLong__)===!0}function Rn(r){var e=Math.clz32(r&-r);return r?31-e:e}ye.isLong=Oe;var pr={},yr={};function Nn(r,e){var t,n,i;return e?(r>>>=0,(i=0<=r&&r<256)&&(n=yr[r],n)?n:(t=Se(r,0,!0),i&&(yr[r]=t),t)):(r|=0,(i=-128<=r&&r<128)&&(n=pr[r],n)?n:(t=Se(r,r<0?-1:0,!1),i&&(pr[r]=t),t))}ye.fromInt=Nn;function _t(r,e){if(isNaN(r))return e?rn:Yt;if(e){if(r<0)return rn;if(r>=cr)return Er}else{if(r<=-Tr)return gt;if(r+1>=Tr)return In}return r<0?_t(-r,e).neg():Se(r%bn|0,r/bn|0,e)}ye.fromNumber=_t;function Se(r,e,t){return new ye(r,e,t)}ye.fromBits=Se;var zn=Math.pow;function Xn(r,e,t){if(r.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return e?rn:Yt;if(t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return Xn(r.substring(1),e,t).neg();for(var i=_t(zn(t,8)),u=Yt,c=0;c<r.length;c+=8){var d=Math.min(8,r.length-c),E=parseInt(r.substring(c,c+d),t);if(d<8){var v=_t(zn(t,d));u=u.mul(v).add(_t(E))}else u=u.mul(i),u=u.add(_t(E))}return u.unsigned=e,u}ye.fromString=Xn;function jt(r,e){return typeof r=="number"?_t(r,e):typeof r=="string"?Xn(r,e):Se(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}ye.fromValue=jt;var Hn=1<<16,ur=1<<24,bn=Hn*Hn,cr=bn*bn,Tr=cr/2,vr=Nn(ur),Yt=Nn(0);ye.ZERO=Yt;var rn=Nn(0,!0);ye.UZERO=rn;var Sn=Nn(1);ye.ONE=Sn;var wr=Nn(1,!0);ye.UONE=wr;var xn=Nn(-1);ye.NEG_ONE=xn;var In=Se(-1,2147483647,!1);ye.MAX_VALUE=In;var Er=Se(-1,-1,!0);ye.MAX_UNSIGNED_VALUE=Er;var gt=Se(0,-2147483648,!1);ye.MIN_VALUE=gt;var G=ye.prototype;G.toInt=function(){return this.unsigned?this.low>>>0:this.low},G.toNumber=function(){return this.unsigned?(this.high>>>0)*bn+(this.low>>>0):this.high*bn+(this.low>>>0)},G.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(gt)){var t=_t(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var u=_t(zn(e,6),this.unsigned),c=this,d="";;){var E=c.div(u),v=c.sub(E.mul(u)).toInt()>>>0,J=v.toString(e);if(c=E,c.isZero())return J+d;for(;J.length<6;)J="0"+J;d=""+J+d}},G.getHighBits=function(){return this.high},G.getHighBitsUnsigned=function(){return this.high>>>0},G.getLowBits=function(){return this.low},G.getLowBitsUnsigned=function(){return this.low>>>0},G.getNumBitsAbs=function(){if(this.isNegative())return this.eq(gt)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1},G.isZero=function(){return this.high===0&&this.low===0},G.eqz=G.isZero,G.isNegative=function(){return!this.unsigned&&this.high<0},G.isPositive=function(){return this.unsigned||this.high>=0},G.isOdd=function(){return(this.low&1)===1},G.isEven=function(){return(this.low&1)===0},G.equals=function(e){return Oe(e)||(e=jt(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},G.eq=G.equals,G.notEquals=function(e){return!this.eq(e)},G.neq=G.notEquals,G.ne=G.notEquals,G.lessThan=function(e){return this.comp(e)<0},G.lt=G.lessThan,G.lessThanOrEqual=function(e){return this.comp(e)<=0},G.lte=G.lessThanOrEqual,G.le=G.lessThanOrEqual,G.greaterThan=function(e){return this.comp(e)>0},G.gt=G.greaterThan,G.greaterThanOrEqual=function(e){return this.comp(e)>=0},G.gte=G.greaterThanOrEqual,G.ge=G.greaterThanOrEqual,G.compare=function(e){if(Oe(e)||(e=jt(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},G.comp=G.compare,G.negate=function(){return!this.unsigned&&this.eq(gt)?gt:this.not().add(Sn)},G.neg=G.negate,G.add=function(e){Oe(e)||(e=jt(e));var t=this.high>>>16,n=this.high&65535,i=this.low>>>16,u=this.low&65535,c=e.high>>>16,d=e.high&65535,E=e.low>>>16,v=e.low&65535,J=0,Q=0,F=0,re=0;return re+=u+v,F+=re>>>16,re&=65535,F+=i+E,Q+=F>>>16,F&=65535,Q+=n+d,J+=Q>>>16,Q&=65535,J+=t+c,J&=65535,Se(F<<16|re,J<<16|Q,this.unsigned)},G.subtract=function(e){return Oe(e)||(e=jt(e)),this.add(e.neg())},G.sub=G.subtract,G.multiply=function(e){if(this.isZero())return this;if(Oe(e)||(e=jt(e)),Fe){var t=Fe.mul(this.low,this.high,e.low,e.high);return Se(t,Fe.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?rn:Yt;if(this.eq(gt))return e.isOdd()?gt:Yt;if(e.eq(gt))return this.isOdd()?gt:Yt;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(vr)&&e.lt(vr))return _t(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,u=this.low>>>16,c=this.low&65535,d=e.high>>>16,E=e.high&65535,v=e.low>>>16,J=e.low&65535,Q=0,F=0,re=0,fe=0;return fe+=c*J,re+=fe>>>16,fe&=65535,re+=u*J,F+=re>>>16,re&=65535,re+=c*v,F+=re>>>16,re&=65535,F+=i*J,Q+=F>>>16,F&=65535,F+=u*v,Q+=F>>>16,F&=65535,F+=c*E,Q+=F>>>16,F&=65535,Q+=n*J+i*v+u*E+c*d,Q&=65535,Se(re<<16|fe,Q<<16|F,this.unsigned)},G.mul=G.multiply,G.divide=function(e){if(Oe(e)||(e=jt(e)),e.isZero())throw Error("division by zero");if(Fe){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Fe.div_u:Fe.div_s)(this.low,this.high,e.low,e.high);return Se(t,Fe.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?rn:Yt;var n,i,u;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return rn;if(e.gt(this.shru(1)))return wr;u=rn}else{if(this.eq(gt)){if(e.eq(Sn)||e.eq(xn))return gt;if(e.eq(gt))return Sn;var c=this.shr(1);return n=c.div(e).shl(1),n.eq(Yt)?e.isNegative()?Sn:xn:(i=this.sub(e.mul(n)),u=n.add(i.div(e)),u)}else if(e.eq(gt))return this.unsigned?rn:Yt;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();u=Yt}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var d=Math.ceil(Math.log(n)/Math.LN2),E=d<=48?1:zn(2,d-48),v=_t(n),J=v.mul(e);J.isNegative()||J.gt(i);)n-=E,v=_t(n,this.unsigned),J=v.mul(e);v.isZero()&&(v=Sn),u=u.add(v),i=i.sub(J)}return u},G.div=G.divide,G.modulo=function(e){if(Oe(e)||(e=jt(e)),Fe){var t=(this.unsigned?Fe.rem_u:Fe.rem_s)(this.low,this.high,e.low,e.high);return Se(t,Fe.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},G.mod=G.modulo,G.rem=G.modulo,G.not=function(){return Se(~this.low,~this.high,this.unsigned)},G.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},G.clz=G.countLeadingZeros,G.countTrailingZeros=function(){return this.low?Rn(this.low):Rn(this.high)+32},G.ctz=G.countTrailingZeros,G.and=function(e){return Oe(e)||(e=jt(e)),Se(this.low&e.low,this.high&e.high,this.unsigned)},G.or=function(e){return Oe(e)||(e=jt(e)),Se(this.low|e.low,this.high|e.high,this.unsigned)},G.xor=function(e){return Oe(e)||(e=jt(e)),Se(this.low^e.low,this.high^e.high,this.unsigned)},G.shiftLeft=function(e){return Oe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Se(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Se(0,this.low<<e-32,this.unsigned)},G.shl=G.shiftLeft,G.shiftRight=function(e){return Oe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Se(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Se(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},G.shr=G.shiftRight,G.shiftRightUnsigned=function(e){return Oe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Se(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?Se(this.high,0,this.unsigned):Se(this.high>>>e-32,0,this.unsigned)},G.shru=G.shiftRightUnsigned,G.shr_u=G.shiftRightUnsigned,G.rotateLeft=function(e){var t;return Oe(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?Se(this.high,this.low,this.unsigned):e<32?(t=32-e,Se(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,Se(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},G.rotl=G.rotateLeft,G.rotateRight=function(e){var t;return Oe(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?Se(this.high,this.low,this.unsigned):e<32?(t=32-e,Se(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,Se(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},G.rotr=G.rotateRight,G.toSigned=function(){return this.unsigned?Se(this.low,this.high,!1):this},G.toUnsigned=function(){return this.unsigned?this:Se(this.low,this.high,!0)},G.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},G.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]},G.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]},ye.fromBytes=function(e,t,n){return n?ye.fromBytesLE(e,t):ye.fromBytesBE(e,t)},ye.fromBytesLE=function(e,t){return new ye(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},ye.fromBytesBE=function(e,t){return new ye(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const Ye=ye;var Ne;(function(r){r.Ok="ok",r.ClientNotActive="client-not-active",r.Unimplemented="unimplemented",r.Unsupported="unsupported",r.DocumentNotAttached="document-not-attached",r.DocumentNotDetached="document-not-detached",r.DocumentRemoved="document-removed",r.InvalidObjectKey="invalid-object-key",r.InvalidArgument="invalid-argument"})(Ne||(Ne={}));class Ie extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="YorkieError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}function qe(r){if(r instanceof Map){const e=Array.from(r);return new Map(JSON.parse(JSON.stringify(e)))}return JSON.parse(JSON.stringify(r))}const st=r=>r?Object.entries(r).length===0:!0,_n=r=>{const e={};for(const[t,n]of Object.entries(r))e[t]=JSON.stringify(n);return e},kn=r=>{const e={};for(const[t,n]of Object.entries(r))e[t]=JSON.parse(n);return e};var qt;(function(r){r.Put="put",r.Clear="clear"})(qt||(qt={}));class pt{constructor(e,t){this.context=e,this.presence=t}set(e,t){for(const n of Object.keys(e))this.presence[n]=e[n];this.context.setPresenceChange({type:qt.Put,presence:qe(this.presence)}),this.context.setReversePresence(e,t)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:qt.Clear})}}const yt="000000000000000000000000",lr="FFFFFFFFFFFFFFFFFFFFFFFF";class Ce{constructor(e,t,n){this.lamport=e,this.delimiter=t,this.actorID=n}static of(e,t,n){return new Ce(e,t,n)}static fromStruct(e){return Ce.of(Ye.fromString(e.lamport,!0),e.delimiter,e.actorID)}toIDString(){return`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`}setActor(e){return new Ce(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return this.compare(e)===0}compare(e){if(this.lamport.greaterThan(e.lamport))return 1;if(e.lamport.greaterThan(this.lamport))return-1;const t=this.actorID.localeCompare(e.actorID);return t!==0?t:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}}const Lt=0,An=4294967295,Bt=Ye.MAX_VALUE,Be=new Ce(Ye.fromNumber(0),Lt,yt);new Ce(Ye.fromNumber(1),Lt+1,yt);const Tt=new Ce(Bt,An,lr);function fn(r){return r.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case`
`:return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}class ft{constructor(e){this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setMovedAt(e){return!this.movedAt||e&&e.after(this.movedAt)?(this.movedAt=e,!0):!1}setRemovedAt(e){this.removedAt=e}remove(e){return e&&e.after(this.getPositionedAt())&&(!this.removedAt||e.after(this.removedAt))?(this.removedAt=e,!0):!1}isRemoved(){return!!this.removedAt}}class Ke extends ft{constructor(e){super(e)}}class kt extends ft{}class vt{constructor(e,t){this.strKey=e,this.value=t}static of(e,t){return new vt(e,t)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}}class it{constructor(){this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new it}set(e,t,n){let i;const u=this.nodeMapByKey.get(e);u!=null&&!u.isRemoved()&&u.remove(n)&&(i=u.getValue());const c=vt.of(e,t);return this.nodeMapByCreatedAt.set(t.getCreatedAt().toIDString(),c),(u==null||n.after(u.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,c),t.setMovedAt(n)),i}delete(e,t){this.nodeMapByCreatedAt.has(e.toIDString())||g.fatal(`fail to find ${e.toIDString()}`);const n=this.nodeMapByCreatedAt.get(e.toIDString());return n.remove(t),n.getValue()}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(!!t)return t.getStrKey()}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t){g.fatal(`fail to find ${e.getCreatedAt().toIDString()}`);return}const n=this.nodeMapByKey.get(t.getStrKey());t===n&&this.nodeMapByKey.delete(n.getStrKey()),this.nodeMapByCreatedAt.delete(t.getValue().getCreatedAt().toIDString())}deleteByKey(e,t){const n=this.nodeMapByKey.get(e);if(n!=null&&!!n.remove(t))return n.getValue()}has(e){const t=this.nodeMapByKey.get(e);return t==null?!1:!t.isRemoved()}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){const t=this.nodeMapByKey.get(e);if(!(!t||t.isRemoved()))return t}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}}class Pe extends Ke{constructor(e,t){super(e),this.memberNodes=t}static create(e,t){if(!t)return new Pe(e,it.create());const n=it.create();for(const[i,u]of Object.entries(t))n.set(i,u.deepcopy(),u.getCreatedAt());return new Pe(e,n)}subPathOf(e){return this.memberNodes.subPathOf(e)}purge(e){this.memberNodes.purge(e)}set(e,t,n){return this.memberNodes.set(e,t,n)}delete(e,t){return this.memberNodes.delete(e,t)}deleteByKey(e,t){return this.memberNodes.deleteByKey(e,t)}get(e){const t=this.memberNodes.get(e);return t==null?void 0:t.getValue()}getByID(e){const t=this.memberNodes.getByID(e);return t==null?void 0:t.getValue()}has(e){return this.memberNodes.has(e)}toJSON(){const e=[];for(const[t,n]of this)e.push(`"${fn(t)}":${n.toJSON()}`);return`{${e.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const e={};for(const[t,n]of this){const{createdAt:i,value:u,type:c}=n.toJSForTest();e[t]={key:t,createdAt:i,value:u,type:c}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_OBJECT"}}getKeys(){const e=Array();for(const[t]of this)e.push(t);return e}toSortedJSON(){var e;const t=Array();for(const[i]of this)t.push(i);const n=[];for(const i of t.sort()){const u=(e=this.memberNodes.get(i))===null||e===void 0?void 0:e.getValue();n.push(`"${fn(i)}":${u.toSortedJSON()}`)}return`{${n.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){const e=Pe.create(this.getCreatedAt());for(const t of this.memberNodes)e.memberNodes.set(t.getStrKey(),t.getValue().deepcopy(),this.getPositionedAt());return e.remove(this.getRemovedAt()),e}getDescendants(e){for(const t of this.memberNodes){const n=t.getValue();if(e(n,this))return;n instanceof Ke&&n.getDescendants(e)}}*[Symbol.iterator](){const e=new Set;for(const t of this.memberNodes)e.has(t.getStrKey())||(e.add(t.getStrKey()),t.isRemoved()||(yield[t.getStrKey(),t.getValue()]))}}var ge;(function(r){r.Local="local",r.Remote="remote",r.UndoRedo="undoredo"})(ge||(ge={}));class Me{constructor(e,t){this.parentCreatedAt=e,this.executedAt=t}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw new Error("executedAt has not been set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}}class At{constructor(e){this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}}class jn{constructor(e){this.root=e}get length(){return this.root?this.root.getWeight():0}find(e){if(!this.root||e<0)return[void 0,0];let t=this.root;for(;;)if(t.hasLeft()&&e<=t.getLeftWeight())t=t.getLeft();else if(t.hasRight()&&t.getLeftWeight()+t.getLength()<e)e-=t.getLeftWeight()+t.getLength(),t=t.getRight();else{e-=t.getLeftWeight();break}return e>t.getLength()&&g.fatal(`out of index range: pos: ${e} > node.length: ${t.getLength()}`),[t,e]}indexOf(e){if(!e||e!==this.root&&!e.hasLinks())return-1;let t=0,n=e,i;for(;n;)(!i||i===n.getRight())&&(t+=n.getLength()+(n.hasLeft()?n.getLeftWeight():0)),i=n,n=n.getParent();return t-e.getLength()}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,t){return e?(this.splayNode(e),this.root=t,t.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(t),t.setLeft(e),e.setParent(t),e.setRight(),this.updateWeight(e),this.updateWeight(t),t):(this.root=t,t)}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(!!e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);const t=new jn(e.getLeft());t.root&&t.root.setParent();const n=new jn(e.getRight());if(n.root&&n.root.setParent(),t.root){const i=t.getRightmost();t.splayNode(i),t.root.setRight(n.root),n.root&&n.root.setParent(t.root),this.root=t.root}else this.root=n.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,t){if(!t){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(t),t.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){const t=[];this.traversePostorder(e.getRight(),t);for(const n of t)n.initWeight();this.updateTreeWeight(e)}toTestString(){const e=[];return this.traverseInorder(this.root,e),e.map(t=>`[${t.getWeight()},${t.getLength()}]${t.getValue()||""}`).join("")}checkWeight(){const e=[];this.traverseInorder(this.root,e);for(const t of e)if(t.getWeight()!=t.getLength()+t.getLeftWeight()+t.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,t){!e||(this.traverseInorder(e.getLeft(),t),t.push(e),this.traverseInorder(e.getRight(),t))}traversePostorder(e,t){!e||(this.traversePostorder(e.getLeft(),t),this.traversePostorder(e.getRight(),t),t.push(e))}rotateLeft(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setRight(e.getLeft()),t.hasRight()&&t.getRight().setParent(t),e.setLeft(t),e.getLeft().setParent(e),this.updateWeight(t),this.updateWeight(e)}rotateRight(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setLeft(e.getRight()),t.hasLeft()&&t.getLeft().setParent(t),e.setRight(t),e.getRight().setParent(e),this.updateWeight(t),this.updateWeight(e)}isLeftChild(e){return e&&e.hasParent()?e.getParent().getLeft()===e:!1}isRightChild(e){return e&&e.hasParent()?e.getParent().getRight()===e:!1}}var ae;(function(r){r[r.Null=0]="Null",r[r.Boolean=1]="Boolean",r[r.Integer=2]="Integer",r[r.Long=3]="Long",r[r.Double=4]="Double",r[r.String=5]="String",r[r.Bytes=6]="Bytes",r[r.Date=7]="Date"})(ae||(ae={}));class _e extends ft{constructor(e,t){super(t),this.valueType=_e.getPrimitiveType(e),this.value=e===void 0?null:e}static of(e,t){return new _e(e,t)}static valueFromBytes(e,t){switch(e){case ae.Null:return null;case ae.Boolean:return!!t[0];case ae.Integer:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case ae.Double:{const n=new DataView(t.buffer);return t.forEach(function(i,u){n.setUint8(u,i)}),n.getFloat64(0,!0)}case ae.String:return new TextDecoder("utf-8").decode(t);case ae.Long:return Ye.fromBytesLE(Array.from(t));case ae.Bytes:return t;case ae.Date:return new Date(Ye.fromBytesLE(Array.from(t),!0).toNumber());default:throw new Ie(Ne.Unimplemented,`unimplemented type: ${e}`)}}toJSON(){return this.valueType===ae.String?`"${fn(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){const e=_e.of(this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e.setRemovedAt(this.getRemovedAt()),e}getType(){return this.valueType}static getPrimitiveType(e){switch(typeof e){case"undefined":return ae.Null;case"boolean":return ae.Boolean;case"number":return this.isInteger(e)?ae.Integer:ae.Double;case"string":return ae.String;case"object":if(e===null)return ae.Null;if(e instanceof Ye)return ae.Long;if(e instanceof Uint8Array)return ae.Bytes;if(e instanceof Date)return ae.Date}}static isSupport(e){return _e.getPrimitiveType(e)!==void 0}static isInteger(e){return e%1===0}isNumericType(){const e=this.valueType;return e===ae.Integer||e===ae.Long||e===ae.Double}getValue(){return this.value}toBytes(){switch(this.valueType){case ae.Null:return new Uint8Array;case ae.Boolean:return this.value?new Uint8Array([1]):new Uint8Array([0]);case ae.Integer:{const e=this.value;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}case ae.Double:{const e=this.value,t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),t}case ae.String:return new TextEncoder().encode(this.value);case ae.Long:{const t=this.value.toBytesLE();return Uint8Array.from(t)}case ae.Bytes:return this.value;case ae.Date:{const e=this.value,t=Ye.fromNumber(e.getTime(),!0).toBytesLE();return Uint8Array.from(t)}default:throw new Ie(Ne.Unimplemented,`unimplemented type: ${this.valueType}`)}}}class Zn extends At{constructor(e){super(e),this.value=e}static createAfter(e,t){const n=new Zn(t),i=e.next;return e.next=n,n.prev=e,n.next=i,i&&(i.prev=n),n}remove(e){return this.value.remove(e)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}}class Yn{constructor(){const e=_e.of(0,Be);e.setRemovedAt(Be),this.dummyHead=new Zn(e),this.last=this.dummyHead,this.nodeMapByIndex=new jn,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new Yn}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,t){let n=this.nodeMapByCreatedAt.get(e.toIDString());for(n||g.fatal(`cant find the given node: ${e.toIDString()}`);n.getNext()&&n.getNext().getPositionedAt().after(t);)n=n.getNext();return n}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,t,n=t.getCreatedAt()){const i=this.findNextBeforeExecutedAt(e,n),u=Zn.createAfter(i,t);i===this.last&&(this.last=u),this.nodeMapByIndex.insertAfter(i,u),this.nodeMapByCreatedAt.set(u.getCreatedAt().toIDString(),u)}moveAfter(e,t,n){const i=this.nodeMapByCreatedAt.get(e.toIDString());i||g.fatal(`cant find the given node: ${e.toIDString()}`);const u=this.nodeMapByCreatedAt.get(t.toIDString());u||g.fatal(`cant find the given node: ${t.toIDString()}`),i!==u&&(!u.getValue().getMovedAt()||n.after(u.getValue().getMovedAt()))&&(this.release(u),this.insertAfter(i.getCreatedAt(),u.getValue(),n),u.getValue().setMovedAt(n))}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(!!t)return String(this.nodeMapByIndex.indexOf(t))}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());t||g.fatal(`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`),this.release(t)}getByIndex(e){if(e>=this.length)return;const[t,n]=this.nodeMapByIndex.find(e);let i=t;if(e===0&&t===this.dummyHead||n>0)do i&&(i=i.getNext());while(i&&i.isRemoved());return i}getPrevCreatedAt(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());do t=t.getPrev();while(this.dummyHead!==t&&t.isRemoved());return t.getValue().getCreatedAt()}delete(e,t){const n=this.nodeMapByCreatedAt.get(e.toIDString()),i=n.isRemoved();return n.remove(t)&&!i&&this.nodeMapByIndex.splayNode(n),n.getValue()}deleteByIndex(e,t){const n=this.getByIndex(e);if(!!n)return n.remove(t)&&this.nodeMapByIndex.splayNode(n),n.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){const e=[];for(const t of this){const n=`${t.getCreatedAt().toIDString()}:${t.getValue().toJSON()}`;t.isRemoved()?e.push(`{${n}}`):e.push(`[${n}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}}class Ot extends Ke{constructor(e,t){super(e),this.elements=t}static create(e,t){if(!t)return new Ot(e,Yn.create());const n=Yn.create();for(const i of t)n.insertAfter(n.getLastCreatedAt(),i.deepcopy());return new Ot(e,n)}subPathOf(e){return this.elements.subPathOf(e)}purge(e){this.elements.purge(e)}insertAfter(e,t){this.elements.insertAfter(e,t)}moveAfter(e,t,n){this.elements.moveAfter(e,t,n)}get(e){const t=this.elements.getByIndex(e);return t==null?void 0:t.getValue()}getByID(e){const t=this.elements.getByID(e);return t==null?void 0:t.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(e){return this.elements.getPrevCreatedAt(e)}delete(e,t){return this.elements.delete(e,t)}deleteByIndex(e,t){return this.elements.deleteByIndex(e,t)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(const e of this.elements)e.isRemoved()||(yield e.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(e){for(const t of this.elements){const n=t.getValue();if(e(n,this))return;n instanceof Ke&&n.getDescendants(e)}}toJSON(){const e=[];for(const t of this)e.push(t.toJSON());return`[${e.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const e={};for(let t=0;t<this.length;t++){const{createdAt:n,value:i,type:u}=this.get(t).toJSForTest();e[t]={key:String(t),createdAt:n,value:i,type:u}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){const e=Ot.create(this.getCreatedAt());for(const t of this.elements)e.elements.insertAfter(e.getLastCreatedAt(),t.getValue().deepcopy());return e.remove(this.getRemovedAt()),e}}class yn extends Me{constructor(e,t,n){super(e,n),this.createdAt=t}static create(e,t,n){return new yn(e,t,n)}execute(e,t){var n;const i=e.findByCreatedAt(this.getParentCreatedAt());if(i||g.fatal(`fail to find ${this.getParentCreatedAt()}`),i instanceof Ke||g.fatal(`only object and array can execute remove: ${i}`),t===ge.UndoRedo){let v=i.getByID(this.createdAt);for(;v;){if(v.getRemovedAt())return;v=(n=e.findElementPairByCreatedAt(v.getCreatedAt()))===null||n===void 0?void 0:n.parent}}const u=i.subPathOf(this.createdAt),c=this.toReverseOperation(i),d=i.delete(this.createdAt,this.getExecutedAt());return e.registerRemovedElement(d),{opInfos:i instanceof Ot?[{type:"remove",path:e.createPath(this.getParentCreatedAt()),index:Number(u)}]:[{type:"remove",path:e.createPath(this.getParentCreatedAt()),key:u}],reverseOp:c}}toReverseOperation(e){if(e instanceof Pe){const t=e.subPathOf(this.createdAt);if(t!==void 0){const n=e.get(t);if(n!==void 0)return On.create(t,n.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}}class On extends Me{constructor(e,t,n,i){super(n,i),this.key=e,this.value=t}static create(e,t,n,i){return new On(e,t,n,i)}execute(e,t){var n;const i=e.findByCreatedAt(this.getParentCreatedAt());if(i||g.fatal(`fail to find ${this.getParentCreatedAt()}`),i instanceof Pe||g.fatal("fail to execute, only object can execute set"),t===ge.UndoRedo){let v=i;for(;v;){if(v.getRemovedAt())return;v=(n=e.findElementPairByCreatedAt(v.getCreatedAt()))===null||n===void 0?void 0:n.parent}}const u=i.get(this.key),c=this.toReverseOperation(u),d=this.value.deepcopy(),E=i.set(this.key,d,this.getExecutedAt());return t===ge.UndoRedo&&e.findByCreatedAt(d.getCreatedAt())&&e.deregisterElement(d),e.registerElement(d,i),E&&e.registerRemovedElement(E),{opInfos:[{type:"set",path:e.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:c}}toReverseOperation(e){let t=yn.create(this.getParentCreatedAt(),this.value.getCreatedAt());return e!==void 0&&!e.isRemoved()&&(t=On.create(this.key,e.deepcopy(),this.getParentCreatedAt())),t}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}}class Ln extends Me{constructor(e,t,n,i){super(e,i),this.prevCreatedAt=t,this.value=n}static create(e,t,n,i){return new Ln(e,t,n,i)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||g.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof Ot||g.fatal("fail to execute, only array can execute add");const n=t,i=this.value.deepcopy();return n.insertAfter(this.prevCreatedAt,i),e.registerElement(i,n),{opInfos:[{type:"add",path:e.createPath(this.getParentCreatedAt()),index:Number(n.subPathOf(this.getEffectedCreatedAt()))}]}}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}}class Kt extends Me{constructor(e,t,n,i){super(e,i),this.prevCreatedAt=t,this.createdAt=n}static create(e,t,n,i){return new Kt(e,t,n,i)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||g.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof Ot||g.fatal("fail to execute, only array can execute move");const n=t,i=Number(n.subPathOf(this.createdAt));n.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());const u=Number(n.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:e.createPath(this.getParentCreatedAt()),index:u,previousIndex:i}]}}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}}class dt{constructor(e,t,n,i){this.key=e,this.value=t,this.updatedAt=n,this._isRemoved=i}static of(e,t,n,i){return new dt(e,t,n,i)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}isRemoved(){return this._isRemoved}}class nt{constructor(){this.nodeMapByKey=new Map,this.numberOfRemovedElement=0}static create(){return new nt}set(e,t,n){const i=this.nodeMapByKey.get(e);if(i===void 0||n.after(i.getUpdatedAt())){i!==void 0&&!i.isRemoved()&&(this.numberOfRemovedElement-=1);const u=dt.of(e,t,n,!1);this.nodeMapByKey.set(e,u)}}remove(e,t){const n=this.nodeMapByKey.get(e);if(n===void 0||t.after(n.getUpdatedAt())){if(n===void 0){this.numberOfRemovedElement+=1;const c=dt.of(e,"",t,!0);return this.nodeMapByKey.set(e,c),""}const i=n.isRemoved();i||(this.numberOfRemovedElement+=1);const u=dt.of(e,n.getValue(),t,!0);return this.nodeMapByKey.set(e,u),i?"":n.getValue()}return""}has(e){if(this.nodeMapByKey.has(e)){const t=this.nodeMapByKey.get(e);return t!==void 0&&!t.isRemoved()}return!1}get(e){if(!!this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){const e=new nt;for(const[,t]of this.nodeMapByKey)e.set(t.getKey(),t.getValue(),t.getUpdatedAt());return e}toJSON(){if(!this.size())return"{}";const e=[];for(const[t,n]of this.nodeMapByKey)n.isRemoved()||e.push(`"${fn(t)}":"${fn(n.getValue())}"`);return`{${e.join(",")}}`}toXML(){return this.size()?` ${[...this.nodeMapByKey].filter(([,t])=>t instanceof dt&&!t.isRemoved()).sort((t,n)=>t[0].localeCompare(n[0])).map(([t,n])=>`${t}="${JSON.parse(n.getValue())}"`).join(" ")}`:""}size(){return this.nodeMapByKey.size-this.numberOfRemovedElement}toObject(){const e={};for(const[t,n]of this.nodeMapByKey)n.isRemoved()||(e[t]=n.getValue());return e}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}}var Mt;(function(r){r.Content="content",r.Style="style"})(Mt||(Mt={}));class Tn{constructor(e){this.attributes=nt.create(),this.content=e}static create(e){return new Tn(e)}get length(){return this.content.length}substring(e,t){const n=new Tn(this.content.substring(e,t));return n.attributes=this.attributes.deepcopy(),n}setAttr(e,t,n){this.attributes.set(e,t,n)}getAttrs(){return this.attributes}toString(){return this.content}toJSON(){const e=fn(this.content),t=this.attributes.toObject(),n=[];for(const[i,u]of Object.entries(t)){const c=JSON.parse(u),d=typeof c=="string"?`"${fn(i)}":"${fn(c)}"`:`"${fn(i)}":${String(c)}`;n.push(d)}return n.sort(),n.length===0?`{"val":"${e}"}`:`{"attrs":{${n.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}}class $e extends kt{constructor(e,t){super(t),this.rgaTreeSplit=e}static create(e,t){return new $e(e,t)}edit(e,t,n,i,u){const c=t?Tn.create(t):void 0;if(c&&i)for(const[Q,F]of Object.entries(i))c.setAttr(Q,F,n);const[d,E,v]=this.rgaTreeSplit.edit(e,n,c,u),J=v.map(Q=>({...Q,value:Q.value?{attributes:kn(Q.value.getAttributes()),content:Q.value.getContent()}:{attributes:void 0,content:""},type:Mt.Content}));return[E,J,[d,d]]}setStyle(e,t,n,i){const[,u]=this.rgaTreeSplit.findNodeWithSplit(e[1],n),[,c]=this.rgaTreeSplit.findNodeWithSplit(e[0],n),d=[],E=this.rgaTreeSplit.findBetween(c,u),v=new Map,J=[];for(const Q of E){const F=Q.getCreatedAt().getActorID(),re=i!=null&&i.size?i.has(F)?i.get(F):Be:Tt;if(Q.canStyle(n,re)){const fe=v.get(F),he=Q.getCreatedAt();(!fe||he.after(fe))&&v.set(F,he),J.push(Q)}}for(const Q of J){if(Q.isRemoved())continue;const[F,re]=this.rgaTreeSplit.findIndexesFromRange(Q.createPosRange());d.push({type:Mt.Style,actor:n.getActorID(),from:F,to:re,value:{attributes:kn(t)}});for(const[fe,he]of Object.entries(t))Q.getValue().setAttr(fe,he,n)}return[v,d]}indexRangeToPosRange(e,t){const n=this.rgaTreeSplit.indexToPos(e);return e===t?[n,n]:[n,this.rgaTreeSplit.indexToPos(t)]}get length(){return this.rgaTreeSplit.length}checkWeight(){return this.rgaTreeSplit.checkWeight()}toJSON(){const e=[];for(const t of this.rgaTreeSplit)t.isRemoved()||e.push(t.getValue().toJSON());return`[${e.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){const e=[];for(const t of this.rgaTreeSplit)if(!t.isRemoved()){const n=t.getValue();e.push({attributes:kn(n.getAttributes()),content:n.getContent()})}return e}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}getRemovedNodesLen(){return this.rgaTreeSplit.getRemovedNodesLen()}purgeRemovedNodesBefore(e){return this.rgaTreeSplit.purgeRemovedNodesBefore(e)}deepcopy(){const e=new $e(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return e.remove(this.getRemovedAt()),e}findIndexesFromRange(e){return this.rgaTreeSplit.findIndexesFromRange(e)}}class ot extends Me{constructor(e,t,n,i,u,c,d){super(e,d),this.fromPos=t,this.toPos=n,this.maxCreatedAtMapByActor=i,this.content=u,this.attributes=c}static create(e,t,n,i,u,c,d){return new ot(e,t,n,i,u,c,d)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||g.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof $e||g.fatal("fail to execute, only Text can execute edit");const n=t,[,i]=n.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),this.maxCreatedAtMapByActor);return this.fromPos.equals(this.toPos)||e.registerElementHasRemovedNodes(n),{opInfos:i.map(({from:u,to:c,value:d})=>({type:"edit",from:u,to:c,value:d,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),n=this.toPos.toTestString(),i=this.content;return`${e}.EDIT(${t},${n},${i})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}class at extends Me{constructor(e,t,n,i,u,c){super(e,c),this.fromPos=t,this.toPos=n,this.maxCreatedAtMapByActor=i,this.attributes=u}static create(e,t,n,i,u,c){return new at(e,t,n,i,u,c)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||g.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof $e||g.fatal("fail to execute, only Text can execute edit");const n=t,[,i]=n.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),this.maxCreatedAtMapByActor);return{opInfos:i.map(({from:u,to:c,value:d})=>({type:"style",from:u,to:c,value:d,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),n=this.toPos.toTestString(),i=this.attributes;return`${e}.STYL(${t},${n},${JSON.stringify(i)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}const dn=2,sn="root",wt="text";function on(r,e){let t=0;const n=r.children;for(let i=0;i<e;i++){const u=n[i];!u||u.isRemoved||(t+=u.paddedSize)}return t}class hn{constructor(e,t=[]){if(this.type=e,this.size=0,this._children=t,this.isText&&this._children.length>0)throw new Error(`Text node cannot have children: ${this.type}`)}updateAncestorsSize(){let e=this.parent;const t=this.isRemoved?-1:1;for(;e;)e.size+=this.paddedSize*t,e=e.parent}get isText(){return this.type===wt}get paddedSize(){return this.size+(this.isText?0:dn)}isAncestorOf(e){return an(this,e)}get nextSibling(){const e=this.parent.findOffset(this),t=this.parent.children[e+1];if(t)return t}splitText(e,t){if(e===0||e===this.size)return;const n=this.value.slice(0,e),i=this.value.slice(e);if(!i.length)return;this.value=n;const u=this.cloneText(e+t);return u.value=i,this.parent.insertAfterInternal(u,this),u}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.length>0&&this.children.every(e=>e.isText)}append(...e){if(this.isText)throw new Error("Text node cannot have children");this._children.push(...e);for(const t of e)t.parent=this,t.updateAncestorsSize()}prepend(...e){if(this.isText)throw new Error("Text node cannot have children");this._children.unshift(...e);for(const t of e)t.parent=this,t.isRemoved||t.updateAncestorsSize()}insertBefore(e,t){if(this.isText)throw new Error("Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new Error("child not found");this.insertAtInternal(e,n),e.updateAncestorsSize()}insertAfter(e,t){if(this.isText)throw new Error("Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new Error("child not found");this.insertAtInternal(e,n+1),e.updateAncestorsSize()}insertAt(e,t){if(this.isText)throw new Error("Text node cannot have children");this.insertAtInternal(e,t),e.updateAncestorsSize()}removeChild(e){if(this.isText)throw new Error("Text node cannot have children");const t=this._children.indexOf(e);if(t===-1)throw new Error("child not found");this._children.splice(t,1),e.parent=void 0}splitElement(e,t){const n=this.cloneElement(t);this.parent.insertAfterInternal(n,this),n.updateAncestorsSize();const i=this.children.slice(0,e),u=this.children.slice(e);this._children=i,n._children=u,this.size=this._children.reduce((c,d)=>c+d.paddedSize,0),n.size=n._children.reduce((c,d)=>c+d.paddedSize,0);for(const c of n._children)c.parent=n;return n}insertAfterInternal(e,t){if(this.isText)throw new Error("Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new Error("child not found");this.insertAtInternal(e,n+1)}insertAtInternal(e,t){if(this.isText)throw new Error("Text node cannot have children");this._children.splice(t,0,e),e.parent=this}findOffset(e){if(this.isText)throw new Error("Text node cannot have children");if(e.isRemoved){const t=this._children.indexOf(e);return this.allChildren.splice(0,t).filter(i=>!i.isRemoved).length}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw new Error("Text node cannot have children");let t=e;for(;t;){const n=this._children.indexOf(t);if(n!==-1)return n;t=t.parent}return-1}}function an(r,e){if(r===e)return!1;for(;e.parent;){if(e.parent===r)return!0;e=e.parent}return!1}var me;(function(r){r.Start="Start",r.End="End",r.Text="Text"})(me||(me={}));function un(r,e,t,n){if(e>t)throw new Error(`from is greater than to: ${e} > ${t}`);if(e>r.size)throw new Error(`from is out of range: ${e} > ${r.size}`);if(t>r.size)throw new Error(`to is out of range: ${t} > ${r.size}`);if(e===t)return;let i=0;for(const u of r.children){if(e-u.paddedSize<i&&i<t){const c=u.isText?e-i:e-i-1,d=u.isText?t-i:t-i-1,E=!u.isText&&c<0,v=!u.isText&&d>u.size;(u.isText||E)&&n([u,u.isText?me.Text:me.Start],v),un(u,Math.max(0,c),Math.min(d,u.size),n),v&&n([u,me.End],v)}i+=u.paddedSize}}function Jt(r,e,t=0){for(const n of r.children)Jt(n,e,t+1);e(r,t)}function Ft(r,e,t=0){for(const n of r._children)Ft(n,e,t+1);e(r,t)}function a(r,e,t=!0){if(e>r.size)throw new Error(`index is out of range: ${e} > ${r.size}`);if(r.isText)return{node:r,offset:e};let n=0,i=0;for(const u of r.children){if(t&&u.isText&&u.size>=e-i)return a(u,e-i,t);if(e===i)return{node:r,offset:n};if(!t&&u.paddedSize===e-i)return{node:r,offset:n+1};if(u.paddedSize>e-i)return a(u,e-i-1,t);i+=u.paddedSize,n+=1}return{node:r,offset:n}}function s(r){return r.isText||r.children.length===0?r:s(r.children[0])}function o(r,e){if(r.size<e)throw new Error("unacceptable path");for(let t=0;t<r.children.length;t++){const n=r.children[t];if(n.size<e)e-=n.size;else{r=n;break}}return{node:r,offset:e}}class h{constructor(e){this.root=e}tokensBetween(e,t,n){un(this.root,e,t,n)}traverse(e){Jt(this.root,e,0)}traverseAll(e){Ft(this.root,e,0)}findTreePos(e,t=!0){return a(this.root,e,t)}treePosToPath(e){const t=[];let n=e.node;if(n.isText){const i=n.parent.findOffset(n);if(i===-1)throw new Error("invalid treePos");const u=on(n.parent,i);t.push(u+e.offset),n=n.parent}else if(n.hasTextChild()){const i=on(n,e.offset);t.push(i)}else t.push(e.offset);for(;n.parent;){const i=n.parent.findOffset(n);if(i===-1)throw new Error("invalid treePos");t.push(i),n=n.parent}return t.reverse()}pathToIndex(e){const t=this.pathToTreePos(e);return this.indexOf(t)}pathToTreePos(e){if(!e.length)throw new Error("unacceptable path");let t=this.root;for(let n=0;n<e.length-1;n++){const i=e[n];if(t=t.children[i],!t)throw new Error("unacceptable path")}if(t.hasTextChild())return o(t,e[e.length-1]);if(t.children.length<e[e.length-1])throw new Error("unacceptable path");return{node:t,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.size}findPostorderRight(e){const{node:t,offset:n}=e;if(t.isText){if(t.size===n){const i=t.nextSibling;return i||t.parent}return t}return t.children.length===n?t:s(t.children[n])}indexOf(e){let{node:t}=e;const{offset:n}=e;let i=0,u=1;if(t.isText){i+=n;const c=t.parent,d=c.findOffset(t);if(d===-1)throw new Error("invalid pos");i+=on(c,d),t=t.parent}else i+=on(t,n);for(;t!=null&&t.parent;){const c=t.parent,d=c.findOffset(t);if(d===-1)throw new Error("invalid pos");i+=on(c,d),u++,t=t.parent}return i+u-1}indexToPath(e){const t=this.findTreePos(e);return this.treePosToPath(t)}}const p=(r,e)=>r===e?0:r<e?-1:1;class N{constructor(e,t,n){this.key=e,this.value=t,this.isRed=n}}class I{constructor(e){this.stack=[],this.traverseInorder(e)}traverseInorder(e){!e||(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}}class j{constructor(e){this.comparator=typeof e<"u"?e:p,this.counter=0}put(e,t){return this.root=this.putInternal(e,t,this.root),this.root.isRed=!1,t}get(e){const t=this.getInternal(e,this.root);return t?t.value:void 0}remove(e){!this.isRed(this.root.left)&&!this.isRed(this.root.right)&&(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new I(this.root)}values(){const e=[];for(const t of this.getIterator().stack)e.push(t.value);return e}floorEntry(e){let t=this.root;for(;t;){const n=this.comparator(e,t.key);if(n>0)if(t.right)t.right.parent=t,t=t.right;else return t;else if(n<0)if(t.left)t.left.parent=t,t=t.left;else{let i=t.parent,u=t;for(;i&&u===i.left;)u=i,i=i.parent;return i}else return t}}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return this.counter===0}getInternal(e,t){for(;t;){const n=this.comparator(e,t.key);if(n===0)return t;n<0?t=t.left:n>0&&(t=t.right)}}putInternal(e,t,n){if(!n)return this.counter+=1,new N(e,t,!0);const i=this.comparator(e,n.key);return i<0?n.left=this.putInternal(e,t,n.left):i>0?n.right=this.putInternal(e,t,n.right):n.value=t,this.isRed(n.right)&&!this.isRed(n.left)&&(n=this.rotateLeft(n)),this.isRed(n.left)&&this.isRed(n.left.left)&&(n=this.rotateRight(n)),this.isRed(n.left)&&this.isRed(n.right)&&this.flipColors(n),n}removeInternal(e,t){if(this.comparator(t,e.key)<0)!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),this.comparator(t,e.key)===0&&!e.right){this.counter-=1;return}if(!this.isRed(e.right)&&!this.isRed(e.right.left)&&(e=this.moveRedRight(e)),this.comparator(t,e.key)===0){this.counter-=1;const n=this.min(e.right);e.value=n.value,e.key=n.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,t)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(!!e.left)return!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.isRed=t.left.isRed,t.left.isRed=!0,t}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.isRed=t.right.isRed,t.right.isRed=!0,t}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}}var P;(function(r){r.Content="content",r.Style="style",r.RemoveStyle="removeStyle"})(P||(P={}));class X{constructor(e,t){this.parentID=e,this.leftSiblingID=t}static of(e,t){return new X(e,t)}static fromTreePos(e){const{offset:t}=e;let{node:n}=e,i;return n.isText?(n.parent.children[0]===n&&t===0?i=n.parent:i=n,n=n.parent):t===0?i=n:i=n.children[t-1],X.of(n.id,H.of(i.getCreatedAt(),i.getOffset()+t))}getParentID(){return this.parentID}static fromStruct(e){return X.of(H.of(Ce.fromStruct(e.parentID.createdAt),e.parentID.offset),H.of(Ce.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodes(e){const t=this.getParentID(),n=this.getLeftSiblingID(),i=e.findFloorNode(t);let u=e.findFloorNode(n);if(!i||!u)throw new Error(`cannot find node at ${this}`);return!n.equals(t)&&n.getOffset()>0&&n.getOffset()===u.id.getOffset()&&u.insPrevID&&(u=e.findFloorNode(u.insPrevID)),[i,u]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}}class H{constructor(e,t){this.createdAt=e,this.offset=t}static of(e,t){return new H(e,t)}static fromStruct(e){return H.of(Ce.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,t)=>{const n=e.getCreatedAt().compare(t.getCreatedAt());return n!==0?n:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}/${this.offset}`}}class se extends hn{constructor(e,t,n,i,u){super(t),this._value="",this.id=e,this.removedAt=u,i&&(this.attrs=i),typeof n=="string"?this.value=n:Array.isArray(n)&&(this._children=n)}static create(e,t,n,i){return new se(e,t,n,i)}deepcopy(){var e;const t=new se(this.id,this.type);return t.removedAt=this.removedAt,t._value=this._value,t.size=this.size,t.attrs=(e=this.attrs)===null||e===void 0?void 0:e.deepcopy(),t._children=this._children.map(n=>{const i=n.deepcopy();return i.parent=t,i}),t.insPrevID=this.insPrevID,t.insNextID=this.insNextID,t}get value(){if(!this.isText)throw new Error(`cannot get value of element node: ${this.type}`);return this._value}set value(e){if(!this.isText)throw new Error(`cannot set value of element node: ${this.type}`);this._value=e,this.size=e.length}get isRemoved(){return!!this.removedAt}remove(e){const t=!this.removedAt;(!this.removedAt||this.removedAt.compare(e)>0)&&(this.removedAt=e),t&&(this.parent.removedAt?this.parent.size-=this.paddedSize:this.updateAncestorsSize())}cloneText(e){return new se(H.of(this.id.getCreatedAt(),e),this.type,void 0,void 0,this.removedAt)}cloneElement(e){return new se(H.of(e(),0),this.type,void 0,void 0,this.removedAt)}split(e,t,n){const i=this.isText?this.splitText(t,this.id.getOffset()):this.splitElement(t,n);if(i){if(i.insPrevID=this.id,this.insNextID){const u=e.findFloorNode(this.insNextID);u.insPrevID=i.id,i.insNextID=this.insNextID}this.insNextID=i.id,e.registerNode(i)}return i}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}}function De(r){var e;if(r.isText){const t=r;return{type:t.type,value:t.value}}return{type:r.type,children:r.children.map(De),attributes:r.attrs?kn((e=r.attrs)===null||e===void 0?void 0:e.toObject()):void 0}}function be(r){var e;return r.isText?r.value:`<${r.type}${((e=r.attrs)===null||e===void 0?void 0:e.toXML())||""}>${r.children.map(t=>be(t)).join("")}</${r.type}>`}function Pt(r){if(r.isText){const e=r;return{type:e.type,value:e.value,size:e.size,isRemoved:e.isRemoved}}return{type:r.type,children:r.children.map(Pt),size:r.size,isRemoved:r.isRemoved}}class Et extends kt{constructor(e,t){super(t),this.indexTree=new h(e),this.nodeMapByID=new j(H.createComparator()),this.removedNodeMap=new Map,this.indexTree.traverse(n=>{this.nodeMapByID.put(n.id,n)})}static create(e,t){return new Et(e,t)}findFloorNode(e){const t=this.nodeMapByID.floorEntry(e);if(!(!t||!t.key.getCreatedAt().equals(e.getCreatedAt())))return t.value}registerNode(e){this.nodeMapByID.put(e.id,e)}findNodesAndSplitText(e,t){const[n,i]=e.toTreeNodes(this);let u=i;const c=n===u,d=u.parent&&!c?u.parent:n;if(u.isText&&u.split(this,e.getLeftSiblingID().getOffset()-u.id.getOffset()),t){const E=d.allChildren,v=c?0:E.indexOf(u)+1;for(let J=v;J<E.length;J++){const Q=E[J];if(!Q.id.getCreatedAt().after(t))break;u=Q}}return[d,u]}style(e,t,n){const[i,u]=this.findNodesAndSplitText(e[0],n),[c,d]=this.findNodesAndSplitText(e[1],n),E=[],v=t?kn(t):void 0;return this.traverseInPosRange(i,u,c,d,([J])=>{if(!J.isRemoved&&!J.isText&&t){J.attrs||(J.attrs=new nt);for(const[Q,F]of Object.entries(t))J.attrs.set(Q,F,n);E.push({type:P.Style,from:this.toIndex(i,u),to:this.toIndex(c,d),fromPath:this.toPath(i,u),toPath:this.toPath(c,d),actor:n.getActorID(),value:v})}}),E}removeStyle(e,t,n){const[i,u]=this.findNodesAndSplitText(e[0],n),[c,d]=this.findNodesAndSplitText(e[1],n),E=[],v=t||void 0;return this.traverseInPosRange(i,u,c,d,([J])=>{if(!J.isRemoved&&!J.isText&&t){J.attrs||(J.attrs=new nt);for(const Q of t)J.attrs.remove(Q,n);E.push({type:P.RemoveStyle,from:this.toIndex(i,u),to:this.toIndex(c,d),fromPath:this.toPath(i,u),toPath:this.toPath(c,d),actor:n.getActorID(),value:v})}}),E}edit(e,t,n,i,u,c){const[d,E]=this.findNodesAndSplitText(e[0],i),[v,J]=this.findNodesAndSplitText(e[1],i),Q=this.toIndex(d,E),F=this.toPath(d,E),re=[],fe=[],he=[],Te=new Map;this.traverseInPosRange(d,E,v,J,([ve,je],Ue)=>{if(je===me.Start&&!Ue)for(const ar of ve.children)he.push(ar);const et=ve.getCreatedAt().getActorID(),Gn=c?c.has(et)?c.get(et):Be:Tt;if(ve.canDelete(i,Gn)||re.includes(ve.parent)){const ar=Te.get(et),gr=ve.getCreatedAt();(!ar||gr.after(ar))&&Te.set(et,gr),(je===me.Text||je===me.Start)&&re.push(ve),fe.push([ve,je])}});const rt=this.makeDeletionChanges(fe,i);for(const ve of re)ve.remove(i),ve.isRemoved&&this.removedNodeMap.set(ve.id.toIDString(),ve);for(const ve of he)ve.removedAt||d.append(ve);if(n>0){let ve=0,je=d,Ue=E;for(;ve<n;)je.split(this,je.findOffset(Ue)+1,u),Ue=je,je=je.parent,ve++;rt.push({type:P.Content,from:Q,to:Q,fromPath:F,toPath:F,actor:i.getActorID()})}if(t!=null&&t.length){const ve=[];let je=E;for(const Ue of t)je===d?d.insertAt(Ue,0):d.insertAfter(Ue,je),je=Ue,Ft(Ue,et=>{d.isRemoved&&(et.remove(i),this.removedNodeMap.set(et.id.toIDString(),et)),this.nodeMapByID.put(et.id,et)}),Ue.isRemoved||ve.push(Ue);if(ve.length){const Ue=ve.map(et=>De(et));rt.length&&rt[rt.length-1].from===Q?rt[rt.length-1].value=Ue:rt.push({type:P.Content,from:Q,to:Q,fromPath:F,toPath:F,actor:i.getActorID(),value:Ue})}}return[rt,Te]}editT(e,t,n,i,u){const c=this.findPos(e[0]),d=this.findPos(e[1]);this.edit([c,d],t,n,i,u)}move(e,t,n){throw new Error(`not implemented: ${e}, ${t}, ${n}`)}purgeRemovedNodesBefore(e){var t;const n=new Set;let i=0;for(const[,u]of this.removedNodeMap)u.removedAt&&e.compare(u.removedAt)>=0&&(n.add(u),i++);for(const u of n)(t=u.parent)===null||t===void 0||t.removeChild(u),this.nodeMapByID.remove(u.id),this.purge(u),this.removedNodeMap.delete(u.id.toIDString());return i}purge(e){const t=e.insPrevID,n=e.insNextID;if(t){const i=this.findFloorNode(t);i.insNextID=n}if(n){const i=this.findFloorNode(n);i.insPrevID=t}e.insPrevID=void 0,e.insNextID=void 0}findPos(e,t=!0){const n=this.indexTree.findTreePos(e,t);return X.fromTreePos(n)}getRemovedNodesLen(){return this.removedNodeMap.size}pathToPosRange(e){const t=this.pathToIndex(e);return[this.findPos(t),this.findPos(t+1)]}pathToPos(e){const t=this.indexTree.pathToIndex(e);return this.findPos(t)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getIndexTree(){return this.indexTree}toXML(){return be(this.indexTree.getRoot())}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){const e=this.indexTree.getRoot(),t=(n,i=void 0,u=void 0,c=0)=>{var d,E,v,J;let Q,F,re;const fe=n.isText?{node:n,offset:0}:i&&u?this.toTreePos(i,u):null;fe&&(Q=this.indexTree.indexOf(fe),F=this.indexTree.treePosToPath(fe),re=X.fromTreePos(fe).toStruct());const he={type:n.type,parent:i==null?void 0:i.id.toTestString(),size:n.size,id:n.id.toTestString(),removedAt:(d=n.removedAt)===null||d===void 0?void 0:d.toTestString(),insPrev:(E=n.insPrevID)===null||E===void 0?void 0:E.toTestString(),insNext:(v=n.insNextID)===null||v===void 0?void 0:v.toTestString(),value:n.isText?n.value:void 0,isRemoved:n.isRemoved,children:[],depth:c,attributes:n.attrs?kn((J=n.attrs)===null||J===void 0?void 0:J.toObject()):void 0,index:Q,path:F,pos:re};for(let Te=0;Te<n.children.length;Te++){const rt=Te===0?n:n.children[Te-1];he.children.push(t(n.children[Te],n,rt,c+1))}return he};return t(e)}getRootTreeNode(){return De(this.indexTree.getRoot())}toTestTreeNode(){return Pt(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){const e=this.getRoot();return new Et(e.deepcopy(),this.getCreatedAt())}toPath(e,t){const n=this.toTreePos(e,t);return n?this.indexTree.treePosToPath(n):[]}toIndex(e,t){const n=this.toTreePos(e,t);return n?this.indexTree.indexOf(n):-1}indexToPath(e){return this.indexTree.indexToPath(e)}pathToIndex(e){return this.indexTree.pathToIndex(e)}indexRangeToPosRange(e){const t=this.findPos(e[0]);return e[0]===e[1]?[t,t]:[t,this.findPos(e[1])]}indexRangeToPosStructRange(e){const[t,n]=e,i=this.findPos(t);return t===n?[i.toStruct(),i.toStruct()]:[i.toStruct(),this.findPos(n).toStruct()]}posRangeToPathRange(e){const[t,n]=this.findNodesAndSplitText(e[0]),[i,u]=this.findNodesAndSplitText(e[1]);return[this.toPath(t,n),this.toPath(i,u)]}posRangeToIndexRange(e){const[t,n]=this.findNodesAndSplitText(e[0]),[i,u]=this.findNodesAndSplitText(e[1]);return[this.toIndex(t,n),this.toIndex(i,u)]}traverseInPosRange(e,t,n,i,u){const c=this.toIndex(e,t),d=this.toIndex(n,i);return this.indexTree.tokensBetween(c,d,u)}toTreePos(e,t){if(!e||!t)return;if(e.isRemoved){let i;for(;e.isRemoved;)i=e,e=i.parent;const u=e.findOffset(i);return{node:e,offset:u}}if(e===t)return{node:e,offset:0};let n=e.findOffset(t);if(!t.isRemoved){if(t.isText)return{node:t,offset:t.paddedSize};n++}return{node:e,offset:n}}makeDeletionChanges(e,t){const n=[],i=[];let u=null,c=null;for(let d=0;d<e.length;d++){const E=e[d],v=e[d+1];u||(u=E),c=E;const J=this.findRightToken(E);(!J||!v||J[0]!==v[0]||J[1]!==v[1])&&(i.push([u,c]),u=null,c=null)}for(const d of i){const[E,v]=d,[J,Q]=this.findLeftToken(E),[F,re]=v,fe=Q===me.Start?J:J.parent,he=re===me.Start?F:F.parent,Te=this.toIndex(fe,J),rt=this.toIndex(he,F);Te<rt&&(n.length>0&&Te===n[n.length-1].to?(n[n.length-1].to=rt,n[n.length-1].toPath=this.toPath(he,F)):n.push({type:P.Content,from:Te,to:rt,fromPath:this.toPath(fe,J),toPath:this.toPath(he,F),actor:t.getActorID()}))}return n.reverse()}findRightToken([e,t]){if(t===me.Start){const d=e.allChildren;return d.length>0?[d[0],d[0].isText?me.Text:me.Start]:[e,me.End]}const n=e.parent,i=n.allChildren,u=i.indexOf(e);if(n&&u===i.length-1)return[n,me.End];const c=i[u+1];return[c,c.isText?me.Text:me.Start]}findLeftToken([e,t]){if(t===me.End){const d=e.allChildren;if(d.length>0){const E=d[d.length-1];return[E,E.isText?me.Text:me.End]}return[e,me.Start]}const n=e.parent,i=n.allChildren,u=i.indexOf(e);if(n&&u===0)return[n,me.Start];const c=i[u-1];return[c,c.isText?me.Text:me.End]}}class qn extends Me{constructor(e,t,n,i,u,c,d){super(e,d),this.fromPos=t,this.toPos=n,this.contents=i,this.splitLevel=u,this.maxCreatedAtMapByActor=c}static create(e,t,n,i,u,c,d){return new qn(e,t,n,i,u,c,d)}execute(e){var t;const n=e.findByCreatedAt(this.getParentCreatedAt());n||g.fatal(`fail to find ${this.getParentCreatedAt()}`),n instanceof Et||g.fatal("fail to execute, only Tree can execute edit");const i=this.getExecutedAt(),u=n,[c]=u.edit([this.fromPos,this.toPos],(t=this.contents)===null||t===void 0?void 0:t.map(d=>d.deepcopy()),this.splitLevel,i,(()=>{let d=i.getDelimiter();return this.contents!==void 0&&(d+=this.contents.length),()=>Ce.of(i.getLamport(),++d,i.getActorID())})(),this.maxCreatedAtMapByActor);return this.fromPos.equals(this.toPos)||e.registerElementHasRemovedNodes(u),{opInfos:c.map(({from:d,to:E,value:v,splitLevel:J,fromPath:Q,toPath:F})=>({type:"tree-edit",path:e.createPath(this.getParentCreatedAt()),from:d,to:E,value:v,splitLevel:J,fromPath:Q,toPath:F}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.fromPos.getLeftSiblingID().getOffset()}`,n=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.toPos.getLeftSiblingID().getOffset()}`,i=this.contents||[];return`${e}.EDIT(${t},${n},${i.map(u=>be(u)).join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}class vn{constructor(e,t,n){this.clientSeq=e,this.lamport=t,this.actor=n}static of(e,t,n){return new vn(e,t,n)}next(){return new vn(this.clientSeq+1,this.lamport.add(1),this.actor)}syncLamport(e){return e.greaterThan(this.lamport)?new vn(this.clientSeq,e,this.actor):new vn(this.clientSeq,this.lamport.add(1),this.actor)}createTimeTicket(e){return Ce.of(this.lamport,e,this.actor)}setActor(e){return new vn(this.clientSeq,this.lamport,e)}getClientSeq(){return this.clientSeq}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}toTestString(){return`${this.lamport.toString()}:${this.actor.slice(-2)}:${this.clientSeq}`}}const As=new vn(0,Ye.fromInt(0,!0),yt);class Kn{constructor({id:e,operations:t,presenceChange:n,message:i}){this.id=e,this.operations=t||[],this.presenceChange=n,this.message=i}static create({id:e,operations:t,presenceChange:n,message:i}){return new Kn({id:e,operations:t,presenceChange:n,message:i})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(const t of this.operations)t.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return this.presenceChange!==void 0}getPresenceChange(){return this.presenceChange}execute(e,t,n){const i=[],u=[];for(const c of this.operations){const d=c.execute(e,n);if(!d)continue;const{opInfos:E,reverseOp:v}=d;i.push(...E),v&&u.unshift(v)}return this.presenceChange&&(this.presenceChange.type===qt.Put?t.set(this.id.getActorID(),qe(this.presenceChange.presence)):t.delete(this.id.getActorID())),{opInfos:i,reverseOps:u}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}toStruct(){return{changeID:Qe.bytesToHex(Qe.toChangeID(this.getID()).toBinary()),message:this.getMessage(),operations:this.getOperations().map(e=>Qe.bytesToHex(Qe.toOperation(e).toBinary())),presenceChange:this.getPresenceChange()}}static fromStruct(e){const{changeID:t,operations:n,presenceChange:i,message:u}=e;return Kn.create({id:Qe.bytesToChangeID(Qe.hexToBytes(t)),operations:n==null?void 0:n.map(c=>Qe.bytesToOperation(Qe.hexToBytes(c))),presenceChange:i,message:u})}}class Nr{constructor(e,t,n,i,u,c){this.documentKey=e,this.checkpoint=t,this.isRemoved=n,this.changes=i,this.snapshot=u,this.minSyncedTicket=c}static create(e,t,n,i,u,c){return new Nr(e,t,n,i,u,c)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getMinSyncedTicket(){return this.minSyncedTicket}}class Qn{constructor(e,t){this.serverSeq=e,this.clientSeq=t}static of(e,t){return new Qn(e,t)}increaseClientSeq(e){return e===0?this:new Qn(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;const t=this.serverSeq.greaterThan(e.serverSeq)?this.serverSeq:e.serverSeq,n=Math.max(this.clientSeq,e.clientSeq);return Qn.of(t,n)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq.equals(e.serverSeq)}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}}const Os=new Qn(Ye.fromInt(0,!0),0);class wn{constructor(e,t){this.createdAt=e,this.offset=t}static of(e,t){return new wn(e,t)}static fromStruct(e){return wn.of(Ce.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}hasSameCreatedAt(e){return this.createdAt.compare(e.createdAt)===0}split(e){return new wn(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}const Ps=wn.of(Be,0);class mn{constructor(e,t){this.id=e,this.relativeOffset=t}static of(e,t){return new mn(e,t)}static fromStruct(e){const t=wn.fromStruct(e.id);return mn.of(t,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return wn.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return this.id.equals(e.id)?this.relativeOffset===e.relativeOffset:!1}}class Bn extends At{constructor(e,t,n){super(t),this.id=e,this.removedAt=n}static create(e,t){return new Bn(e,t)}static createComparator(){return(e,t)=>{const n=e.getCreatedAt().compare(t.getCreatedAt());return n!==0?n:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(e){this.prev=e,e&&(e.next=this)}setNext(e){this.next=e,e&&(e.prev=this)}setInsPrev(e){this.insPrev=e,e&&(e.insNext=this)}setInsNext(e){this.insNext=e,e&&(e.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(e){return new Bn(this.id.split(e),this.splitValue(e),this.removedAt)}canDelete(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}canStyle(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}remove(e){this.removedAt=e}createPosRange(){return[mn.of(this.id,0),mn.of(this.id,this.getLength())]}deepcopy(){return new Bn(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(e){const t=this.value;return this.value=t.substring(0,e),t.substring(e,t.length)}}class er{constructor(){this.head=Bn.create(Ps),this.treeByIndex=new jn,this.treeByID=new j(Bn.createComparator()),this.removedNodeMap=new Map,this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new er}edit(e,t,n,i){const[u,c]=this.findNodeWithSplit(e[1],t),[d,E]=this.findNodeWithSplit(e[0],t),v=this.findBetween(E,c),[J,Q,F]=this.deleteNodes(v,t,i),re=c?c.getID():u.getID();let fe=mn.of(re,0);if(n){const he=this.posToIndex(d.createPosRange()[1],!0),Te=this.insertAfter(d,Bn.create(wn.of(t,0),n));J.length&&J[J.length-1].from===he?J[J.length-1].value=n:J.push({actor:t.getActorID(),from:he,to:he,value:n}),fe=mn.of(Te.getID(),Te.getContentLength())}for(const[he,Te]of F)this.removedNodeMap.set(he,Te);return[fe,Q,J]}indexToPos(e){const[t,n]=this.treeByIndex.find(e),i=t;return mn.of(i.getID(),n)}findIndexesFromRange(e){const[t,n]=e;return[this.posToIndex(t,!1),this.posToIndex(n,!0)]}posToIndex(e,t){const n=e.getAbsoluteID(),i=t?this.findFloorNodePreferToLeft(n):this.findFloorNode(n);i||g.fatal(`the node of the given id should be found: ${n.toTestString()}`);const u=this.treeByIndex.indexOf(i),c=i.isRemoved()?0:n.getOffset()-i.getID().getOffset();return u+c}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}checkWeight(){return this.treeByIndex.checkWeight()}toString(){const e=[];for(const t of this)t.isRemoved()||e.push(t.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){const e=new er;let t=this.head.getNext(),n=e.head,i;for(;t;){if(i=e.insertAfter(n,t.deepcopy()),t.hasInsPrev()){const u=e.findNode(t.getInsPrevID());i.setInsPrev(u)}n=i,t=t.getNext()}return e}toTestString(){const e=[];let t=this.head;for(;t;)t.isRemoved()?e.push(`{${t.toTestString()}}`):e.push(`[${t.toTestString()}]`),t=t.getNext();return e.join("")}insertAfter(e,t){const n=e.getNext();return t.setPrev(e),n&&n.setPrev(t),this.treeByID.put(t.getID(),t),this.treeByIndex.insertAfter(e,t),t}findNodeWithSplit(e,t){const n=e.getAbsoluteID();let i=this.findFloorNodePreferToLeft(n);const u=n.getOffset()-i.getID().getOffset();for(this.splitNode(i,u);i.hasNext()&&i.getNext().getCreatedAt().after(t);)i=i.getNext();return[i,i.getNext()]}findFloorNodePreferToLeft(e){let t=this.findFloorNode(e);if(t||g.fatal(`the node of the given id should be found: ${e.toTestString()}`),e.getOffset()>0&&t.getID().getOffset()==e.getOffset()){if(!t.hasInsPrev())return t;t=t.getInsPrev()}return t}findFloorNode(e){const t=this.treeByID.floorEntry(e);if(!!t&&!(!t.key.equals(e)&&!t.key.hasSameCreatedAt(e)))return t.value}findBetween(e,t){const n=[];let i=e;for(;i&&i!==t;)n.push(i),i=i.getNext();return n}splitNode(e,t){if(t>e.getContentLength()&&g.fatal("offset should be less than or equal to length"),t===0)return e;if(t===e.getContentLength())return e.getNext();const n=e.split(t);this.treeByIndex.updateWeight(n),this.insertAfter(e,n);const i=e.getInsNext();return i&&i.setInsPrev(n),n.setInsPrev(e),n}deleteNodes(e,t,n){if(!e.length)return[[],new Map,new Map];const[i,u]=this.filterNodes(e,t,n),c=new Map,d=new Map,E=this.makeChanges(u,t);for(const v of i){const J=v.getCreatedAt().getActorID();(!c.has(J)||v.getID().getCreatedAt().after(c.get(J)))&&c.set(J,v.getID().getCreatedAt()),d.set(v.getID().toIDString(),v),v.remove(t)}return this.deleteIndexNodes(u),[E,c,d]}filterNodes(e,t,n){const i=!!n,u=[],c=[],[d,E]=this.findEdgesOfCandidates(e);c.push(d);for(const v of e){const J=v.getCreatedAt().getActorID(),Q=i?n.has(J)?n.get(J):Be:Tt;v.canDelete(t,Q)?u.push(v):c.push(v)}return c.push(E),[u,c]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,t){const n=[];let i,u;for(let c=0;c<e.length-1;c++){const d=e[c],E=e[c+1];d.getNext()!=E&&([i]=this.findIndexesFromRange(d.getNext().createPosRange()),E?[,u]=this.findIndexesFromRange(E.getPrev().createPosRange()):u=this.treeByIndex.length,i<u&&n.push({actor:t.getActorID(),from:i,to:u}))}return n.reverse()}deleteIndexNodes(e){for(let t=0;t<e.length-1;t++){const n=e[t],i=e[t+1];n.getNext()!=i&&this.treeByIndex.deleteRange(n,i)}}getRemovedNodesLen(){return this.removedNodeMap.size}purgeRemovedNodesBefore(e){let t=0;for(const[,n]of this.removedNodeMap)n.getRemovedAt()&&e.compare(n.getRemovedAt())>=0&&(this.treeByIndex.delete(n),this.purge(n),this.treeByID.remove(n.getID()),this.removedNodeMap.delete(n.getID().toIDString()),t++);return t}purge(e){const t=e.getPrev(),n=e.getNext(),i=e.getInsPrev(),u=e.getInsNext();t&&t.setNext(n),n&&n.setPrev(t),e.setPrev(void 0),e.setNext(void 0),i&&i.setInsNext(u),u&&u.setInsPrev(i),e.setInsPrev(void 0),e.setInsNext(void 0)}}const qr=r=>r<0?Math.ceil(r):Math.floor(r);var We;(function(r){r[r.IntegerCnt=0]="IntegerCnt",r[r.LongCnt=1]="LongCnt"})(We||(We={}));class Wt extends ft{constructor(e,t,n){switch(super(n),this.valueType=e,e){case We.IntegerCnt:typeof t=="number"?t>Math.pow(2,31)-1||t<-Math.pow(2,31)?this.value=Ye.fromNumber(t).toInt():this.value=qr(t):this.value=t.toInt();break;case We.LongCnt:typeof t=="number"?this.value=Ye.fromNumber(t):this.value=t;break;default:throw new Ie(Ne.Unimplemented,`unimplemented type: ${e}`)}}static create(e,t,n){return new Wt(e,t,n)}static valueFromBytes(e,t){switch(e){case We.IntegerCnt:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case We.LongCnt:return Ye.fromBytesLE(Array.from(t));default:throw new Ie(Ne.Unimplemented,`unimplemented type: ${e}`)}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){const e=Wt.create(this.valueType,this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e}getType(){return this.valueType}static getCounterType(e){switch(typeof e){case"object":return e instanceof Ye?We.LongCnt:void 0;case"number":return e>Math.pow(2,31)-1||e<-Math.pow(2,31)?We.LongCnt:We.IntegerCnt;default:return}}static isSupport(e){return!!Wt.getCounterType(e)}static isInteger(e){return e%1===0}isNumericType(){const e=this.valueType;return e===We.IntegerCnt||e===We.LongCnt}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case We.IntegerCnt:{const e=this.value;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}case We.LongCnt:{const t=this.value.toBytesLE();return Uint8Array.from(t)}default:throw new Ie(Ne.Unimplemented,`unimplemented type: ${this.valueType}`)}}increase(e){function t(n){if(!n.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof n.getValue()}`)}return t(this),t(e),this.valueType===We.LongCnt?this.value=this.value.add(e.getValue()):e.getType()===ae.Long?this.value=this.value+e.getValue().toInt():this.value=Ye.fromNumber(this.value+qr(e.getValue())).toInt(),this}}class tr extends Me{constructor(e,t,n){super(e,n),this.value=t}static create(e,t,n){return new tr(e,t,n)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||g.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof Wt||g.fatal("fail to execute, only Counter can execute increase");const n=t,i=this.value.deepcopy();return n.increase(i),{opInfos:[{type:"increase",path:e.createPath(this.getParentCreatedAt()),value:i.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){const e=this.value.deepcopy(),n=e.getType()===ae.Long?e.getValue().multiply(-1):e.getValue()*-1;return tr.create(this.getParentCreatedAt(),_e.of(n,e.getCreatedAt()))}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}}class Pn extends Me{constructor(e,t,n,i,u,c){super(e,c),this.fromPos=t,this.toPos=n,this.attributes=i,this.attributesToRemove=u}static create(e,t,n,i,u){return new Pn(e,t,n,i,new Array,u)}static createTreeRemoveStyleOperation(e,t,n,i,u){return new Pn(e,t,n,new Map,i,u)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||g.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof Et||g.fatal("fail to execute, only Tree can execute edit");const n=t;let i;if(this.attributes.size){const u={};[...this.attributes].forEach(([c,d])=>u[c]=d),i=n.style([this.fromPos,this.toPos],u,this.getExecutedAt())}else{const u=this.attributesToRemove;i=n.removeStyle([this.fromPos,this.toPos],u,this.getExecutedAt())}return{opInfos:i.map(({from:u,to:c,value:d,fromPath:E})=>({type:"tree-style",from:u,to:c,value:d,fromPath:E,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,n=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${e}.STYLE(${t},${n},${Object.entries(this.attributes||{}).map(([i,u])=>`${i}:"${u}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}}function Ds(r){const e=new M.Presence,t=e.data;for(const[n,i]of Object.entries(r))t[n]=JSON.stringify(i);return e}function Cs(r){if(r.type===qt.Put)return new M.PresenceChange({type:M.PresenceChange_ChangeType.PUT,presence:Ds(r.presence)});if(r.type===qt.Clear)return new M.PresenceChange({type:M.PresenceChange_ChangeType.CLEAR});throw new Ie(Ne.Unimplemented,"unimplemented type")}function Rs(r){return new M.Checkpoint({serverSeq:r.getServerSeqAsString(),clientSeq:r.getClientSeq()})}function Kr(r){return new M.ChangeID({clientSeq:r.getClientSeq(),lamport:r.getLamportAsString(),actorId:Fr(r.getActorID())})}function ie(r){if(!!r)return new M.TimeTicket({lamport:r.getLamportAsString(),delimiter:r.getDelimiter(),actorId:Fr(r.getActorID())})}function Wr(r){switch(r){case ae.Null:return M.ValueType.NULL;case ae.Boolean:return M.ValueType.BOOLEAN;case ae.Integer:return M.ValueType.INTEGER;case ae.Long:return M.ValueType.LONG;case ae.Double:return M.ValueType.DOUBLE;case ae.String:return M.ValueType.STRING;case ae.Bytes:return M.ValueType.BYTES;case ae.Date:return M.ValueType.DATE;default:throw new Ie(Ne.Unsupported,`unsupported type: ${r}`)}}function Gr(r){switch(r){case We.IntegerCnt:return M.ValueType.INTEGER_CNT;case We.LongCnt:return M.ValueType.LONG_CNT;default:throw new Ie(Ne.Unsupported,`unsupported type: ${r}`)}}function xr(r){if(r instanceof Pe)return new M.JSONElementSimple({type:M.ValueType.JSON_OBJECT,createdAt:ie(r.getCreatedAt()),value:cs(r)});if(r instanceof Ot)return new M.JSONElementSimple({type:M.ValueType.JSON_ARRAY,createdAt:ie(r.getCreatedAt()),value:ii(r)});if(r instanceof $e)return new M.JSONElementSimple({type:M.ValueType.TEXT,createdAt:ie(r.getCreatedAt())});if(r instanceof _e)return new M.JSONElementSimple({type:Wr(r.getType()),createdAt:ie(r.getCreatedAt()),value:r.toBytes()});if(r instanceof Wt)return new M.JSONElementSimple({type:Gr(r.getType()),createdAt:ie(r.getCreatedAt()),value:r.toBytes()});if(r instanceof Et)return new M.JSONElementSimple({type:M.ValueType.TREE,createdAt:ie(r.getCreatedAt()),value:ai(r)});throw new Ie(Ne.Unimplemented,"unimplemented element")}function xs(r){return new M.TextNodeID({createdAt:ie(r.getCreatedAt()),offset:r.getOffset()})}function br(r){return new M.TextNodePos({createdAt:ie(r.getID().getCreatedAt()),offset:r.getID().getOffset(),relativeOffset:r.getRelativeOffset()})}function Sr(r){return new M.TreePos({parentId:fr(r.getParentID()),leftSiblingId:fr(r.getLeftSiblingID())})}function fr(r){return new M.TreeNodeID({createdAt:ie(r.getCreatedAt()),offset:r.getOffset()})}function zr(r){const e=new M.Operation;if(r instanceof On){const t=r,n=new M.Operation_Set;n.parentCreatedAt=ie(t.getParentCreatedAt()),n.key=t.getKey(),n.value=xr(t.getValue()),n.executedAt=ie(t.getExecutedAt()),e.body.case="set",e.body.value=n}else if(r instanceof Ln){const t=r,n=new M.Operation_Add;n.parentCreatedAt=ie(t.getParentCreatedAt()),n.prevCreatedAt=ie(t.getPrevCreatedAt()),n.value=xr(t.getValue()),n.executedAt=ie(t.getExecutedAt()),e.body.case="add",e.body.value=n}else if(r instanceof Kt){const t=r,n=new M.Operation_Move;n.parentCreatedAt=ie(t.getParentCreatedAt()),n.prevCreatedAt=ie(t.getPrevCreatedAt()),n.createdAt=ie(t.getCreatedAt()),n.executedAt=ie(t.getExecutedAt()),e.body.case="move",e.body.value=n}else if(r instanceof yn){const t=r,n=new M.Operation_Remove;n.parentCreatedAt=ie(t.getParentCreatedAt()),n.createdAt=ie(t.getCreatedAt()),n.executedAt=ie(t.getExecutedAt()),e.body.case="remove",e.body.value=n}else if(r instanceof ot){const t=r,n=new M.Operation_Edit;n.parentCreatedAt=ie(t.getParentCreatedAt()),n.from=br(t.getFromPos()),n.to=br(t.getToPos());const i=n.createdAtMapByActor;for(const[c,d]of t.getMaxCreatedAtMapByActor())i[c]=ie(d);n.content=t.getContent();const u=n.attributes;for(const[c,d]of t.getAttributes())u[c]=d;n.executedAt=ie(t.getExecutedAt()),e.body.case="edit",e.body.value=n}else if(r instanceof at){const t=r,n=new M.Operation_Style;n.parentCreatedAt=ie(t.getParentCreatedAt()),n.from=br(t.getFromPos()),n.to=br(t.getToPos());const i=n.createdAtMapByActor;for(const[c,d]of t.getMaxCreatedAtMapByActor())i[c]=ie(d);const u=n.attributes;for(const[c,d]of t.getAttributes())u[c]=d;n.executedAt=ie(t.getExecutedAt()),e.body.case="style",e.body.value=n}else if(r instanceof tr){const t=r,n=new M.Operation_Increase;n.parentCreatedAt=ie(t.getParentCreatedAt()),n.value=xr(t.getValue()),n.executedAt=ie(t.getExecutedAt()),e.body.case="increase",e.body.value=n}else if(r instanceof qn){const t=r,n=new M.Operation_TreeEdit,i=n.createdAtMapByActor;for(const[u,c]of t.getMaxCreatedAtMapByActor())i[u]=ie(c);n.parentCreatedAt=ie(t.getParentCreatedAt()),n.from=Sr(t.getFromPos()),n.to=Sr(t.getToPos()),n.contents=Us(t.getContents()),n.splitLevel=t.getSplitLevel(),n.executedAt=ie(t.getExecutedAt()),e.body.case="treeEdit",e.body.value=n}else if(r instanceof Pn){const t=r,n=new M.Operation_TreeStyle;n.parentCreatedAt=ie(t.getParentCreatedAt()),n.from=Sr(t.getFromPos()),n.to=Sr(t.getToPos());const i=t.getAttributesToRemove();if(i.length>0)n.attributesToRemove=i;else{const u=n.attributes;for(const[c,d]of t.getAttributes())u[c]=d}n.executedAt=ie(t.getExecutedAt()),e.body.case="treeStyle",e.body.value=n}else throw new Ie(Ne.Unimplemented,"unimplemented operation");return e}function _s(r){const e=[];for(const t of r)e.push(zr(t));return e}function Ls(r){const e=new M.Change({id:Kr(r.getID()),message:r.getMessage()});return r.hasOperations()&&(e.operations=_s(r.getOperations())),r.hasPresenceChange()&&(e.presenceChange=Cs(r.getPresenceChange())),e}function Bs(r){const e=[];for(const t of r)e.push(Ls(t));return e}function Ms(r){const e=[];for(const t of r)e.push(new M.RHTNode({key:t.getStrKey(),element:_r(t.getValue())}));return e}function Js(r){const e=[];for(const t of r)e.push(new M.RGANode({element:_r(t.getValue())}));return e}function Fs(r){const e=[];for(const t of r){const n=new M.TextNode;n.id=xs(t.getID()),n.value=t.getValue().getContent(),n.removedAt=ie(t.getRemovedAt());const i=n.attributes,u=t.getValue().getAttrs();for(const c of u){const d=new M.NodeAttr;d.value=c.getValue(),d.updatedAt=ie(c.getUpdatedAt()),i[c.getKey()]=d}e.push(n)}return e}function Us(r){const e=[];if(!r||!r.length)return e;for(const t of r)e.push(new M.TreeNodes({content:Xr(t)}));return e}function Xr(r){if(!r)return[];const e=[];return Jt(r,(t,n)=>{const i=new M.TreeNode({id:fr(t.id),type:t.type,removedAt:ie(t.removedAt),depth:n});if(t.isText&&(i.value=t.value),t.insPrevID&&(i.insPrevId=fr(t.insPrevID)),t.insNextID&&(i.insNextId=fr(t.insNextID)),t.attrs)for(const u of t.attrs)i.attributes[u.getKey()]=new M.NodeAttr({value:u.getValue(),updatedAt:ie(u.getUpdatedAt())});e.push(i)}),e}function $s(r){const e=new M.JSONElement;return e.body.case="jsonObject",e.body.value=new M.JSONElement_JSONObject({nodes:Ms(r.getRHT()),createdAt:ie(r.getCreatedAt()),movedAt:ie(r.getMovedAt()),removedAt:ie(r.getRemovedAt())}),e}function Hr(r){const e=new M.JSONElement;return e.body.case="jsonArray",e.body.value=new M.JSONElement_JSONArray({nodes:Js(r.getElements()),createdAt:ie(r.getCreatedAt()),movedAt:ie(r.getMovedAt()),removedAt:ie(r.getRemovedAt())}),e}function Vs(r){const e=new M.JSONElement;return e.body.case="primitive",e.body.value=new M.JSONElement_Primitive({type:Wr(r.getType()),value:r.toBytes(),createdAt:ie(r.getCreatedAt()),movedAt:ie(r.getMovedAt()),removedAt:ie(r.getRemovedAt())}),e}function js(r){const e=new M.JSONElement;return e.body.case="text",e.body.value=new M.JSONElement_Text({nodes:Fs(r.getRGATreeSplit()),createdAt:ie(r.getCreatedAt()),movedAt:ie(r.getMovedAt()),removedAt:ie(r.getRemovedAt())}),e}function Ys(r){const e=new M.JSONElement;return e.body.case="counter",e.body.value=new M.JSONElement_Counter({type:Gr(r.getType()),value:r.toBytes(),createdAt:ie(r.getCreatedAt()),movedAt:ie(r.getMovedAt()),removedAt:ie(r.getRemovedAt())}),e}function Zr(r){const e=new M.JSONElement;return e.body.case="tree",e.body.value=new M.JSONElement_Tree({nodes:Xr(r.getRoot()),createdAt:ie(r.getCreatedAt()),movedAt:ie(r.getMovedAt()),removedAt:ie(r.getRemovedAt())}),e}function _r(r){if(r instanceof Pe)return $s(r);if(r instanceof Ot)return Hr(r);if(r instanceof _e)return Vs(r);if(r instanceof $e)return js(r);if(r instanceof Wt)return Ys(r);if(r instanceof Et)return Zr(r);throw new Ie(Ne.Unimplemented,"unimplemented element")}function qs(r){return new M.ChangePack({documentKey:r.getDocumentKey(),checkpoint:Rs(r.getCheckpoint()),isRemoved:r.getIsRemoved(),changes:Bs(r.getChanges()),snapshot:r.getSnapshot(),minSyncedTicket:ie(r.getMinSyncedTicket())})}function Qr(r){return vn.of(r.clientSeq,Ye.fromString(r.lamport,!0),Jr(r.actorId))}function oe(r){if(!!r)return Ce.of(Ye.fromString(r.lamport,!0),r.delimiter,Jr(r.actorId))}function Lr(r){const e={};return Object.entries(r.data).forEach(([t,n])=>{e[t]=JSON.parse(n)}),e}function Ks(r){const e=r.type;if(e===M.PresenceChange_ChangeType.PUT){const t=Lr(r.presence);return{type:qt.Put,presence:t}}if(e===M.PresenceChange_ChangeType.CLEAR)return{type:qt.Clear};throw new Ie(Ne.Unsupported,`unsupported type: ${e}`)}function Ws(r){const e=new Map;return Object.entries(r).forEach(([t,n])=>{e.set(t,Lr(n))}),e}function es(r){switch(r){case M.ValueType.NULL:return ae.Null;case M.ValueType.BOOLEAN:return ae.Boolean;case M.ValueType.INTEGER:return ae.Integer;case M.ValueType.LONG:return ae.Long;case M.ValueType.DOUBLE:return ae.Double;case M.ValueType.STRING:return ae.String;case M.ValueType.BYTES:return ae.Bytes;case M.ValueType.DATE:return ae.Date}throw new Ie(Ne.Unimplemented,`unimplemented value type: ${r}`)}function Ir(r){switch(r){case M.ValueType.INTEGER_CNT:return We.IntegerCnt;case M.ValueType.LONG_CNT:return We.LongCnt}throw new Ie(Ne.Unimplemented,`unimplemented value type: ${r}`)}function Br(r){switch(r.type){case M.ValueType.JSON_OBJECT:return r.value?us(r.value):Pe.create(oe(r.createdAt));case M.ValueType.JSON_ARRAY:return r.value?si(r.value):Ot.create(oe(r.createdAt));case M.ValueType.TEXT:return $e.create(er.create(),oe(r.createdAt));case M.ValueType.TREE:return oi(r.value);case M.ValueType.NULL:case M.ValueType.BOOLEAN:case M.ValueType.INTEGER:case M.ValueType.LONG:case M.ValueType.DOUBLE:case M.ValueType.STRING:case M.ValueType.BYTES:case M.ValueType.DATE:return _e.of(_e.valueFromBytes(es(r.type),r.value),oe(r.createdAt));case M.ValueType.INTEGER_CNT:case M.ValueType.LONG_CNT:return Wt.create(Ir(r.type),Wt.valueFromBytes(Ir(r.type),r.value),oe(r.createdAt))}}function kr(r){return mn.of(wn.of(oe(r.createdAt),r.offset),r.relativeOffset)}function ts(r){return wn.of(oe(r.createdAt),r.offset)}function Gs(r){const e=Tn.create(r.value);Object.entries(r.attributes).forEach(([n,i])=>{e.setAttr(n,i.value,oe(i.updatedAt))});const t=Bn.create(ts(r.id),e);return t.remove(oe(r.removedAt)),t}function nr(r){return X.of(dr(r.parentId),dr(r.leftSiblingId))}function dr(r){return H.of(oe(r.createdAt),r.offset)}function zs(r){if(!r.length)return;const e=[];return r.forEach(t=>{const n=ns(t.content);e.push(n)}),e}function ns(r){if(r.length===0)return;const e=[];for(const n of r)e.push(Xs(n));const t=e[e.length-1];for(let n=e.length-2;n>=0;n--){let i;for(let u=n+1;u<e.length;u++)if(r[n].depth-1===r[u].depth){i=e[u];break}i.prepend(e[n])}return Et.create(t,Be).getRoot()}function Xs(r){const e=dr(r.id),t=se.create(e,r.type);if(t.isText)t.value=r.value;else{const n=nt.create();Object.entries(r.attributes).forEach(([i,u])=>{n.set(i,u.value,oe(u.updatedAt))}),t.attrs=n}return r.insPrevId&&(t.insPrevID=dr(r.insPrevId)),r.insNextId&&(t.insNextID=dr(r.insNextId)),t.removedAt=oe(r.removedAt),t}function rs(r){if(r.body.case==="set"){const e=r.body.value;return On.create(e.key,Br(e.value),oe(e.parentCreatedAt),oe(e.executedAt))}else if(r.body.case==="add"){const e=r.body.value;return Ln.create(oe(e.parentCreatedAt),oe(e.prevCreatedAt),Br(e.value),oe(e.executedAt))}else if(r.body.case==="move"){const e=r.body.value;return Kt.create(oe(e.parentCreatedAt),oe(e.prevCreatedAt),oe(e.createdAt),oe(e.executedAt))}else if(r.body.case==="remove"){const e=r.body.value;return yn.create(oe(e.parentCreatedAt),oe(e.createdAt),oe(e.executedAt))}else if(r.body.case==="edit"){const e=r.body.value,t=new Map;Object.entries(e.createdAtMapByActor).forEach(([i,u])=>{t.set(i,oe(u))});const n=new Map;return Object.entries(e.attributes).forEach(([i,u])=>{n.set(i,u)}),ot.create(oe(e.parentCreatedAt),kr(e.from),kr(e.to),t,e.content,n,oe(e.executedAt))}else if(r.body.case==="style"){const e=r.body.value,t=new Map;Object.entries(e.createdAtMapByActor).forEach(([i,u])=>{t.set(i,oe(u))});const n=new Map;return Object.entries(e.attributes).forEach(([i,u])=>{n.set(i,u)}),at.create(oe(e.parentCreatedAt),kr(e.from),kr(e.to),t,n,oe(e.executedAt))}else{if(r.body.case==="select")return;if(r.body.case==="increase"){const e=r.body.value;return tr.create(oe(e.parentCreatedAt),Br(e.value),oe(e.executedAt))}else if(r.body.case==="treeEdit"){const e=r.body.value,t=new Map;return Object.entries(e.createdAtMapByActor).forEach(([n,i])=>{t.set(n,oe(i))}),qn.create(oe(e.parentCreatedAt),nr(e.from),nr(e.to),zs(e.contents),e.splitLevel,t,oe(e.executedAt))}else if(r.body.case==="treeStyle"){const e=r.body.value,t=new Map,n=e.attributesToRemove;return n.length>0?Pn.createTreeRemoveStyleOperation(oe(e.parentCreatedAt),nr(e.from),nr(e.to),n,oe(e.executedAt)):(Object.entries(e.attributes).forEach(([i,u])=>{t.set(i,u)}),Pn.create(oe(e.parentCreatedAt),nr(e.from),nr(e.to),t,oe(e.executedAt)))}else throw new Ie(Ne.Unimplemented,"unimplemented operation")}}function Hs(r){const e=[];for(const t of r){const n=rs(t);n&&e.push(n)}return e}function ss(r){const e=[];for(const t of r)e.push(Kn.create({id:Qr(t.id),operations:Hs(t.operations),presenceChange:t.presenceChange?Ks(t.presenceChange):void 0,message:t.message}));return e}function Zs(r){return Qn.of(Ye.fromString(r.serverSeq,!0),r.clientSeq)}function Qs(r){return Nr.create(r.documentKey,Zs(r.checkpoint),r.isRemoved,ss(r.changes),r.snapshot,oe(r.minSyncedTicket))}function is(r){const e=new it;for(const n of r.nodes){const i=Mr(n.element);e.set(n.key,i,i.getPositionedAt())}const t=new Pe(oe(r.createdAt),e);return t.setMovedAt(oe(r.movedAt)),t.setRemovedAt(oe(r.removedAt)),t}function os(r){const e=new Yn;for(const n of r.nodes)e.insert(Mr(n.element));const t=new Ot(oe(r.createdAt),e);return t.setMovedAt(oe(r.movedAt)),t.setRemovedAt(oe(r.removedAt)),t}function ei(r){const e=_e.of(_e.valueFromBytes(es(r.type),r.value),oe(r.createdAt));return e.setMovedAt(oe(r.movedAt)),e.setRemovedAt(oe(r.removedAt)),e}function ti(r){const e=new er;let t=e.getHead();for(const i of r.nodes){const u=e.insertAfter(t,Gs(i));i.insPrevId&&u.setInsPrev(e.findNode(ts(i.insPrevId))),t=u}const n=new $e(e,oe(r.createdAt));return n.setMovedAt(oe(r.movedAt)),n.setRemovedAt(oe(r.removedAt)),n}function ni(r){const e=Wt.create(Ir(r.type),Wt.valueFromBytes(Ir(r.type),r.value),oe(r.createdAt));return e.setMovedAt(oe(r.movedAt)),e.setRemovedAt(oe(r.removedAt)),e}function as(r){const e=ns(r.nodes);return Et.create(e,oe(r.createdAt))}function Mr(r){if(r.body.case==="jsonObject")return is(r.body.value);if(r.body.case==="jsonArray")return os(r.body.value);if(r.body.case==="primitive")return ei(r.body.value);if(r.body.case==="text")return ti(r.body.value);if(r.body.case==="counter")return ni(r.body.value);if(r.body.case==="tree")return as(r.body.value);throw new Ie(Ne.Unimplemented,"unimplemented element")}function ri(r){if(!r)return{root:Pe.create(Be),presences:new Map};const e=M.Snapshot.fromBinary(r);return{root:Mr(e.root),presences:Ws(e.presences)}}function us(r){if(!r)throw new Error("bytes is empty");const e=M.JSONElement.fromBinary(r);return is(e.body.value)}function cs(r){return _r(r).toBinary()}function si(r){if(!r)throw new Error("bytes is empty");const e=M.JSONElement.fromBinary(r);return os(e.body.value)}function ii(r){return Hr(r).toBinary()}function oi(r){if(!r)throw new Error("bytes is empty");const e=M.JSONElement.fromBinary(r);return as(e.body.value)}function ai(r){return Zr(r).toBinary()}function ls(r){return r?Array.from(r).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function Jr(r){return ls(r)}function fs(r){return new Uint8Array(r.match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Fr(r){return fs(r)}function ui(r){const e=M.ChangeID.fromBinary(r);return Qr(e)}function ci(r){const e=M.Operation.fromBinary(r);return rs(e)}const Qe={fromPresence:Lr,toChangePack:qs,fromChangePack:Qs,fromChanges:ss,objectToBytes:cs,bytesToObject:us,bytesToSnapshot:ri,bytesToHex:ls,hexToBytes:fs,toHexString:Jr,toUint8Array:Fr,toOperation:zr,toChangeID:Kr,PbChangeID:M.ChangeID,bytesToChangeID:ui,bytesToOperation:ci};class li{constructor(e,t,n,i){this.reconnectStreamDelay=e,this.doc=t,this.docID=n,this.syncMode=i,this.remoteChangeEventReceived=!1}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.syncMode===Gt.RealtimeSyncOff?!1:this.syncMode!==Gt.Manual&&(this.doc.hasLocalChanges()||this.remoteChangeEventReceived)}async runWatchLoop(e){const t=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.watchLoopTimerID=setTimeout(t,this.reconnectStreamDelay)})}catch{}};await t()}cancelWatchStream(){this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}}class rr{constructor(e,t,n,i){this.id=e,this.delimiter=Lt,this.root=t,this.operations=[],this.previousPresence=qe(n),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=i}static create(e,t,n,i){return new rr(e,t,n,i)}push(e){this.operations.push(e)}registerElement(e,t){this.root.registerElement(e,t)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerElementHasRemovedNodes(e){this.root.registerElementHasRemovedNodes(e)}getChange(){return Kn.create({id:this.id,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}hasChange(){return this.operations.length>0||this.presenceChange!==void 0}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,t){for(const n of Object.keys(e))t!=null&&t.addToHistory?this.reversePresenceKeys.add(n):this.reversePresenceKeys.delete(n)}getReversePresence(){if(this.reversePresenceKeys.size===0)return;const e={};for(const t of this.reversePresenceKeys)e[t]=this.previousPresence[t];return e}issueTimeTicket(){return this.delimiter+=1,this.id.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.id.createTimeTicket(this.delimiter)}}class hr{constructor(e){this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.removedElementSetByCreatedAt=new Set,this.elementHasRemovedNodesSetByCreatedAt=new Set,this.registerElement(e,void 0)}static create(){return new hr(Pe.create(Be))}findByCreatedAt(e){const t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!!t)return t.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!t)return[];const n=[];for(;t.parent;){const i=t.element.getCreatedAt(),u=t.parent.subPathOf(i);u===void 0&&g.fatal(`cant find the given element: ${i.toIDString()}`),n.unshift(u),t=this.elementPairMapByCreatedAt.get(t.parent.getCreatedAt().toIDString())}return n.unshift("$"),n}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,t){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),e instanceof Ke&&e.getDescendants((n,i)=>(this.registerElement(n,i),!1))}deregisterElement(e){let t=0;const n=i=>{const u=i.getCreatedAt().toIDString();this.elementPairMapByCreatedAt.delete(u),this.removedElementSetByCreatedAt.delete(u),t++};return n(e),e instanceof Ke&&e.getDescendants(i=>(n(i),!1)),t}registerRemovedElement(e){this.removedElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerElementHasRemovedNodes(e){this.elementHasRemovedNodesSetByCreatedAt.add(e.getCreatedAt().toIDString())}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getRemovedElementSetSize(){return this.removedElementSetByCreatedAt.size}getObject(){return this.rootObject}getGarbageLen(){let e=0;const t=new Set;for(const n of this.removedElementSetByCreatedAt){t.add(n);const i=this.elementPairMapByCreatedAt.get(n);i.element instanceof Ke&&i.element.getDescendants(u=>(t.add(u.getCreatedAt().toIDString()),!1))}e+=t.size;for(const n of this.elementHasRemovedNodesSetByCreatedAt){const u=this.elementPairMapByCreatedAt.get(n).element;e+=u.getRemovedNodesLen()}return e}deepcopy(){return new hr(this.rootObject.deepcopy())}garbageCollect(e){let t=0;for(const n of this.removedElementSetByCreatedAt){const i=this.elementPairMapByCreatedAt.get(n);i.element.getRemovedAt()&&e.compare(i.element.getRemovedAt())>=0&&(i.parent.purge(i.element),t+=this.deregisterElement(i.element))}for(const n of this.elementHasRemovedNodesSetByCreatedAt){const u=this.elementPairMapByCreatedAt.get(n).element,c=u.purgeRemovedNodesBefore(e);c>0&&this.elementHasRemovedNodesSetByCreatedAt.delete(u.getCreatedAt().toIDString()),t+=c}return t}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}}function ds(r,e){const t=new mr(r);return new Proxy(e,t.getHandlers())}class mr{constructor(e){this.context=e,this.handlers={set:(t,n,i)=>(g.isEnabled(A.Trivial)&&g.trivial(`obj[${n}]=${JSON.stringify(i)}`),mr.setInternal(e,t,n,i),!0),get:(t,n)=>(g.isEnabled(A.Trivial)&&g.trivial(`obj[${n}]`),n==="getID"?()=>t.getCreatedAt():n==="toJSON"||n==="toString"?()=>t.toJSON():n==="toJS"?()=>t.toJS():n==="toJSForTest"?()=>t.toJSForTest():Wn(e,t.get(n))),ownKeys:t=>t.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(t,n)=>(g.isEnabled(A.Trivial)&&g.trivial(`obj[${n}]`),mr.deleteInternal(e,t,n),!0)}}static setInternal(e,t,n,i){if(n.includes("."))throw new Ie(Ne.InvalidObjectKey,"key must not contain the '.'.");const u=e.issueTimeTicket(),c=Dr(e,i,u),d=t.set(n,c,u);e.registerElement(c,t),d&&e.registerRemovedElement(d),e.push(On.create(n,c.deepcopy(),t.getCreatedAt(),u))}static buildObjectMembers(e,t){const n={};for(const[i,u]of Object.entries(t)){if(i.includes("."))throw new Ie(Ne.InvalidObjectKey,"key must not contain the '.'.");const c=e.issueTimeTicket(),d=Dr(e,u,c);n[i]=d}return n}static deleteInternal(e,t,n){const i=e.issueTimeTicket(),u=t.deleteByKey(n,i);!u||(e.push(yn.create(t.getCreatedAt(),u.getCreatedAt(),i)),e.registerRemovedElement(u))}getHandlers(){return this.handlers}}function fi(r,e){const t=new Ve(r,e);return new Proxy(e,t.getHandlers())}function di(r){return typeof r=="string"||r instanceof String?!isNaN(r):!1}function hi(r){return["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(r)}class Ve{constructor(e,t){this.context=e,this.array=t,this.handlers={get:(n,i,u)=>i==="getID"?()=>n.getCreatedAt():i==="getElementByID"?c=>{const d=n.getByID(c);if(!(!d||d.isRemoved()))return Mn(e,d)}:i==="getElementByIndex"?c=>{const d=n.get(c);return Mn(e,d)}:i==="getLast"?()=>Mn(e,n.getLast()):i==="deleteByID"?c=>{const d=Ve.deleteInternalByID(e,n,c);return Mn(e,d)}:i==="insertAfter"?(c,d)=>{const E=Ve.insertAfterInternal(e,n,c,d);return Mn(e,E)}:i==="insertBefore"?(c,d)=>{const E=Ve.insertBeforeInternal(e,n,c,d);return Mn(e,E)}:i==="moveBefore"?(c,d)=>{Ve.moveBeforeInternal(e,n,c,d)}:i==="moveAfter"?(c,d)=>{Ve.moveAfterInternal(e,n,c,d)}:i==="moveFront"?c=>{Ve.moveFrontInternal(e,n,c)}:i==="moveLast"?c=>{Ve.moveLastInternal(e,n,c)}:di(i)?Wn(e,n.get(Number(i))):i==="push"?c=>Ve.pushInternal(e,n,c):i==="splice"?(c,d,...E)=>Ve.splice(e,n,c,d,...E):i==="length"?n.length:typeof i=="symbol"&&i===Symbol.iterator?Ve.iteratorInternal.bind(this,e,n):i==="includes"?(c,d)=>Ve.includes(e,n,c,d):i==="indexOf"?(c,d)=>Ve.indexOf(e,n,c,d):i==="lastIndexOf"?(c,d)=>Ve.lastIndexOf(e,n,c,d):i==="toJSForTest"?()=>n.toJSForTest():i==="toTestString"?()=>Ve.toTestString(n):typeof i=="string"&&hi(i)?(...c)=>{const d=Array.from(n).map(E=>Wn(e,E));return Array.prototype[i].apply(d,c)}:Reflect.get(n,i,u),deleteProperty:(n,i)=>(g.isEnabled(A.Trivial)&&g.trivial(`array[${i}]`),Ve.deleteInternalByIndex(e,n,Number.parseInt(i)),!0)}}static*iteratorInternal(e,t){for(const n of t)yield Mn(e,n)}static buildArrayElements(e,t){const n=[];for(const i of t){const u=e.issueTimeTicket(),c=Dr(e,i,u);n.push(c)}return n}static pushInternal(e,t,n){return Ve.insertAfterInternal(e,t,t.getLastCreatedAt(),n),t.length}static moveBeforeInternal(e,t,n,i){const u=e.issueTimeTicket(),c=t.getPrevCreatedAt(n);t.moveAfter(c,i,u),e.push(Kt.create(t.getCreatedAt(),c,i,u))}static moveAfterInternal(e,t,n,i){const u=e.issueTimeTicket();t.moveAfter(n,i,u),e.push(Kt.create(t.getCreatedAt(),n,i,u))}static moveFrontInternal(e,t,n){const i=e.issueTimeTicket(),u=t.getHead();t.moveAfter(u.getCreatedAt(),n,i),e.push(Kt.create(t.getCreatedAt(),u.getCreatedAt(),n,i))}static moveLastInternal(e,t,n){const i=e.issueTimeTicket(),u=t.getLastCreatedAt();t.moveAfter(u,n,i),e.push(Kt.create(t.getCreatedAt(),u,n,i))}static insertAfterInternal(e,t,n,i){const u=e.issueTimeTicket(),c=Dr(e,i,u);return t.insertAfter(n,c),e.registerElement(c,t),e.push(Ln.create(t.getCreatedAt(),n,c.deepcopy(),u)),c}static insertBeforeInternal(e,t,n,i){return Ve.insertAfterInternal(e,t,t.getPrevCreatedAt(n),i)}static deleteInternalByIndex(e,t,n){const i=e.issueTimeTicket(),u=t.deleteByIndex(n,i);if(!!u)return e.push(yn.create(t.getCreatedAt(),u.getCreatedAt(),i)),e.registerRemovedElement(u),u}static deleteInternalByID(e,t,n){const i=e.issueTimeTicket(),u=t.delete(n,i);return e.push(yn.create(t.getCreatedAt(),u.getCreatedAt(),i)),e.registerRemovedElement(u),u}static splice(e,t,n,i,...u){const c=t.length,d=n>=0?Math.min(n,c):Math.max(c+n,0),E=i===void 0?c:i<0?d:Math.min(d+i,c),v=[];for(let J=d;J<E;J++){const Q=Ve.deleteInternalByIndex(e,t,d);if(Q){const F=Q.deepcopy();F.setRemovedAt(),v.push(Wn(e,F))}}if(u){let J=d===0?t.getHead().getID():t.get(d-1).getID();for(const Q of u)J=Ve.insertAfterInternal(e,t,J,Q).getID()}return v}static includes(e,t,n,i){var u;const c=t.length,d=i===void 0?0:i<0?Math.max(i+c,0):i;if(d>=c)return!1;if(_e.isSupport(n))return Array.from(t).map(v=>Wn(e,v)).includes(n,d);for(let E=d;E<c;E++)if(((u=t.get(E))===null||u===void 0?void 0:u.getID())===n.getID())return!0;return!1}static indexOf(e,t,n,i){var u;const c=t.length,d=i===void 0?0:i<0?Math.max(i+c,0):i;if(d>=c)return-1;if(_e.isSupport(n))return Array.from(t).map(v=>Wn(e,v)).indexOf(n,d);for(let E=d;E<c;E++)if(((u=t.get(E))===null||u===void 0?void 0:u.getID())===n.getID())return E;return-1}static lastIndexOf(e,t,n,i){var u;const c=t.length,d=i===void 0||i>=c?c-1:i<0?i+c:i;if(d<0)return-1;if(_e.isSupport(n))return Array.from(t).map(v=>Wn(e,v)).lastIndexOf(n,d);for(let E=d;E>0;E--)if(((u=t.get(E))===null||u===void 0?void 0:u.getID())===n.getID())return E;return-1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}}class Ar{constructor(e,t){this.context=e,this.text=t}initialize(e,t){this.context=e,this.text=t}getID(){return this.text.getID()}edit(e,t,n,i){if(!this.context||!this.text){g.fatal("it is not initialized yet");return}if(e>t){g.fatal("from should be less than or equal to to");return}const u=this.text.indexRangeToPosRange(e,t);g.isEnabled(A.Debug)&&g.debug(`EDIT: f:${e}->${u[0].toTestString()}, t:${t}->${u[1].toTestString()} c:${n}`);const c=i?_n(i):void 0,d=this.context.issueTimeTicket(),[E,,v]=this.text.edit(u,n,d,c);return this.context.push(new ot(this.text.getCreatedAt(),u[0],u[1],E,n,c?new Map(Object.entries(c)):new Map,d)),u[0].equals(u[1])||this.context.registerElementHasRemovedNodes(this.text),this.text.findIndexesFromRange(v)}delete(e,t){return this.edit(e,t,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,t,n){if(!this.context||!this.text)return g.fatal("it is not initialized yet"),!1;if(e>t)return g.fatal("from should be less than or equal to to"),!1;const i=this.text.indexRangeToPosRange(e,t);g.isEnabled(A.Debug)&&g.debug(`STYL: f:${e}->${i[0].toTestString()}, t:${t}->${i[1].toTestString()} a:${JSON.stringify(n)}`);const u=_n(n),c=this.context.issueTimeTicket(),[d]=this.text.setStyle(i,u,c);return this.context.push(new at(this.text.getCreatedAt(),i[0],i[1],d,new Map(Object.entries(u)),c)),!0}indexRangeToPosRange(e){if(!this.context||!this.text){g.fatal("it is not initialized yet");return}const t=this.text.indexRangeToPosRange(e[0],e[1]);return[t[0].toStruct(),t[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text){g.fatal("it is not initialized yet");return}const t=this.text.findIndexesFromRange([mn.fromStruct(e[0]),mn.fromStruct(e[1])]);return[t[0],t[1]]}toTestString(){if(!this.context||!this.text){g.fatal("it is not initialized yet");return}return this.text.toTestString()}values(){if(!this.context||!this.text){g.fatal("it is not initialized yet");return}return this.text.values()}get length(){return this.text.length}checkWeight(){return this.text.checkWeight()}toString(){return!this.context||!this.text?(g.fatal("it is not initialized yet"),""):this.text.toString()}toJSForTest(){if(!this.context||!this.text)throw new Error("it is not initialized yet");return this.text.toJSForTest()}createRangeForTest(e,t){if(!this.context||!this.text){g.fatal("it is not initialized yet");return}return this.text.indexRangeToPosRange(e,t)}}class Or{constructor(e,t){this.valueType=e,this.value=t}initialize(e,t){this.valueType=t.getValueType(),this.context=e,this.counter=t,this.value=t.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter){g.fatal("it is not initialized yet");return}const t=this.context.issueTimeTicket(),n=_e.of(e,t);if(!n.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof n.getValue()}`);return this.counter.increase(n),this.context.push(tr.create(this.counter.getCreatedAt(),n,t)),this}toJSForTest(){if(!this.context||!this.counter)throw new Error("it is not initialized yet");return this.counter.toJSForTest()}}function Ur(r,e,t){const{type:n}=r,i=t.issueTimeTicket();if(n===wt){hs(r);const{value:u}=r,c=se.create(H.of(i,0),n,u);e.append(c)}else{const{children:u=[]}=r;let{attributes:c}=r,d;if(typeof c=="object"&&!st(c)){c=_n(c),d=new nt;for(const[v,J]of Object.entries(c))d.set(v,J,i)}const E=se.create(H.of(i,0),n,void 0,d);e.append(E);for(const v of u)Ur(v,E,t)}}function mi(r,e){const{type:t}=e,n=r.issueTimeTicket();let i;if(e.type===wt){const{value:u}=e;i=se.create(H.of(n,0),t,u)}else if(e){const{children:u=[]}=e;let{attributes:c}=e,d;if(typeof c=="object"&&!st(c)){c=_n(c),d=new nt;for(const[E,v]of Object.entries(c))d.set(E,v,n)}i=se.create(H.of(r.issueTimeTicket(),0),t,void 0,d);for(const E of u)Ur(E,i,r)}return i}function hs(r){if(!r.value.length)throw new Error("text node cannot have empty value");return!0}function ms(r){if(!r.length)return!0;if(r[0].type===wt)for(const t of r){const{type:n}=t;if(n!==wt)throw new Error("element node and text node cannot be passed together");hs(t)}else for(const t of r){const{type:n}=t;if(n===wt)throw new Error("element node and text node cannot be passed together")}return!0}class Pr{constructor(e){this.initialRoot=e}initialize(e,t){this.context=e,this.tree=t}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return se.create(H.of(e.issueTimeTicket(),0),sn);const t=se.create(H.of(e.issueTimeTicket(),0),this.initialRoot.type);for(const n of this.initialRoot.children)Ur(n,t,e);return t}getSize(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.getSize()}getIndexTree(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.getIndexTree()}styleByPath(e,t){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(!e.length)throw new Error("path should not be empty");const[n,i]=this.tree.pathToPosRange(e),u=this.context.issueTimeTicket(),c=t?_n(t):void 0;this.tree.style([n,i],c,u),this.context.push(Pn.create(this.tree.getCreatedAt(),n,i,c?new Map(Object.entries(c)):new Map,u))}style(e,t,n){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e>t)throw new Error("from should be less than or equal to to");const i=this.tree.findPos(e),u=this.tree.findPos(t),c=this.context.issueTimeTicket(),d=n?_n(n):void 0;this.tree.style([i,u],d,c),this.context.push(Pn.create(this.tree.getCreatedAt(),i,u,d?new Map(Object.entries(d)):new Map,c))}removeStyle(e,t,n){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e>t)throw new Error("from should be less than or equal to to");const i=this.tree.findPos(e),u=this.tree.findPos(t),c=this.context.issueTimeTicket();this.tree.removeStyle([i,u],n,c),this.context.push(Pn.createTreeRemoveStyleOperation(this.tree.getCreatedAt(),i,u,n,c))}editInternal(e,t,n,i=0){var u;if(n.length!==0&&n[0]&&(ms(n),n[0].type!==wt))for(const v of n){const{children:J=[]}=v;ms(J)}const c=this.context.getLastTimeTicket();let d=new Array;if(((u=n[0])===null||u===void 0?void 0:u.type)===wt){let v="";for(const J of n){const{value:Q}=J;v+=Q}d.push(se.create(H.of(this.context.issueTimeTicket(),0),wt,v))}else d=n.map(v=>v&&mi(this.context,v)).filter(v=>v);const[,E]=this.tree.edit([e,t],d.length?d.map(v=>v==null?void 0:v.deepcopy()):void 0,i,c,()=>this.context.issueTimeTicket());return this.context.push(qn.create(this.tree.getCreatedAt(),e,t,d.length?d:void 0,i,E,c)),e.equals(t)||this.context.registerElementHasRemovedNodes(this.tree),!0}editByPath(e,t,n,i=0){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e.length!==t.length)throw new Error("path length should be equal");if(!e.length||!t.length)throw new Error("path should not be empty");const u=this.tree.pathToPos(e),c=this.tree.pathToPos(t);return this.editInternal(u,c,n?[n]:[],i)}editBulkByPath(e,t,n,i=0){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e.length!==t.length)throw new Error("path length should be equal");if(!e.length||!t.length)throw new Error("path should not be empty");const u=this.tree.pathToPos(e),c=this.tree.pathToPos(t);return this.editInternal(u,c,n,i)}edit(e,t,n,i=0){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e>t)throw new Error("from should be less than or equal to to");const u=this.tree.findPos(e),c=this.tree.findPos(t);return this.editInternal(u,c,n?[n]:[],i)}editBulk(e,t,n,i=0){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e>t)throw new Error("from should be less than or equal to to");const u=this.tree.findPos(e),c=this.tree.findPos(t);return this.editInternal(u,c,n,i)}toXML(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.toJSON()}toJSForTest(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.toJSForTest()}toJSInfoForTest(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree){g.fatal("it is not initialized yet");return}const t=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],n=this.tree.indexRangeToPosRange(t);return[n[0].toStruct(),n[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree){g.fatal("it is not initialized yet");return}return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree){g.fatal("it is not initialized yet");return}const t=[X.fromStruct(e[0]),X.fromStruct(e[1])];return this.tree.posRangeToIndexRange(t)}posRangeToPathRange(e){if(!this.context||!this.tree){g.fatal("it is not initialized yet");return}const t=[X.fromStruct(e[0]),X.fromStruct(e[1])];return this.tree.posRangeToPathRange(t)}}function gs(r,e){return ds(r,e)}function Mn(r,e){if(e){if(e instanceof _e)return e;if(e instanceof Pe)return ds(r,e);if(e instanceof Ot)return fi(r,e);if(e instanceof $e)return new Ar(r,e);if(e instanceof Wt){const t=new Or(We.IntegerCnt,0);return t.initialize(r,e),t}else if(e instanceof Et){const t=new Pr;return t.initialize(r,e),t}}else return;throw new TypeError(`Unsupported type of element: ${typeof e}`)}function Wn(r,e){const t=Mn(r,e);return t instanceof _e?t.getValue():t}function Dr(r,e,t){let n;if(_e.isSupport(e))n=_e.of(e,t);else if(Array.isArray(e))n=Ot.create(t,Ve.buildArrayElements(r,e));else if(typeof e=="object")e instanceof Ar?(n=$e.create(er.create(),t),e.initialize(r,n)):e instanceof Or?(n=Wt.create(e.getValueType(),e.getValue(),t),e.initialize(r,n)):e instanceof Pr?(n=Et.create(e.buildRoot(r),t),e.initialize(r,n)):n=Pe.create(t,mr.buildObjectMembers(r,e));else throw new TypeError(`Unsupported type of value: ${typeof e}`);return n}const ps=50;class gi{constructor(){this.undoStack=[],this.redoStack=[]}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=ps&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=ps&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}}const ys="yorkie-devtools-panel",Ts="yorkie-devtools-sdk";let sr="disconnected";const vs=new Map,$r=new Map;function Cr(r,e){!((e==null?void 0:e.force)||sr!=="disconnected")||window.postMessage({source:Ts,...r},"*")}function pi(r){if(!r.isEnableDevtools()||vs.has(r.getKey()))return;$r.set(r.getKey(),[]);const e=r.subscribe("all",t=>{$r.get(r.getKey()).push(t),sr==="synced"&&Cr({msg:"doc::sync::partial",docKey:r.getKey(),event:t})});vs.set(r.getKey(),[e]),Cr({msg:"refresh-devtools"},{force:!0}),window.addEventListener("message",t=>{var n;if(((n=t.data)===null||n===void 0?void 0:n.source)!==ys)return;switch(t.data.msg){case"devtools::connect":if(sr!=="disconnected")break;sr="connected",Cr({msg:"doc::available",docKey:r.getKey()}),g.info(`[YD] Devtools connected. Doc: ${r.getKey()}`);break;case"devtools::disconnect":sr="disconnected",g.info(`[YD] Devtools disconnected. Doc: ${r.getKey()}`);break;case"devtools::subscribe":sr="synced",Cr({msg:"doc::sync::full",docKey:r.getKey(),events:$r.get(r.getKey())}),g.info(`[YD] Devtools subscribed. Doc: ${r.getKey()}`);break}})}var Nt;(function(r){r.Detached="detached",r.Attached="attached",r.Removed="removed"})(Nt||(Nt={}));var le;(function(r){r.StatusChanged="status-changed",r.Snapshot="snapshot",r.LocalChange="local-change",r.RemoteChange="remote-change",r.Initialized="initialized",r.Watched="watched",r.Unwatched="unwatched",r.PresenceChanged="presence-changed"})(le||(le={}));class ws{constructor(e,t){this.opts=t||{},this.key=e,this.status=Nt.Detached,this.root=hr.create(),this.changeID=As,this.checkpoint=Os,this.localChanges=[],this.eventStream=_(n=>{this.eventStreamObserver=n}),this.onlineClients=new Set,this.presences=new Map,this.isUpdating=!1,this.internalHistory=new gi,this.history={canUndo:this.canUndo.bind(this),canRedo:this.canRedo.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this)},pi(this)}update(e,t){if(this.getStatus()===Nt.Removed)throw new Ie(Ne.DocumentRemoved,`${this.key} is removed`);this.ensureClone();const n=this.changeID.getActorID(),i=rr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(n)||{},t);try{const u=gs(i,this.clone.root.getObject());this.presences.has(n)||this.clone.presences.set(n,{}),this.isUpdating=!0,e(u,new pt(i,this.clone.presences.get(n)))}catch(u){throw this.clone=void 0,g.error(u),u}finally{this.isUpdating=!1}if(i.hasChange()){g.isEnabled(A.Trivial)&&g.trivial(`trying to update a local change: ${this.toJSON()}`);const u=i.getChange(),{opInfos:c,reverseOps:d}=u.execute(this.root,this.presences,ge.Local),E=i.getReversePresence();E&&d.push({type:"presence",value:E}),this.localChanges.push(u),d.length>0&&this.internalHistory.pushUndo(d),c.length>0&&this.internalHistory.clearRedo(),this.changeID=u.getID();const v=[];c.length>0&&v.push({type:le.LocalChange,source:ge.Local,value:{message:u.getMessage()||"",operations:c,actor:n},rawChange:this.isEnableDevtools()?u.toStruct():void 0}),u.hasPresenceChange()&&v.push({type:le.PresenceChanged,source:ge.Local,value:{clientID:n,presence:this.getPresence(n)}}),this.publish(v),g.isEnabled(A.Trivial)&&g.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(e,t,n,i){if(typeof e=="string"){if(typeof t!="function")throw new Error("Second argument must be a callback function");if(e==="presence"){const d=t;return this.eventStream.subscribe(E=>{for(const v of E)v.type!==le.Initialized&&v.type!==le.Watched&&v.type!==le.Unwatched&&v.type!==le.PresenceChanged||d(v)},n,i)}if(e==="my-presence"){const d=t;return this.eventStream.subscribe(E=>{for(const v of E)v.type!==le.Initialized&&v.type!==le.Watched&&v.type!==le.Unwatched&&v.type!==le.PresenceChanged||v.type!==le.Initialized&&v.value.clientID!==this.changeID.getActorID()||d(v)},n,i)}if(e==="others"){const d=t;return this.eventStream.subscribe(E=>{for(const v of E)v.type!==le.Watched&&v.type!==le.Unwatched&&v.type!==le.PresenceChanged||v.value.clientID!==this.changeID.getActorID()&&d(v)},n,i)}if(e==="all"){const d=t;return this.eventStream.subscribe(d,n,i)}const u=e,c=t;return this.eventStream.subscribe(d=>{for(const E of d){if(E.type!==le.Snapshot&&E.type!==le.LocalChange&&E.type!==le.RemoteChange)continue;if(E.type===le.Snapshot){u==="$"&&c(E);continue}const v=[];for(const J of E.value.operations)this.isSameElementOrChildOf(J.path,u)&&v.push(J);v.length&&c({...E,value:{...E.value,operations:v}})}},n,i)}if(typeof e=="function"){const u=e,c=t,d=n;return this.eventStream.subscribe(E=>{for(const v of E)v.type!==le.Snapshot&&v.type!==le.LocalChange&&v.type!==le.RemoteChange||u(v)},c,d)}throw new Error(`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}isSameElementOrChildOf(e,t){if(t===e)return!0;const n=e.split(".");return t.split(".").every((u,c)=>u===n[c])}applyChangePack(e){for(e.hasSnapshot()?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getSnapshot()):e.hasChanges()&&this.applyChanges(e.getChanges(),ge.Remote);this.localChanges.length&&!(this.localChanges[0].getID().getClientSeq()>e.getCheckpoint().getClientSeq());)this.localChanges.shift();this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),this.garbageCollect(e.getMinSyncedTicket()),e.getIsRemoved()&&this.applyStatus(Nt.Removed),g.isEnabled(A.Trivial)&&g.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:qe(this.presences)})}createChangePack(){const e=Array.from(this.localChanges),t=this.checkpoint.increaseClientSeq(e.length);return Nr.create(this.key,t,!1,e)}setActor(e){for(const t of this.localChanges)t.setActor(e);this.changeID=this.changeID.setActor(e)}isEnableDevtools(){return!!this.opts.enableDevtools}getKey(){return this.key}getStatus(){return this.status}getCloneRoot(){if(!!this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();const e=rr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return gs(e,this.clone.root.getObject())}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(e,t){const{root:n,presences:i}=Qe.bytesToSnapshot(t);this.root=new hr(n),this.presences=i,this.changeID=this.changeID.syncLamport(e),this.clone=void 0,this.publish([{type:le.Snapshot,source:ge.Remote,value:{snapshot:this.isEnableDevtools()?Qe.bytesToHex(t):void 0,serverSeq:e.toString()}}])}applyChanges(e,t){g.isEnabled(A.Debug)&&g.debug(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getRemovedElementSetSize()}`),g.isEnabled(A.Trivial)&&g.trivial(e.map(n=>`${n.getID().toTestString()}	${n.toTestString()}`).join(`
`));for(const n of e)this.applyChange(n,t);g.isEnabled(A.Debug)&&g.debug(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getRemovedElementSetSize()}`)}applyChange(e,t){this.ensureClone(),e.execute(this.clone.root,this.clone.presences,t);const n=[],i=e.getID().getActorID();if(e.hasPresenceChange()&&this.onlineClients.has(i)){const c=e.getPresenceChange();switch(c.type){case qt.Put:n.push(this.presences.has(i)?{type:le.PresenceChanged,source:t,value:{clientID:i,presence:c.presence}}:{type:le.Watched,source:ge.Remote,value:{clientID:i,presence:c.presence}});break;case qt.Clear:n.push({type:le.Unwatched,source:ge.Remote,value:{clientID:i,presence:this.getPresence(i)}}),this.removeOnlineClient(i);break}}const{opInfos:u}=e.execute(this.root,this.presences,t);if(this.changeID=this.changeID.syncLamport(e.getID().getLamport()),u.length>0){const c=this.isEnableDevtools()?e.toStruct():void 0;n.push(t===ge.Remote?{type:le.RemoteChange,source:t,value:{actor:i,message:e.getMessage()||"",operations:u},rawChange:c}:{type:le.LocalChange,source:t,value:{actor:i,message:e.getMessage()||"",operations:u},rawChange:c})}n.length>0&&this.publish(n)}applyWatchStream(e){if(e.body.case==="initialization"){const t=e.body.value.clientIds,n=new Set;for(const i of t)n.add(i);this.setOnlineClients(n),this.publish([{type:le.Initialized,source:ge.Local,value:this.getPresences()}]);return}if(e.body.case==="event"){const{type:t,publisher:n}=e.body.value,i=[];if(t===M.DocEventType.DOCUMENT_WATCHED)this.addOnlineClient(n),this.hasPresence(n)&&i.push({type:le.Watched,source:ge.Remote,value:{clientID:n,presence:this.getPresence(n)}});else if(t===M.DocEventType.DOCUMENT_UNWATCHED){const u=this.getPresence(n);this.removeOnlineClient(n),u&&i.push({type:le.Unwatched,source:ge.Remote,value:{clientID:n,presence:u}})}i.length>0&&this.publish(i)}}applyStatus(e){this.status=e,e===Nt.Detached&&this.setActor(yt),this.publish([{source:e===Nt.Removed?ge.Remote:ge.Local,type:le.StatusChanged,value:e===Nt.Attached?{status:e,actorID:this.changeID.getActorID()}:{status:e}}])}applyDocEvent(e){if(e.type===le.StatusChanged){this.applyStatus(e.value.status),e.value.status===Nt.Attached&&this.setActor(e.value.actorID);return}if(e.type===le.Snapshot){const{snapshot:t,serverSeq:n}=e.value;if(!t)return;this.applySnapshot(Ye.fromString(n),Qe.hexToBytes(t));return}if(e.type===le.LocalChange||e.type===le.RemoteChange){if(!e.rawChange)return;const t=Kn.fromStruct(e.rawChange);this.applyChange(t,e.source)}if(e.type===le.Initialized){const t=new Set;for(const{clientID:n,presence:i}of e.value)t.add(n),this.presences.set(n,i);this.setOnlineClients(t);return}if(e.type===le.Watched){const{clientID:t,presence:n}=e.value;this.addOnlineClient(t),this.presences.set(t,n);return}if(e.type===le.Unwatched){const{clientID:t}=e.value;this.removeOnlineClient(t),this.presences.delete(t)}if(e.type===le.PresenceChanged){const{clientID:t,presence:n}=e.value;this.presences.set(t,n)}}applyTransactionEvent(e){for(const t of e)this.applyDocEvent(t)}getValueByPath(e){if(!e.startsWith("$"))throw new Ie(Ne.InvalidArgument,'path must start with "$"');const t=e.split(".");t.shift();let n=this.getRoot();for(const i of t)if(n=n[i],n===void 0)return;return n}setOnlineClients(e){this.onlineClients=e}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if(this.status!==Nt.Attached)return{};const e=this.presences.get(this.changeID.getActorID());return e?qe(e):{}}getPresence(e){if(!this.onlineClients.has(e))return;const t=this.presences.get(e);return t?qe(t):void 0}getPresenceForTest(e){const t=this.presences.get(e);return t?qe(t):void 0}getPresences(){const e=[];for(const t of this.onlineClients)this.presences.has(t)&&e.push({clientID:t,presence:qe(this.presences.get(t))});return e}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){const e=this.getChangeID().getActorID();return this.getPresences().filter(t=>t.clientID!==e).sort((t,n)=>t.clientID>n.clientID?1:-1)}canUndo(){return this.internalHistory.hasUndo()&&!this.isUpdating}canRedo(){return this.internalHistory.hasRedo()&&!this.isUpdating}undo(){if(this.isUpdating)throw new Error("Undo is not allowed during an update");const e=this.internalHistory.popUndo();if(e===void 0)throw new Error("There is no operation to be undone");this.ensureClone();const t=rr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const v of e){if(!(v instanceof Me)){new pt(t,qe(this.clone.presences.get(this.changeID.getActorID()))).set(v.value,{addToHistory:!0});continue}const J=t.issueTimeTicket();v.setExecutedAt(J),t.push(v)}const n=t.getChange();n.execute(this.clone.root,this.clone.presences,ge.UndoRedo);const{opInfos:i,reverseOps:u}=n.execute(this.root,this.presences,ge.UndoRedo),c=t.getReversePresence();if(c&&u.push({type:"presence",value:c}),u.length>0&&this.internalHistory.pushRedo(u),!n.hasPresenceChange()&&i.length===0)return;this.localChanges.push(n),this.changeID=n.getID();const d=this.changeID.getActorID(),E=[];i.length>0&&E.push({type:le.LocalChange,source:ge.UndoRedo,value:{message:n.getMessage()||"",operations:i,actor:d},rawChange:this.isEnableDevtools()?n.toStruct():void 0}),n.hasPresenceChange()&&E.push({type:le.PresenceChanged,source:ge.UndoRedo,value:{clientID:d,presence:this.getPresence(d)}}),this.publish(E)}redo(){if(this.isUpdating)throw new Error("Redo is not allowed during an update");const e=this.internalHistory.popRedo();if(e===void 0)throw new Error("There is no operation to be redone");this.ensureClone();const t=rr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const v of e){if(!(v instanceof Me)){new pt(t,qe(this.clone.presences.get(this.changeID.getActorID()))).set(v.value,{addToHistory:!0});continue}const J=t.issueTimeTicket();v.setExecutedAt(J),t.push(v)}const n=t.getChange();n.execute(this.clone.root,this.clone.presences,ge.UndoRedo);const{opInfos:i,reverseOps:u}=n.execute(this.root,this.presences,ge.UndoRedo),c=t.getReversePresence();if(c&&u.push({type:"presence",value:c}),u.length>0&&this.internalHistory.pushUndo(u),!n.hasPresenceChange()&&i.length===0)return;this.localChanges.push(n),this.changeID=n.getID();const d=this.changeID.getActorID(),E=[];i.length>0&&E.push({type:le.LocalChange,source:ge.UndoRedo,value:{message:n.getMessage()||"",operations:i,actor:d},rawChange:this.isEnableDevtools()?n.toStruct():void 0}),n.hasPresenceChange()&&E.push({type:le.PresenceChanged,source:ge.UndoRedo,value:{clientID:d,presence:this.getPresence(d)}}),this.publish(E)}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}}function yi(r,e){return t=>async n=>(r&&n.header.set("x-api-key",r),e&&n.header.set("authorization",e),await t(n))}const Es=JSON.parse('{"u2":"yorkie-js-sdk","i8":"0.4.18"}');function Ti(){return r=>async e=>(e.header.set("x-yorkie-user-agent",Es.u2+"/"+Es.i8),await r(e))}var Gt;(function(r){r.Manual="manual",r.Realtime="realtime",r.RealtimePushOnly="realtime-pushonly",r.RealtimeSyncOff="realtime-syncoff"})(Gt||(Gt={}));var Jn;(function(r){r.Deactivated="deactivated",r.Activated="activated"})(Jn||(Jn={}));var ir;(function(r){r.Connected="connected",r.Disconnected="disconnected"})(ir||(ir={}));var or;(function(r){r.Synced="synced",r.SyncFailed="sync-failed"})(or||(or={}));var cn;(function(r){r.StatusChanged="status-changed",r.DocumentChanged="document-changed",r.StreamConnectionStatusChanged="stream-connection-status-changed",r.DocumentSynced="document-synced"})(cn||(cn={}));const Rr={syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3};class Ns{constructor(e,t){t=t||Rr,this.key=t.key?t.key:m(),this.status=Jn.Deactivated,this.attachmentMap=new Map,this.apiKey=t.apiKey||"",this.syncLoopDuration=t.syncLoopDuration||Rr.syncLoopDuration,this.reconnectStreamDelay=t.reconnectStreamDelay||Rr.reconnectStreamDelay,this.retrySyncLoopDelay=t.retrySyncLoopDelay||Rr.retrySyncLoopDelay,this.rpcClient=z(nn.V,tn({baseUrl:e,interceptors:[yi(t.apiKey,t.token),Ti()]})),this.eventStream=_(n=>{this.eventStreamObserver=n})}activate(){return this.isActive()?Promise.resolve():this.rpcClient.activateClient({clientKey:this.key},{headers:{"x-shard-key":this.apiKey}}).then(e=>{this.id=e.clientId,this.status=Jn.Activated,this.runSyncLoop(),this.eventStreamObserver.next({type:cn.StatusChanged,value:this.status}),g.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`)}).catch(e=>{throw g.error(`[AC] c:"${this.getKey()}" err :`,e),e})}deactivate(){if(this.status===Jn.Deactivated)return Promise.resolve();for(const[e]of this.attachmentMap)this.detachInternal(e);return this.rpcClient.deactivateClient({clientId:this.id},{headers:{"x-shard-key":this.apiKey}}).then(()=>{this.status=Jn.Deactivated,this.eventStreamObserver.next({type:cn.StatusChanged,value:this.status}),g.info(`[DC] c"${this.getKey()}" deactivated`)}).catch(e=>{throw g.error(`[DC] c:"${this.getKey()}" err :`,e),e})}attach(e,t={}){var n;if(!this.isActive())throw new Ie(Ne.ClientNotActive,`${this.key} is not active`);if(e.getStatus()!==Nt.Detached)throw new Ie(Ne.DocumentNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((u,c)=>c.set(t.initialPresence||{}));const i=(n=t.syncMode)!==null&&n!==void 0?n:Gt.Realtime;return this.rpcClient.attachDocument({clientId:this.id,changePack:Qe.toChangePack(e.createChangePack())},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(async u=>{const c=Qe.fromChangePack(u.changePack);return e.applyChangePack(c),e.getStatus()===Nt.Removed||(e.applyStatus(Nt.Attached),this.attachmentMap.set(e.getKey(),new li(this.reconnectStreamDelay,e,u.documentId,i)),i!==Gt.Manual&&await this.runWatchLoop(e.getKey()),g.info(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`)),e}).catch(u=>{throw g.error(`[AD] c:"${this.getKey()}" err :`,u),u})}detach(e,t={}){var n;if(!this.isActive())throw new Ie(Ne.ClientNotActive,`${this.key} is not active`);const i=this.attachmentMap.get(e.getKey());if(!i)throw new Ie(Ne.DocumentNotAttached,`${e.getKey()} is not attached`);return e.update((u,c)=>c.clear()),this.rpcClient.detachDocument({clientId:this.id,documentId:i.docID,changePack:Qe.toChangePack(e.createChangePack()),removeIfNotAttached:(n=t.removeIfNotAttached)!==null&&n!==void 0?n:!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(u=>{const c=Qe.fromChangePack(u.changePack);return e.applyChangePack(c),e.getStatus()!==Nt.Removed&&e.applyStatus(Nt.Detached),this.detachInternal(e.getKey()),g.info(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}).catch(u=>{throw g.error(`[DD] c:"${this.getKey()}" err :`,u),u})}async changeSyncMode(e,t){if(!this.isActive())throw new Ie(Ne.ClientNotActive,`${this.key} is not active`);const n=this.attachmentMap.get(e.getKey());if(!n)throw new Ie(Ne.DocumentNotAttached,`${e.getKey()} is not attached`);const i=n.syncMode;return i===t?e:(n.changeSyncMode(t),t===Gt.Manual?(n.cancelWatchStream(),e):(t===Gt.Realtime&&(n.remoteChangeEventReceived=!0),i===Gt.Manual&&await this.runWatchLoop(e.getKey()),e))}sync(e){if(!this.isActive())throw new Ie(Ne.ClientNotActive,`${this.key} is not active`);const t=[];if(e){const n=this.attachmentMap.get(e.getKey());if(!n)throw new Ie(Ne.DocumentNotAttached,`${e.getKey()} is not attached`);t.push(this.syncInternal(n,Gt.Realtime))}else this.attachmentMap.forEach(n=>{t.push(this.syncInternal(n,n.syncMode))});return Promise.all(t).catch(n=>{throw this.eventStreamObserver.next({type:cn.DocumentSynced,value:or.SyncFailed}),n})}remove(e){if(!this.isActive())throw new Ie(Ne.ClientNotActive,`${this.key} is not active`);const t=this.attachmentMap.get(e.getKey());if(!t)throw new Ie(Ne.DocumentNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);const n=Qe.toChangePack(e.createChangePack());return n.isRemoved=!0,this.rpcClient.removeDocument({clientId:this.id,documentId:t.docID,changePack:n},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(i=>{const u=Qe.fromChangePack(i.changePack);e.applyChangePack(u),this.detachInternal(e.getKey()),g.info(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}).catch(i=>{throw g.error(`[RD] c:"${this.getKey()}" err :`,i),i})}subscribe(e,t,n){return this.eventStream.subscribe(e,t,n)}getID(){return this.id}getKey(){return this.key}isActive(){return this.status===Jn.Activated}getStatus(){return this.status}runSyncLoop(){const e=()=>{if(!this.isActive()){g.debug(`[SL] c:"${this.getKey()}" exit sync loop`);return}const t=[];for(const[,n]of this.attachmentMap)n.needRealtimeSync()&&(n.remoteChangeEventReceived=!1,t.push(this.syncInternal(n,n.syncMode)));Promise.all(t).then(()=>setTimeout(e,this.syncLoopDuration)).catch(n=>{g.error(`[SL] c:"${this.getKey()}" sync failed:`,n),this.eventStreamObserver.next({type:cn.DocumentSynced,value:or.SyncFailed}),setTimeout(e,this.retrySyncLoopDelay)})};g.debug(`[SL] c:"${this.getKey()}" run sync loop`),e()}async runWatchLoop(e){const t=this.attachmentMap.get(e);if(!t)throw new Ie(Ne.DocumentNotAttached,`${e} is not attached`);return t.runWatchLoop(n=>{if(!this.isActive())return Promise.reject(new Ie(Ne.ClientNotActive,`${this.key} is not active`));const i=new AbortController,u=this.rpcClient.watchDocument({clientId:this.id,documentId:t.docID},{headers:{"x-shard-key":`${this.apiKey}/${e}`},signal:i.signal});return this.eventStreamObserver.next({type:cn.StreamConnectionStatusChanged,value:ir.Connected}),g.info(`[WD] c:"${this.getKey()}" watches d:"${e}"`),new Promise((c,d)=>{(async()=>{try{for await(const v of u)this.handleWatchDocumentsResponse(t,v),v.body.case==="initialization"&&c([u,i])}catch(v){this.eventStreamObserver.next({type:cn.StreamConnectionStatusChanged,value:ir.Disconnected}),g.debug(`[WD] c:"${this.getKey()}" unwatches`),n(),d(v)}})()})})}handleWatchDocumentsResponse(e,t){if(t.body.case==="event"&&t.body.value.type===M.DocEventType.DOCUMENT_CHANGED){e.remoteChangeEventReceived=!0,this.eventStreamObserver.next({type:cn.DocumentChanged,value:[e.doc.getKey()]});return}e.doc.applyWatchStream(t)}detachInternal(e){const t=this.attachmentMap.get(e);!t||(t.cancelWatchStream(),g.debug(`[WD] c:"${this.getKey()}" unwatches`),this.eventStreamObserver.next({type:cn.StreamConnectionStatusChanged,value:ir.Disconnected}),this.attachmentMap.delete(e))}syncInternal(e,t){const{doc:n,docID:i}=e,u=n.createChangePack();return this.rpcClient.pushPullChanges({clientId:this.id,documentId:i,changePack:Qe.toChangePack(u),pushOnly:t===Gt.RealtimePushOnly},{headers:{"x-shard-key":`${this.apiKey}/${n.getKey()}`}}).then(c=>{const d=Qe.fromChangePack(c.changePack);if(d.hasChanges()&&e.syncMode===Gt.RealtimePushOnly)return n;n.applyChangePack(d),this.eventStreamObserver.next({type:cn.DocumentSynced,value:or.Synced}),n.getStatus()===Nt.Removed&&this.detachInternal(n.getKey());const E=n.getKey(),v=d.getChangeSize();return g.info(`[PP] c:"${this.getKey()}" sync d:"${E}", push:${u.getChangeSize()} pull:${v} cp:${d.getCheckpoint().toTestString()}`),n}).catch(c=>{throw g.error(`[PP] c:"${this.getKey()}" err :`,c),c})}}const vi={Client:Ns,Document:ws,Primitive:_e,Text:Ar,Counter:Or,Tree:Pr,IntType:We.IntegerCnt,LongType:We.LongCnt}})(),Ge})())})(Yr);const Ss=bi(Yr.exports),Is=["Ali","Beatriz","Charles","Diya","Eric","Fatima","Gabriel","Hanna","Johnson","Perry","Parker","Kelly"],Si=()=>{const Je=Math.floor(Math.random()*Is.length);return Is[Je]},ks=["red","yellow","orange","green","blue","purple"],Ii=()=>{const Je=Math.floor(Math.random()*ks.length);return ks[Je]};async function ki(){const Je=new Ss.Client("https://api.yorkie.dev",{apiKey:"cedaovjuioqlk4pjqn6g"});await Je.activate();const Dt=new Ss.Document("profile-stack");Dt.subscribe("presence",zt=>{zt.type!==Yr.exports.DocEventType.PresenceChanged&&Ai(Dt.getPresences(),Je.getID())}),await Je.attach(Dt,{initialPresence:{name:Si(),color:Ii()}}),window.addEventListener("beforeunload",()=>{Je.deactivate()})}const Vr=4,jr=(Je,Dt,zt)=>{const Ct=document.createElement("div");return Ct.className="peer",zt==="main"?Ct.innerHTML=`
    <div class="profile">
      <img src="./images/profile-${Dt}.svg" alt="profile" class="profile-img"/>
    </div>
    <div class="name speech-bubbles">${Je}</div>
  `:zt==="more"&&(Ct.innerHTML=`
    <img src="./images/profile-${Dt}.svg" alt="profile" class="profile-img"/>
    <span class="name">${Je}</span>
  `),Ct},Ai=(Je,Dt)=>{const zt=Je.filter(({clientID:l,presence:g})=>l!==Dt&&g.name&&g.color),Ct=zt.length+1,we=Ct>Vr,Ge=document.getElementById("peerList");Ge.innerHTML="";const ce=document.createElement("div");ce.className="peer-more-list speech-bubbles";const A=Je.find(({clientID:l})=>l===Dt).presence,D=jr(`${A.name} (me)`,A.color,"main");if(D.classList.add("me"),Ge.appendChild(D),zt.forEach((l,g)=>{const{name:m,color:x}=l.presence;if(g<Vr-1){const _=jr(m,x,"main");Ge.appendChild(_);return}const b=jr(m,x,"more");ce.appendChild(b)}),we){const l=document.createElement("div");l.className="peer more",l.innerHTML=`
      <div class="profile">
      +${Ct-Vr}
      </div>
    `,l.appendChild(ce),Ge.appendChild(l)}};ki();
