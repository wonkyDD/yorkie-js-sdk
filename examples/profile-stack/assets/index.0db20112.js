(function(){const Ot=document.createElement("link").relList;if(Ot&&Ot.supports&&Ot.supports("modulepreload"))return;for(const Ee of document.querySelectorAll('link[rel="modulepreload"]'))Pt(Ee);new MutationObserver(Ee=>{for(const Xe of Ee)if(Xe.type==="childList")for(const re of Xe.addedNodes)re.tagName==="LINK"&&re.rel==="modulepreload"&&Pt(re)}).observe(document,{childList:!0,subtree:!0});function Xt(Ee){const Xe={};return Ee.integrity&&(Xe.integrity=Ee.integrity),Ee.referrerpolicy&&(Xe.referrerPolicy=Ee.referrerpolicy),Ee.crossorigin==="use-credentials"?Xe.credentials="include":Ee.crossorigin==="anonymous"?Xe.credentials="omit":Xe.credentials="same-origin",Xe}function Pt(Ee){if(Ee.ep)return;Ee.ep=!0;const Xe=Xt(Ee);fetch(Ee.href,Xe)}})();var li=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fi(Je){return Je&&Je.__esModule&&Object.prototype.hasOwnProperty.call(Je,"default")?Je.default:Je}var Ur={exports:{}};/*!
 * 
 * yorkie-js-sdk for building collaborative editing applications.
 *  - Version: v0.4.12
 *  - Date: 2024-01-05T11:06Z
 *  - Homepage: https://yorkie.dev
 *
 * Copyright 2020 The Yorkie Authors. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */(function(Je,Ot){(function(Pt,Ee){Je.exports=Ee()})(li,()=>(()=>{var Xt={646:(re,C,p)=>{Object.defineProperty(C,"__esModule",{value:!0});const{proto3:l,StringValue:D,Timestamp:m}=p(532),x=l.makeEnum("yorkie.v1.ValueType",[{no:0,name:"VALUE_TYPE_NULL",localName:"NULL"},{no:1,name:"VALUE_TYPE_BOOLEAN",localName:"BOOLEAN"},{no:2,name:"VALUE_TYPE_INTEGER",localName:"INTEGER"},{no:3,name:"VALUE_TYPE_LONG",localName:"LONG"},{no:4,name:"VALUE_TYPE_DOUBLE",localName:"DOUBLE"},{no:5,name:"VALUE_TYPE_STRING",localName:"STRING"},{no:6,name:"VALUE_TYPE_BYTES",localName:"BYTES"},{no:7,name:"VALUE_TYPE_DATE",localName:"DATE"},{no:8,name:"VALUE_TYPE_JSON_OBJECT",localName:"JSON_OBJECT"},{no:9,name:"VALUE_TYPE_JSON_ARRAY",localName:"JSON_ARRAY"},{no:10,name:"VALUE_TYPE_TEXT",localName:"TEXT"},{no:11,name:"VALUE_TYPE_INTEGER_CNT",localName:"INTEGER_CNT"},{no:12,name:"VALUE_TYPE_LONG_CNT",localName:"LONG_CNT"},{no:13,name:"VALUE_TYPE_TREE",localName:"TREE"}]),N=l.makeEnum("yorkie.v1.DocEventType",[{no:0,name:"DOC_EVENT_TYPE_DOCUMENT_CHANGED",localName:"DOCUMENT_CHANGED"},{no:1,name:"DOC_EVENT_TYPE_DOCUMENT_WATCHED",localName:"DOCUMENT_WATCHED"},{no:2,name:"DOC_EVENT_TYPE_DOCUMENT_UNWATCHED",localName:"DOCUMENT_UNWATCHED"},{no:3,name:"DOC_EVENT_TYPE_DOCUMENT_BROADCAST",localName:"DOCUMENT_BROADCAST"}]),L=l.makeMessageType("yorkie.v1.Snapshot",()=>[{no:1,name:"root",kind:"message",T:$},{no:2,name:"presences",kind:"map",K:9,V:{kind:"message",T:ht}}]),R=l.makeMessageType("yorkie.v1.ChangePack",()=>[{no:1,name:"document_key",kind:"scalar",T:9},{no:2,name:"checkpoint",kind:"message",T:mt},{no:3,name:"snapshot",kind:"scalar",T:12},{no:4,name:"changes",kind:"message",T:y,repeated:!0},{no:5,name:"min_synced_ticket",kind:"message",T:te},{no:6,name:"is_removed",kind:"scalar",T:8}]),y=l.makeMessageType("yorkie.v1.Change",()=>[{no:1,name:"id",kind:"message",T},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"operations",kind:"message",T:O,repeated:!0},{no:4,name:"presence_change",kind:"message",T:ot}]),T=l.makeMessageType("yorkie.v1.ChangeID",()=>[{no:1,name:"client_seq",kind:"scalar",T:13},{no:2,name:"server_seq",kind:"scalar",T:3,L:1},{no:3,name:"lamport",kind:"scalar",T:3,L:1},{no:4,name:"actor_id",kind:"scalar",T:12}]),O=l.makeMessageType("yorkie.v1.Operation",()=>[{no:1,name:"set",kind:"message",T:I,oneof:"body"},{no:2,name:"add",kind:"message",T:j,oneof:"body"},{no:3,name:"move",kind:"message",T:S,oneof:"body"},{no:4,name:"remove",kind:"message",T:f,oneof:"body"},{no:5,name:"edit",kind:"message",T:U,oneof:"body"},{no:6,name:"select",kind:"message",T:_,oneof:"body"},{no:7,name:"style",kind:"message",T:w,oneof:"body"},{no:8,name:"increase",kind:"message",T:B,oneof:"body"},{no:9,name:"tree_edit",kind:"message",T:V,oneof:"body"},{no:10,name:"tree_style",kind:"message",T:W,oneof:"body"}]),I=l.makeMessageType("yorkie.v1.Operation.Set",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"value",kind:"message",T:P},{no:4,name:"executed_at",kind:"message",T:te}],{localName:"Operation_Set"}),j=l.makeMessageType("yorkie.v1.Operation.Add",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"prev_created_at",kind:"message",T:te},{no:3,name:"value",kind:"message",T:P},{no:4,name:"executed_at",kind:"message",T:te}],{localName:"Operation_Add"}),S=l.makeMessageType("yorkie.v1.Operation.Move",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"prev_created_at",kind:"message",T:te},{no:3,name:"created_at",kind:"message",T:te},{no:4,name:"executed_at",kind:"message",T:te}],{localName:"Operation_Move"}),f=l.makeMessageType("yorkie.v1.Operation.Remove",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"created_at",kind:"message",T:te},{no:3,name:"executed_at",kind:"message",T:te}],{localName:"Operation_Remove"}),U=l.makeMessageType("yorkie.v1.Operation.Edit",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"from",kind:"message",T:qe},{no:3,name:"to",kind:"message",T:qe},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:te}},{no:5,name:"content",kind:"scalar",T:9},{no:6,name:"executed_at",kind:"message",T:te},{no:7,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"Operation_Edit"}),_=l.makeMessageType("yorkie.v1.Operation.Select",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"from",kind:"message",T:qe},{no:3,name:"to",kind:"message",T:qe},{no:4,name:"executed_at",kind:"message",T:te}],{localName:"Operation_Select"}),w=l.makeMessageType("yorkie.v1.Operation.Style",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"from",kind:"message",T:qe},{no:3,name:"to",kind:"message",T:qe},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:te},{no:6,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:te}}],{localName:"Operation_Style"}),B=l.makeMessageType("yorkie.v1.Operation.Increase",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"value",kind:"message",T:P},{no:3,name:"executed_at",kind:"message",T:te}],{localName:"Operation_Increase"}),V=l.makeMessageType("yorkie.v1.Operation.TreeEdit",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"from",kind:"message",T:ft},{no:3,name:"to",kind:"message",T:ft},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:te}},{no:5,name:"contents",kind:"message",T:je,repeated:!0},{no:7,name:"split_level",kind:"scalar",T:5},{no:6,name:"executed_at",kind:"message",T:te}],{localName:"Operation_TreeEdit"}),W=l.makeMessageType("yorkie.v1.Operation.TreeStyle",()=>[{no:1,name:"parent_created_at",kind:"message",T:te},{no:2,name:"from",kind:"message",T:ft},{no:3,name:"to",kind:"message",T:ft},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:te}],{localName:"Operation_TreeStyle"}),P=l.makeMessageType("yorkie.v1.JSONElementSimple",()=>[{no:1,name:"created_at",kind:"message",T:te},{no:2,name:"moved_at",kind:"message",T:te},{no:3,name:"removed_at",kind:"message",T:te},{no:4,name:"type",kind:"enum",T:l.getEnumType(x)},{no:5,name:"value",kind:"scalar",T:12}]),$=l.makeMessageType("yorkie.v1.JSONElement",()=>[{no:1,name:"json_object",kind:"message",T:X,oneof:"body"},{no:2,name:"json_array",kind:"message",T:H,oneof:"body"},{no:3,name:"primitive",kind:"message",T:q,oneof:"body"},{no:5,name:"text",kind:"message",T:ee,oneof:"body"},{no:6,name:"counter",kind:"message",T:Se,oneof:"body"},{no:7,name:"tree",kind:"message",T:G,oneof:"body"}]),X=l.makeMessageType("yorkie.v1.JSONElement.JSONObject",()=>[{no:1,name:"nodes",kind:"message",T:ve,repeated:!0},{no:2,name:"created_at",kind:"message",T:te},{no:3,name:"moved_at",kind:"message",T:te},{no:4,name:"removed_at",kind:"message",T:te}],{localName:"JSONElement_JSONObject"}),H=l.makeMessageType("yorkie.v1.JSONElement.JSONArray",()=>[{no:1,name:"nodes",kind:"message",T:ne,repeated:!0},{no:2,name:"created_at",kind:"message",T:te},{no:3,name:"moved_at",kind:"message",T:te},{no:4,name:"removed_at",kind:"message",T:te}],{localName:"JSONElement_JSONArray"}),q=l.makeMessageType("yorkie.v1.JSONElement.Primitive",()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(x)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:te},{no:4,name:"moved_at",kind:"message",T:te},{no:5,name:"removed_at",kind:"message",T:te}],{localName:"JSONElement_Primitive"}),ee=l.makeMessageType("yorkie.v1.JSONElement.Text",()=>[{no:1,name:"nodes",kind:"message",T:Ie,repeated:!0},{no:2,name:"created_at",kind:"message",T:te},{no:3,name:"moved_at",kind:"message",T:te},{no:4,name:"removed_at",kind:"message",T:te}],{localName:"JSONElement_Text"}),Se=l.makeMessageType("yorkie.v1.JSONElement.Counter",()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(x)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:te},{no:4,name:"moved_at",kind:"message",T:te},{no:5,name:"removed_at",kind:"message",T:te}],{localName:"JSONElement_Counter"}),G=l.makeMessageType("yorkie.v1.JSONElement.Tree",()=>[{no:1,name:"nodes",kind:"message",T:Ce,repeated:!0},{no:2,name:"created_at",kind:"message",T:te},{no:3,name:"moved_at",kind:"message",T:te},{no:4,name:"removed_at",kind:"message",T:te}],{localName:"JSONElement_Tree"}),ve=l.makeMessageType("yorkie.v1.RHTNode",()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"element",kind:"message",T:$}]),ne=l.makeMessageType("yorkie.v1.RGANode",()=>[{no:1,name:"next",kind:"message",T:ne},{no:2,name:"element",kind:"message",T:$}]),ue=l.makeMessageType("yorkie.v1.NodeAttr",()=>[{no:1,name:"value",kind:"scalar",T:9},{no:2,name:"updated_at",kind:"message",T:te}]),Ie=l.makeMessageType("yorkie.v1.TextNode",()=>[{no:1,name:"id",kind:"message",T:we},{no:2,name:"value",kind:"scalar",T:9},{no:3,name:"removed_at",kind:"message",T:te},{no:4,name:"ins_prev_id",kind:"message",T:we},{no:5,name:"attributes",kind:"map",K:9,V:{kind:"message",T:ue}}]),we=l.makeMessageType("yorkie.v1.TextNodeID",()=>[{no:1,name:"created_at",kind:"message",T:te},{no:2,name:"offset",kind:"scalar",T:5}]),Ce=l.makeMessageType("yorkie.v1.TreeNode",()=>[{no:1,name:"id",kind:"message",T:Le},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9},{no:4,name:"removed_at",kind:"message",T:te},{no:5,name:"ins_prev_id",kind:"message",T:Le},{no:6,name:"ins_next_id",kind:"message",T:Le},{no:7,name:"depth",kind:"scalar",T:5},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:ue}}]),je=l.makeMessageType("yorkie.v1.TreeNodes",()=>[{no:1,name:"content",kind:"message",T:Ce,repeated:!0}]),Le=l.makeMessageType("yorkie.v1.TreeNodeID",()=>[{no:1,name:"created_at",kind:"message",T:te},{no:2,name:"offset",kind:"scalar",T:5}]),ft=l.makeMessageType("yorkie.v1.TreePos",()=>[{no:1,name:"parent_id",kind:"message",T:Le},{no:2,name:"left_sibling_id",kind:"message",T:Le}]),dt=l.makeMessageType("yorkie.v1.User",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"created_at",kind:"message",T:m}]),He=l.makeMessageType("yorkie.v1.Project",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"public_key",kind:"scalar",T:9},{no:4,name:"secret_key",kind:"scalar",T:9},{no:5,name:"auth_webhook_url",kind:"scalar",T:9},{no:6,name:"auth_webhook_methods",kind:"scalar",T:9,repeated:!0},{no:7,name:"client_deactivate_threshold",kind:"scalar",T:9},{no:8,name:"created_at",kind:"message",T:m},{no:9,name:"updated_at",kind:"message",T:m}]),le=l.makeMessageType("yorkie.v1.UpdatableProjectFields",()=>[{no:1,name:"name",kind:"message",T:D},{no:2,name:"auth_webhook_url",kind:"message",T:D},{no:3,name:"auth_webhook_methods",kind:"message",T:Dt},{no:4,name:"client_deactivate_threshold",kind:"message",T:D}]),Dt=l.makeMessageType("yorkie.v1.UpdatableProjectFields.AuthWebhookMethods",()=>[{no:1,name:"methods",kind:"scalar",T:9,repeated:!0}],{localName:"UpdatableProjectFields_AuthWebhookMethods"}),Tt=l.makeMessageType("yorkie.v1.DocumentSummary",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"snapshot",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:m},{no:5,name:"accessed_at",kind:"message",T:m},{no:6,name:"updated_at",kind:"message",T:m}]),ot=l.makeMessageType("yorkie.v1.PresenceChange",()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(vt)},{no:2,name:"presence",kind:"message",T:ht}]),vt=l.makeEnum("yorkie.v1.PresenceChange.ChangeType",[{no:0,name:"CHANGE_TYPE_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"CHANGE_TYPE_PUT",localName:"PUT"},{no:2,name:"CHANGE_TYPE_DELETE",localName:"DELETE"},{no:3,name:"CHANGE_TYPE_CLEAR",localName:"CLEAR"}]),ht=l.makeMessageType("yorkie.v1.Presence",()=>[{no:1,name:"data",kind:"map",K:9,V:{kind:"scalar",T:9}}]),mt=l.makeMessageType("yorkie.v1.Checkpoint",()=>[{no:1,name:"server_seq",kind:"scalar",T:3,L:1},{no:2,name:"client_seq",kind:"scalar",T:13}]),qe=l.makeMessageType("yorkie.v1.TextNodePos",()=>[{no:1,name:"created_at",kind:"message",T:te},{no:2,name:"offset",kind:"scalar",T:5},{no:3,name:"relative_offset",kind:"scalar",T:5}]),te=l.makeMessageType("yorkie.v1.TimeTicket",()=>[{no:1,name:"lamport",kind:"scalar",T:3,L:1},{no:2,name:"delimiter",kind:"scalar",T:13},{no:3,name:"actor_id",kind:"scalar",T:12}]),un=l.makeMessageType("yorkie.v1.DocEventBody",()=>[{no:1,name:"topic",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12}]),Ct=l.makeMessageType("yorkie.v1.DocEvent",()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(N)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"body",kind:"message",T:un}]);C.ValueType=x,C.DocEventType=N,C.Snapshot=L,C.ChangePack=R,C.Change=y,C.ChangeID=T,C.Operation=O,C.Operation_Set=I,C.Operation_Add=j,C.Operation_Move=S,C.Operation_Remove=f,C.Operation_Edit=U,C.Operation_Select=_,C.Operation_Style=w,C.Operation_Increase=B,C.Operation_TreeEdit=V,C.Operation_TreeStyle=W,C.JSONElementSimple=P,C.JSONElement=$,C.JSONElement_JSONObject=X,C.JSONElement_JSONArray=H,C.JSONElement_Primitive=q,C.JSONElement_Text=ee,C.JSONElement_Counter=Se,C.JSONElement_Tree=G,C.RHTNode=ve,C.RGANode=ne,C.NodeAttr=ue,C.TextNode=Ie,C.TextNodeID=we,C.TreeNode=Ce,C.TreeNodes=je,C.TreeNodeID=Le,C.TreePos=ft,C.User=dt,C.Project=He,C.UpdatableProjectFields=le,C.UpdatableProjectFields_AuthWebhookMethods=Dt,C.DocumentSummary=Tt,C.PresenceChange=ot,C.PresenceChange_ChangeType=vt,C.Presence=ht,C.Checkpoint=mt,C.TextNodePos=qe,C.TimeTicket=te,C.DocEventBody=un,C.DocEvent=Ct},295:(re,C,p)=>{const{ActivateClientRequest:l,ActivateClientResponse:D,AttachDocumentRequest:m,AttachDocumentResponse:x,BroadcastRequest:N,BroadcastResponse:L,DeactivateClientRequest:R,DeactivateClientResponse:y,DetachDocumentRequest:T,DetachDocumentResponse:O,PushPullChangesRequest:I,PushPullChangesResponse:j,RemoveDocumentRequest:S,RemoveDocumentResponse:f,WatchDocumentRequest:U,WatchDocumentResponse:_}=p(176),{MethodKind:w}=p(532),B={typeName:"yorkie.v1.YorkieService",methods:{activateClient:{name:"ActivateClient",I:l,O:D,kind:w.Unary},deactivateClient:{name:"DeactivateClient",I:R,O:y,kind:w.Unary},attachDocument:{name:"AttachDocument",I:m,O:x,kind:w.Unary},detachDocument:{name:"DetachDocument",I:T,O,kind:w.Unary},removeDocument:{name:"RemoveDocument",I:S,O:f,kind:w.Unary},pushPullChanges:{name:"PushPullChanges",I,O:j,kind:w.Unary},watchDocument:{name:"WatchDocument",I:U,O:_,kind:w.ServerStreaming},broadcast:{name:"Broadcast",I:N,O:L,kind:w.Unary}}};C.V=B},176:(re,C,p)=>{Object.defineProperty(C,"__esModule",{value:!0});const{proto3:l}=p(532),{ChangePack:D,DocEvent:m}=p(646),x=l.makeMessageType("yorkie.v1.ActivateClientRequest",()=>[{no:1,name:"client_key",kind:"scalar",T:9}]),N=l.makeMessageType("yorkie.v1.ActivateClientResponse",()=>[{no:1,name:"client_id",kind:"scalar",T:9}]),L=l.makeMessageType("yorkie.v1.DeactivateClientRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9}]),R=l.makeMessageType("yorkie.v1.DeactivateClientResponse",[]),y=l.makeMessageType("yorkie.v1.AttachDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:D}]),T=l.makeMessageType("yorkie.v1.AttachDocumentResponse",()=>[{no:1,name:"document_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:D}]),O=l.makeMessageType("yorkie.v1.DetachDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:D},{no:4,name:"remove_if_not_attached",kind:"scalar",T:8}]),I=l.makeMessageType("yorkie.v1.DetachDocumentResponse",()=>[{no:2,name:"change_pack",kind:"message",T:D}]),j=l.makeMessageType("yorkie.v1.WatchDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9}]),S=l.makeMessageType("yorkie.v1.WatchDocumentResponse",()=>[{no:1,name:"initialization",kind:"message",T:f,oneof:"body"},{no:2,name:"event",kind:"message",T:m,oneof:"body"}]),f=l.makeMessageType("yorkie.v1.WatchDocumentResponse.Initialization",()=>[{no:1,name:"client_ids",kind:"scalar",T:9,repeated:!0}],{localName:"WatchDocumentResponse_Initialization"}),U=l.makeMessageType("yorkie.v1.RemoveDocumentRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:D}]),_=l.makeMessageType("yorkie.v1.RemoveDocumentResponse",()=>[{no:1,name:"change_pack",kind:"message",T:D}]),w=l.makeMessageType("yorkie.v1.PushPullChangesRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:D},{no:4,name:"push_only",kind:"scalar",T:8}]),B=l.makeMessageType("yorkie.v1.PushPullChangesResponse",()=>[{no:1,name:"change_pack",kind:"message",T:D}]),V=l.makeMessageType("yorkie.v1.BroadcastRequest",()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}]),W=l.makeMessageType("yorkie.v1.BroadcastResponse",[]);C.ActivateClientRequest=x,C.ActivateClientResponse=N,C.DeactivateClientRequest=L,C.DeactivateClientResponse=R,C.AttachDocumentRequest=y,C.AttachDocumentResponse=T,C.DetachDocumentRequest=O,C.DetachDocumentResponse=I,C.WatchDocumentRequest=j,C.WatchDocumentResponse=S,C.WatchDocumentResponse_Initialization=f,C.RemoveDocumentRequest=U,C.RemoveDocumentResponse=_,C.PushPullChangesRequest=w,C.PushPullChangesResponse=B,C.BroadcastRequest=V,C.BroadcastResponse=W},79:(re,C,p)=>{p.d(C,{Lt:()=>N,TD:()=>x,oP:()=>L});var l=p(818),D=p(120),m=p(210),x;(function(R){R[R.Varint=0]="Varint",R[R.Bit64=1]="Bit64",R[R.LengthDelimited=2]="LengthDelimited",R[R.StartGroup=3]="StartGroup",R[R.EndGroup=4]="EndGroup",R[R.Bit32=5]="Bit32"})(x||(x={}));class N{constructor(y){this.stack=[],this.textEncoder=y!=null?y:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let y=0;for(let I=0;I<this.chunks.length;I++)y+=this.chunks[I].length;let T=new Uint8Array(y),O=0;for(let I=0;I<this.chunks.length;I++)T.set(this.chunks[I],O),O+=this.chunks[I].length;return this.chunks=[],T}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let y=this.finish(),T=this.stack.pop();if(!T)throw new Error("invalid state, fork stack empty");return this.chunks=T.chunks,this.buf=T.buf,this.uint32(y.byteLength),this.raw(y)}tag(y,T){return this.uint32((y<<3|T)>>>0)}raw(y){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(y),this}uint32(y){for((0,D.fp)(y);y>127;)this.buf.push(y&127|128),y=y>>>7;return this.buf.push(y),this}int32(y){return(0,D.ug)(y),(0,l.fC)(y,this.buf),this}bool(y){return this.buf.push(y?1:0),this}bytes(y){return this.uint32(y.byteLength),this.raw(y)}string(y){let T=this.textEncoder.encode(y);return this.uint32(T.byteLength),this.raw(T)}float(y){(0,D.E_)(y);let T=new Uint8Array(4);return new DataView(T.buffer).setFloat32(0,y,!0),this.raw(T)}double(y){let T=new Uint8Array(8);return new DataView(T.buffer).setFloat64(0,y,!0),this.raw(T)}fixed32(y){(0,D.fp)(y);let T=new Uint8Array(4);return new DataView(T.buffer).setUint32(0,y,!0),this.raw(T)}sfixed32(y){(0,D.ug)(y);let T=new Uint8Array(4);return new DataView(T.buffer).setInt32(0,y,!0),this.raw(T)}sint32(y){return(0,D.ug)(y),y=(y<<1^y>>31)>>>0,(0,l.fC)(y,this.buf),this}sfixed64(y){let T=new Uint8Array(8),O=new DataView(T.buffer),I=m.q.enc(y);return O.setInt32(0,I.lo,!0),O.setInt32(4,I.hi,!0),this.raw(T)}fixed64(y){let T=new Uint8Array(8),O=new DataView(T.buffer),I=m.q.uEnc(y);return O.setInt32(0,I.lo,!0),O.setInt32(4,I.hi,!0),this.raw(T)}int64(y){let T=m.q.enc(y);return(0,l._y)(T.lo,T.hi,this.buf),this}sint64(y){let T=m.q.enc(y),O=T.hi>>31,I=T.lo<<1^O,j=(T.hi<<1|T.lo>>>31)^O;return(0,l._y)(I,j,this.buf),this}uint64(y){let T=m.q.uEnc(y);return(0,l._y)(T.lo,T.hi,this.buf),this}}class L{constructor(y,T){this.varint64=l.sg,this.uint32=l.jI,this.buf=y,this.len=y.length,this.pos=0,this.view=new DataView(y.buffer,y.byteOffset,y.byteLength),this.textDecoder=T!=null?T:new TextDecoder}tag(){let y=this.uint32(),T=y>>>3,O=y&7;if(T<=0||O<0||O>5)throw new Error("illegal tag: field no "+T+" wire type "+O);return[T,O]}skip(y){let T=this.pos;switch(y){case x.Varint:for(;this.buf[this.pos++]&128;);break;case x.Bit64:this.pos+=4;case x.Bit32:this.pos+=4;break;case x.LengthDelimited:let O=this.uint32();this.pos+=O;break;case x.StartGroup:let I;for(;(I=this.tag()[1])!==x.EndGroup;)this.skip(I);break;default:throw new Error("cant skip wire type "+y)}return this.assertBounds(),this.buf.subarray(T,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let y=this.uint32();return y>>>1^-(y&1)}int64(){return m.q.dec(...this.varint64())}uint64(){return m.q.uDec(...this.varint64())}sint64(){let[y,T]=this.varint64(),O=-(y&1);return y=(y>>>1|(T&1)<<31)^O,T=T>>>1^O,m.q.dec(y,T)}bool(){let[y,T]=this.varint64();return y!==0||T!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return m.q.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return m.q.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let y=this.uint32(),T=this.pos;return this.pos+=y,this.assertBounds(),this.buf.subarray(T,T+y)}string(){return this.textDecoder.decode(this.bytes())}}},465:(re,C,p)=>{p.d(C,{p:()=>D,w:()=>l});var l;(function(m){m[m.DOUBLE=1]="DOUBLE",m[m.FLOAT=2]="FLOAT",m[m.INT64=3]="INT64",m[m.UINT64=4]="UINT64",m[m.INT32=5]="INT32",m[m.FIXED64=6]="FIXED64",m[m.FIXED32=7]="FIXED32",m[m.BOOL=8]="BOOL",m[m.STRING=9]="STRING",m[m.BYTES=12]="BYTES",m[m.UINT32=13]="UINT32",m[m.SFIXED32=15]="SFIXED32",m[m.SFIXED64=16]="SFIXED64",m[m.SINT32=17]="SINT32",m[m.SINT64=18]="SINT64"})(l||(l={}));var D;(function(m){m[m.BIGINT=0]="BIGINT",m[m.STRING=1]="STRING"})(D||(D={}))},733:(re,C,p)=>{p.d(C,{I:()=>m});var l=p(561),D=p(850);class m extends l.v{constructor(N){super(),this.typeUrl="",this.value=new Uint8Array(0),D.w.util.initPartial(N,this)}toJson(N){var L;if(this.typeUrl==="")return{};const R=this.typeUrlToName(this.typeUrl),y=(L=N==null?void 0:N.typeRegistry)===null||L===void 0?void 0:L.findMessage(R);if(!y)throw new Error(`cannot encode message google.protobuf.Any to JSON: "${this.typeUrl}" is not in the type registry`);let O=y.fromBinary(this.value).toJson(N);return(R.startsWith("google.protobuf.")||O===null||Array.isArray(O)||typeof O!="object")&&(O={value:O}),O["@type"]=this.typeUrl,O}fromJson(N,L){var R;if(N===null||Array.isArray(N)||typeof N!="object")throw new Error(`cannot decode message google.protobuf.Any from JSON: expected object but got ${N===null?"null":Array.isArray(N)?"array":typeof N}`);if(Object.keys(N).length==0)return this;const y=N["@type"];if(typeof y!="string"||y=="")throw new Error('cannot decode message google.protobuf.Any from JSON: "@type" is empty');const T=this.typeUrlToName(y),O=(R=L==null?void 0:L.typeRegistry)===null||R===void 0?void 0:R.findMessage(T);if(!O)throw new Error(`cannot decode message google.protobuf.Any from JSON: ${y} is not in the type registry`);let I;if(T.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(N,"value"))I=O.fromJson(N.value,L);else{const j=Object.assign({},N);delete j["@type"],I=O.fromJson(j,L)}return this.packFrom(I),this}packFrom(N){this.value=N.toBinary(),this.typeUrl=this.typeNameToUrl(N.getType().typeName)}unpackTo(N){return this.is(N.getType())?(N.fromBinary(this.value),!0):!1}unpack(N){if(this.typeUrl==="")return;const L=N.findMessage(this.typeUrlToName(this.typeUrl));if(!!L)return L.fromBinary(this.value)}is(N){if(this.typeUrl==="")return!1;const L=this.typeUrlToName(this.typeUrl);let R="";return typeof N=="string"?R=N:R=N.typeName,L===R}typeNameToUrl(N){return`type.googleapis.com/${N}`}typeUrlToName(N){if(!N.length)throw new Error(`invalid type url: ${N}`);const L=N.lastIndexOf("/"),R=L>=0?N.substring(L+1):N;if(!R.length)throw new Error(`invalid type url: ${N}`);return R}static pack(N){const L=new m;return L.packFrom(N),L}static fromBinary(N,L){return new m().fromBinary(N,L)}static fromJson(N,L){return new m().fromJson(N,L)}static fromJsonString(N,L){return new m().fromJsonString(N,L)}static equals(N,L){return D.w.util.equals(m,N,L)}}m.runtime=D.w,m.typeName="google.protobuf.Any",m.fields=D.w.util.newFieldList(()=>[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}])},818:(re,C,p)=>{p.d(C,{Ak:()=>N,CZ:()=>x,Fd:()=>L,_y:()=>D,fC:()=>I,jI:()=>j,sg:()=>l});function l(){let S=0,f=0;for(let _=0;_<28;_+=7){let w=this.buf[this.pos++];if(S|=(w&127)<<_,(w&128)==0)return this.assertBounds(),[S,f]}let U=this.buf[this.pos++];if(S|=(U&15)<<28,f=(U&112)>>4,(U&128)==0)return this.assertBounds(),[S,f];for(let _=3;_<=31;_+=7){let w=this.buf[this.pos++];if(f|=(w&127)<<_,(w&128)==0)return this.assertBounds(),[S,f]}throw new Error("invalid varint")}function D(S,f,U){for(let B=0;B<28;B=B+7){const V=S>>>B,W=!(V>>>7==0&&f==0),P=(W?V|128:V)&255;if(U.push(P),!W)return}const _=S>>>28&15|(f&7)<<4,w=f>>3!=0;if(U.push((w?_|128:_)&255),!!w){for(let B=3;B<31;B=B+7){const V=f>>>B,W=V>>>7!=0,P=(W?V|128:V)&255;if(U.push(P),!W)return}U.push(f>>>31&1)}}const m=4294967296;function x(S){const f=S[0]==="-";f&&(S=S.slice(1));const U=1e6;let _=0,w=0;function B(V,W){const P=Number(S.slice(V,W));w*=U,_=_*U+P,_>=m&&(w=w+(_/m|0),_=_%m)}return B(-24,-18),B(-18,-12),B(-12,-6),B(-6),f?T(_,w):y(_,w)}function N(S,f){let U=y(S,f);const _=U.hi&2147483648;_&&(U=T(U.lo,U.hi));const w=L(U.lo,U.hi);return _?"-"+w:w}function L(S,f){if({lo:S,hi:f}=R(S,f),f<=2097151)return String(m*f+S);const U=S&16777215,_=(S>>>24|f<<8)&16777215,w=f>>16&65535;let B=U+_*6777216+w*6710656,V=_+w*8147497,W=w*2;const P=1e7;return B>=P&&(V+=Math.floor(B/P),B%=P),V>=P&&(W+=Math.floor(V/P),V%=P),W.toString()+O(V)+O(B)}function R(S,f){return{lo:S>>>0,hi:f>>>0}}function y(S,f){return{lo:S|0,hi:f|0}}function T(S,f){return f=~f,S?S=~S+1:f+=1,y(S,f)}const O=S=>{const f=String(S);return"0000000".slice(f.length)+f};function I(S,f){if(S>=0){for(;S>127;)f.push(S&127|128),S=S>>>7;f.push(S)}else{for(let U=0;U<9;U++)f.push(S&127|128),S=S>>7;f.push(1)}}function j(){let S=this.buf[this.pos++],f=S&127;if((S&128)==0)return this.assertBounds(),f;if(S=this.buf[this.pos++],f|=(S&127)<<7,(S&128)==0)return this.assertBounds(),f;if(S=this.buf[this.pos++],f|=(S&127)<<14,(S&128)==0)return this.assertBounds(),f;if(S=this.buf[this.pos++],f|=(S&127)<<21,(S&128)==0)return this.assertBounds(),f;S=this.buf[this.pos++],f|=(S&15)<<28;for(let U=5;(S&128)!==0&&U<10;U++)S=this.buf[this.pos++];if((S&128)!=0)throw new Error("invalid varint");return this.assertBounds(),f>>>0}},532:(re,C,p)=>{p.r(C),p.d(C,{Any:()=>Gn.I,Api:()=>Yt,BinaryReader:()=>V.oP,BinaryWriter:()=>V.Lt,BoolValue:()=>bt,BytesValue:()=>se,CodeGeneratorRequest:()=>kt,CodeGeneratorResponse:()=>Ge,CodeGeneratorResponse_Feature:()=>pn,CodeGeneratorResponse_File:()=>yt,DescriptorProto:()=>we,DescriptorProto_ExtensionRange:()=>Ce,DescriptorProto_ReservedRange:()=>je,DoubleValue:()=>Nt,Duration:()=>Pe,Edition:()=>ne,Empty:()=>sn,Enum:()=>be,EnumDescriptorProto:()=>ot,EnumDescriptorProto_EnumReservedRange:()=>vt,EnumOptions:()=>Ze,EnumValue:()=>qt,EnumValueDescriptorProto:()=>ht,EnumValueOptions:()=>Qt,ExtensionRangeOptions:()=>Le,ExtensionRangeOptions_Declaration:()=>dt,ExtensionRangeOptions_VerificationState:()=>ft,FeatureSet:()=>Re,FeatureSetDefaults:()=>F,FeatureSetDefaults_FeatureSetEditionDefault:()=>Fe,FeatureSet_EnumType:()=>_n,FeatureSet_FieldPresence:()=>Sn,FeatureSet_JsonFormat:()=>Bn,FeatureSet_MessageEncoding:()=>Ln,FeatureSet_RepeatedFieldEncoding:()=>Et,FeatureSet_Utf8Validation:()=>xn,Field:()=>At,FieldDescriptorProto:()=>He,FieldDescriptorProto_Label:()=>Dt,FieldDescriptorProto_Type:()=>le,FieldMask:()=>on,FieldOptions:()=>Ht,FieldOptions_CType:()=>Nn,FieldOptions_EditionDefault:()=>wt,FieldOptions_JSType:()=>fn,FieldOptions_OptionRetention:()=>bn,FieldOptions_OptionTargetType:()=>Rn,Field_Cardinality:()=>On,Field_Kind:()=>An,FileDescriptorProto:()=>Ie,FileDescriptorSet:()=>ue,FileOptions:()=>te,FileOptions_OptimizeMode:()=>un,FloatValue:()=>pt,GeneratedCodeInfo:()=>Jt,GeneratedCodeInfo_Annotation:()=>Ft,GeneratedCodeInfo_Annotation_Semantic:()=>In,Int32Value:()=>_e,Int64Value:()=>rt,ListValue:()=>ct,LongType:()=>m.p,Message:()=>G.v,MessageOptions:()=>Ct,Method:()=>Mt,MethodDescriptorProto:()=>qe,MethodIdempotency:()=>ve.w,MethodKind:()=>ve.t,MethodOptions:()=>tn,MethodOptions_IdempotencyLevel:()=>nn,Mixin:()=>Kt,NullValue:()=>ut,OneofDescriptorProto:()=>Tt,OneofOptions:()=>Zt,Option:()=>nt,ScalarType:()=>m.w,ServiceDescriptorProto:()=>mt,ServiceOptions:()=>en,SourceCodeInfo:()=>ye,SourceCodeInfo_Location:()=>Ae,SourceContext:()=>Lt,StringValue:()=>st,Struct:()=>gt,Syntax:()=>Bt,Timestamp:()=>xt,Type:()=>tt,UInt32Value:()=>Me,UInt64Value:()=>Oe,UninterpretedOption:()=>Ye,UninterpretedOption_NamePart:()=>Rt,Value:()=>Be,Version:()=>It,WireType:()=>V.TD,codegenInfo:()=>Se,createDescriptorSet:()=>ir,createRegistry:()=>pr,createRegistryFromDescriptors:()=>Jn,proto2:()=>f,proto3:()=>l.w,protoBase64:()=>B.W,protoDelimited:()=>X,protoDouble:()=>_,protoInt64:()=>w.q,toPlainMessage:()=>Xn});var l=p(850),D=p(493),m=p(465),x=p(744);function N(){return Object.assign(Object.assign({},(0,x.gY)()),{writeMessage(a,r,o){const h=a.getType();let g;try{for(g of h.fields.byNumber()){let E,b=g.repeated,M=g.localName;if(g.oneof){const A=a[g.oneof.localName];if(A.case!==M)continue;E=A.value}else if(E=a[M],E===void 0&&!g.oneof&&!g.opt)throw new Error(`cannot encode field ${h.typeName}.${g.name} to binary: required field not set`);switch(g.kind){case"scalar":case"enum":let A=g.kind=="enum"?m.w.INT32:g.T;if(b)if(g.packed)(0,x.Jj)(r,A,g.no,E);else for(const K of E)(0,x.NN)(r,A,g.no,K,!0);else E!==void 0&&(0,x.NN)(r,A,g.no,E,!0);break;case"message":if(b)for(const K of E)(0,x.oQ)(r,o,g,K);else(0,x.oQ)(r,o,g,E);break;case"map":for(const[K,Z]of Object.entries(E))(0,x.gQ)(r,o,g,K,Z);break}}}catch(E){let b=g?`cannot encode field ${h.typeName}.${g==null?void 0:g.name} to binary`:`cannot encode message ${h.typeName} to binary`,M=E instanceof Error?E.message:String(E);throw new Error(b+(M.length>0?`: ${M}`:""))}return o.writeUnknownFields&&this.writeUnknownFields(a,r),r}})}var L=p(433),R=p(501),y=p(215),T=p(504),O=p(432),I=p(120),j=p(814);function S(){return(0,j.b)((a,r)=>function(h,g,E){if(h.kind=="map"){const b={};switch(h.V.kind){case"scalar":for(const[A,K]of Object.entries(g)){const Z=r(h.V.T,K,!0);(0,I.hu)(Z!==void 0),b[A.toString()]=Z}break;case"message":for(const[A,K]of Object.entries(g))b[A.toString()]=K.toJson(E);break;case"enum":const M=h.V.T;for(const[A,K]of Object.entries(g)){(0,I.hu)(K===void 0||typeof K=="number");const Z=a(M,K,!0,E.enumAsInteger);(0,I.hu)(Z!==void 0),b[A.toString()]=Z}break}return E.emitDefaultValues||Object.keys(b).length>0?b:void 0}else if(h.repeated){const b=[];switch(h.kind){case"scalar":for(let M=0;M<g.length;M++)b.push(r(h.T,g[M],!0));break;case"enum":for(let M=0;M<g.length;M++)b.push(a(h.T,g[M],!0,E.enumAsInteger));break;case"message":for(let M=0;M<g.length;M++)b.push(g[M].toJson(E));break}return E.emitDefaultValues||b.length>0?b:void 0}else{if(g===void 0){if(!h.oneof&&!h.opt)throw"required field not set";return}switch(h.kind){case"scalar":return r(h.T,g,!0);case"enum":return a(h.T,g,!0,E.enumAsInteger);case"message":return(0,O.E)(h.T,g).toJson(E)}}})}const f=(0,D.F)("proto2",S(),N(),Object.assign(Object.assign({},(0,L.f)()),{newFieldList(a){return new R.i(a,U)},initFields(a){for(const r of a.getType().fields.byMember()){const o=r.localName,h=a;if(r.repeated){h[o]=[];continue}switch(r.kind){case"oneof":h[o]={case:void 0};break;case"map":h[o]={};break}}}}));function U(a){var r,o,h,g,E;const b=[];let M;for(const A of typeof a=="function"?a():a){const K=A;if(K.localName=(0,T.Rz)(A.name,A.oneof!==void 0),K.jsonName=(r=A.jsonName)!==null&&r!==void 0?r:(0,T.x1)(A.name),K.repeated=(o=A.repeated)!==null&&o!==void 0?o:!1,A.kind=="scalar"&&(K.L=(h=A.L)!==null&&h!==void 0?h:m.p.BIGINT),A.oneof!==void 0){const Z=typeof A.oneof=="string"?A.oneof:A.oneof.name;(!M||M.name!=Z)&&(M=new y.o(Z)),K.oneof=M,M.addField(K)}A.kind=="message"&&(K.delimited=(g=A.delimited)!==null&&g!==void 0?g:!1),K.packed=(E=A.packed)!==null&&E!==void 0?E:!1,b.push(K)}return b}const _={NaN:Number.NaN,POSITIVE_INFINITY:Number.POSITIVE_INFINITY,NEGATIVE_INFINITY:Number.NEGATIVE_INFINITY};var w=p(210),B=p(236),V=p(79),W=function(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],o;return r?r.call(a):(a=typeof __values=="function"?__values(a):a[Symbol.iterator](),o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o);function h(E){o[E]=a[E]&&function(b){return new Promise(function(M,A){b=a[E](b),g(M,A,b.done,b.value)})}}function g(E,b,M,A){Promise.resolve(A).then(function(K){E({value:K,done:M})},b)}},P=function(a){return this instanceof P?(this.v=a,this):new P(a)},$=function(a,r,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=o.apply(a,r||[]),g,E=[];return g={},M("next"),M("throw"),M("return",b),g[Symbol.asyncIterator]=function(){return this},g;function b(fe){return function(it){return Promise.resolve(it).then(fe,ce)}}function M(fe,it){h[fe]&&(g[fe]=function(Wt){return new Promise(function(Pr,Un){E.push([fe,Wt,Pr,Un])>1||A(fe,Wt)})},it&&(g[fe]=it(g[fe])))}function A(fe,it){try{K(h[fe](it))}catch(Wt){De(E[0][3],Wt)}}function K(fe){fe.value instanceof P?Promise.resolve(fe.value.v).then(Z,ce):De(E[0][2],fe)}function Z(fe){A("next",fe)}function ce(fe){A("throw",fe)}function De(fe,it){fe(it),E.shift(),E.length&&A(E[0][0],E[0][1])}};const X={enc(a,r){const o=(0,x.gY)().makeWriteOptions(r);return o.writerFactory().bytes(a.toBinary(o)).finish()},dec(a,r,o){const h=(0,x.gY)().makeReadOptions(o);return a.fromBinary(h.readerFactory(r).bytes(),h)},decStream(a,r){return $(this,arguments,function*(){var h,g,E,b;function M(De,fe){const it=new Uint8Array(De.byteLength+fe.byteLength);return it.set(De),it.set(fe,De.length),it}let A=new Uint8Array(0);try{for(var K=!0,Z=W(r),ce;ce=yield P(Z.next()),h=ce.done,!h;K=!0)for(b=ce.value,K=!1,A=M(A,b);;){const fe=X.peekSize(A);if(fe.eof||fe.offset+fe.size>A.byteLength)break;yield yield P(X.dec(a,A)),A=A.subarray(fe.offset+fe.size)}}catch(De){g={error:De}}finally{try{!K&&!h&&(E=Z.return)&&(yield P(E.call(Z)))}finally{if(g)throw g.error}}if(A.byteLength>0)throw new Error("incomplete data")})},peekSize(a){const r={eof:!0,size:null,offset:null};for(let o=0;o<10;o++){if(o>a.byteLength)return r;if((a[o]&128)==0){const h=new V.oP(a);let g;try{g=h.uint32()}catch(E){if(E instanceof RangeError)return r;throw E}return{eof:!1,size:g,offset:h.pos}}}throw new Error("invalid varint")}};var H=p(781);function q(a){switch(a.typeName){case"google.protobuf.Any":{const r=a.fields.find(h=>h.number==1&&h.fieldKind=="scalar"&&h.scalar===m.w.STRING),o=a.fields.find(h=>h.number==2&&h.fieldKind=="scalar"&&h.scalar===m.w.BYTES);if(r&&o)return{typeName:a.typeName,typeUrl:r,value:o};break}case"google.protobuf.Timestamp":{const r=a.fields.find(h=>h.number==1&&h.fieldKind=="scalar"&&h.scalar===m.w.INT64),o=a.fields.find(h=>h.number==2&&h.fieldKind=="scalar"&&h.scalar===m.w.INT32);if(r&&o)return{typeName:a.typeName,seconds:r,nanos:o};break}case"google.protobuf.Duration":{const r=a.fields.find(h=>h.number==1&&h.fieldKind=="scalar"&&h.scalar===m.w.INT64),o=a.fields.find(h=>h.number==2&&h.fieldKind=="scalar"&&h.scalar===m.w.INT32);if(r&&o)return{typeName:a.typeName,seconds:r,nanos:o};break}case"google.protobuf.Struct":{const r=a.fields.find(o=>o.number==1&&!o.repeated);if((r==null?void 0:r.fieldKind)!=="map"||r.mapValue.kind!=="message"||r.mapValue.message.typeName!=="google.protobuf.Value")break;return{typeName:a.typeName,fields:r}}case"google.protobuf.Value":{const r=a.oneofs.find(A=>A.name==="kind"),o=a.fields.find(A=>A.number==1&&A.oneof===r);if((o==null?void 0:o.fieldKind)!=="enum"||o.enum.typeName!=="google.protobuf.NullValue")return;const h=a.fields.find(A=>A.number==2&&A.fieldKind=="scalar"&&A.scalar===m.w.DOUBLE&&A.oneof===r),g=a.fields.find(A=>A.number==3&&A.fieldKind=="scalar"&&A.scalar===m.w.STRING&&A.oneof===r),E=a.fields.find(A=>A.number==4&&A.fieldKind=="scalar"&&A.scalar===m.w.BOOL&&A.oneof===r),b=a.fields.find(A=>A.number==5&&A.oneof===r);if((b==null?void 0:b.fieldKind)!=="message"||b.message.typeName!=="google.protobuf.Struct")return;const M=a.fields.find(A=>A.number==6&&A.oneof===r);if((M==null?void 0:M.fieldKind)!=="message"||M.message.typeName!=="google.protobuf.ListValue")return;if(r&&h&&g&&E)return{typeName:a.typeName,kind:r,nullValue:o,numberValue:h,stringValue:g,boolValue:E,structValue:b,listValue:M};break}case"google.protobuf.ListValue":{const r=a.fields.find(o=>o.number==1&&o.repeated);if((r==null?void 0:r.fieldKind)!="message"||r.message.typeName!=="google.protobuf.Value")break;return{typeName:a.typeName,values:r}}case"google.protobuf.FieldMask":{const r=a.fields.find(o=>o.number==1&&o.fieldKind=="scalar"&&o.scalar===m.w.STRING&&o.repeated);if(r)return{typeName:a.typeName,paths:r};break}case"google.protobuf.DoubleValue":case"google.protobuf.FloatValue":case"google.protobuf.Int64Value":case"google.protobuf.UInt64Value":case"google.protobuf.Int32Value":case"google.protobuf.UInt32Value":case"google.protobuf.BoolValue":case"google.protobuf.StringValue":case"google.protobuf.BytesValue":{const r=a.fields.find(o=>o.number==1&&o.name=="value");if(!r||r.fieldKind!=="scalar")break;return{typeName:a.typeName,value:r}}}}const ee="@bufbuild/protobuf",Se={packageName:"@bufbuild/protobuf",localName:T.r1,reifyWkt:q,getUnwrappedFieldType:O.w,scalarDefaultValue:H.kY,safeIdentifier:T.GD,safeObjectProperty:T.ll,symbols:{proto2:{typeOnly:!1,privateImportPath:"./proto2.js",publicImportPath:ee},proto3:{typeOnly:!1,privateImportPath:"./proto3.js",publicImportPath:ee},Message:{typeOnly:!1,privateImportPath:"./message.js",publicImportPath:ee},PartialMessage:{typeOnly:!0,privateImportPath:"./message.js",publicImportPath:ee},PlainMessage:{typeOnly:!0,privateImportPath:"./message.js",publicImportPath:ee},FieldList:{typeOnly:!0,privateImportPath:"./field-list.js",publicImportPath:ee},MessageType:{typeOnly:!0,privateImportPath:"./message-type.js",publicImportPath:ee},BinaryReadOptions:{typeOnly:!0,privateImportPath:"./binary-format.js",publicImportPath:ee},BinaryWriteOptions:{typeOnly:!0,privateImportPath:"./binary-format.js",publicImportPath:ee},JsonReadOptions:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:ee},JsonWriteOptions:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:ee},JsonValue:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:ee},JsonObject:{typeOnly:!0,privateImportPath:"./json-format.js",publicImportPath:ee},protoDouble:{typeOnly:!1,privateImportPath:"./proto-double.js",publicImportPath:ee},protoInt64:{typeOnly:!1,privateImportPath:"./proto-int64.js",publicImportPath:ee},ScalarType:{typeOnly:!1,privateImportPath:"./field.js",publicImportPath:ee},LongType:{typeOnly:!1,privateImportPath:"./field.js",publicImportPath:ee},MethodKind:{typeOnly:!1,privateImportPath:"./service-type.js",publicImportPath:ee},MethodIdempotency:{typeOnly:!1,privateImportPath:"./service-type.js",publicImportPath:ee},IMessageTypeRegistry:{typeOnly:!0,privateImportPath:"./type-registry.js",publicImportPath:ee}},wktSourceFiles:["google/protobuf/compiler/plugin.proto","google/protobuf/any.proto","google/protobuf/api.proto","google/protobuf/descriptor.proto","google/protobuf/duration.proto","google/protobuf/empty.proto","google/protobuf/field_mask.proto","google/protobuf/source_context.proto","google/protobuf/struct.proto","google/protobuf/timestamp.proto","google/protobuf/type.proto","google/protobuf/wrappers.proto"]};var G=p(561),ve=p(328),ne;(function(a){a[a.EDITION_UNKNOWN=0]="EDITION_UNKNOWN",a[a.EDITION_PROTO2=998]="EDITION_PROTO2",a[a.EDITION_PROTO3=999]="EDITION_PROTO3",a[a.EDITION_2023=1e3]="EDITION_2023",a[a.EDITION_1_TEST_ONLY=1]="EDITION_1_TEST_ONLY",a[a.EDITION_2_TEST_ONLY=2]="EDITION_2_TEST_ONLY",a[a.EDITION_99997_TEST_ONLY=99997]="EDITION_99997_TEST_ONLY",a[a.EDITION_99998_TEST_ONLY=99998]="EDITION_99998_TEST_ONLY",a[a.EDITION_99999_TEST_ONLY=99999]="EDITION_99999_TEST_ONLY"})(ne||(ne={})),f.util.setEnumType(ne,"google.protobuf.Edition",[{no:0,name:"EDITION_UNKNOWN"},{no:998,name:"EDITION_PROTO2"},{no:999,name:"EDITION_PROTO3"},{no:1e3,name:"EDITION_2023"},{no:1,name:"EDITION_1_TEST_ONLY"},{no:2,name:"EDITION_2_TEST_ONLY"},{no:99997,name:"EDITION_99997_TEST_ONLY"},{no:99998,name:"EDITION_99998_TEST_ONLY"},{no:99999,name:"EDITION_99999_TEST_ONLY"}]);class ue extends G.v{constructor(r){super(),this.file=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new ue().fromBinary(r,o)}static fromJson(r,o){return new ue().fromJson(r,o)}static fromJsonString(r,o){return new ue().fromJsonString(r,o)}static equals(r,o){return f.util.equals(ue,r,o)}}ue.runtime=f,ue.typeName="google.protobuf.FileDescriptorSet",ue.fields=f.util.newFieldList(()=>[{no:1,name:"file",kind:"message",T:Ie,repeated:!0}]);class Ie extends G.v{constructor(r){super(),this.dependency=[],this.publicDependency=[],this.weakDependency=[],this.messageType=[],this.enumType=[],this.service=[],this.extension=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Ie().fromBinary(r,o)}static fromJson(r,o){return new Ie().fromJson(r,o)}static fromJsonString(r,o){return new Ie().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ie,r,o)}}Ie.runtime=f,Ie.typeName="google.protobuf.FileDescriptorProto",Ie.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"package",kind:"scalar",T:9,opt:!0},{no:3,name:"dependency",kind:"scalar",T:9,repeated:!0},{no:10,name:"public_dependency",kind:"scalar",T:5,repeated:!0},{no:11,name:"weak_dependency",kind:"scalar",T:5,repeated:!0},{no:4,name:"message_type",kind:"message",T:we,repeated:!0},{no:5,name:"enum_type",kind:"message",T:ot,repeated:!0},{no:6,name:"service",kind:"message",T:mt,repeated:!0},{no:7,name:"extension",kind:"message",T:He,repeated:!0},{no:8,name:"options",kind:"message",T:te,opt:!0},{no:9,name:"source_code_info",kind:"message",T:ye,opt:!0},{no:12,name:"syntax",kind:"scalar",T:9,opt:!0},{no:14,name:"edition",kind:"enum",T:f.getEnumType(ne),opt:!0}]);class we extends G.v{constructor(r){super(),this.field=[],this.extension=[],this.nestedType=[],this.enumType=[],this.extensionRange=[],this.oneofDecl=[],this.reservedRange=[],this.reservedName=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new we().fromBinary(r,o)}static fromJson(r,o){return new we().fromJson(r,o)}static fromJsonString(r,o){return new we().fromJsonString(r,o)}static equals(r,o){return f.util.equals(we,r,o)}}we.runtime=f,we.typeName="google.protobuf.DescriptorProto",we.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"field",kind:"message",T:He,repeated:!0},{no:6,name:"extension",kind:"message",T:He,repeated:!0},{no:3,name:"nested_type",kind:"message",T:we,repeated:!0},{no:4,name:"enum_type",kind:"message",T:ot,repeated:!0},{no:5,name:"extension_range",kind:"message",T:Ce,repeated:!0},{no:8,name:"oneof_decl",kind:"message",T:Tt,repeated:!0},{no:7,name:"options",kind:"message",T:Ct,opt:!0},{no:9,name:"reserved_range",kind:"message",T:je,repeated:!0},{no:10,name:"reserved_name",kind:"scalar",T:9,repeated:!0}]);class Ce extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new Ce().fromBinary(r,o)}static fromJson(r,o){return new Ce().fromJson(r,o)}static fromJsonString(r,o){return new Ce().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ce,r,o)}}Ce.runtime=f,Ce.typeName="google.protobuf.DescriptorProto.ExtensionRange",Ce.fields=f.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0},{no:3,name:"options",kind:"message",T:Le,opt:!0}]);class je extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new je().fromBinary(r,o)}static fromJson(r,o){return new je().fromJson(r,o)}static fromJsonString(r,o){return new je().fromJsonString(r,o)}static equals(r,o){return f.util.equals(je,r,o)}}je.runtime=f,je.typeName="google.protobuf.DescriptorProto.ReservedRange",je.fields=f.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0}]);class Le extends G.v{constructor(r){super(),this.uninterpretedOption=[],this.declaration=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Le().fromBinary(r,o)}static fromJson(r,o){return new Le().fromJson(r,o)}static fromJsonString(r,o){return new Le().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Le,r,o)}}Le.runtime=f,Le.typeName="google.protobuf.ExtensionRangeOptions",Le.fields=f.util.newFieldList(()=>[{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0},{no:2,name:"declaration",kind:"message",T:dt,repeated:!0},{no:50,name:"features",kind:"message",T:Re,opt:!0},{no:3,name:"verification",kind:"enum",T:f.getEnumType(ft),opt:!0,default:ft.UNVERIFIED}]);var ft;(function(a){a[a.DECLARATION=0]="DECLARATION",a[a.UNVERIFIED=1]="UNVERIFIED"})(ft||(ft={})),f.util.setEnumType(ft,"google.protobuf.ExtensionRangeOptions.VerificationState",[{no:0,name:"DECLARATION"},{no:1,name:"UNVERIFIED"}]);class dt extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new dt().fromBinary(r,o)}static fromJson(r,o){return new dt().fromJson(r,o)}static fromJsonString(r,o){return new dt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(dt,r,o)}}dt.runtime=f,dt.typeName="google.protobuf.ExtensionRangeOptions.Declaration",dt.fields=f.util.newFieldList(()=>[{no:1,name:"number",kind:"scalar",T:5,opt:!0},{no:2,name:"full_name",kind:"scalar",T:9,opt:!0},{no:3,name:"type",kind:"scalar",T:9,opt:!0},{no:5,name:"reserved",kind:"scalar",T:8,opt:!0},{no:6,name:"repeated",kind:"scalar",T:8,opt:!0}]);class He extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new He().fromBinary(r,o)}static fromJson(r,o){return new He().fromJson(r,o)}static fromJsonString(r,o){return new He().fromJsonString(r,o)}static equals(r,o){return f.util.equals(He,r,o)}}He.runtime=f,He.typeName="google.protobuf.FieldDescriptorProto",He.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:3,name:"number",kind:"scalar",T:5,opt:!0},{no:4,name:"label",kind:"enum",T:f.getEnumType(Dt),opt:!0},{no:5,name:"type",kind:"enum",T:f.getEnumType(le),opt:!0},{no:6,name:"type_name",kind:"scalar",T:9,opt:!0},{no:2,name:"extendee",kind:"scalar",T:9,opt:!0},{no:7,name:"default_value",kind:"scalar",T:9,opt:!0},{no:9,name:"oneof_index",kind:"scalar",T:5,opt:!0},{no:10,name:"json_name",kind:"scalar",T:9,opt:!0},{no:8,name:"options",kind:"message",T:Ht,opt:!0},{no:17,name:"proto3_optional",kind:"scalar",T:8,opt:!0}]);var le;(function(a){a[a.DOUBLE=1]="DOUBLE",a[a.FLOAT=2]="FLOAT",a[a.INT64=3]="INT64",a[a.UINT64=4]="UINT64",a[a.INT32=5]="INT32",a[a.FIXED64=6]="FIXED64",a[a.FIXED32=7]="FIXED32",a[a.BOOL=8]="BOOL",a[a.STRING=9]="STRING",a[a.GROUP=10]="GROUP",a[a.MESSAGE=11]="MESSAGE",a[a.BYTES=12]="BYTES",a[a.UINT32=13]="UINT32",a[a.ENUM=14]="ENUM",a[a.SFIXED32=15]="SFIXED32",a[a.SFIXED64=16]="SFIXED64",a[a.SINT32=17]="SINT32",a[a.SINT64=18]="SINT64"})(le||(le={})),f.util.setEnumType(le,"google.protobuf.FieldDescriptorProto.Type",[{no:1,name:"TYPE_DOUBLE"},{no:2,name:"TYPE_FLOAT"},{no:3,name:"TYPE_INT64"},{no:4,name:"TYPE_UINT64"},{no:5,name:"TYPE_INT32"},{no:6,name:"TYPE_FIXED64"},{no:7,name:"TYPE_FIXED32"},{no:8,name:"TYPE_BOOL"},{no:9,name:"TYPE_STRING"},{no:10,name:"TYPE_GROUP"},{no:11,name:"TYPE_MESSAGE"},{no:12,name:"TYPE_BYTES"},{no:13,name:"TYPE_UINT32"},{no:14,name:"TYPE_ENUM"},{no:15,name:"TYPE_SFIXED32"},{no:16,name:"TYPE_SFIXED64"},{no:17,name:"TYPE_SINT32"},{no:18,name:"TYPE_SINT64"}]);var Dt;(function(a){a[a.OPTIONAL=1]="OPTIONAL",a[a.REPEATED=3]="REPEATED",a[a.REQUIRED=2]="REQUIRED"})(Dt||(Dt={})),f.util.setEnumType(Dt,"google.protobuf.FieldDescriptorProto.Label",[{no:1,name:"LABEL_OPTIONAL"},{no:3,name:"LABEL_REPEATED"},{no:2,name:"LABEL_REQUIRED"}]);class Tt extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new Tt().fromBinary(r,o)}static fromJson(r,o){return new Tt().fromJson(r,o)}static fromJsonString(r,o){return new Tt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Tt,r,o)}}Tt.runtime=f,Tt.typeName="google.protobuf.OneofDescriptorProto",Tt.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"options",kind:"message",T:Zt,opt:!0}]);class ot extends G.v{constructor(r){super(),this.value=[],this.reservedRange=[],this.reservedName=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new ot().fromBinary(r,o)}static fromJson(r,o){return new ot().fromJson(r,o)}static fromJsonString(r,o){return new ot().fromJsonString(r,o)}static equals(r,o){return f.util.equals(ot,r,o)}}ot.runtime=f,ot.typeName="google.protobuf.EnumDescriptorProto",ot.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"value",kind:"message",T:ht,repeated:!0},{no:3,name:"options",kind:"message",T:Ze,opt:!0},{no:4,name:"reserved_range",kind:"message",T:vt,repeated:!0},{no:5,name:"reserved_name",kind:"scalar",T:9,repeated:!0}]);class vt extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new vt().fromBinary(r,o)}static fromJson(r,o){return new vt().fromJson(r,o)}static fromJsonString(r,o){return new vt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(vt,r,o)}}vt.runtime=f,vt.typeName="google.protobuf.EnumDescriptorProto.EnumReservedRange",vt.fields=f.util.newFieldList(()=>[{no:1,name:"start",kind:"scalar",T:5,opt:!0},{no:2,name:"end",kind:"scalar",T:5,opt:!0}]);class ht extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new ht().fromBinary(r,o)}static fromJson(r,o){return new ht().fromJson(r,o)}static fromJsonString(r,o){return new ht().fromJsonString(r,o)}static equals(r,o){return f.util.equals(ht,r,o)}}ht.runtime=f,ht.typeName="google.protobuf.EnumValueDescriptorProto",ht.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"number",kind:"scalar",T:5,opt:!0},{no:3,name:"options",kind:"message",T:Qt,opt:!0}]);class mt extends G.v{constructor(r){super(),this.method=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new mt().fromBinary(r,o)}static fromJson(r,o){return new mt().fromJson(r,o)}static fromJsonString(r,o){return new mt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(mt,r,o)}}mt.runtime=f,mt.typeName="google.protobuf.ServiceDescriptorProto",mt.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"method",kind:"message",T:qe,repeated:!0},{no:3,name:"options",kind:"message",T:en,opt:!0}]);class qe extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new qe().fromBinary(r,o)}static fromJson(r,o){return new qe().fromJson(r,o)}static fromJsonString(r,o){return new qe().fromJsonString(r,o)}static equals(r,o){return f.util.equals(qe,r,o)}}qe.runtime=f,qe.typeName="google.protobuf.MethodDescriptorProto",qe.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"input_type",kind:"scalar",T:9,opt:!0},{no:3,name:"output_type",kind:"scalar",T:9,opt:!0},{no:4,name:"options",kind:"message",T:tn,opt:!0},{no:5,name:"client_streaming",kind:"scalar",T:8,opt:!0,default:!1},{no:6,name:"server_streaming",kind:"scalar",T:8,opt:!0,default:!1}]);class te extends G.v{constructor(r){super(),this.uninterpretedOption=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new te().fromBinary(r,o)}static fromJson(r,o){return new te().fromJson(r,o)}static fromJsonString(r,o){return new te().fromJsonString(r,o)}static equals(r,o){return f.util.equals(te,r,o)}}te.runtime=f,te.typeName="google.protobuf.FileOptions",te.fields=f.util.newFieldList(()=>[{no:1,name:"java_package",kind:"scalar",T:9,opt:!0},{no:8,name:"java_outer_classname",kind:"scalar",T:9,opt:!0},{no:10,name:"java_multiple_files",kind:"scalar",T:8,opt:!0,default:!1},{no:20,name:"java_generate_equals_and_hash",kind:"scalar",T:8,opt:!0},{no:27,name:"java_string_check_utf8",kind:"scalar",T:8,opt:!0,default:!1},{no:9,name:"optimize_for",kind:"enum",T:f.getEnumType(un),opt:!0,default:un.SPEED},{no:11,name:"go_package",kind:"scalar",T:9,opt:!0},{no:16,name:"cc_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:17,name:"java_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:18,name:"py_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:42,name:"php_generic_services",kind:"scalar",T:8,opt:!0,default:!1},{no:23,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:31,name:"cc_enable_arenas",kind:"scalar",T:8,opt:!0,default:!0},{no:36,name:"objc_class_prefix",kind:"scalar",T:9,opt:!0},{no:37,name:"csharp_namespace",kind:"scalar",T:9,opt:!0},{no:39,name:"swift_prefix",kind:"scalar",T:9,opt:!0},{no:40,name:"php_class_prefix",kind:"scalar",T:9,opt:!0},{no:41,name:"php_namespace",kind:"scalar",T:9,opt:!0},{no:44,name:"php_metadata_namespace",kind:"scalar",T:9,opt:!0},{no:45,name:"ruby_package",kind:"scalar",T:9,opt:!0},{no:50,name:"features",kind:"message",T:Re,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0}]);var un;(function(a){a[a.SPEED=1]="SPEED",a[a.CODE_SIZE=2]="CODE_SIZE",a[a.LITE_RUNTIME=3]="LITE_RUNTIME"})(un||(un={})),f.util.setEnumType(un,"google.protobuf.FileOptions.OptimizeMode",[{no:1,name:"SPEED"},{no:2,name:"CODE_SIZE"},{no:3,name:"LITE_RUNTIME"}]);class Ct extends G.v{constructor(r){super(),this.uninterpretedOption=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Ct().fromBinary(r,o)}static fromJson(r,o){return new Ct().fromJson(r,o)}static fromJsonString(r,o){return new Ct().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ct,r,o)}}Ct.runtime=f,Ct.typeName="google.protobuf.MessageOptions",Ct.fields=f.util.newFieldList(()=>[{no:1,name:"message_set_wire_format",kind:"scalar",T:8,opt:!0,default:!1},{no:2,name:"no_standard_descriptor_accessor",kind:"scalar",T:8,opt:!0,default:!1},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:7,name:"map_entry",kind:"scalar",T:8,opt:!0},{no:11,name:"deprecated_legacy_json_field_conflicts",kind:"scalar",T:8,opt:!0},{no:12,name:"features",kind:"message",T:Re,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0}]);class Ht extends G.v{constructor(r){super(),this.targets=[],this.editionDefaults=[],this.uninterpretedOption=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Ht().fromBinary(r,o)}static fromJson(r,o){return new Ht().fromJson(r,o)}static fromJsonString(r,o){return new Ht().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ht,r,o)}}Ht.runtime=f,Ht.typeName="google.protobuf.FieldOptions",Ht.fields=f.util.newFieldList(()=>[{no:1,name:"ctype",kind:"enum",T:f.getEnumType(Nn),opt:!0,default:Nn.STRING},{no:2,name:"packed",kind:"scalar",T:8,opt:!0},{no:6,name:"jstype",kind:"enum",T:f.getEnumType(fn),opt:!0,default:fn.JS_NORMAL},{no:5,name:"lazy",kind:"scalar",T:8,opt:!0,default:!1},{no:15,name:"unverified_lazy",kind:"scalar",T:8,opt:!0,default:!1},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:10,name:"weak",kind:"scalar",T:8,opt:!0,default:!1},{no:16,name:"debug_redact",kind:"scalar",T:8,opt:!0,default:!1},{no:17,name:"retention",kind:"enum",T:f.getEnumType(bn),opt:!0},{no:19,name:"targets",kind:"enum",T:f.getEnumType(Rn),repeated:!0},{no:20,name:"edition_defaults",kind:"message",T:wt,repeated:!0},{no:21,name:"features",kind:"message",T:Re,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0}]);var Nn;(function(a){a[a.STRING=0]="STRING",a[a.CORD=1]="CORD",a[a.STRING_PIECE=2]="STRING_PIECE"})(Nn||(Nn={})),f.util.setEnumType(Nn,"google.protobuf.FieldOptions.CType",[{no:0,name:"STRING"},{no:1,name:"CORD"},{no:2,name:"STRING_PIECE"}]);var fn;(function(a){a[a.JS_NORMAL=0]="JS_NORMAL",a[a.JS_STRING=1]="JS_STRING",a[a.JS_NUMBER=2]="JS_NUMBER"})(fn||(fn={})),f.util.setEnumType(fn,"google.protobuf.FieldOptions.JSType",[{no:0,name:"JS_NORMAL"},{no:1,name:"JS_STRING"},{no:2,name:"JS_NUMBER"}]);var bn;(function(a){a[a.RETENTION_UNKNOWN=0]="RETENTION_UNKNOWN",a[a.RETENTION_RUNTIME=1]="RETENTION_RUNTIME",a[a.RETENTION_SOURCE=2]="RETENTION_SOURCE"})(bn||(bn={})),f.util.setEnumType(bn,"google.protobuf.FieldOptions.OptionRetention",[{no:0,name:"RETENTION_UNKNOWN"},{no:1,name:"RETENTION_RUNTIME"},{no:2,name:"RETENTION_SOURCE"}]);var Rn;(function(a){a[a.TARGET_TYPE_UNKNOWN=0]="TARGET_TYPE_UNKNOWN",a[a.TARGET_TYPE_FILE=1]="TARGET_TYPE_FILE",a[a.TARGET_TYPE_EXTENSION_RANGE=2]="TARGET_TYPE_EXTENSION_RANGE",a[a.TARGET_TYPE_MESSAGE=3]="TARGET_TYPE_MESSAGE",a[a.TARGET_TYPE_FIELD=4]="TARGET_TYPE_FIELD",a[a.TARGET_TYPE_ONEOF=5]="TARGET_TYPE_ONEOF",a[a.TARGET_TYPE_ENUM=6]="TARGET_TYPE_ENUM",a[a.TARGET_TYPE_ENUM_ENTRY=7]="TARGET_TYPE_ENUM_ENTRY",a[a.TARGET_TYPE_SERVICE=8]="TARGET_TYPE_SERVICE",a[a.TARGET_TYPE_METHOD=9]="TARGET_TYPE_METHOD"})(Rn||(Rn={})),f.util.setEnumType(Rn,"google.protobuf.FieldOptions.OptionTargetType",[{no:0,name:"TARGET_TYPE_UNKNOWN"},{no:1,name:"TARGET_TYPE_FILE"},{no:2,name:"TARGET_TYPE_EXTENSION_RANGE"},{no:3,name:"TARGET_TYPE_MESSAGE"},{no:4,name:"TARGET_TYPE_FIELD"},{no:5,name:"TARGET_TYPE_ONEOF"},{no:6,name:"TARGET_TYPE_ENUM"},{no:7,name:"TARGET_TYPE_ENUM_ENTRY"},{no:8,name:"TARGET_TYPE_SERVICE"},{no:9,name:"TARGET_TYPE_METHOD"}]);class wt extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new wt().fromBinary(r,o)}static fromJson(r,o){return new wt().fromJson(r,o)}static fromJsonString(r,o){return new wt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(wt,r,o)}}wt.runtime=f,wt.typeName="google.protobuf.FieldOptions.EditionDefault",wt.fields=f.util.newFieldList(()=>[{no:3,name:"edition",kind:"enum",T:f.getEnumType(ne),opt:!0},{no:2,name:"value",kind:"scalar",T:9,opt:!0}]);class Zt extends G.v{constructor(r){super(),this.uninterpretedOption=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Zt().fromBinary(r,o)}static fromJson(r,o){return new Zt().fromJson(r,o)}static fromJsonString(r,o){return new Zt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Zt,r,o)}}Zt.runtime=f,Zt.typeName="google.protobuf.OneofOptions",Zt.fields=f.util.newFieldList(()=>[{no:1,name:"features",kind:"message",T:Re,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0}]);class Ze extends G.v{constructor(r){super(),this.uninterpretedOption=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Ze().fromBinary(r,o)}static fromJson(r,o){return new Ze().fromJson(r,o)}static fromJsonString(r,o){return new Ze().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ze,r,o)}}Ze.runtime=f,Ze.typeName="google.protobuf.EnumOptions",Ze.fields=f.util.newFieldList(()=>[{no:2,name:"allow_alias",kind:"scalar",T:8,opt:!0},{no:3,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:6,name:"deprecated_legacy_json_field_conflicts",kind:"scalar",T:8,opt:!0},{no:7,name:"features",kind:"message",T:Re,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0}]);class Qt extends G.v{constructor(r){super(),this.uninterpretedOption=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Qt().fromBinary(r,o)}static fromJson(r,o){return new Qt().fromJson(r,o)}static fromJsonString(r,o){return new Qt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Qt,r,o)}}Qt.runtime=f,Qt.typeName="google.protobuf.EnumValueOptions",Qt.fields=f.util.newFieldList(()=>[{no:1,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:2,name:"features",kind:"message",T:Re,opt:!0},{no:3,name:"debug_redact",kind:"scalar",T:8,opt:!0,default:!1},{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0}]);class en extends G.v{constructor(r){super(),this.uninterpretedOption=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new en().fromBinary(r,o)}static fromJson(r,o){return new en().fromJson(r,o)}static fromJsonString(r,o){return new en().fromJsonString(r,o)}static equals(r,o){return f.util.equals(en,r,o)}}en.runtime=f,en.typeName="google.protobuf.ServiceOptions",en.fields=f.util.newFieldList(()=>[{no:34,name:"features",kind:"message",T:Re,opt:!0},{no:33,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0}]);class tn extends G.v{constructor(r){super(),this.uninterpretedOption=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new tn().fromBinary(r,o)}static fromJson(r,o){return new tn().fromJson(r,o)}static fromJsonString(r,o){return new tn().fromJsonString(r,o)}static equals(r,o){return f.util.equals(tn,r,o)}}tn.runtime=f,tn.typeName="google.protobuf.MethodOptions",tn.fields=f.util.newFieldList(()=>[{no:33,name:"deprecated",kind:"scalar",T:8,opt:!0,default:!1},{no:34,name:"idempotency_level",kind:"enum",T:f.getEnumType(nn),opt:!0,default:nn.IDEMPOTENCY_UNKNOWN},{no:35,name:"features",kind:"message",T:Re,opt:!0},{no:999,name:"uninterpreted_option",kind:"message",T:Ye,repeated:!0}]);var nn;(function(a){a[a.IDEMPOTENCY_UNKNOWN=0]="IDEMPOTENCY_UNKNOWN",a[a.NO_SIDE_EFFECTS=1]="NO_SIDE_EFFECTS",a[a.IDEMPOTENT=2]="IDEMPOTENT"})(nn||(nn={})),f.util.setEnumType(nn,"google.protobuf.MethodOptions.IdempotencyLevel",[{no:0,name:"IDEMPOTENCY_UNKNOWN"},{no:1,name:"NO_SIDE_EFFECTS"},{no:2,name:"IDEMPOTENT"}]);class Ye extends G.v{constructor(r){super(),this.name=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Ye().fromBinary(r,o)}static fromJson(r,o){return new Ye().fromJson(r,o)}static fromJsonString(r,o){return new Ye().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ye,r,o)}}Ye.runtime=f,Ye.typeName="google.protobuf.UninterpretedOption",Ye.fields=f.util.newFieldList(()=>[{no:2,name:"name",kind:"message",T:Rt,repeated:!0},{no:3,name:"identifier_value",kind:"scalar",T:9,opt:!0},{no:4,name:"positive_int_value",kind:"scalar",T:4,opt:!0},{no:5,name:"negative_int_value",kind:"scalar",T:3,opt:!0},{no:6,name:"double_value",kind:"scalar",T:1,opt:!0},{no:7,name:"string_value",kind:"scalar",T:12,opt:!0},{no:8,name:"aggregate_value",kind:"scalar",T:9,opt:!0}]);class Rt extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new Rt().fromBinary(r,o)}static fromJson(r,o){return new Rt().fromJson(r,o)}static fromJsonString(r,o){return new Rt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Rt,r,o)}}Rt.runtime=f,Rt.typeName="google.protobuf.UninterpretedOption.NamePart",Rt.fields=f.util.newFieldList(()=>[{no:1,name:"name_part",kind:"scalar",T:9},{no:2,name:"is_extension",kind:"scalar",T:8}]);class Re extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new Re().fromBinary(r,o)}static fromJson(r,o){return new Re().fromJson(r,o)}static fromJsonString(r,o){return new Re().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Re,r,o)}}Re.runtime=f,Re.typeName="google.protobuf.FeatureSet",Re.fields=f.util.newFieldList(()=>[{no:1,name:"field_presence",kind:"enum",T:f.getEnumType(Sn),opt:!0},{no:2,name:"enum_type",kind:"enum",T:f.getEnumType(_n),opt:!0},{no:3,name:"repeated_field_encoding",kind:"enum",T:f.getEnumType(Et),opt:!0},{no:4,name:"utf8_validation",kind:"enum",T:f.getEnumType(xn),opt:!0},{no:5,name:"message_encoding",kind:"enum",T:f.getEnumType(Ln),opt:!0},{no:6,name:"json_format",kind:"enum",T:f.getEnumType(Bn),opt:!0}]);var Sn;(function(a){a[a.FIELD_PRESENCE_UNKNOWN=0]="FIELD_PRESENCE_UNKNOWN",a[a.EXPLICIT=1]="EXPLICIT",a[a.IMPLICIT=2]="IMPLICIT",a[a.LEGACY_REQUIRED=3]="LEGACY_REQUIRED"})(Sn||(Sn={})),f.util.setEnumType(Sn,"google.protobuf.FeatureSet.FieldPresence",[{no:0,name:"FIELD_PRESENCE_UNKNOWN"},{no:1,name:"EXPLICIT"},{no:2,name:"IMPLICIT"},{no:3,name:"LEGACY_REQUIRED"}]);var _n;(function(a){a[a.ENUM_TYPE_UNKNOWN=0]="ENUM_TYPE_UNKNOWN",a[a.OPEN=1]="OPEN",a[a.CLOSED=2]="CLOSED"})(_n||(_n={})),f.util.setEnumType(_n,"google.protobuf.FeatureSet.EnumType",[{no:0,name:"ENUM_TYPE_UNKNOWN"},{no:1,name:"OPEN"},{no:2,name:"CLOSED"}]);var Et;(function(a){a[a.REPEATED_FIELD_ENCODING_UNKNOWN=0]="REPEATED_FIELD_ENCODING_UNKNOWN",a[a.PACKED=1]="PACKED",a[a.EXPANDED=2]="EXPANDED"})(Et||(Et={})),f.util.setEnumType(Et,"google.protobuf.FeatureSet.RepeatedFieldEncoding",[{no:0,name:"REPEATED_FIELD_ENCODING_UNKNOWN"},{no:1,name:"PACKED"},{no:2,name:"EXPANDED"}]);var xn;(function(a){a[a.UTF8_VALIDATION_UNKNOWN=0]="UTF8_VALIDATION_UNKNOWN",a[a.NONE=1]="NONE",a[a.VERIFY=2]="VERIFY"})(xn||(xn={})),f.util.setEnumType(xn,"google.protobuf.FeatureSet.Utf8Validation",[{no:0,name:"UTF8_VALIDATION_UNKNOWN"},{no:1,name:"NONE"},{no:2,name:"VERIFY"}]);var Ln;(function(a){a[a.MESSAGE_ENCODING_UNKNOWN=0]="MESSAGE_ENCODING_UNKNOWN",a[a.LENGTH_PREFIXED=1]="LENGTH_PREFIXED",a[a.DELIMITED=2]="DELIMITED"})(Ln||(Ln={})),f.util.setEnumType(Ln,"google.protobuf.FeatureSet.MessageEncoding",[{no:0,name:"MESSAGE_ENCODING_UNKNOWN"},{no:1,name:"LENGTH_PREFIXED"},{no:2,name:"DELIMITED"}]);var Bn;(function(a){a[a.JSON_FORMAT_UNKNOWN=0]="JSON_FORMAT_UNKNOWN",a[a.ALLOW=1]="ALLOW",a[a.LEGACY_BEST_EFFORT=2]="LEGACY_BEST_EFFORT"})(Bn||(Bn={})),f.util.setEnumType(Bn,"google.protobuf.FeatureSet.JsonFormat",[{no:0,name:"JSON_FORMAT_UNKNOWN"},{no:1,name:"ALLOW"},{no:2,name:"LEGACY_BEST_EFFORT"}]);class F extends G.v{constructor(r){super(),this.defaults=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new F().fromBinary(r,o)}static fromJson(r,o){return new F().fromJson(r,o)}static fromJsonString(r,o){return new F().fromJsonString(r,o)}static equals(r,o){return f.util.equals(F,r,o)}}F.runtime=f,F.typeName="google.protobuf.FeatureSetDefaults",F.fields=f.util.newFieldList(()=>[{no:1,name:"defaults",kind:"message",T:Fe,repeated:!0},{no:4,name:"minimum_edition",kind:"enum",T:f.getEnumType(ne),opt:!0},{no:5,name:"maximum_edition",kind:"enum",T:f.getEnumType(ne),opt:!0}]);class Fe extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new Fe().fromBinary(r,o)}static fromJson(r,o){return new Fe().fromJson(r,o)}static fromJsonString(r,o){return new Fe().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Fe,r,o)}}Fe.runtime=f,Fe.typeName="google.protobuf.FeatureSetDefaults.FeatureSetEditionDefault",Fe.fields=f.util.newFieldList(()=>[{no:3,name:"edition",kind:"enum",T:f.getEnumType(ne),opt:!0},{no:2,name:"features",kind:"message",T:Re,opt:!0}]);class ye extends G.v{constructor(r){super(),this.location=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new ye().fromBinary(r,o)}static fromJson(r,o){return new ye().fromJson(r,o)}static fromJsonString(r,o){return new ye().fromJsonString(r,o)}static equals(r,o){return f.util.equals(ye,r,o)}}ye.runtime=f,ye.typeName="google.protobuf.SourceCodeInfo",ye.fields=f.util.newFieldList(()=>[{no:1,name:"location",kind:"message",T:Ae,repeated:!0}]);class Ae extends G.v{constructor(r){super(),this.path=[],this.span=[],this.leadingDetachedComments=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Ae().fromBinary(r,o)}static fromJson(r,o){return new Ae().fromJson(r,o)}static fromJsonString(r,o){return new Ae().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ae,r,o)}}Ae.runtime=f,Ae.typeName="google.protobuf.SourceCodeInfo.Location",Ae.fields=f.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:5,repeated:!0,packed:!0},{no:2,name:"span",kind:"scalar",T:5,repeated:!0,packed:!0},{no:3,name:"leading_comments",kind:"scalar",T:9,opt:!0},{no:4,name:"trailing_comments",kind:"scalar",T:9,opt:!0},{no:6,name:"leading_detached_comments",kind:"scalar",T:9,repeated:!0}]);class Jt extends G.v{constructor(r){super(),this.annotation=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Jt().fromBinary(r,o)}static fromJson(r,o){return new Jt().fromJson(r,o)}static fromJsonString(r,o){return new Jt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Jt,r,o)}}Jt.runtime=f,Jt.typeName="google.protobuf.GeneratedCodeInfo",Jt.fields=f.util.newFieldList(()=>[{no:1,name:"annotation",kind:"message",T:Ft,repeated:!0}]);class Ft extends G.v{constructor(r){super(),this.path=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Ft().fromBinary(r,o)}static fromJson(r,o){return new Ft().fromJson(r,o)}static fromJsonString(r,o){return new Ft().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ft,r,o)}}Ft.runtime=f,Ft.typeName="google.protobuf.GeneratedCodeInfo.Annotation",Ft.fields=f.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:5,repeated:!0,packed:!0},{no:2,name:"source_file",kind:"scalar",T:9,opt:!0},{no:3,name:"begin",kind:"scalar",T:5,opt:!0},{no:4,name:"end",kind:"scalar",T:5,opt:!0},{no:5,name:"semantic",kind:"enum",T:f.getEnumType(In),opt:!0}]);var In;(function(a){a[a.NONE=0]="NONE",a[a.SET=1]="SET",a[a.ALIAS=2]="ALIAS"})(In||(In={})),f.util.setEnumType(In,"google.protobuf.GeneratedCodeInfo.Annotation.Semantic",[{no:0,name:"NONE"},{no:1,name:"SET"},{no:2,name:"ALIAS"}]);function vn(a,r){const o=a.values.find(h=>h.name===r);return(0,I.hu)(o,`cannot parse ${a.name} default value: ${r}`),o.number}function _t(a,r){switch(a){case m.w.STRING:return r;case m.w.BYTES:{const o=Ne(r);if(o===!1)throw new Error(`cannot parse ${m.w[a]} default value: ${r}`);return o}case m.w.INT64:case m.w.SFIXED64:case m.w.SINT64:return w.q.parse(r);case m.w.UINT64:case m.w.FIXED64:return w.q.uParse(r);case m.w.DOUBLE:case m.w.FLOAT:switch(r){case"inf":return Number.POSITIVE_INFINITY;case"-inf":return Number.NEGATIVE_INFINITY;case"nan":return Number.NaN;default:return parseFloat(r)}case m.w.BOOL:return r==="true";case m.w.INT32:case m.w.UINT32:case m.w.SINT32:case m.w.FIXED32:case m.w.SFIXED32:return parseInt(r,10)}}function Ne(a){const r=[],o={tail:a,c:"",next(){return this.tail.length==0?!1:(this.c=this.tail[0],this.tail=this.tail.substring(1),!0)},take(h){if(this.tail.length>=h){const g=this.tail.substring(0,h);return this.tail=this.tail.substring(h),g}return!1}};for(;o.next();)switch(o.c){case"\\":if(o.next())switch(o.c){case"\\":r.push(o.c.charCodeAt(0));break;case"b":r.push(8);break;case"f":r.push(12);break;case"n":r.push(10);break;case"r":r.push(13);break;case"t":r.push(9);break;case"v":r.push(11);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":{const h=o.c,g=o.take(2);if(g===!1)return!1;const E=parseInt(h+g,8);if(isNaN(E))return!1;r.push(E);break}case"x":{const h=o.c,g=o.take(2);if(g===!1)return!1;const E=parseInt(h+g,16);if(isNaN(E))return!1;r.push(E);break}case"u":{const h=o.c,g=o.take(4);if(g===!1)return!1;const E=parseInt(h+g,16);if(isNaN(E))return!1;const b=new Uint8Array(4);new DataView(b.buffer).setInt32(0,E,!0),r.push(b[0],b[1],b[2],b[3]);break}case"U":{const h=o.c,g=o.take(8);if(g===!1)return!1;const E=w.q.uEnc(h+g),b=new Uint8Array(8),M=new DataView(b.buffer);M.setInt32(0,E.lo,!0),M.setInt32(4,E.hi,!0),r.push(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);break}}break;default:r.push(o.c.charCodeAt(0))}return new Uint8Array(r)}const qn=F.fromBinary(B.W.dec("ChESDAgBEAIYAiABKAEwAhjmBwoREgwIAhABGAEgAigBMAEY5wcKERIMCAEQARgBIAIoATABGOgHIOYHKOgH"));function sr(a){const r=a.minimumEdition,o=a.maximumEdition;if(r===void 0||o===void 0||a.defaults.some(g=>g.edition===void 0))throw new Error("Invalid FeatureSetDefaults");const h=new Map;return(g,...E)=>{var b,M;let A=h.get(g);if(A===void 0){if(g<r)throw new Error(`Edition ${ne[g]} is earlier than the minimum supported edition ${ne[r]}`);if(o<g)throw new Error(`Edition ${ne[g]} is later than the maximum supported edition ${ne[o]}`);let Z;for(const ce of a.defaults){const De=(b=ce.edition)!==null&&b!==void 0?b:0;De>g||Z!==void 0&&Z.e>De||(Z={e:De,f:(M=ce.features)!==null&&M!==void 0?M:new Re})}if(Z===void 0)throw new Error(`No valid default found for edition ${ne[g]}`);A=Z.f.toBinary(),h.set(g,A)}const K=Re.fromBinary(A);for(const Z of E)Z!==void 0&&K.fromBinary(Z.toBinary());if(!Ut(K))throw new Error(`Invalid FeatureSet for edition ${ne[g]}`);return K}}function Ut(a){for(const r of Re.fields.list()){const o=a[r.localName];if(o===void 0||r.kind=="enum"&&o===0)return!1}return!0}function ir(a,r){var o;const h={enums:new Map,messages:new Map,services:new Map,extensions:new Map,mapEntries:new Map,resolveFeatures:sr((o=r==null?void 0:r.featureSetDefaults)!==null&&o!==void 0?o:qn)},E=(a instanceof ue?a.file:a instanceof Uint8Array?ue.fromBinary(a).file:a).map(b=>Or(b,h));return Object.assign({files:E},h)}function Or(a,r){var o,h;(0,I.hu)(a.name,"invalid FileDescriptorProto: missing name");const g=Object.assign(Object.assign({kind:"file",proto:a,deprecated:(h=(o=a.options)===null||o===void 0?void 0:o.deprecated)!==null&&h!==void 0?h:!1},mr(a.syntax,a.edition)),{name:a.name.replace(/\.proto/,""),enums:[],messages:[],extensions:[],services:[],toString(){return`file ${this.proto.name}`},getSyntaxComments(){return at(this.proto.sourceCodeInfo,[We.FileDescriptorProto_Syntax])},getPackageComments(){return at(this.proto.sourceCodeInfo,[We.FileDescriptorProto_Package])},getFeatures(){var E;return r.resolveFeatures(this.edition,(E=this.proto.options)===null||E===void 0?void 0:E.features)}});r.mapEntries.clear();for(const E of a.enumType)or(E,g,void 0,r);for(const E of a.messageType)ar(E,g,void 0,r);for(const E of a.service)$t(E,g,r);dn(g,r);for(const E of r.mapEntries.values())Yn(E,r);for(const E of g.messages)Yn(E,r),dn(E,r);return r.mapEntries.clear(),g}function dn(a,r){switch(a.kind){case"file":for(const o of a.proto.extension){const h=Kn(o,a,void 0,r);a.extensions.push(h),r.extensions.set(h.typeName,h)}break;case"message":for(const o of a.proto.extension){const h=Kn(o,a.file,a,r);a.nestedExtensions.push(h),r.extensions.set(h.typeName,h)}for(const o of a.nestedMessages)dn(o,r);break}}function Yn(a,r){const o=a.proto.oneofDecl.map(g=>kn(g,a,r)),h=new Set;for(const g of a.proto.field){const E=et(g,o),b=ur(g,a.file,a,E,r);a.fields.push(b),E===void 0?a.members.push(b):(E.fields.push(b),h.has(E)||(h.add(E),a.members.push(E)))}for(const g of o.filter(E=>h.has(E)))a.oneofs.push(g);for(const g of a.nestedMessages)Yn(g,r)}function or(a,r,o,h){var g,E,b;(0,I.hu)(a.name,"invalid EnumDescriptorProto: missing name");const M={kind:"enum",proto:a,deprecated:(E=(g=a.options)===null||g===void 0?void 0:g.deprecated)!==null&&E!==void 0?E:!1,file:r,parent:o,name:a.name,typeName:Mn(a,o,r),values:[],sharedPrefix:(0,T.Sm)(a.name,a.value.map(A=>{var K;return(K=A.name)!==null&&K!==void 0?K:""})),toString(){return`enum ${this.typeName}`},getComments(){const A=this.parent?[...this.parent.getComments().sourcePath,We.DescriptorProto_EnumType,this.parent.proto.enumType.indexOf(this.proto)]:[We.FileDescriptorProto_EnumType,this.file.proto.enumType.indexOf(this.proto)];return at(r.proto.sourceCodeInfo,A)},getFeatures(){var A,K,Z;const ce=(K=(A=this.parent)===null||A===void 0?void 0:A.getFeatures())!==null&&K!==void 0?K:this.file.getFeatures();return h.resolveFeatures(this.file.edition,ce,(Z=this.proto.options)===null||Z===void 0?void 0:Z.features)}};h.enums.set(M.typeName,M),a.value.forEach(A=>{var K,Z;(0,I.hu)(A.name,"invalid EnumValueDescriptorProto: missing name"),(0,I.hu)(A.number!==void 0,"invalid EnumValueDescriptorProto: missing number"),M.values.push({kind:"enum_value",proto:A,deprecated:(Z=(K=A.options)===null||K===void 0?void 0:K.deprecated)!==null&&Z!==void 0?Z:!1,parent:M,name:A.name,number:A.number,toString(){return`enum value ${M.typeName}.${this.name}`},declarationString(){var ce;let De=`${this.name} = ${this.number}`;return((ce=this.proto.options)===null||ce===void 0?void 0:ce.deprecated)===!0&&(De+=" [deprecated = true]"),De},getComments(){const ce=[...this.parent.getComments().sourcePath,We.EnumDescriptorProto_Value,this.parent.proto.value.indexOf(this.proto)];return at(r.proto.sourceCodeInfo,ce)},getFeatures(){var ce;return h.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),(ce=this.proto.options)===null||ce===void 0?void 0:ce.features)}})}),((b=o==null?void 0:o.nestedEnums)!==null&&b!==void 0?b:r.enums).push(M)}function ar(a,r,o,h){var g,E,b,M;(0,I.hu)(a.name,"invalid DescriptorProto: missing name");const A={kind:"message",proto:a,deprecated:(E=(g=a.options)===null||g===void 0?void 0:g.deprecated)!==null&&E!==void 0?E:!1,file:r,parent:o,name:a.name,typeName:Mn(a,o,r),fields:[],oneofs:[],members:[],nestedEnums:[],nestedMessages:[],nestedExtensions:[],toString(){return`message ${this.typeName}`},getComments(){const K=this.parent?[...this.parent.getComments().sourcePath,We.DescriptorProto_NestedType,this.parent.proto.nestedType.indexOf(this.proto)]:[We.FileDescriptorProto_MessageType,this.file.proto.messageType.indexOf(this.proto)];return at(r.proto.sourceCodeInfo,K)},getFeatures(){var K,Z,ce;const De=(Z=(K=this.parent)===null||K===void 0?void 0:K.getFeatures())!==null&&Z!==void 0?Z:this.file.getFeatures();return h.resolveFeatures(this.file.edition,De,(ce=this.proto.options)===null||ce===void 0?void 0:ce.features)}};((b=a.options)===null||b===void 0?void 0:b.mapEntry)===!0?h.mapEntries.set(A.typeName,A):(((M=o==null?void 0:o.nestedMessages)!==null&&M!==void 0?M:r.messages).push(A),h.messages.set(A.typeName,A));for(const K of a.enumType)or(K,r,A,h);for(const K of a.nestedType)ar(K,r,A,h)}function $t(a,r,o){var h,g;(0,I.hu)(a.name,"invalid ServiceDescriptorProto: missing name");const E={kind:"service",proto:a,deprecated:(g=(h=a.options)===null||h===void 0?void 0:h.deprecated)!==null&&g!==void 0?g:!1,file:r,name:a.name,typeName:Mn(a,void 0,r),methods:[],toString(){return`service ${this.typeName}`},getComments(){const b=[We.FileDescriptorProto_Service,this.file.proto.service.indexOf(this.proto)];return at(r.proto.sourceCodeInfo,b)},getFeatures(){var b;return o.resolveFeatures(this.file.edition,this.file.getFeatures(),(b=this.proto.options)===null||b===void 0?void 0:b.features)}};r.services.push(E),o.services.set(E.typeName,E);for(const b of a.method)E.methods.push(cn(b,E,o))}function cn(a,r,o){var h,g,E;(0,I.hu)(a.name,"invalid MethodDescriptorProto: missing name"),(0,I.hu)(a.inputType,"invalid MethodDescriptorProto: missing input_type"),(0,I.hu)(a.outputType,"invalid MethodDescriptorProto: missing output_type");let b;a.clientStreaming===!0&&a.serverStreaming===!0?b=ve.t.BiDiStreaming:a.clientStreaming===!0?b=ve.t.ClientStreaming:a.serverStreaming===!0?b=ve.t.ServerStreaming:b=ve.t.Unary;let M;switch((h=a.options)===null||h===void 0?void 0:h.idempotencyLevel){case nn.IDEMPOTENT:M=ve.w.Idempotent;break;case nn.NO_SIDE_EFFECTS:M=ve.w.NoSideEffects;break;case nn.IDEMPOTENCY_UNKNOWN:case void 0:M=void 0;break}const A=o.messages.get(Ke(a.inputType)),K=o.messages.get(Ke(a.outputType));(0,I.hu)(A,`invalid MethodDescriptorProto: input_type ${a.inputType} not found`),(0,I.hu)(K,`invalid MethodDescriptorProto: output_type ${a.inputType} not found`);const Z=a.name;return{kind:"rpc",proto:a,deprecated:(E=(g=a.options)===null||g===void 0?void 0:g.deprecated)!==null&&E!==void 0?E:!1,parent:r,name:Z,methodKind:b,input:A,output:K,idempotency:M,toString(){return`rpc ${r.typeName}.${Z}`},getComments(){const ce=[...this.parent.getComments().sourcePath,We.ServiceDescriptorProto_Method,this.parent.proto.method.indexOf(this.proto)];return at(r.file.proto.sourceCodeInfo,ce)},getFeatures(){var ce;return o.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),(ce=this.proto.options)===null||ce===void 0?void 0:ce.features)}}}function kn(a,r,o){return(0,I.hu)(a.name,"invalid OneofDescriptorProto: missing name"),{kind:"oneof",proto:a,deprecated:!1,parent:r,fields:[],name:a.name,toString(){return`oneof ${r.typeName}.${this.name}`},getComments(){const h=[...this.parent.getComments().sourcePath,We.DescriptorProto_OneofDecl,this.parent.proto.oneofDecl.indexOf(this.proto)];return at(r.file.proto.sourceCodeInfo,h)},getFeatures(){var h;return o.resolveFeatures(this.parent.file.edition,this.parent.getFeatures(),(h=this.proto.options)===null||h===void 0?void 0:h.features)}}}function ur(a,r,o,h,g){var E,b,M;(0,I.hu)(a.name,"invalid FieldDescriptorProto: missing name"),(0,I.hu)(a.number,"invalid FieldDescriptorProto: missing number"),(0,I.hu)(a.type,"invalid FieldDescriptorProto: missing type");const A={proto:a,deprecated:(b=(E=a.options)===null||E===void 0?void 0:E.deprecated)!==null&&b!==void 0?b:!1,name:a.name,number:a.number,parent:o,oneof:h,optional:de(a,r.syntax),packedByDefault:me(r,a,g.resolveFeatures),packed:rn(r,o,a,g.resolveFeatures),jsonName:a.jsonName===(0,T.x1)(a.name)?void 0:a.jsonName,scalar:void 0,longType:void 0,message:void 0,enum:void 0,mapKey:void 0,mapValue:void 0,declarationString:Vt,toString(){return`field ${this.parent.typeName}.${this.name}`},getComments(){const Z=[...this.parent.getComments().sourcePath,We.DescriptorProto_Field,this.parent.proto.field.indexOf(this.proto)];return at(r.proto.sourceCodeInfo,Z)},getFeatures(){var Z;return g.resolveFeatures(r.edition,this.parent.getFeatures(),(Z=this.proto.options)===null||Z===void 0?void 0:Z.features)}},K=a.label===Dt.REPEATED;switch(a.type){case le.MESSAGE:case le.GROUP:{(0,I.hu)(a.typeName,"invalid FieldDescriptorProto: missing type_name");const Z=g.mapEntries.get(Ke(a.typeName));if(Z!==void 0)return(0,I.hu)(K,"invalid FieldDescriptorProto: expected map entry to be repeated"),Object.assign(Object.assign(Object.assign({},A),{kind:"field",fieldKind:"map",repeated:!1}),Y(Z));const ce=g.messages.get(Ke(a.typeName));return(0,I.hu)(ce!==void 0,`invalid FieldDescriptorProto: type_name ${a.typeName} not found`),Object.assign(Object.assign({},A),{kind:"field",fieldKind:"message",repeated:K,message:ce})}case le.ENUM:{(0,I.hu)(a.typeName,"invalid FieldDescriptorProto: missing type_name");const Z=g.enums.get(Ke(a.typeName));return(0,I.hu)(Z!==void 0,`invalid FieldDescriptorProto: type_name ${a.typeName} not found`),Object.assign(Object.assign({},A),{kind:"field",fieldKind:"enum",getDefaultValue:Wn,repeated:K,enum:Z})}default:{const Z=gr[a.type];return(0,I.hu)(Z,`invalid FieldDescriptorProto: unknown type ${a.type}`),Object.assign(Object.assign({},A),{kind:"field",fieldKind:"scalar",getDefaultValue:Wn,repeated:K,scalar:Z,longType:((M=a.options)===null||M===void 0?void 0:M.jstype)==fn.JS_STRING?m.p.STRING:m.p.BIGINT})}}}function Kn(a,r,o,h){(0,I.hu)(a.extendee,"invalid FieldDescriptorProto: missing extendee");const g=ur(a,r,null,void 0,h),E=h.messages.get(Ke(a.extendee));return(0,I.hu)(E,`invalid FieldDescriptorProto: extendee ${a.extendee} not found`),Object.assign(Object.assign({},g),{kind:"extension",typeName:Mn(a,o,r),parent:o,file:r,extendee:E,toString(){return`extension ${this.typeName}`},getComments(){const b=this.parent?[...this.parent.getComments().sourcePath,We.DescriptorProto_Extension,this.parent.proto.extension.indexOf(a)]:[We.FileDescriptorProto_Extension,this.file.proto.extension.indexOf(a)];return at(r.proto.sourceCodeInfo,b)},getFeatures(){var b,M;return h.resolveFeatures(this.file.edition,((b=this.parent)!==null&&b!==void 0?b:this.file).getFeatures(),(M=this.proto.options)===null||M===void 0?void 0:M.features)}})}function mr(a,r){let o,h;switch(a){case void 0:case"proto2":h="proto2",o=ne.EDITION_PROTO2;break;case"proto3":h="proto3",o=ne.EDITION_PROTO3;break;case"editions":switch(h="editions",r){case void 0:case ne.EDITION_1_TEST_ONLY:case ne.EDITION_2_TEST_ONLY:case ne.EDITION_99997_TEST_ONLY:case ne.EDITION_99998_TEST_ONLY:case ne.EDITION_99999_TEST_ONLY:case ne.EDITION_UNKNOWN:o=ne.EDITION_UNKNOWN;break;default:o=r;break}break;default:throw new Error(`invalid FileDescriptorProto: unsupported syntax: ${a}`)}if(a==="editions"&&r===ne.EDITION_UNKNOWN)throw new Error(`invalid FileDescriptorProto: syntax ${a} cannot have edition ${String(r)}`);return{syntax:h,edition:o}}function Mn(a,r,o){(0,I.hu)(a.name,`invalid ${a.getType().typeName}: missing name`);let h;return r?h=`${r.typeName}.${a.name}`:o.proto.package!==void 0?h=`${o.proto.package}.${a.name}`:h=`${a.name}`,h}function Ke(a){return a.startsWith(".")?a.substring(1):a}function Y(a){var r,o;(0,I.hu)((r=a.proto.options)===null||r===void 0?void 0:r.mapEntry,`invalid DescriptorProto: expected ${a.toString()} to be a map entry`),(0,I.hu)(a.fields.length===2,`invalid DescriptorProto: map entry ${a.toString()} has ${a.fields.length} fields`);const h=a.fields.find(b=>b.proto.number===1);(0,I.hu)(h,`invalid DescriptorProto: map entry ${a.toString()} is missing key field`);const g=h.scalar;(0,I.hu)(g!==void 0&&g!==m.w.BYTES&&g!==m.w.FLOAT&&g!==m.w.DOUBLE,`invalid DescriptorProto: map entry ${a.toString()} has unexpected key type ${(o=h.proto.type)!==null&&o!==void 0?o:-1}`);const E=a.fields.find(b=>b.proto.number===2);switch((0,I.hu)(E,`invalid DescriptorProto: map entry ${a.toString()} is missing value field`),E.fieldKind){case"scalar":return{mapKey:g,mapValue:Object.assign(Object.assign({},E),{kind:"scalar"})};case"message":return{mapKey:g,mapValue:Object.assign(Object.assign({},E),{kind:"message"})};case"enum":return{mapKey:g,mapValue:Object.assign(Object.assign({},E),{kind:"enum"})};default:throw new Error("invalid DescriptorProto: unsupported map entry value field")}}function et(a,r){var o;const h=a.oneofIndex;if(h===void 0)return;let g;return a.proto3Optional!==!0&&(g=r[h],(0,I.hu)(g,`invalid FieldDescriptorProto: oneof #${h} for field #${(o=a.number)!==null&&o!==void 0?o:-1} not found`)),g}function de(a,r){switch(r){case"proto2":return a.oneofIndex===void 0&&a.label===Dt.OPTIONAL;case"proto3":return a.proto3Optional===!0;case"editions":return!1}}function me(a,r,o){const{repeatedFieldEncoding:h}=o(a.edition);if(h!=Et.PACKED)return!1;switch(r.type){case le.STRING:case le.BYTES:case le.GROUP:case le.MESSAGE:return!1;default:return!0}}function rn(a,r,o,h){var g,E,b,M,A,K;switch(o.type){case le.STRING:case le.BYTES:case le.GROUP:case le.MESSAGE:return!1;default:switch(a.edition){case ne.EDITION_PROTO2:return(E=(g=o.options)===null||g===void 0?void 0:g.packed)!==null&&E!==void 0?E:!1;case ne.EDITION_PROTO3:return(M=(b=o.options)===null||b===void 0?void 0:b.packed)!==null&&M!==void 0?M:!0;default:{const{repeatedFieldEncoding:Z}=h(a.edition,(A=r==null?void 0:r.getFeatures())!==null&&A!==void 0?A:a.getFeatures(),(K=o.options)===null||K===void 0?void 0:K.features);return Z==Et.PACKED}}}}const gr={[le.DOUBLE]:m.w.DOUBLE,[le.FLOAT]:m.w.FLOAT,[le.INT64]:m.w.INT64,[le.UINT64]:m.w.UINT64,[le.INT32]:m.w.INT32,[le.FIXED64]:m.w.FIXED64,[le.FIXED32]:m.w.FIXED32,[le.BOOL]:m.w.BOOL,[le.STRING]:m.w.STRING,[le.GROUP]:void 0,[le.MESSAGE]:void 0,[le.BYTES]:m.w.BYTES,[le.UINT32]:m.w.UINT32,[le.ENUM]:void 0,[le.SFIXED32]:m.w.SFIXED32,[le.SFIXED64]:m.w.SFIXED64,[le.SINT32]:m.w.SINT32,[le.SINT64]:m.w.SINT64};function at(a,r){if(!a)return{leadingDetached:[],sourcePath:r};for(const o of a.location)if(o.path.length===r.length&&!o.path.some((h,g)=>r[g]!==h))return{leadingDetached:o.leadingDetachedComments,leading:o.leadingComments,trailing:o.trailingComments,sourcePath:r};return{leadingDetached:[],sourcePath:r}}var We;(function(a){a[a.FileDescriptorProto_Package=2]="FileDescriptorProto_Package",a[a.FileDescriptorProto_MessageType=4]="FileDescriptorProto_MessageType",a[a.FileDescriptorProto_EnumType=5]="FileDescriptorProto_EnumType",a[a.FileDescriptorProto_Service=6]="FileDescriptorProto_Service",a[a.FileDescriptorProto_Extension=7]="FileDescriptorProto_Extension",a[a.FileDescriptorProto_Syntax=12]="FileDescriptorProto_Syntax",a[a.DescriptorProto_Field=2]="DescriptorProto_Field",a[a.DescriptorProto_NestedType=3]="DescriptorProto_NestedType",a[a.DescriptorProto_EnumType=4]="DescriptorProto_EnumType",a[a.DescriptorProto_Extension=6]="DescriptorProto_Extension",a[a.DescriptorProto_OneofDecl=8]="DescriptorProto_OneofDecl",a[a.EnumDescriptorProto_Value=2]="EnumDescriptorProto_Value",a[a.ServiceDescriptorProto_Method=2]="ServiceDescriptorProto_Method"})(We||(We={}));function Vt(){var a,r,o;const h=[];this.repeated&&h.push("repeated"),this.optional&&h.push("optional"),(this.kind==="extension"?this.file:this.parent.file).syntax=="proto2"&&this.proto.label===Dt.REQUIRED&&h.push("required");let E;switch(this.fieldKind){case"scalar":E=m.w[this.scalar].toLowerCase();break;case"enum":E=this.enum.typeName;break;case"message":E=this.message.typeName;break;case"map":{const A=m.w[this.mapKey].toLowerCase();let K;switch(this.mapValue.kind){case"scalar":K=m.w[this.mapValue.scalar].toLowerCase();break;case"enum":K=this.mapValue.enum.typeName;break;case"message":K=this.mapValue.message.typeName;break}E=`map<${A}, ${K}>`;break}}h.push(`${E} ${this.name} = ${this.number}`);const b=[];((a=this.proto.options)===null||a===void 0?void 0:a.packed)!==void 0&&b.push(`packed = ${this.proto.options.packed.toString()}`);let M=this.proto.defaultValue;return M!==void 0&&((this.proto.type==le.BYTES||this.proto.type==le.STRING)&&(M='"'+M.replace('"','\\"')+'"'),b.push(`default = ${M}`)),this.jsonName!==void 0&&b.push(`json_name = "${this.jsonName}"`),((r=this.proto.options)===null||r===void 0?void 0:r.jstype)!==void 0&&b.push(`jstype = ${fn[this.proto.options.jstype]}`),((o=this.proto.options)===null||o===void 0?void 0:o.deprecated)===!0&&b.push("deprecated = true"),b.length>0&&h.push("["+b.join(", ")+"]"),h.join(" ")}function Wn(){const a=this.proto.defaultValue;if(a!==void 0)switch(this.fieldKind){case"enum":return vn(this.enum,a);case"scalar":return _t(this.scalar,a);default:return}}function pr(...a){const r={},o={},h={},g={add(E){if("fields"in E){if(!this.findMessage(E.typeName)){r[E.typeName]=E;for(const b of E.fields.list())b.kind=="message"?this.add(b.T):b.kind=="map"&&b.V.kind=="message"?this.add(b.V.T):b.kind=="enum"&&this.add(b.T)}}else if("methods"in E){if(!this.findService(E.typeName)){h[E.typeName]=E;for(const b of Object.values(E.methods))this.add(b.I),this.add(b.O)}}else o[E.typeName]=E},findMessage(E){return r[E]},findEnum(E){return o[E]},findService(E){return h[E]}};for(const E of a)g.add(E);return g}class xt extends G.v{constructor(r){super(),this.seconds=w.q.zero,this.nanos=0,l.w.util.initPartial(r,this)}fromJson(r,o){if(typeof r!="string")throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${l.w.json.debug(r)}`);const h=r.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!h)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const g=Date.parse(h[1]+"-"+h[2]+"-"+h[3]+"T"+h[4]+":"+h[5]+":"+h[6]+(h[8]?h[8]:"Z"));if(Number.isNaN(g))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(g<Date.parse("0001-01-01T00:00:00Z")||g>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=w.q.parse(g/1e3),this.nanos=0,h[7]&&(this.nanos=parseInt("1"+h[7]+"0".repeat(9-h[7].length))-1e9),this}toJson(r){const o=Number(this.seconds)*1e3;if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let h="Z";if(this.nanos>0){const g=(this.nanos+1e9).toString().substring(1);g.substring(3)==="000000"?h="."+g.substring(0,3)+"Z":g.substring(6)==="000"?h="."+g.substring(0,6)+"Z":h="."+g+"Z"}return new Date(o).toISOString().replace(".000Z",h)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return xt.fromDate(new Date)}static fromDate(r){const o=r.getTime();return new xt({seconds:w.q.parse(Math.floor(o/1e3)),nanos:o%1e3*1e6})}static fromBinary(r,o){return new xt().fromBinary(r,o)}static fromJson(r,o){return new xt().fromJson(r,o)}static fromJsonString(r,o){return new xt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(xt,r,o)}}xt.runtime=l.w,xt.typeName="google.protobuf.Timestamp",xt.fields=l.w.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class Pe extends G.v{constructor(r){super(),this.seconds=w.q.zero,this.nanos=0,l.w.util.initPartial(r,this)}fromJson(r,o){if(typeof r!="string")throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.w.json.debug(r)}`);const h=r.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(h===null)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.w.json.debug(r)}`);const g=Number(h[1]);if(g>315576e6||g<-315576e6)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.w.json.debug(r)}`);if(this.seconds=w.q.parse(g),typeof h[2]=="string"){const E=h[2]+"0".repeat(9-h[2].length);this.nanos=parseInt(E),(g<0||Object.is(g,-0))&&(this.nanos=-this.nanos)}return this}toJson(r){if(Number(this.seconds)>315576e6||Number(this.seconds)<-315576e6)throw new Error("cannot encode google.protobuf.Duration to JSON: value out of range");let o=this.seconds.toString();if(this.nanos!==0){let h=Math.abs(this.nanos).toString();h="0".repeat(9-h.length)+h,h.substring(3)==="000000"?h=h.substring(0,3):h.substring(6)==="000"&&(h=h.substring(0,6)),o+="."+h,this.nanos<0&&Number(this.seconds)==0&&(o="-"+o)}return o+"s"}static fromBinary(r,o){return new Pe().fromBinary(r,o)}static fromJson(r,o){return new Pe().fromJson(r,o)}static fromJsonString(r,o){return new Pe().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Pe,r,o)}}Pe.runtime=l.w,Pe.typeName="google.protobuf.Duration",Pe.fields=l.w.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var Gn=p(733);class sn extends G.v{constructor(r){super(),l.w.util.initPartial(r,this)}static fromBinary(r,o){return new sn().fromBinary(r,o)}static fromJson(r,o){return new sn().fromJson(r,o)}static fromJsonString(r,o){return new sn().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(sn,r,o)}}sn.runtime=l.w,sn.typeName="google.protobuf.Empty",sn.fields=l.w.util.newFieldList(()=>[]);class on extends G.v{constructor(r){super(),this.paths=[],l.w.util.initPartial(r,this)}toJson(r){function o(h){let g=!1;const E=[];for(let b=0;b<h.length;b++){let M=h.charAt(b);switch(M){case"_":g=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":E.push(M),g=!1;break;default:g&&(g=!1,M=M.toUpperCase()),E.push(M);break}}return E.join("")}return this.paths.map(h=>{if(h.match(/_[0-9]?_/g)||h.match(/[A-Z]/g))throw new Error('cannot encode google.protobuf.FieldMask to JSON: lowerCamelCase of path name "'+h+'" is irreversible');return o(h)}).join(",")}fromJson(r,o){if(typeof r!="string")throw new Error("cannot decode google.protobuf.FieldMask from JSON: "+l.w.json.debug(r));if(r==="")return this;function h(g){if(g.includes("_"))throw new Error("cannot decode google.protobuf.FieldMask from JSON: path names must be lowerCamelCase");const E=g.replace(/[A-Z]/g,b=>"_"+b.toLowerCase());return E[0]==="_"?E.substring(1):E}return this.paths=r.split(",").map(h),this}static fromBinary(r,o){return new on().fromBinary(r,o)}static fromJson(r,o){return new on().fromJson(r,o)}static fromJsonString(r,o){return new on().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(on,r,o)}}on.runtime=l.w,on.typeName="google.protobuf.FieldMask",on.fields=l.w.util.newFieldList(()=>[{no:1,name:"paths",kind:"scalar",T:9,repeated:!0}]);var ut;(function(a){a[a.NULL_VALUE=0]="NULL_VALUE"})(ut||(ut={})),l.w.util.setEnumType(ut,"google.protobuf.NullValue",[{no:0,name:"NULL_VALUE"}]);class gt extends G.v{constructor(r){super(),this.fields={},l.w.util.initPartial(r,this)}toJson(r){const o={};for(const[h,g]of Object.entries(this.fields))o[h]=g.toJson(r);return o}fromJson(r,o){if(typeof r!="object"||r==null||Array.isArray(r))throw new Error("cannot decode google.protobuf.Struct from JSON "+l.w.json.debug(r));for(const[h,g]of Object.entries(r))this.fields[h]=Be.fromJson(g);return this}static fromBinary(r,o){return new gt().fromBinary(r,o)}static fromJson(r,o){return new gt().fromJson(r,o)}static fromJsonString(r,o){return new gt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(gt,r,o)}}gt.runtime=l.w,gt.typeName="google.protobuf.Struct",gt.fields=l.w.util.newFieldList(()=>[{no:1,name:"fields",kind:"map",K:9,V:{kind:"message",T:Be}}]);class Be extends G.v{constructor(r){super(),this.kind={case:void 0},l.w.util.initPartial(r,this)}toJson(r){switch(this.kind.case){case"nullValue":return null;case"numberValue":if(!Number.isFinite(this.kind.value))throw new Error("google.protobuf.Value cannot be NaN or Infinity");return this.kind.value;case"boolValue":return this.kind.value;case"stringValue":return this.kind.value;case"structValue":case"listValue":return this.kind.value.toJson(Object.assign(Object.assign({},r),{emitDefaultValues:!0}))}throw new Error("google.protobuf.Value must have a value")}fromJson(r,o){switch(typeof r){case"number":this.kind={case:"numberValue",value:r};break;case"string":this.kind={case:"stringValue",value:r};break;case"boolean":this.kind={case:"boolValue",value:r};break;case"object":r===null?this.kind={case:"nullValue",value:ut.NULL_VALUE}:Array.isArray(r)?this.kind={case:"listValue",value:ct.fromJson(r)}:this.kind={case:"structValue",value:gt.fromJson(r)};break;default:throw new Error("cannot decode google.protobuf.Value from JSON "+l.w.json.debug(r))}return this}static fromBinary(r,o){return new Be().fromBinary(r,o)}static fromJson(r,o){return new Be().fromJson(r,o)}static fromJsonString(r,o){return new Be().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Be,r,o)}}Be.runtime=l.w,Be.typeName="google.protobuf.Value",Be.fields=l.w.util.newFieldList(()=>[{no:1,name:"null_value",kind:"enum",T:l.w.getEnumType(ut),oneof:"kind"},{no:2,name:"number_value",kind:"scalar",T:1,oneof:"kind"},{no:3,name:"string_value",kind:"scalar",T:9,oneof:"kind"},{no:4,name:"bool_value",kind:"scalar",T:8,oneof:"kind"},{no:5,name:"struct_value",kind:"message",T:gt,oneof:"kind"},{no:6,name:"list_value",kind:"message",T:ct,oneof:"kind"}]);class ct extends G.v{constructor(r){super(),this.values=[],l.w.util.initPartial(r,this)}toJson(r){return this.values.map(o=>o.toJson())}fromJson(r,o){if(!Array.isArray(r))throw new Error("cannot decode google.protobuf.ListValue from JSON "+l.w.json.debug(r));for(let h of r)this.values.push(Be.fromJson(h));return this}static fromBinary(r,o){return new ct().fromBinary(r,o)}static fromJson(r,o){return new ct().fromJson(r,o)}static fromJsonString(r,o){return new ct().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(ct,r,o)}}ct.runtime=l.w,ct.typeName="google.protobuf.ListValue",ct.fields=l.w.util.newFieldList(()=>[{no:1,name:"values",kind:"message",T:Be,repeated:!0}]);var hn=p(609);class Nt extends G.v{constructor(r){super(),this.value=0,l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.DOUBLE,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.DOUBLE,r)}catch(h){let g='cannot decode message google.protobuf.DoubleValue from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new Nt().fromBinary(r,o)}static fromJson(r,o){return new Nt().fromJson(r,o)}static fromJsonString(r,o){return new Nt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Nt,r,o)}}Nt.runtime=l.w,Nt.typeName="google.protobuf.DoubleValue",Nt.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:1}]),Nt.fieldWrapper={wrapField(a){return new Nt({value:a})},unwrapField(a){return a.value}};class pt extends G.v{constructor(r){super(),this.value=0,l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.FLOAT,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.FLOAT,r)}catch(h){let g='cannot decode message google.protobuf.FloatValue from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new pt().fromBinary(r,o)}static fromJson(r,o){return new pt().fromJson(r,o)}static fromJsonString(r,o){return new pt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(pt,r,o)}}pt.runtime=l.w,pt.typeName="google.protobuf.FloatValue",pt.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:2}]),pt.fieldWrapper={wrapField(a){return new pt({value:a})},unwrapField(a){return a.value}};class rt extends G.v{constructor(r){super(),this.value=w.q.zero,l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.INT64,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.INT64,r)}catch(h){let g='cannot decode message google.protobuf.Int64Value from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new rt().fromBinary(r,o)}static fromJson(r,o){return new rt().fromJson(r,o)}static fromJsonString(r,o){return new rt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(rt,r,o)}}rt.runtime=l.w,rt.typeName="google.protobuf.Int64Value",rt.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:3}]),rt.fieldWrapper={wrapField(a){return new rt({value:a})},unwrapField(a){return a.value}};class Oe extends G.v{constructor(r){super(),this.value=w.q.zero,l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.UINT64,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.UINT64,r)}catch(h){let g='cannot decode message google.protobuf.UInt64Value from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new Oe().fromBinary(r,o)}static fromJson(r,o){return new Oe().fromJson(r,o)}static fromJsonString(r,o){return new Oe().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Oe,r,o)}}Oe.runtime=l.w,Oe.typeName="google.protobuf.UInt64Value",Oe.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:4}]),Oe.fieldWrapper={wrapField(a){return new Oe({value:a})},unwrapField(a){return a.value}};class _e extends G.v{constructor(r){super(),this.value=0,l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.INT32,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.INT32,r)}catch(h){let g='cannot decode message google.protobuf.Int32Value from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new _e().fromBinary(r,o)}static fromJson(r,o){return new _e().fromJson(r,o)}static fromJsonString(r,o){return new _e().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(_e,r,o)}}_e.runtime=l.w,_e.typeName="google.protobuf.Int32Value",_e.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:5}]),_e.fieldWrapper={wrapField(a){return new _e({value:a})},unwrapField(a){return a.value}};class Me extends G.v{constructor(r){super(),this.value=0,l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.UINT32,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.UINT32,r)}catch(h){let g='cannot decode message google.protobuf.UInt32Value from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new Me().fromBinary(r,o)}static fromJson(r,o){return new Me().fromJson(r,o)}static fromJsonString(r,o){return new Me().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Me,r,o)}}Me.runtime=l.w,Me.typeName="google.protobuf.UInt32Value",Me.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:13}]),Me.fieldWrapper={wrapField(a){return new Me({value:a})},unwrapField(a){return a.value}};class bt extends G.v{constructor(r){super(),this.value=!1,l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.BOOL,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.BOOL,r)}catch(h){let g='cannot decode message google.protobuf.BoolValue from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new bt().fromBinary(r,o)}static fromJson(r,o){return new bt().fromJson(r,o)}static fromJsonString(r,o){return new bt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(bt,r,o)}}bt.runtime=l.w,bt.typeName="google.protobuf.BoolValue",bt.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:8}]),bt.fieldWrapper={wrapField(a){return new bt({value:a})},unwrapField(a){return a.value}};class st extends G.v{constructor(r){super(),this.value="",l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.STRING,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.STRING,r)}catch(h){let g='cannot decode message google.protobuf.StringValue from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new st().fromBinary(r,o)}static fromJson(r,o){return new st().fromJson(r,o)}static fromJsonString(r,o){return new st().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(st,r,o)}}st.runtime=l.w,st.typeName="google.protobuf.StringValue",st.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9}]),st.fieldWrapper={wrapField(a){return new st({value:a})},unwrapField(a){return a.value}};class se extends G.v{constructor(r){super(),this.value=new Uint8Array(0),l.w.util.initPartial(r,this)}toJson(r){return l.w.json.writeScalar(m.w.BYTES,this.value,!0)}fromJson(r,o){try{this.value=l.w.json.readScalar(m.w.BYTES,r)}catch(h){let g='cannot decode message google.protobuf.BytesValue from JSON"';throw h instanceof Error&&h.message.length>0&&(g+=`: ${h.message}`),new Error(g)}return this}static fromBinary(r,o){return new se().fromBinary(r,o)}static fromJson(r,o){return new se().fromJson(r,o)}static fromJsonString(r,o){return new se().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(se,r,o)}}se.runtime=l.w,se.typeName="google.protobuf.BytesValue",se.fields=l.w.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:12}]),se.fieldWrapper={wrapField(a){return new se({value:a})},unwrapField(a){return a.value}};const xe=[Gn.I,Pe,sn,on,gt,Be,ct,xt,Pe,Nt,pt,rt,_e,Me,Oe,bt,st,se],zn=[(0,hn.V3)(ut)];function Jn(a,r=!0){const o=a instanceof Uint8Array||a instanceof ue?ir(a):a,h={},g={},E={};if(r){for(const b of xe)g[b.typeName]=b;for(const b of zn)h[b.typeName]=b}return{findEnum(b){const M=h[b];if(M)return M;const A=o.enums.get(b);if(!A)return;const Z=(A.file.syntax=="proto3"?l.w:f).makeEnumType(b,A.values.map(ce=>({no:ce.number,name:ce.name,localName:(0,T.r1)(ce)})),{});return h[b]=Z,Z},findMessage(b){const M=g[b];if(M)return M;const A=o.messages.get(b);if(!A)return;const K=A.file.syntax=="proto3"?l.w:f,Z=[],ce=K.makeMessageType(b,()=>Z,{localName:(0,T.r1)(A)});g[b]=ce;for(const De of A.fields){const fe=St(De,this);Z.push(fe)}return ce},findService(b){const M=E[b];if(M)return M;const A=o.services.get(b);if(!A)return;const K={};for(const Z of A.methods){const ce=this.findMessage(Z.input.typeName),De=this.findMessage(Z.output.typeName);(0,I.hu)(ce,`message "${Z.input.typeName}" for ${Z.toString()} not found`),(0,I.hu)(De,`output message "${Z.output.typeName}" for ${Z.toString()} not found`),K[(0,T.r1)(Z)]={name:Z.name,I:ce,O:De,kind:Z.methodKind,idempotency:Z.idempotency}}return E[b]={typeName:A.typeName,methods:K}}}}function St(a,r){switch(a.fieldKind){case"map":return mn(a,r);case"message":return Fn(a,r);case"enum":{const o=gn(a,r);return o.default=a.getDefaultValue(),o}case"scalar":{const o=wn(a);return o.default=a.getDefaultValue(),o}}}function mn(a,r){const o={kind:"map",no:a.number,name:a.name,jsonName:a.jsonName,K:a.mapKey};if(a.mapValue.message){const h=r.findMessage(a.mapValue.message.typeName);return(0,I.hu)(h,`message "${a.mapValue.message.typeName}" for ${a.toString()} not found`),Object.assign(Object.assign({},o),{V:{kind:"message",T:h}})}if(a.mapValue.enum){const h=r.findEnum(a.mapValue.enum.typeName);return(0,I.hu)(h,`enum "${a.mapValue.enum.typeName}" for ${a.toString()} not found`),Object.assign(Object.assign({},o),{V:{kind:"enum",T:h}})}return Object.assign(Object.assign({},o),{V:{kind:"scalar",T:a.mapValue.scalar}})}function wn(a){const r=a.longType==m.p.STRING?{L:m.p.STRING}:{},o=Object.assign({kind:"scalar",no:a.number,name:a.name,jsonName:a.jsonName,T:a.scalar},r);return a.repeated?Object.assign(Object.assign({},o),{repeated:!0,packed:a.packed,oneof:void 0,T:a.scalar}):a.oneof?Object.assign(Object.assign({},o),{oneof:a.oneof.name}):a.optional?Object.assign(Object.assign({},o),{opt:!0}):o}function Fn(a,r){const o=r.findMessage(a.message.typeName);(0,I.hu)(o,`message "${a.message.typeName}" for ${a.toString()} not found`);const h={kind:"message",no:a.number,name:a.name,jsonName:a.jsonName,T:o,delimited:a.proto.type==le.GROUP};return a.repeated?Object.assign(Object.assign({},h),{repeated:!0,packed:a.packed,oneof:void 0}):a.oneof?Object.assign(Object.assign({},h),{oneof:a.oneof.name}):a.optional?Object.assign(Object.assign({},h),{opt:!0}):h}function gn(a,r){const o=r.findEnum(a.enum.typeName);(0,I.hu)(o,`enum "${a.enum.typeName}" for ${a.toString()} not found`);const h={kind:"enum",no:a.number,name:a.name,jsonName:a.jsonName,T:o};return a.repeated?Object.assign(Object.assign({},h),{repeated:!0,packed:a.packed,oneof:void 0}):a.oneof?Object.assign(Object.assign({},h),{oneof:a.oneof.name}):a.optional?Object.assign(Object.assign({},h),{opt:!0}):h}function Xn(a){if(!(a instanceof G.v))return a;const r=a.getType(),o={};for(const h of r.fields.byMember()){const g=a[h.localName];let E;if(h.repeated)E=g.map(b=>jt(b));else if(h.kind=="map"){E={};for(const[b,M]of Object.entries(g))E[b]=jt(M)}else h.kind=="oneof"?E=h.findField(g.case)?{case:g.case,value:jt(g.value)}:{case:void 0}:E=jt(g);o[h.localName]=E}return o}function jt(a){if(a===void 0)return a;if(a instanceof G.v)return Xn(a);if(a instanceof Uint8Array){const r=new Uint8Array(a.byteLength);return r.set(a),r}return a}class It extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new It().fromBinary(r,o)}static fromJson(r,o){return new It().fromJson(r,o)}static fromJsonString(r,o){return new It().fromJsonString(r,o)}static equals(r,o){return f.util.equals(It,r,o)}}It.runtime=f,It.typeName="google.protobuf.compiler.Version",It.fields=f.util.newFieldList(()=>[{no:1,name:"major",kind:"scalar",T:5,opt:!0},{no:2,name:"minor",kind:"scalar",T:5,opt:!0},{no:3,name:"patch",kind:"scalar",T:5,opt:!0},{no:4,name:"suffix",kind:"scalar",T:9,opt:!0}]);class kt extends G.v{constructor(r){super(),this.fileToGenerate=[],this.protoFile=[],this.sourceFileDescriptors=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new kt().fromBinary(r,o)}static fromJson(r,o){return new kt().fromJson(r,o)}static fromJsonString(r,o){return new kt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(kt,r,o)}}kt.runtime=f,kt.typeName="google.protobuf.compiler.CodeGeneratorRequest",kt.fields=f.util.newFieldList(()=>[{no:1,name:"file_to_generate",kind:"scalar",T:9,repeated:!0},{no:2,name:"parameter",kind:"scalar",T:9,opt:!0},{no:15,name:"proto_file",kind:"message",T:Ie,repeated:!0},{no:17,name:"source_file_descriptors",kind:"message",T:Ie,repeated:!0},{no:3,name:"compiler_version",kind:"message",T:It,opt:!0}]);class Ge extends G.v{constructor(r){super(),this.file=[],f.util.initPartial(r,this)}static fromBinary(r,o){return new Ge().fromBinary(r,o)}static fromJson(r,o){return new Ge().fromJson(r,o)}static fromJsonString(r,o){return new Ge().fromJsonString(r,o)}static equals(r,o){return f.util.equals(Ge,r,o)}}Ge.runtime=f,Ge.typeName="google.protobuf.compiler.CodeGeneratorResponse",Ge.fields=f.util.newFieldList(()=>[{no:1,name:"error",kind:"scalar",T:9,opt:!0},{no:2,name:"supported_features",kind:"scalar",T:4,opt:!0},{no:15,name:"file",kind:"message",T:yt,repeated:!0}]);var pn;(function(a){a[a.NONE=0]="NONE",a[a.PROTO3_OPTIONAL=1]="PROTO3_OPTIONAL",a[a.SUPPORTS_EDITIONS=2]="SUPPORTS_EDITIONS"})(pn||(pn={})),f.util.setEnumType(pn,"google.protobuf.compiler.CodeGeneratorResponse.Feature",[{no:0,name:"FEATURE_NONE"},{no:1,name:"FEATURE_PROTO3_OPTIONAL"},{no:2,name:"FEATURE_SUPPORTS_EDITIONS"}]);class yt extends G.v{constructor(r){super(),f.util.initPartial(r,this)}static fromBinary(r,o){return new yt().fromBinary(r,o)}static fromJson(r,o){return new yt().fromJson(r,o)}static fromJsonString(r,o){return new yt().fromJsonString(r,o)}static equals(r,o){return f.util.equals(yt,r,o)}}yt.runtime=f,yt.typeName="google.protobuf.compiler.CodeGeneratorResponse.File",yt.fields=f.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"insertion_point",kind:"scalar",T:9,opt:!0},{no:15,name:"content",kind:"scalar",T:9,opt:!0},{no:16,name:"generated_code_info",kind:"message",T:Jt,opt:!0}]);class Lt extends G.v{constructor(r){super(),this.fileName="",l.w.util.initPartial(r,this)}static fromBinary(r,o){return new Lt().fromBinary(r,o)}static fromJson(r,o){return new Lt().fromJson(r,o)}static fromJsonString(r,o){return new Lt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Lt,r,o)}}Lt.runtime=l.w,Lt.typeName="google.protobuf.SourceContext",Lt.fields=l.w.util.newFieldList(()=>[{no:1,name:"file_name",kind:"scalar",T:9}]);var Bt;(function(a){a[a.PROTO2=0]="PROTO2",a[a.PROTO3=1]="PROTO3",a[a.EDITIONS=2]="EDITIONS"})(Bt||(Bt={})),l.w.util.setEnumType(Bt,"google.protobuf.Syntax",[{no:0,name:"SYNTAX_PROTO2"},{no:1,name:"SYNTAX_PROTO3"},{no:2,name:"SYNTAX_EDITIONS"}]);class tt extends G.v{constructor(r){super(),this.name="",this.fields=[],this.oneofs=[],this.options=[],this.syntax=Bt.PROTO2,this.edition="",l.w.util.initPartial(r,this)}static fromBinary(r,o){return new tt().fromBinary(r,o)}static fromJson(r,o){return new tt().fromJson(r,o)}static fromJsonString(r,o){return new tt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(tt,r,o)}}tt.runtime=l.w,tt.typeName="google.protobuf.Type",tt.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"fields",kind:"message",T:At,repeated:!0},{no:3,name:"oneofs",kind:"scalar",T:9,repeated:!0},{no:4,name:"options",kind:"message",T:nt,repeated:!0},{no:5,name:"source_context",kind:"message",T:Lt},{no:6,name:"syntax",kind:"enum",T:l.w.getEnumType(Bt)},{no:7,name:"edition",kind:"scalar",T:9}]);class At extends G.v{constructor(r){super(),this.kind=An.TYPE_UNKNOWN,this.cardinality=On.UNKNOWN,this.number=0,this.name="",this.typeUrl="",this.oneofIndex=0,this.packed=!1,this.options=[],this.jsonName="",this.defaultValue="",l.w.util.initPartial(r,this)}static fromBinary(r,o){return new At().fromBinary(r,o)}static fromJson(r,o){return new At().fromJson(r,o)}static fromJsonString(r,o){return new At().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(At,r,o)}}At.runtime=l.w,At.typeName="google.protobuf.Field",At.fields=l.w.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:l.w.getEnumType(An)},{no:2,name:"cardinality",kind:"enum",T:l.w.getEnumType(On)},{no:3,name:"number",kind:"scalar",T:5},{no:4,name:"name",kind:"scalar",T:9},{no:6,name:"type_url",kind:"scalar",T:9},{no:7,name:"oneof_index",kind:"scalar",T:5},{no:8,name:"packed",kind:"scalar",T:8},{no:9,name:"options",kind:"message",T:nt,repeated:!0},{no:10,name:"json_name",kind:"scalar",T:9},{no:11,name:"default_value",kind:"scalar",T:9}]);var An;(function(a){a[a.TYPE_UNKNOWN=0]="TYPE_UNKNOWN",a[a.TYPE_DOUBLE=1]="TYPE_DOUBLE",a[a.TYPE_FLOAT=2]="TYPE_FLOAT",a[a.TYPE_INT64=3]="TYPE_INT64",a[a.TYPE_UINT64=4]="TYPE_UINT64",a[a.TYPE_INT32=5]="TYPE_INT32",a[a.TYPE_FIXED64=6]="TYPE_FIXED64",a[a.TYPE_FIXED32=7]="TYPE_FIXED32",a[a.TYPE_BOOL=8]="TYPE_BOOL",a[a.TYPE_STRING=9]="TYPE_STRING",a[a.TYPE_GROUP=10]="TYPE_GROUP",a[a.TYPE_MESSAGE=11]="TYPE_MESSAGE",a[a.TYPE_BYTES=12]="TYPE_BYTES",a[a.TYPE_UINT32=13]="TYPE_UINT32",a[a.TYPE_ENUM=14]="TYPE_ENUM",a[a.TYPE_SFIXED32=15]="TYPE_SFIXED32",a[a.TYPE_SFIXED64=16]="TYPE_SFIXED64",a[a.TYPE_SINT32=17]="TYPE_SINT32",a[a.TYPE_SINT64=18]="TYPE_SINT64"})(An||(An={})),l.w.util.setEnumType(An,"google.protobuf.Field.Kind",[{no:0,name:"TYPE_UNKNOWN"},{no:1,name:"TYPE_DOUBLE"},{no:2,name:"TYPE_FLOAT"},{no:3,name:"TYPE_INT64"},{no:4,name:"TYPE_UINT64"},{no:5,name:"TYPE_INT32"},{no:6,name:"TYPE_FIXED64"},{no:7,name:"TYPE_FIXED32"},{no:8,name:"TYPE_BOOL"},{no:9,name:"TYPE_STRING"},{no:10,name:"TYPE_GROUP"},{no:11,name:"TYPE_MESSAGE"},{no:12,name:"TYPE_BYTES"},{no:13,name:"TYPE_UINT32"},{no:14,name:"TYPE_ENUM"},{no:15,name:"TYPE_SFIXED32"},{no:16,name:"TYPE_SFIXED64"},{no:17,name:"TYPE_SINT32"},{no:18,name:"TYPE_SINT64"}]);var On;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.OPTIONAL=1]="OPTIONAL",a[a.REQUIRED=2]="REQUIRED",a[a.REPEATED=3]="REPEATED"})(On||(On={})),l.w.util.setEnumType(On,"google.protobuf.Field.Cardinality",[{no:0,name:"CARDINALITY_UNKNOWN"},{no:1,name:"CARDINALITY_OPTIONAL"},{no:2,name:"CARDINALITY_REQUIRED"},{no:3,name:"CARDINALITY_REPEATED"}]);class be extends G.v{constructor(r){super(),this.name="",this.enumvalue=[],this.options=[],this.syntax=Bt.PROTO2,this.edition="",l.w.util.initPartial(r,this)}static fromBinary(r,o){return new be().fromBinary(r,o)}static fromJson(r,o){return new be().fromJson(r,o)}static fromJsonString(r,o){return new be().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(be,r,o)}}be.runtime=l.w,be.typeName="google.protobuf.Enum",be.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"enumvalue",kind:"message",T:qt,repeated:!0},{no:3,name:"options",kind:"message",T:nt,repeated:!0},{no:4,name:"source_context",kind:"message",T:Lt},{no:5,name:"syntax",kind:"enum",T:l.w.getEnumType(Bt)},{no:6,name:"edition",kind:"scalar",T:9}]);class qt extends G.v{constructor(r){super(),this.name="",this.number=0,this.options=[],l.w.util.initPartial(r,this)}static fromBinary(r,o){return new qt().fromBinary(r,o)}static fromJson(r,o){return new qt().fromJson(r,o)}static fromJsonString(r,o){return new qt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(qt,r,o)}}qt.runtime=l.w,qt.typeName="google.protobuf.EnumValue",qt.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"number",kind:"scalar",T:5},{no:3,name:"options",kind:"message",T:nt,repeated:!0}]);class nt extends G.v{constructor(r){super(),this.name="",l.w.util.initPartial(r,this)}static fromBinary(r,o){return new nt().fromBinary(r,o)}static fromJson(r,o){return new nt().fromJson(r,o)}static fromJsonString(r,o){return new nt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(nt,r,o)}}nt.runtime=l.w,nt.typeName="google.protobuf.Option",nt.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"value",kind:"message",T:Gn.I}]);class Yt extends G.v{constructor(r){super(),this.name="",this.methods=[],this.options=[],this.version="",this.mixins=[],this.syntax=Bt.PROTO2,l.w.util.initPartial(r,this)}static fromBinary(r,o){return new Yt().fromBinary(r,o)}static fromJson(r,o){return new Yt().fromJson(r,o)}static fromJsonString(r,o){return new Yt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Yt,r,o)}}Yt.runtime=l.w,Yt.typeName="google.protobuf.Api",Yt.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"methods",kind:"message",T:Mt,repeated:!0},{no:3,name:"options",kind:"message",T:nt,repeated:!0},{no:4,name:"version",kind:"scalar",T:9},{no:5,name:"source_context",kind:"message",T:Lt},{no:6,name:"mixins",kind:"message",T:Kt,repeated:!0},{no:7,name:"syntax",kind:"enum",T:l.w.getEnumType(Bt)}]);class Mt extends G.v{constructor(r){super(),this.name="",this.requestTypeUrl="",this.requestStreaming=!1,this.responseTypeUrl="",this.responseStreaming=!1,this.options=[],this.syntax=Bt.PROTO2,l.w.util.initPartial(r,this)}static fromBinary(r,o){return new Mt().fromBinary(r,o)}static fromJson(r,o){return new Mt().fromJson(r,o)}static fromJsonString(r,o){return new Mt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Mt,r,o)}}Mt.runtime=l.w,Mt.typeName="google.protobuf.Method",Mt.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"request_type_url",kind:"scalar",T:9},{no:3,name:"request_streaming",kind:"scalar",T:8},{no:4,name:"response_type_url",kind:"scalar",T:9},{no:5,name:"response_streaming",kind:"scalar",T:8},{no:6,name:"options",kind:"message",T:nt,repeated:!0},{no:7,name:"syntax",kind:"enum",T:l.w.getEnumType(Bt)}]);class Kt extends G.v{constructor(r){super(),this.name="",this.root="",l.w.util.initPartial(r,this)}static fromBinary(r,o){return new Kt().fromBinary(r,o)}static fromJson(r,o){return new Kt().fromJson(r,o)}static fromJsonString(r,o){return new Kt().fromJsonString(r,o)}static equals(r,o){return l.w.util.equals(Kt,r,o)}}Kt.runtime=l.w,Kt.typeName="google.protobuf.Mixin",Kt.fields=l.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"root",kind:"scalar",T:9}])},561:(re,C,p)=>{p.d(C,{v:()=>l});class l{equals(m){return this.getType().runtime.util.equals(this.getType(),this,m)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(m,x){const N=this.getType(),L=N.runtime.bin,R=L.makeReadOptions(x);return L.readMessage(this,R.readerFactory(m),m.byteLength,R),this}fromJson(m,x){const N=this.getType(),L=N.runtime.json,R=L.makeReadOptions(x);return L.readMessage(N,m,R,this),this}fromJsonString(m,x){let N;try{N=JSON.parse(m)}catch(L){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${L instanceof Error?L.message:String(L)}`)}return this.fromJson(N,x)}toBinary(m){const x=this.getType(),N=x.runtime.bin,L=N.makeWriteOptions(m),R=L.writerFactory();return N.writeMessage(this,R,L),R.finish()}toJson(m){const x=this.getType(),N=x.runtime.json,L=N.makeWriteOptions(m);return N.writeMessage(this,L)}toJsonString(m){var x;const N=this.toJson(m);return JSON.stringify(N,null,(x=m==null?void 0:m.prettySpaces)!==null&&x!==void 0?x:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}},120:(re,C,p)=>{p.d(C,{E_:()=>T,fp:()=>y,hu:()=>l,ug:()=>R});function l(O,I){if(!O)throw new Error(I)}const D=34028234663852886e22,m=-34028234663852886e22,x=4294967295,N=2147483647,L=-2147483648;function R(O){if(typeof O!="number")throw new Error("invalid int 32: "+typeof O);if(!Number.isInteger(O)||O>N||O<L)throw new Error("invalid int 32: "+O)}function y(O){if(typeof O!="number")throw new Error("invalid uint 32: "+typeof O);if(!Number.isInteger(O)||O>x||O<0)throw new Error("invalid uint 32: "+O)}function T(O){if(typeof O!="number")throw new Error("invalid float 32: "+typeof O);if(!!Number.isFinite(O)&&(O>D||O<m))throw new Error("invalid float 32: "+O)}},744:(re,C,p)=>{p.d(C,{Jj:()=>W,NN:()=>V,gQ:()=>w,gY:()=>j,oQ:()=>B});var l=p(79),D=p(561),m=p(465),x=p(432),N=p(781),L=p(120);const R=Symbol("@bufbuild/protobuf/unknown-fields"),y={readUnknownFields:!0,readerFactory:P=>new l.oP(P)},T={writeUnknownFields:!0,writerFactory:()=>new l.Lt};function O(P){return P?Object.assign(Object.assign({},y),P):y}function I(P){return P?Object.assign(Object.assign({},T),P):T}function j(){return{makeReadOptions:O,makeWriteOptions:I,listUnknownFields(P){var $;return($=P[R])!==null&&$!==void 0?$:[]},discardUnknownFields(P){delete P[R]},writeUnknownFields(P,$){const H=P[R];if(H)for(const q of H)$.tag(q.no,q.wireType).raw(q.data)},onUnknownField(P,$,X,H){const q=P;Array.isArray(q[R])||(q[R]=[]),q[R].push({no:$,wireType:X,data:H})},readMessage(P,$,X,H,q){const ee=P.getType(),Se=q?$.len:$.pos+X;let G,ve;for(;$.pos<Se&&([G,ve]=$.tag(),ve!=l.TD.EndGroup);){const ne=ee.fields.find(G);if(!ne){const Ce=$.skip(ve);H.readUnknownFields&&this.onUnknownField(P,G,ve,Ce);continue}let ue=P,Ie=ne.repeated,we=ne.localName;switch(ne.oneof&&(ue=ue[ne.oneof.localName],ue.case!=we&&delete ue.value,ue.case=we,we="value"),ne.kind){case"scalar":case"enum":const Ce=ne.kind=="enum"?m.w.INT32:ne.T;let je=_;if(ne.kind=="scalar"&&ne.L>0&&(je=U),Ie){let He=ue[we];if(ve==l.TD.LengthDelimited&&Ce!=m.w.STRING&&Ce!=m.w.BYTES){let le=$.uint32()+$.pos;for(;$.pos<le;)He.push(je($,Ce))}else He.push(je($,Ce))}else ue[we]=je($,Ce);break;case"message":const Le=ne.T;Ie?ue[we].push(S($,new Le,H,ne)):ue[we]instanceof D.v?S($,ue[we],H,ne):(ue[we]=S($,new Le,H,ne),Le.fieldWrapper&&!ne.oneof&&!ne.repeated&&(ue[we]=Le.fieldWrapper.unwrapField(ue[we])));break;case"map":let[ft,dt]=f(ne,$,H);ue[we][ft]=dt;break}}if(q&&(ve!=l.TD.EndGroup||G!==X))throw new Error("invalid end group tag")}}}function S(P,$,X,H){const q=$.getType().runtime.bin,ee=H==null?void 0:H.delimited;return q.readMessage($,P,ee?H==null?void 0:H.no:P.uint32(),X,ee),$}function f(P,$,X){const H=$.uint32(),q=$.pos+H;let ee,Se;for(;$.pos<q;){let[G]=$.tag();switch(G){case 1:ee=_($,P.K);break;case 2:switch(P.V.kind){case"scalar":Se=_($,P.V.T);break;case"enum":Se=$.int32();break;case"message":Se=S($,new P.V.T,X,void 0);break}break}}if(ee===void 0){let G=(0,N.kY)(P.K,m.p.BIGINT);ee=P.K==m.w.BOOL?G.toString():G}if(typeof ee!="string"&&typeof ee!="number"&&(ee=ee.toString()),Se===void 0)switch(P.V.kind){case"scalar":Se=(0,N.kY)(P.V.T,m.p.BIGINT);break;case"enum":Se=0;break;case"message":Se=new P.V.T;break}return[ee,Se]}function U(P,$){const X=_(P,$);return typeof X=="bigint"?X.toString():X}function _(P,$){switch($){case m.w.STRING:return P.string();case m.w.BOOL:return P.bool();case m.w.DOUBLE:return P.double();case m.w.FLOAT:return P.float();case m.w.INT32:return P.int32();case m.w.INT64:return P.int64();case m.w.UINT64:return P.uint64();case m.w.FIXED64:return P.fixed64();case m.w.BYTES:return P.bytes();case m.w.FIXED32:return P.fixed32();case m.w.SFIXED32:return P.sfixed32();case m.w.SFIXED64:return P.sfixed64();case m.w.SINT64:return P.sint64();case m.w.UINT32:return P.uint32();case m.w.SINT32:return P.sint32()}}function w(P,$,X,H,q){P.tag(X.no,l.TD.LengthDelimited),P.fork();let ee=H;switch(X.K){case m.w.INT32:case m.w.FIXED32:case m.w.UINT32:case m.w.SFIXED32:case m.w.SINT32:ee=Number.parseInt(H);break;case m.w.BOOL:(0,L.hu)(H=="true"||H=="false"),ee=H=="true";break}switch(V(P,X.K,1,ee,!0),X.V.kind){case"scalar":V(P,X.V.T,2,q,!0);break;case"enum":V(P,m.w.INT32,2,q,!0);break;case"message":P.tag(2,l.TD.LengthDelimited).bytes(q.toBinary($));break}P.join()}function B(P,$,X,H){if(H!==void 0){const q=(0,x.E)(X.T,H);X!=null&&X.delimited?P.tag(X.no,l.TD.StartGroup).raw(q.toBinary($)).tag(X.no,l.TD.EndGroup):P.tag(X.no,l.TD.LengthDelimited).bytes(q.toBinary($))}}function V(P,$,X,H,q){let[ee,Se,G]=(0,N.T1)($,H);(!G||q)&&P.tag(X,ee)[Se](H)}function W(P,$,X,H){if(!H.length)return;P.tag(X,l.TD.LengthDelimited).fork();let[,q]=(0,N.T1)($);for(let ee=0;ee<H.length;ee++)P[q](H[ee]);P.join()}},609:(re,C,p)=>{p.d(C,{V3:()=>m,be:()=>N,ut:()=>L,zg:()=>x});var l=p(120);const D=Symbol("@bufbuild/protobuf/enum-type");function m(y){const T=y[D];return(0,l.hu)(T,"missing enum type on enum object"),T}function x(y,T,O,I){y[D]=N(T,O.map(j=>({no:j.no,name:j.name,localName:y[j.no]})))}function N(y,T,O){const I=Object.create(null),j=Object.create(null),S=[];for(const f of T){const U=R(f);S.push(U),I[f.name]=U,j[f.no]=U}return{typeName:y,values:S,findName(f){return I[f]},findNumber(f){return j[f]}}}function L(y,T,O){const I={};for(const j of T){const S=R(j);I[S.localName]=S.no,I[S.no]=S.localName}return x(I,y,T),I}function R(y){return"localName"in y?y:Object.assign(Object.assign({},y),{localName:y.name})}},501:(re,C,p)=>{p.d(C,{i:()=>l});class l{constructor(m,x){this._fields=m,this._normalizer=x}findJsonName(m){if(!this.jsonNames){const x={};for(const N of this.list())x[N.jsonName]=x[N.name]=N;this.jsonNames=x}return this.jsonNames[m]}find(m){if(!this.numbers){const x={};for(const N of this.list())x[N.no]=N;this.numbers=x}return this.numbers[m]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((m,x)=>m.no-x.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const m=this.members;let x;for(const N of this.list())N.oneof?N.oneof!==x&&(x=N.oneof,m.push(x)):m.push(N)}return this.members}}},432:(re,C,p)=>{p.d(C,{E:()=>m,w:()=>x});var l=p(561),D=p(465);function m(L,R){return R instanceof l.v||!L.fieldWrapper?R:L.fieldWrapper.wrapField(R)}function x(L){if(L.fieldKind==="message"&&!L.repeated&&L.oneof==null)return N[L.message.typeName]}const N={"google.protobuf.DoubleValue":D.w.DOUBLE,"google.protobuf.FloatValue":D.w.FLOAT,"google.protobuf.Int64Value":D.w.INT64,"google.protobuf.UInt64Value":D.w.UINT64,"google.protobuf.Int32Value":D.w.INT32,"google.protobuf.UInt32Value":D.w.UINT32,"google.protobuf.BoolValue":D.w.BOOL,"google.protobuf.StringValue":D.w.STRING,"google.protobuf.BytesValue":D.w.BYTES}},215:(re,C,p)=>{p.d(C,{o:()=>m});var l=p(504),D=p(120);class m{constructor(N){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=N,this.localName=(0,l.uA)(N)}addField(N){(0,D.hu)(N.oneof===this,`field ${N.name} not one of ${this.name}`),this.fields.push(N)}findField(N){if(!this._lookup){this._lookup=Object.create(null);for(let L=0;L<this.fields.length;L++)this._lookup[this.fields[L].localName]=this.fields[L]}return this._lookup[N]}}},814:(re,C,p)=>{p.d(C,{b:()=>O});var l=p(561),D=p(465),m=p(120),x=p(210),N=p(236);const L={ignoreUnknownFields:!1},R={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function y(_){return _?Object.assign(Object.assign({},L),_):L}function T(_){return _?Object.assign(Object.assign({},R),_):R}function O(_){const w=_(f,U);return{makeReadOptions:y,makeWriteOptions:T,readMessage(B,V,W,P){if(V==null||Array.isArray(V)||typeof V!="object")throw new Error(`cannot decode message ${B.typeName} from JSON: ${this.debug(V)}`);P=P!=null?P:new B;const $={};for(const[X,H]of Object.entries(V)){const q=B.fields.findJsonName(X);if(!q){if(!W.ignoreUnknownFields)throw new Error(`cannot decode message ${B.typeName} from JSON: key "${X}" is unknown`);continue}let ee=q.localName,Se=P;if(q.oneof){if(H===null&&q.kind=="scalar")continue;const G=$[q.oneof.localName];if(G)throw new Error(`cannot decode message ${B.typeName} from JSON: multiple keys for oneof "${q.oneof.name}" present: "${G}", "${X}"`);$[q.oneof.localName]=X,Se=Se[q.oneof.localName]={case:ee},ee="value"}if(q.repeated){if(H===null)continue;if(!Array.isArray(H))throw new Error(`cannot decode field ${B.typeName}.${q.name} from JSON: ${this.debug(H)}`);const G=Se[ee];for(const ve of H){if(ve===null)throw new Error(`cannot decode field ${B.typeName}.${q.name} from JSON: ${this.debug(ve)}`);let ne;switch(q.kind){case"message":ne=q.T.fromJson(ve,W);break;case"enum":if(ne=S(q.T,ve,W.ignoreUnknownFields),ne===void 0)continue;break;case"scalar":try{ne=j(q.T,ve,q.L)}catch(ue){let Ie=`cannot decode field ${B.typeName}.${q.name} from JSON: ${this.debug(ve)}`;throw ue instanceof Error&&ue.message.length>0&&(Ie+=`: ${ue.message}`),new Error(Ie)}break}G.push(ne)}}else if(q.kind=="map"){if(H===null)continue;if(Array.isArray(H)||typeof H!="object")throw new Error(`cannot decode field ${B.typeName}.${q.name} from JSON: ${this.debug(H)}`);const G=Se[ee];for(const[ve,ne]of Object.entries(H)){if(ne===null)throw new Error(`cannot decode field ${B.typeName}.${q.name} from JSON: map value null`);let ue;switch(q.V.kind){case"message":ue=q.V.T.fromJson(ne,W);break;case"enum":if(ue=S(q.V.T,ne,W.ignoreUnknownFields),ue===void 0)continue;break;case"scalar":try{ue=j(q.V.T,ne,D.p.BIGINT)}catch(Ie){let we=`cannot decode map value for field ${B.typeName}.${q.name} from JSON: ${this.debug(H)}`;throw Ie instanceof Error&&Ie.message.length>0&&(we+=`: ${Ie.message}`),new Error(we)}break}try{G[j(q.K,q.K==D.w.BOOL?ve=="true"?!0:ve=="false"?!1:ve:ve,D.p.BIGINT).toString()]=ue}catch(Ie){let we=`cannot decode map key for field ${B.typeName}.${q.name} from JSON: ${this.debug(H)}`;throw Ie instanceof Error&&Ie.message.length>0&&(we+=`: ${Ie.message}`),new Error(we)}}}else switch(q.kind){case"message":const G=q.T;if(H===null&&G.typeName!="google.protobuf.Value"){if(q.oneof)throw new Error(`cannot decode field ${B.typeName}.${q.name} from JSON: null is invalid for oneof field "${X}"`);continue}Se[ee]instanceof l.v?Se[ee].fromJson(H,W):(Se[ee]=G.fromJson(H,W),G.fieldWrapper&&!q.oneof&&(Se[ee]=G.fieldWrapper.unwrapField(Se[ee])));break;case"enum":const ve=S(q.T,H,W.ignoreUnknownFields);ve!==void 0&&(Se[ee]=ve);break;case"scalar":try{Se[ee]=j(q.T,H,q.L)}catch(ne){let ue=`cannot decode field ${B.typeName}.${q.name} from JSON: ${this.debug(H)}`;throw ne instanceof Error&&ne.message.length>0&&(ue+=`: ${ne.message}`),new Error(ue)}break}}return P},writeMessage(B,V){const W=B.getType(),P={};let $;try{for(const X of W.fields.byMember()){let H;if(X.kind=="oneof"){const q=B[X.localName];if(q.value===void 0)continue;if($=X.findField(q.case),!$)throw"oneof case not found: "+q.case;H=w($,q.value,V)}else $=X,H=w($,B[$.localName],V);H!==void 0&&(P[V.useProtoFieldName?$.name:$.jsonName]=H)}}catch(X){const H=$?`cannot encode field ${W.typeName}.${$.name} to JSON`:`cannot encode message ${W.typeName} to JSON`,q=X instanceof Error?X.message:String(X);throw new Error(H+(q.length>0?`: ${q}`:""))}return P},readScalar:j,writeScalar:U,debug:I}}function I(_){if(_===null)return"null";switch(typeof _){case"object":return Array.isArray(_)?"array":"object";case"string":return _.length>100?"string":`"${_.split('"').join('\\"')}"`;default:return String(_)}}function j(_,w,B){switch(_){case D.w.DOUBLE:case D.w.FLOAT:if(w===null)return 0;if(w==="NaN")return Number.NaN;if(w==="Infinity")return Number.POSITIVE_INFINITY;if(w==="-Infinity")return Number.NEGATIVE_INFINITY;if(w===""||typeof w=="string"&&w.trim().length!==w.length||typeof w!="string"&&typeof w!="number")break;const V=Number(w);if(Number.isNaN(V)||!Number.isFinite(V))break;return _==D.w.FLOAT&&(0,m.E_)(V),V;case D.w.INT32:case D.w.FIXED32:case D.w.SFIXED32:case D.w.SINT32:case D.w.UINT32:if(w===null)return 0;let W;if(typeof w=="number"?W=w:typeof w=="string"&&w.length>0&&w.trim().length===w.length&&(W=Number(w)),W===void 0)break;return _==D.w.UINT32?(0,m.fp)(W):(0,m.ug)(W),W;case D.w.INT64:case D.w.SFIXED64:case D.w.SINT64:if(w===null)return x.q.zero;if(typeof w!="number"&&typeof w!="string")break;const P=x.q.parse(w);return B?P.toString():P;case D.w.FIXED64:case D.w.UINT64:if(w===null)return x.q.zero;if(typeof w!="number"&&typeof w!="string")break;const $=x.q.uParse(w);return B?$.toString():$;case D.w.BOOL:if(w===null)return!1;if(typeof w!="boolean")break;return w;case D.w.STRING:if(w===null)return"";if(typeof w!="string")break;try{encodeURIComponent(w)}catch{throw new Error("invalid UTF8")}return w;case D.w.BYTES:if(w===null||w==="")return new Uint8Array(0);if(typeof w!="string")break;return N.W.dec(w)}throw new Error}function S(_,w,B){if(w===null)return 0;switch(typeof w){case"number":if(Number.isInteger(w))return w;break;case"string":const V=_.findName(w);if(V||B)return V==null?void 0:V.no;break}throw new Error(`cannot decode enum ${_.typeName} from JSON: ${I(w)}`)}function f(_,w,B,V){var W;if(w===void 0)return w;if(w===0&&!B)return;if(V)return w;if(_.typeName=="google.protobuf.NullValue")return null;const P=_.findNumber(w);return(W=P==null?void 0:P.name)!==null&&W!==void 0?W:w}function U(_,w,B){if(w!==void 0)switch(_){case D.w.INT32:case D.w.SFIXED32:case D.w.SINT32:case D.w.FIXED32:case D.w.UINT32:return(0,m.hu)(typeof w=="number"),w!=0||B?w:void 0;case D.w.FLOAT:case D.w.DOUBLE:return(0,m.hu)(typeof w=="number"),Number.isNaN(w)?"NaN":w===Number.POSITIVE_INFINITY?"Infinity":w===Number.NEGATIVE_INFINITY?"-Infinity":w!==0||B?w:void 0;case D.w.STRING:return(0,m.hu)(typeof w=="string"),w.length>0||B?w:void 0;case D.w.BOOL:return(0,m.hu)(typeof w=="boolean"),w||B?w:void 0;case D.w.UINT64:case D.w.FIXED64:case D.w.INT64:case D.w.SFIXED64:case D.w.SINT64:return(0,m.hu)(typeof w=="bigint"||typeof w=="string"||typeof w=="number"),B||w!=0?w.toString(10):void 0;case D.w.BYTES:return(0,m.hu)(w instanceof Uint8Array),B||w.byteLength>0?N.W.enc(w):void 0}}},504:(re,C,p)=>{p.d(C,{GD:()=>f,Rz:()=>D,Sm:()=>N,ll:()=>S,r1:()=>l,uA:()=>m,x1:()=>x});function l(U){switch(U.kind){case"field":return D(U.name,U.oneof!==void 0);case"oneof":return m(U.name);case"enum":case"message":case"service":{const _=U.file.proto.package,w=_===void 0?0:_.length+1,B=U.typeName.substring(w).replace(/\./g,"_");return S(f(B))}case"enum_value":{const _=U.parent.sharedPrefix;if(_===void 0)return U.name;const w=U.name.substring(_.length);return S(w)}case"rpc":{let _=U.name;return _.length==0?_:(_=_[0].toLowerCase()+_.substring(1),S(_))}}}function D(U,_){const w=R(U);return _?w:S(j(w))}function m(U){return D(U,!1)}const x=R;function N(U,_){const w=L(U)+"_";for(const B of _){if(!B.toLowerCase().startsWith(w))return;const V=B.substring(w.length);if(V.length==0||/^\d/.test(V))return}return w}function L(U){return(U.substring(0,1)+U.substring(1).replace(/[A-Z]/g,_=>"_"+_)).toLowerCase()}function R(U){let _=!1;const w=[];for(let B=0;B<U.length;B++){let V=U.charAt(B);switch(V){case"_":_=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":w.push(V),_=!1;break;default:_&&(_=!1,V=V.toUpperCase()),w.push(V);break}}return w.join("")}const y=new Set(["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","enum","implements","interface","let","package","private","protected","public","static","Object","bigint","number","boolean","string","object","globalThis","Uint8Array","Partial"]),T=new Set(["constructor","toString","toJSON","valueOf"]),O=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),I=U=>`${U}$`,j=U=>O.has(U)?I(U):U,S=U=>T.has(U)?I(U):U,f=U=>y.has(U)?I(U):U},493:(re,C,p)=>{p.d(C,{F:()=>x});var l=p(609),D=p(561);function m(N,L,R,y){var T;const O=(T=y==null?void 0:y.localName)!==null&&T!==void 0?T:L.substring(L.lastIndexOf(".")+1),I={[O]:function(j){N.util.initFields(this),N.util.initPartial(j,this)}}[O];return Object.setPrototypeOf(I.prototype,new D.v),Object.assign(I,{runtime:N,typeName:L,fields:N.util.newFieldList(R),fromBinary(j,S){return new I().fromBinary(j,S)},fromJson(j,S){return new I().fromJson(j,S)},fromJsonString(j,S){return new I().fromJsonString(j,S)},equals(j,S){return N.util.equals(I,j,S)}}),I}function x(N,L,R,y){return{syntax:N,json:L,bin:R,util:y,makeMessageType(T,O,I){return m(this,T,O,I)},makeEnum:l.ut,makeEnumType:l.be,getEnumType:l.V3}}},781:(re,C,p)=>{p.d(C,{AA:()=>x,T1:()=>L,kY:()=>N});var l=p(465),D=p(79),m=p(210);function x(R,y,T){if(y===T)return!0;if(R==l.w.BYTES){if(!(y instanceof Uint8Array)||!(T instanceof Uint8Array)||y.length!==T.length)return!1;for(let O=0;O<y.length;O++)if(y[O]!==T[O])return!1;return!0}switch(R){case l.w.UINT64:case l.w.FIXED64:case l.w.INT64:case l.w.SFIXED64:case l.w.SINT64:return y==T}return!1}function N(R,y){switch(R){case l.w.BOOL:return!1;case l.w.UINT64:case l.w.FIXED64:case l.w.INT64:case l.w.SFIXED64:case l.w.SINT64:return y==0?m.q.zero:"0";case l.w.DOUBLE:case l.w.FLOAT:return 0;case l.w.BYTES:return new Uint8Array(0);case l.w.STRING:return"";default:return 0}}function L(R,y){const T=y===void 0;let O=D.TD.Varint,I=y===0;switch(R){case l.w.STRING:I=T||!y.length,O=D.TD.LengthDelimited;break;case l.w.BOOL:I=y===!1;break;case l.w.DOUBLE:O=D.TD.Bit64;break;case l.w.FLOAT:O=D.TD.Bit32;break;case l.w.INT64:I=T||y==0;break;case l.w.UINT64:I=T||y==0;break;case l.w.FIXED64:I=T||y==0,O=D.TD.Bit64;break;case l.w.BYTES:I=T||!y.byteLength,O=D.TD.LengthDelimited;break;case l.w.FIXED32:O=D.TD.Bit32;break;case l.w.SFIXED32:O=D.TD.Bit32;break;case l.w.SFIXED64:I=T||y==0,O=D.TD.Bit64;break;case l.w.SINT64:I=T||y==0;break}const j=l.w[R].toLowerCase();return[O,j,T||I]}},433:(re,C,p)=>{p.d(C,{f:()=>N});var l=p(609),D=p(561),m=p(465),x=p(781);function N(){return{setEnumType:l.zg,initPartial(y,T){if(y===void 0)return;const O=T.getType();for(const I of O.fields.byMember()){const j=I.localName,S=T,f=y;if(f[j]!==void 0)switch(I.kind){case"oneof":const U=f[j].case;if(U===void 0)continue;const _=I.findField(U);let w=f[j].value;_&&_.kind=="message"&&!(w instanceof _.T)?w=new _.T(w):_&&_.kind==="scalar"&&_.T===m.w.BYTES&&(w=R(w)),S[j]={case:U,value:w};break;case"scalar":case"enum":let B=f[j];I.T===m.w.BYTES&&(B=I.repeated?B.map(R):R(B)),S[j]=B;break;case"map":switch(I.V.kind){case"scalar":case"enum":if(I.V.T===m.w.BYTES)for(const[P,$]of Object.entries(f[j]))S[j][P]=R($);else Object.assign(S[j],f[j]);break;case"message":const W=I.V.T;for(const P of Object.keys(f[j])){let $=f[j][P];W.fieldWrapper||($=new W($)),S[j][P]=$}break}break;case"message":const V=I.T;if(I.repeated)S[j]=f[j].map(W=>W instanceof V?W:new V(W));else if(f[j]!==void 0){const W=f[j];V.fieldWrapper?V.typeName==="google.protobuf.BytesValue"?S[j]=R(W):S[j]=W:S[j]=W instanceof V?W:new V(W)}break}}},equals(y,T,O){return T===O?!0:!T||!O?!1:y.fields.byMember().every(I=>{const j=T[I.localName],S=O[I.localName];if(I.repeated){if(j.length!==S.length)return!1;switch(I.kind){case"message":return j.every((f,U)=>I.T.equals(f,S[U]));case"scalar":return j.every((f,U)=>(0,x.AA)(I.T,f,S[U]));case"enum":return j.every((f,U)=>(0,x.AA)(m.w.INT32,f,S[U]))}throw new Error(`repeated cannot contain ${I.kind}`)}switch(I.kind){case"message":return I.T.equals(j,S);case"enum":return(0,x.AA)(m.w.INT32,j,S);case"scalar":return(0,x.AA)(I.T,j,S);case"oneof":if(j.case!==S.case)return!1;const f=I.findField(j.case);if(f===void 0)return!0;switch(f.kind){case"message":return f.T.equals(j.value,S.value);case"enum":return(0,x.AA)(m.w.INT32,j.value,S.value);case"scalar":return(0,x.AA)(f.T,j.value,S.value)}throw new Error(`oneof cannot contain ${f.kind}`);case"map":const U=Object.keys(j).concat(Object.keys(S));switch(I.V.kind){case"message":const _=I.V.T;return U.every(B=>_.equals(j[B],S[B]));case"enum":return U.every(B=>(0,x.AA)(m.w.INT32,j[B],S[B]));case"scalar":const w=I.V.T;return U.every(B=>(0,x.AA)(w,j[B],S[B]))}break}})},clone(y){const T=y.getType(),O=new T,I=O;for(const j of T.fields.byMember()){const S=y[j.localName];let f;if(j.repeated)f=S.map(L);else if(j.kind=="map"){f=I[j.localName];for(const[U,_]of Object.entries(S))f[U]=L(_)}else j.kind=="oneof"?f=j.findField(S.case)?{case:S.case,value:L(S.value)}:{case:void 0}:f=L(S);I[j.localName]=f}return O}}}function L(y){if(y===void 0)return y;if(y instanceof D.v)return y.clone();if(y instanceof Uint8Array){const T=new Uint8Array(y.byteLength);return T.set(y),T}return y}function R(y){return y instanceof Uint8Array?y:new Uint8Array(y)}},236:(re,C,p)=>{p.d(C,{W:()=>m});let l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),D=[];for(let x=0;x<l.length;x++)D[l[x].charCodeAt(0)]=x;D["-".charCodeAt(0)]=l.indexOf("+"),D["_".charCodeAt(0)]=l.indexOf("/");const m={dec(x){let N=x.length*3/4;x[x.length-2]=="="?N-=2:x[x.length-1]=="="&&(N-=1);let L=new Uint8Array(N),R=0,y=0,T,O=0;for(let I=0;I<x.length;I++){if(T=D[x.charCodeAt(I)],T===void 0)switch(x[I]){case"=":y=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(y){case 0:O=T,y=1;break;case 1:L[R++]=O<<2|(T&48)>>4,O=T,y=2;break;case 2:L[R++]=(O&15)<<4|(T&60)>>2,O=T,y=3;break;case 3:L[R++]=(O&3)<<6|T,y=0;break}}if(y==1)throw Error("invalid base64 string.");return L.subarray(0,R)},enc(x){let N="",L=0,R,y=0;for(let T=0;T<x.length;T++)switch(R=x[T],L){case 0:N+=l[R>>2],y=(R&3)<<4,L=1;break;case 1:N+=l[y|R>>4],y=(R&15)<<2,L=2;break;case 2:N+=l[y|R>>6],N+=l[R&63],L=0;break}return L&&(N+=l[y],N+="=",L==1&&(N+="=")),N}}},210:(re,C,p)=>{p.d(C,{q:()=>x});var l=p(120),D=p(818);function m(){const N=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof N.getBigInt64=="function"&&typeof N.getBigUint64=="function"&&typeof N.setBigInt64=="function"&&typeof N.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const T=BigInt("-9223372036854775808"),O=BigInt("9223372036854775807"),I=BigInt("0"),j=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(S){const f=typeof S=="bigint"?S:BigInt(S);if(f>O||f<T)throw new Error(`int64 invalid: ${S}`);return f},uParse(S){const f=typeof S=="bigint"?S:BigInt(S);if(f>j||f<I)throw new Error(`uint64 invalid: ${S}`);return f},enc(S){return N.setBigInt64(0,this.parse(S),!0),{lo:N.getInt32(0,!0),hi:N.getInt32(4,!0)}},uEnc(S){return N.setBigInt64(0,this.uParse(S),!0),{lo:N.getInt32(0,!0),hi:N.getInt32(4,!0)}},dec(S,f){return N.setInt32(0,S,!0),N.setInt32(4,f,!0),N.getBigInt64(0,!0)},uDec(S,f){return N.setInt32(0,S,!0),N.setInt32(4,f,!0),N.getBigUint64(0,!0)}}}const R=T=>(0,l.hu)(/^-?[0-9]+$/.test(T),`int64 invalid: ${T}`),y=T=>(0,l.hu)(/^[0-9]+$/.test(T),`uint64 invalid: ${T}`);return{zero:"0",supported:!1,parse(T){return typeof T!="string"&&(T=T.toString()),R(T),T},uParse(T){return typeof T!="string"&&(T=T.toString()),y(T),T},enc(T){return typeof T!="string"&&(T=T.toString()),R(T),(0,D.CZ)(T)},uEnc(T){return typeof T!="string"&&(T=T.toString()),y(T),(0,D.CZ)(T)},dec(T,O){return(0,D.Ak)(T,O)},uDec(T,O){return(0,D.Fd)(T,O)}}}const x=m()},850:(re,C,p)=>{p.d(C,{w:()=>f});var l=p(493),D=p(465),m=p(744);function x(){return Object.assign(Object.assign({},(0,m.gY)()),{writeMessage(_,w,B){const V=_.getType();for(const W of V.fields.byNumber()){let P,$=W.repeated,X=W.localName;if(W.oneof){const H=_[W.oneof.localName];if(H.case!==X)continue;P=H.value}else P=_[X];switch(W.kind){case"scalar":case"enum":let H=W.kind=="enum"?D.w.INT32:W.T;if($)if(W.packed)(0,m.Jj)(w,H,W.no,P);else for(const q of P)(0,m.NN)(w,H,W.no,q,!0);else P!==void 0&&(0,m.NN)(w,H,W.no,P,!!W.oneof||W.opt);break;case"message":if($)for(const q of P)(0,m.oQ)(w,B,W,q);else(0,m.oQ)(w,B,W,P);break;case"map":for(const[q,ee]of Object.entries(P))(0,m.gQ)(w,B,W,q,ee);break}}return B.writeUnknownFields&&this.writeUnknownFields(_,w),w}})}var N=p(432),L=p(120),R=p(814);function y(){return(0,R.b)((_,w)=>function(V,W,P){if(V.kind=="map"){const $={};switch(V.V.kind){case"scalar":for(const[H,q]of Object.entries(W)){const ee=w(V.V.T,q,!0);(0,L.hu)(ee!==void 0),$[H.toString()]=ee}break;case"message":for(const[H,q]of Object.entries(W))$[H.toString()]=q.toJson(P);break;case"enum":const X=V.V.T;for(const[H,q]of Object.entries(W)){(0,L.hu)(q===void 0||typeof q=="number");const ee=_(X,q,!0,P.enumAsInteger);(0,L.hu)(ee!==void 0),$[H.toString()]=ee}break}return P.emitDefaultValues||Object.keys($).length>0?$:void 0}else if(V.repeated){const $=[];switch(V.kind){case"scalar":for(let X=0;X<W.length;X++)$.push(w(V.T,W[X],!0));break;case"enum":for(let X=0;X<W.length;X++)$.push(_(V.T,W[X],!0,P.enumAsInteger));break;case"message":for(let X=0;X<W.length;X++)$.push((0,N.E)(V.T,W[X]).toJson(P));break}return P.emitDefaultValues||$.length>0?$:void 0}else switch(V.kind){case"scalar":return w(V.T,W,!!V.oneof||V.opt||P.emitDefaultValues);case"enum":return _(V.T,W,!!V.oneof||V.opt||P.emitDefaultValues,P.enumAsInteger);case"message":return W!==void 0?(0,N.E)(V.T,W).toJson(P):void 0}})}var T=p(433),O=p(501),I=p(781),j=p(215),S=p(504);const f=(0,l.F)("proto3",y(),x(),Object.assign(Object.assign({},(0,T.f)()),{newFieldList(_){return new O.i(_,U)},initFields(_){for(const w of _.getType().fields.byMember()){if(w.opt)continue;const B=w.localName,V=_;if(w.repeated){V[B]=[];continue}switch(w.kind){case"oneof":V[B]={case:void 0};break;case"enum":V[B]=0;break;case"map":V[B]={};break;case"scalar":V[B]=(0,I.kY)(w.T,w.L);break}}}}));function U(_){var w,B,V,W;const P=[];let $;for(const X of typeof _=="function"?_():_){const H=X;if(H.localName=(0,S.Rz)(X.name,X.oneof!==void 0),H.jsonName=(w=X.jsonName)!==null&&w!==void 0?w:(0,S.x1)(X.name),H.repeated=(B=X.repeated)!==null&&B!==void 0?B:!1,X.kind=="scalar"&&(H.L=(V=X.L)!==null&&V!==void 0?V:D.p.BIGINT),X.oneof!==void 0){const q=typeof X.oneof=="string"?X.oneof:X.oneof.name;(!$||$.name!=q)&&($=new j.o(q)),H.oneof=$,$.addField(H)}X.kind=="message"&&(H.delimited=!1),H.packed=(W=X.packed)!==null&&W!==void 0?W:X.kind=="enum"||X.kind=="scalar"&&X.T!=D.w.BYTES&&X.T!=D.w.STRING,P.push(H)}return P}},328:(re,C,p)=>{p.d(C,{t:()=>l,w:()=>D});var l;(function(m){m[m.Unary=0]="Unary",m[m.ServerStreaming=1]="ServerStreaming",m[m.ClientStreaming=2]="ClientStreaming",m[m.BiDiStreaming=3]="BiDiStreaming"})(l||(l={}));var D;(function(m){m[m.NoSideEffects=1]="NoSideEffects",m[m.Idempotent=2]="Idempotent"})(D||(D={}))}},Pt={};function Ee(re){var C=Pt[re];if(C!==void 0)return C.exports;var p=Pt[re]={exports:{}};return Xt[re](p,p.exports,Ee),p.exports}Ee.d=(re,C)=>{for(var p in C)Ee.o(C,p)&&!Ee.o(re,p)&&Object.defineProperty(re,p,{enumerable:!0,get:C[p]})},Ee.o=(re,C)=>Object.prototype.hasOwnProperty.call(re,C),Ee.r=re=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(re,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(re,"__esModule",{value:!0})};var Xe={};return(()=>{Ee.r(Xe),Ee.d(Xe,{Change:()=>Un,Client:()=>cs,ClientEventType:()=>zt,ClientStatus:()=>Cn,Counter:()=>Sr,DocEventType:()=>pe,Document:()=>as,DocumentSyncResultType:()=>nr,Primitive:()=>xe,StreamConnectionStatus:()=>Vn,SyncMode:()=>En,Text:()=>br,TimeTicket:()=>Pe,Tree:()=>Ir,converter:()=>Tn,default:()=>ai});var re;(function(s){s[s.Trivial=0]="Trivial",s[s.Debug=1]="Debug",s[s.Info=2]="Info",s[s.Warn=3]="Warn",s[s.Error=4]="Error",s[s.Fatal=5]="Fatal"})(re||(re={}));let C=re.Info;const p={trivial:(...s)=>{C>re.Trivial||typeof console<"u"&&console.log("YORKIE T:",...s)},debug:(...s)=>{C>re.Debug||typeof console<"u"&&console.log("YORKIE D:",...s)},info:(...s)=>{C>re.Info||typeof console<"u"&&console.log("YORKIE I:",...s)},warn:(...s)=>{C>re.Warn||typeof console<"u"&&(typeof console.warn<"u"?console.warn("YORKIE W:",...s):console.log("YORKIE W:",...s))},error:(...s)=>{C>re.Error||typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE E:",...s):console.log("YORKIE E:",...s))},fatal:(s,...e)=>{throw typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE F:",...e):console.log("YORKIE F:",...e)),new Error(`YORKIE F: ${s}`)},isEnabled:s=>C<=s};function l(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)})}const D=()=>{};class m{constructor(e){this.finalized=!1,this.observers=[];try{e(this)}catch(t){this.error(t)}}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;e||p.fatal("missing observer"),this.finalized&&p.fatal("observable is finalized due to previous error"),typeof e=="object"?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=D),i.error===void 0&&(i.error=D),i.complete===void 0&&(i.complete=D);const u=l(),c=this.unsubscribeOne.bind(this,u);if(this.observers.push({subscriptionID:u,observer:i}),this.finalized)try{this.finalError?i.error(this.finalError):i.complete()}catch(d){p.warn(d)}return c}unsubscribeOne(e){var t;this.observers=(t=this.observers)===null||t===void 0?void 0:t.filter(n=>n.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e].observer)}catch(n){p.error(n)}}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.observers=void 0)}}function x(s){const e=new m(s);return{subscribe:e.subscribe.bind(e),getProxy:()=>e}}var N=Ee(328);function L(s,e){const t={};for(const[n,i]of Object.entries(s.methods)){const u=e(Object.assign(Object.assign({},i),{localName:n,service:s}));u!=null&&(t[n]=u)}return t}var R;(function(s){s[s.Canceled=1]="Canceled",s[s.Unknown=2]="Unknown",s[s.InvalidArgument=3]="InvalidArgument",s[s.DeadlineExceeded=4]="DeadlineExceeded",s[s.NotFound=5]="NotFound",s[s.AlreadyExists=6]="AlreadyExists",s[s.PermissionDenied=7]="PermissionDenied",s[s.ResourceExhausted=8]="ResourceExhausted",s[s.FailedPrecondition=9]="FailedPrecondition",s[s.Aborted=10]="Aborted",s[s.OutOfRange=11]="OutOfRange",s[s.Unimplemented=12]="Unimplemented",s[s.Internal=13]="Internal",s[s.Unavailable=14]="Unavailable",s[s.DataLoss=15]="DataLoss",s[s.Unauthenticated=16]="Unauthenticated"})(R||(R={}));var y=Ee(561);function T(s){const e=R[s];return typeof e!="string"?s.toString():e[0].toLowerCase()+e.substring(1).replace(/[A-Z]/g,t=>"_"+t.toLowerCase())}class O extends Error{constructor(e,t=R.Unknown,n,i,u){super(I(e,t)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(n!=null?n:{}),this.details=i!=null?i:[],this.cause=u}static from(e,t=R.Unknown){return e instanceof O?e:e instanceof Error?e.name=="AbortError"?new O(e.message,R.Canceled):new O(e.message,t,void 0,void 0,e):new O(String(e),t,void 0,void 0,e)}findDetails(e){const t="typeName"in e?{findMessage:i=>i===e.typeName?e:void 0}:e,n=[];for(const i of this.details){if(i instanceof y.v){t.findMessage(i.getType().typeName)&&n.push(i);continue}const u=t.findMessage(i.type);if(u)try{n.push(u.fromBinary(i.value))}catch{}}return n}}function I(s,e){return s.length?`[${T(e)}] ${s}`:`[${T(e)}]`}var j=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=s[Symbol.asyncIterator],t;return e?e.call(s):(s=typeof __values=="function"?__values(s):s[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(u){t[u]=s[u]&&function(c){return new Promise(function(d,v){c=s[u](c),i(d,v,c.done,c.value)})}}function i(u,c,d,v){Promise.resolve(v).then(function(k){u({value:k,done:d})},c)}},S=function(s){return this instanceof S?(this.v=s,this):new S(s)},f=function(s,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(s,e||[]),i,u=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(J){n[J]&&(i[J]=function(ie){return new Promise(function(he,ge){u.push([J,ie,he,ge])>1||d(J,ie)})})}function d(J,ie){try{v(n[J](ie))}catch(he){Q(u[0][3],he)}}function v(J){J.value instanceof S?Promise.resolve(J.value.v).then(k,z):Q(u[0][2],J)}function k(J){d("next",J)}function z(J){d("throw",J)}function Q(J,ie){J(ie),u.shift(),u.length&&d(u[0][0],u[0][1])}},U=function(s){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,u){e[i]=s[i]?function(c){return(t=!t)?{value:S(s[i](c)),done:!1}:u?u(c):c}:u}};function _(s){return f(this,arguments,function*(){yield S(yield*U(j(s)))})}var w=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=s[Symbol.asyncIterator],t;return e?e.call(s):(s=typeof __values=="function"?__values(s):s[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(u){t[u]=s[u]&&function(c){return new Promise(function(d,v){c=s[u](c),i(d,v,c.done,c.value)})}}function i(u,c,d,v){Promise.resolve(v).then(function(k){u({value:k,done:d})},c)}},B=function(s){return this instanceof B?(this.v=s,this):new B(s)},V=function(s){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,u){e[i]=s[i]?function(c){return(t=!t)?{value:B(s[i](c)),done:!1}:u?u(c):c}:u}},W=function(s,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(s,e||[]),i,u=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(J){n[J]&&(i[J]=function(ie){return new Promise(function(he,ge){u.push([J,ie,he,ge])>1||d(J,ie)})})}function d(J,ie){try{v(n[J](ie))}catch(he){Q(u[0][3],he)}}function v(J){J.value instanceof B?Promise.resolve(J.value.v).then(k,z):Q(u[0][2],J)}function k(J){d("next",J)}function z(J){d("throw",J)}function Q(J,ie){J(ie),u.shift(),u.length&&d(u[0][0],u[0][1])}};function P(s,e){return L(s,t=>{switch(t.kind){case N.t.Unary:return $(e,s,t);case N.t.ServerStreaming:return X(e,s,t);case N.t.ClientStreaming:return H(e,s,t);case N.t.BiDiStreaming:return q(e,s,t);default:return null}})}function $(s,e,t){return async function(n,i){var u,c;const d=await s.unary(e,t,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,n,i==null?void 0:i.contextValues);return(u=i==null?void 0:i.onHeader)===null||u===void 0||u.call(i,d.header),(c=i==null?void 0:i.onTrailer)===null||c===void 0||c.call(i,d.trailer),d.message}}function X(s,e,t){return function(n,i){return ee(s.stream(e,t,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,_([n]),i==null?void 0:i.contextValues),i)}}function H(s,e,t){return async function(n,i){var u,c,d,v,k,z;const Q=await s.stream(e,t,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,n,i==null?void 0:i.contextValues);(k=i==null?void 0:i.onHeader)===null||k===void 0||k.call(i,Q.header);let J;try{for(var ie=!0,he=w(Q.message),ge;ge=await he.next(),u=ge.done,!u;ie=!0)v=ge.value,ie=!1,J=v}catch(ke){c={error:ke}}finally{try{!ie&&!u&&(d=he.return)&&await d.call(he)}finally{if(c)throw c.error}}if(!J)throw new O("protocol error: missing response message",R.Internal);return(z=i==null?void 0:i.onTrailer)===null||z===void 0||z.call(i,Q.trailer),J}}function q(s,e,t){return function(n,i){return ee(s.stream(e,t,i==null?void 0:i.signal,i==null?void 0:i.timeoutMs,i==null?void 0:i.headers,n,i==null?void 0:i.contextValues),i)}}function ee(s,e){const t=function(){var n,i;return W(this,arguments,function*(){const u=yield B(s);(n=e==null?void 0:e.onHeader)===null||n===void 0||n.call(e,u.header),yield B(yield*V(w(u.message))),(i=e==null?void 0:e.onTrailer)===null||i===void 0||i.call(e,u.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>t.next()})}}function Se(){return{get(s){return s.id in this?this[s.id]:s.defaultValue},set(s,e){return this[s.id]=e,this},delete(s){return delete this[s.id],this}}}function G(s){var e;const t=Object.assign({},s);return(e=t.ignoreUnknownFields)!==null&&e!==void 0||(t.ignoreUnknownFields=!0),t}function ve(s,e,t,n){const i=e?ne(s.I,n):ue(s.I,t);return{parse:(e?ne(s.O,n):ue(s.O,t)).parse,serialize:i.serialize}}function ne(s,e){return{parse(t){try{return s.fromBinary(t,e)}catch(n){const i=n instanceof Error?n.message:String(n);throw new O(`parse binary: ${i}`,R.InvalidArgument)}},serialize(t){try{return t.toBinary(e)}catch(n){const i=n instanceof Error?n.message:String(n);throw new O(`serialize binary: ${i}`,R.Internal)}}}}function ue(s,e){var t,n;const i=(t=e==null?void 0:e.textEncoder)!==null&&t!==void 0?t:new TextEncoder,u=(n=e==null?void 0:e.textDecoder)!==null&&n!==void 0?n:new TextDecoder,c=G(e);return{parse(d){try{const v=u.decode(d);return s.fromJsonString(v,c)}catch(v){throw O.from(v,R.InvalidArgument)}},serialize(d){try{const v=d.toJsonString(c);return i.encode(v)}catch(v){throw O.from(v,R.Internal)}}}}function Ie(...s){const e=new AbortController,t=s.filter(i=>i!==void 0).concat(e.signal);for(const i of t){if(i.aborted){n.apply(i);break}i.addEventListener("abort",n)}function n(){e.signal.aborted||e.abort(Ce(this));for(const i of t)i.removeEventListener("abort",n)}return e}function we(s){const e=new AbortController,t=()=>{e.abort(new O("the operation timed out",R.DeadlineExceeded))};let n;return s!==void 0&&(s<=0?t():n=setTimeout(t,s)),{signal:e.signal,cleanup:()=>clearTimeout(n)}}function Ce(s){if(!s.aborted)return;if(s.reason!==void 0)return s.reason;const e=new Error("This operation was aborted");return e.name="AbortError",e}function je(s,e){return e instanceof y.v?e:new s(e)}function Le(s,e){function t(n){return n.done===!0?n:{done:n.done,value:je(s,n.value)}}return{[Symbol.asyncIterator](){const n=e[Symbol.asyncIterator](),i={next:()=>n.next().then(t)};return n.throw!==void 0&&(i.throw=u=>n.throw(u).then(t)),n.return!==void 0&&(i.return=u=>n.return(u).then(t)),i}}}function ft(s){const e=le(s.next,s.interceptors),[t,n,i]=He(s),u=Object.assign(Object.assign({},s.req),{message:je(s.req.method.I,s.req.message),signal:t});return e(u).then(c=>(i(),c),n)}function dt(s){const e=le(s.next,s.interceptors),[t,n,i]=He(s),u=Object.assign(Object.assign({},s.req),{message:Le(s.req.method.I,s.req.message),signal:t});let c=!1;return t.addEventListener("abort",function(){var d,v;const k=s.req.message[Symbol.asyncIterator]();c||(d=k.throw)===null||d===void 0||d.call(k,this.reason).catch(()=>{}),(v=k.return)===null||v===void 0||v.call(k).catch(()=>{})}),e(u).then(d=>Object.assign(Object.assign({},d),{message:{[Symbol.asyncIterator](){const v=d.message[Symbol.asyncIterator]();return{next(){return v.next().then(k=>(k.done==!0&&(c=!0,i()),k),n)}}}}}),n)}function He(s){const{signal:e,cleanup:t}=we(s.timeoutMs),n=Ie(s.signal,e);return[n.signal,function(u){const c=O.from(e.aborted?Ce(e):u);return n.abort(c),t(),Promise.reject(c)},function(){t(),n.abort()}]}function le(s,e){var t;return(t=e==null?void 0:e.concat().reverse().reduce((n,i)=>i(n),s))!==null&&t!==void 0?t:s}function Dt(s,e,t){const n=typeof e=="string"?e:e.typeName,i=typeof t=="string"?t:t.name;return s.toString().replace(/\/?$/,`/${n}/${i}`)}function Tt(s){let e,t=new Uint8Array(0);function n(i){const u=new Uint8Array(t.length+i.length);u.set(t),u.set(i,t.length),t=u}return new ReadableStream({start(){e=s.getReader()},async pull(i){let u;for(;;){if(u===void 0&&t.byteLength>=5){let v=0;for(let k=1;k<5;k++)v=(v<<8)+t[k];u={flags:t[0],length:v}}if(u!==void 0&&t.byteLength>=u.length+5)break;const d=await e.read();if(d.done)break;n(d.value)}if(u===void 0){if(t.byteLength==0){i.close();return}i.error(new O("premature end of stream",R.DataLoss));return}const c=t.subarray(5,5+u.length);t=t.subarray(5+u.length),i.enqueue({flags:u.flags,data:c})}})}function ot(s,e){const t=new Uint8Array(e.length+5);t.set(e,5);const n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setUint8(0,s),n.setUint32(1,e.length),t}const vt="Content-Type",ht="Grpc-Timeout",mt="Grpc-Status",qe="Grpc-Message",te="Grpc-Status-Details-Bin",un="User-Agent",Ct="X-User-Agent",Ht="X-Grpc-Web",Nn="application/grpc-web+proto",fn="application/grpc-web+json";function bn(s,e,t,n){const i=new Headers(t!=null?t:{});return i.set(vt,s?Nn:fn),i.set(Ht,"1"),i.set(Ct,"connect-es/1.2.0"),n&&i.set(un,"connect-es/1.2.0"),e!==void 0&&i.set(ht,`${e}m`),i}function Rn(s){switch(s){case 400:return R.Internal;case 401:return R.Unauthenticated;case 403:return R.PermissionDenied;case 404:return R.Unimplemented;case 429:return R.Unavailable;case 502:return R.Unavailable;case 503:return R.Unavailable;case 504:return R.Unavailable;default:return R.Unknown}}var wt=Ee(850),Zt=Ee(733);class Ze extends y.v{constructor(e){super(),this.code=0,this.message="",this.details=[],wt.w.util.initPartial(e,this)}static fromBinary(e,t){return new Ze().fromBinary(e,t)}static fromJson(e,t){return new Ze().fromJson(e,t)}static fromJsonString(e,t){return new Ze().fromJsonString(e,t)}static equals(e,t){return wt.w.util.equals(Ze,e,t)}}Ze.runtime=wt.w,Ze.typeName="google.rpc.Status",Ze.fields=wt.w.util.newFieldList(()=>[{no:1,name:"code",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"details",kind:"message",T:Zt.I,repeated:!0}]);var Qt=Ee(236);function en(s,e,t){try{const n=Qt.W.dec(s);return e?e.fromBinary(n,t):n}catch(n){throw O.from(n,R.DataLoss)}}const tn="0";function nn(s){var e;const t=s.get(te);if(t!=null){const i=en(t,Ze);if(i.code==0)return;const u=new O(i.message,i.code,s);return u.details=i.details.map(c=>({type:c.typeUrl.substring(c.typeUrl.lastIndexOf("/")+1),value:c.value})),u}const n=s.get(mt);if(n!=null){if(n===tn)return;const i=parseInt(n,10);return i in R?new O(decodeURIComponent((e=s.get(qe))!==null&&e!==void 0?e:""),i,s):new O(`invalid grpc-status: ${n}`,R.Internal,s)}}function Ye(s,e){var t;if(s>=200&&s<300){const n=nn(e);if(n)throw n;return{foundStatus:e.has(mt)}}throw new O(decodeURIComponent((t=e.get(qe))!==null&&t!==void 0?t:`HTTP ${s}`),Rn(s),e)}const Rt=128;function Re(s){const e=new Headers,t=new TextDecoder().decode(s).split(`\r
`);for(const n of t){if(n==="")continue;const i=n.indexOf(":");if(i>0){const u=n.substring(0,i).trim(),c=n.substring(i+1).trim();e.append(u,c)}}return e}function Sn(s,e){const t=nn(s);if(t)throw e.forEach((n,i)=>{t.metadata.append(i,n)}),t}function _n(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}var Et=function(s){return this instanceof Et?(this.v=s,this):new Et(s)},xn=function(s,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(s,e||[]),i,u=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(J){n[J]&&(i[J]=function(ie){return new Promise(function(he,ge){u.push([J,ie,he,ge])>1||d(J,ie)})})}function d(J,ie){try{v(n[J](ie))}catch(he){Q(u[0][3],he)}}function v(J){J.value instanceof Et?Promise.resolve(J.value.v).then(k,z):Q(u[0][2],J)}function k(J){d("next",J)}function z(J){d("throw",J)}function Q(J,ie){J(ie),u.shift(),u.length&&d(u[0][0],u[0][1])}};function Ln(s){var e;_n();const t=(e=s.useBinaryFormat)!==null&&e!==void 0?e:!0;return{async unary(n,i,u,c,d,v,k){var z;const{serialize:Q,parse:J}=ve(i,t,s.jsonOptions,s.binaryOptions);return c=c===void 0?s.defaultTimeoutMs:c<=0?void 0:c,await ft({interceptors:s.interceptors,signal:u,timeoutMs:c,req:{stream:!1,service:n,method:i,url:Dt(s.baseUrl,n,i),init:{method:"POST",credentials:(z=s.credentials)!==null&&z!==void 0?z:"same-origin",redirect:"error",mode:"cors"},header:bn(t,c,d,!1),contextValues:k!=null?k:Se(),message:v},next:async ie=>{var he;const ke=await((he=s.fetch)!==null&&he!==void 0?he:globalThis.fetch)(ie.url,Object.assign(Object.assign({},ie.init),{headers:ie.header,signal:ie.signal,body:ot(0,Q(ie.message))}));if(Ye(ke.status,ke.headers),!ke.body)throw"missing response body";const lt=Tt(ke.body).getReader();let Te,Ve;for(;;){const Ue=await lt.read();if(Ue.done)break;const{flags:Qe,data:jn}=Ue.value;if(Qe===Rt){if(Te!==void 0)throw"extra trailer";Te=Re(jn);continue}if(Ve!==void 0)throw"extra message";Ve=J(jn)}if(Te===void 0)throw"missing trailer";if(Sn(Te,ke.headers),Ve===void 0)throw"missing message";return{stream:!1,header:ke.headers,message:Ve,trailer:Te}}})},async stream(n,i,u,c,d,v,k){var z;const{serialize:Q,parse:J}=ve(i,t,s.jsonOptions,s.binaryOptions);function ie(ge,ke,lt,Te){return xn(this,arguments,function*(){const Ue=Tt(ge).getReader();if(ke){if(!(yield Et(Ue.read())).done)throw"extra data for trailers-only";return yield Et(void 0)}let Qe=!1;for(;;){const jn=yield Et(Ue.read());if(jn.done)break;const{flags:rr,data:hr}=jn.value;if((rr&Rt)===Rt){if(Qe)throw"extra trailer";Qe=!0;const ls=Re(hr);Sn(ls,Te),ls.forEach((ui,ci)=>lt.set(ci,ui));continue}if(Qe)throw"extra message";yield yield Et(J(hr))}if(!Qe)throw"missing trailer"})}async function he(ge){if(i.kind!=N.t.ServerStreaming)throw"The fetch API does not support streaming request bodies";const ke=await ge[Symbol.asyncIterator]().next();if(ke.done==!0)throw"missing request message";return ot(0,Q(ke.value))}return c=c===void 0?s.defaultTimeoutMs:c<=0?void 0:c,dt({interceptors:s.interceptors,signal:u,timeoutMs:c,req:{stream:!0,service:n,method:i,url:Dt(s.baseUrl,n,i),init:{method:"POST",credentials:(z=s.credentials)!==null&&z!==void 0?z:"same-origin",redirect:"error",mode:"cors"},header:bn(t,c,d,!1),contextValues:k!=null?k:Se(),message:v},next:async ge=>{var ke;const Te=await((ke=s.fetch)!==null&&ke!==void 0?ke:globalThis.fetch)(ge.url,Object.assign(Object.assign({},ge.init),{headers:ge.header,signal:ge.signal,body:await he(ge.message)})),{foundStatus:Ve}=Ye(Te.status,Te.headers);if(!Te.body)throw"missing response body";const Ue=new Headers;return Object.assign(Object.assign({},ge),{header:Te.headers,trailer:Ue,message:ie(Te.body,Ve,Ue,Te.headers)})}})}}}var Bn=Ee(295),F=Ee(646);/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var Fe=null;try{Fe=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ye(s,e,t){this.low=s|0,this.high=e|0,this.unsigned=!!t}ye.prototype.__isLong__,Object.defineProperty(ye.prototype,"__isLong__",{value:!0});function Ae(s){return(s&&s.__isLong__)===!0}function Jt(s){var e=Math.clz32(s&-s);return s?31-e:e}ye.isLong=Ae;var Ft={},In={};function vn(s,e){var t,n,i;return e?(s>>>=0,(i=0<=s&&s<256)&&(n=In[s],n)?n:(t=Ne(s,0,!0),i&&(In[s]=t),t)):(s|=0,(i=-128<=s&&s<128)&&(n=Ft[s],n)?n:(t=Ne(s,s<0?-1:0,!1),i&&(Ft[s]=t),t))}ye.fromInt=vn;function _t(s,e){if(isNaN(s))return e?cn:$t;if(e){if(s<0)return cn;if(s>=Yn)return Mn}else{if(s<=-or)return Ke;if(s+1>=or)return mr}return s<0?_t(-s,e).neg():Ne(s%dn|0,s/dn|0,e)}ye.fromNumber=_t;function Ne(s,e,t){return new ye(s,e,t)}ye.fromBits=Ne;var qn=Math.pow;function sr(s,e,t){if(s.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,s==="NaN"||s==="Infinity"||s==="+Infinity"||s==="-Infinity")return e?cn:$t;if(t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=s.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return sr(s.substring(1),e,t).neg();for(var i=_t(qn(t,8)),u=$t,c=0;c<s.length;c+=8){var d=Math.min(8,s.length-c),v=parseInt(s.substring(c,c+d),t);if(d<8){var k=_t(qn(t,d));u=u.mul(k).add(_t(v))}else u=u.mul(i),u=u.add(_t(v))}return u.unsigned=e,u}ye.fromString=sr;function Ut(s,e){return typeof s=="number"?_t(s,e):typeof s=="string"?sr(s,e):Ne(s.low,s.high,typeof e=="boolean"?e:s.unsigned)}ye.fromValue=Ut;var ir=1<<16,Or=1<<24,dn=ir*ir,Yn=dn*dn,or=Yn/2,ar=vn(Or),$t=vn(0);ye.ZERO=$t;var cn=vn(0,!0);ye.UZERO=cn;var kn=vn(1);ye.ONE=kn;var ur=vn(1,!0);ye.UONE=ur;var Kn=vn(-1);ye.NEG_ONE=Kn;var mr=Ne(-1,2147483647,!1);ye.MAX_VALUE=mr;var Mn=Ne(-1,-1,!0);ye.MAX_UNSIGNED_VALUE=Mn;var Ke=Ne(0,-2147483648,!1);ye.MIN_VALUE=Ke;var Y=ye.prototype;Y.toInt=function(){return this.unsigned?this.low>>>0:this.low},Y.toNumber=function(){return this.unsigned?(this.high>>>0)*dn+(this.low>>>0):this.high*dn+(this.low>>>0)},Y.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ke)){var t=_t(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var u=_t(qn(e,6),this.unsigned),c=this,d="";;){var v=c.div(u),k=c.sub(v.mul(u)).toInt()>>>0,z=k.toString(e);if(c=v,c.isZero())return z+d;for(;z.length<6;)z="0"+z;d=""+z+d}},Y.getHighBits=function(){return this.high},Y.getHighBitsUnsigned=function(){return this.high>>>0},Y.getLowBits=function(){return this.low},Y.getLowBitsUnsigned=function(){return this.low>>>0},Y.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ke)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1},Y.isZero=function(){return this.high===0&&this.low===0},Y.eqz=Y.isZero,Y.isNegative=function(){return!this.unsigned&&this.high<0},Y.isPositive=function(){return this.unsigned||this.high>=0},Y.isOdd=function(){return(this.low&1)===1},Y.isEven=function(){return(this.low&1)===0},Y.equals=function(e){return Ae(e)||(e=Ut(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},Y.eq=Y.equals,Y.notEquals=function(e){return!this.eq(e)},Y.neq=Y.notEquals,Y.ne=Y.notEquals,Y.lessThan=function(e){return this.comp(e)<0},Y.lt=Y.lessThan,Y.lessThanOrEqual=function(e){return this.comp(e)<=0},Y.lte=Y.lessThanOrEqual,Y.le=Y.lessThanOrEqual,Y.greaterThan=function(e){return this.comp(e)>0},Y.gt=Y.greaterThan,Y.greaterThanOrEqual=function(e){return this.comp(e)>=0},Y.gte=Y.greaterThanOrEqual,Y.ge=Y.greaterThanOrEqual,Y.compare=function(e){if(Ae(e)||(e=Ut(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},Y.comp=Y.compare,Y.negate=function(){return!this.unsigned&&this.eq(Ke)?Ke:this.not().add(kn)},Y.neg=Y.negate,Y.add=function(e){Ae(e)||(e=Ut(e));var t=this.high>>>16,n=this.high&65535,i=this.low>>>16,u=this.low&65535,c=e.high>>>16,d=e.high&65535,v=e.low>>>16,k=e.low&65535,z=0,Q=0,J=0,ie=0;return ie+=u+k,J+=ie>>>16,ie&=65535,J+=i+v,Q+=J>>>16,J&=65535,Q+=n+d,z+=Q>>>16,Q&=65535,z+=t+c,z&=65535,Ne(J<<16|ie,z<<16|Q,this.unsigned)},Y.subtract=function(e){return Ae(e)||(e=Ut(e)),this.add(e.neg())},Y.sub=Y.subtract,Y.multiply=function(e){if(this.isZero())return this;if(Ae(e)||(e=Ut(e)),Fe){var t=Fe.mul(this.low,this.high,e.low,e.high);return Ne(t,Fe.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?cn:$t;if(this.eq(Ke))return e.isOdd()?Ke:$t;if(e.eq(Ke))return this.isOdd()?Ke:$t;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(ar)&&e.lt(ar))return _t(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,u=this.low>>>16,c=this.low&65535,d=e.high>>>16,v=e.high&65535,k=e.low>>>16,z=e.low&65535,Q=0,J=0,ie=0,he=0;return he+=c*z,ie+=he>>>16,he&=65535,ie+=u*z,J+=ie>>>16,ie&=65535,ie+=c*k,J+=ie>>>16,ie&=65535,J+=i*z,Q+=J>>>16,J&=65535,J+=u*k,Q+=J>>>16,J&=65535,J+=c*v,Q+=J>>>16,J&=65535,Q+=n*z+i*k+u*v+c*d,Q&=65535,Ne(ie<<16|he,Q<<16|J,this.unsigned)},Y.mul=Y.multiply,Y.divide=function(e){if(Ae(e)||(e=Ut(e)),e.isZero())throw Error("division by zero");if(Fe){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Fe.div_u:Fe.div_s)(this.low,this.high,e.low,e.high);return Ne(t,Fe.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?cn:$t;var n,i,u;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return cn;if(e.gt(this.shru(1)))return ur;u=cn}else{if(this.eq(Ke)){if(e.eq(kn)||e.eq(Kn))return Ke;if(e.eq(Ke))return kn;var c=this.shr(1);return n=c.div(e).shl(1),n.eq($t)?e.isNegative()?kn:Kn:(i=this.sub(e.mul(n)),u=n.add(i.div(e)),u)}else if(e.eq(Ke))return this.unsigned?cn:$t;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();u=$t}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var d=Math.ceil(Math.log(n)/Math.LN2),v=d<=48?1:qn(2,d-48),k=_t(n),z=k.mul(e);z.isNegative()||z.gt(i);)n-=v,k=_t(n,this.unsigned),z=k.mul(e);k.isZero()&&(k=kn),u=u.add(k),i=i.sub(z)}return u},Y.div=Y.divide,Y.modulo=function(e){if(Ae(e)||(e=Ut(e)),Fe){var t=(this.unsigned?Fe.rem_u:Fe.rem_s)(this.low,this.high,e.low,e.high);return Ne(t,Fe.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},Y.mod=Y.modulo,Y.rem=Y.modulo,Y.not=function(){return Ne(~this.low,~this.high,this.unsigned)},Y.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},Y.clz=Y.countLeadingZeros,Y.countTrailingZeros=function(){return this.low?Jt(this.low):Jt(this.high)+32},Y.ctz=Y.countTrailingZeros,Y.and=function(e){return Ae(e)||(e=Ut(e)),Ne(this.low&e.low,this.high&e.high,this.unsigned)},Y.or=function(e){return Ae(e)||(e=Ut(e)),Ne(this.low|e.low,this.high|e.high,this.unsigned)},Y.xor=function(e){return Ae(e)||(e=Ut(e)),Ne(this.low^e.low,this.high^e.high,this.unsigned)},Y.shiftLeft=function(e){return Ae(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ne(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Ne(0,this.low<<e-32,this.unsigned)},Y.shl=Y.shiftLeft,Y.shiftRight=function(e){return Ae(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ne(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Ne(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},Y.shr=Y.shiftRight,Y.shiftRightUnsigned=function(e){return Ae(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ne(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?Ne(this.high,0,this.unsigned):Ne(this.high>>>e-32,0,this.unsigned)},Y.shru=Y.shiftRightUnsigned,Y.shr_u=Y.shiftRightUnsigned,Y.rotateLeft=function(e){var t;return Ae(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?Ne(this.high,this.low,this.unsigned):e<32?(t=32-e,Ne(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,Ne(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},Y.rotl=Y.rotateLeft,Y.rotateRight=function(e){var t;return Ae(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?Ne(this.high,this.low,this.unsigned):e<32?(t=32-e,Ne(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,Ne(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},Y.rotr=Y.rotateRight,Y.toSigned=function(){return this.unsigned?Ne(this.low,this.high,!1):this},Y.toUnsigned=function(){return this.unsigned?this:Ne(this.low,this.high,!0)},Y.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},Y.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]},Y.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]},ye.fromBytes=function(e,t,n){return n?ye.fromBytesLE(e,t):ye.fromBytesBE(e,t)},ye.fromBytesLE=function(e,t){return new ye(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},ye.fromBytesBE=function(e,t){return new ye(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const et=ye;var de;(function(s){s.Ok="ok",s.ClientNotActive="client-not-active",s.Unimplemented="unimplemented",s.Unsupported="unsupported",s.DocumentNotAttached="document-not-attached",s.DocumentNotDetached="document-not-detached",s.DocumentRemoved="document-removed",s.InvalidObjectKey="invalid-object-key",s.InvalidArgument="invalid-argument"})(de||(de={}));class me extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="YorkieError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}function rn(s){if(s instanceof Map){const e=Array.from(s);return new Map(JSON.parse(JSON.stringify(e)))}return JSON.parse(JSON.stringify(s))}const gr=s=>s?Object.entries(s).length===0:!0,at=s=>{const e={};for(const[t,n]of Object.entries(s))e[t]=JSON.stringify(n);return e},We=s=>{const e={};for(const[t,n]of Object.entries(s))e[t]=JSON.parse(n);return e};var Vt;(function(s){s.Put="put",s.Clear="clear"})(Vt||(Vt={}));class Wn{constructor(e,t){this.context=e,this.presence=t}set(e,t){for(const n of Object.keys(e))this.presence[n]=e[n];this.context.setPresenceChange({type:Vt.Put,presence:rn(this.presence)}),this.context.setReversePresence(e,t)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:Vt.Clear})}}const pr="000000000000000000000000",xt="FFFFFFFFFFFFFFFFFFFFFFFF";class Pe{constructor(e,t,n){this.lamport=e,this.delimiter=t,this.actorID=n}static of(e,t,n){return new Pe(e,t,n)}static fromStruct(e){return Pe.of(et.fromString(e.lamport,!0),e.delimiter,e.actorID)}toIDString(){return this.actorID?`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`:`${this.lamport.toString()}:nil:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return this.actorID?`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`:`${this.lamport.toString()}:nil:${this.delimiter}`}setActor(e){return new Pe(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return this.compare(e)===0}compare(e){if(this.lamport.greaterThan(e.lamport))return 1;if(e.lamport.greaterThan(this.lamport))return-1;const t=this.actorID.localeCompare(e.actorID);return t!==0?t:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}}const Gn=0,sn=4294967295,on=et.MAX_VALUE,ut=new Pe(et.fromNumber(0),Gn,pr),gt=new Pe(on,sn,xt);function Be(s){return s.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case`
`:return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}class ct{constructor(e){this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setMovedAt(e){return!this.movedAt||e&&e.after(this.movedAt)?(this.movedAt=e,!0):!1}setRemovedAt(e){this.removedAt=e}remove(e){return e&&e.after(this.getPositionedAt())&&(!this.removedAt||e.after(this.removedAt))?(this.removedAt=e,!0):!1}isRemoved(){return!!this.removedAt}}class hn extends ct{constructor(e){super(e)}}class Nt extends ct{}class pt{constructor(e,t){this.strKey=e,this.value=t}static of(e,t){return new pt(e,t)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}}class rt{constructor(){this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new rt}set(e,t,n){let i;const u=this.nodeMapByKey.get(e);u!=null&&!u.isRemoved()&&u.remove(n)&&(i=u.getValue());const c=pt.of(e,t);return this.nodeMapByCreatedAt.set(t.getCreatedAt().toIDString(),c),(u==null||n.after(u.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,c),t.setMovedAt(n)),i}delete(e,t){this.nodeMapByCreatedAt.has(e.toIDString())||p.fatal(`fail to find ${e.toIDString()}`);const n=this.nodeMapByCreatedAt.get(e.toIDString());return n.remove(t),n.getValue()}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(!!t)return t.getStrKey()}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t){p.fatal(`fail to find ${e.getCreatedAt().toIDString()}`);return}const n=this.nodeMapByKey.get(t.getStrKey());t===n&&this.nodeMapByKey.delete(n.getStrKey()),this.nodeMapByCreatedAt.delete(t.getValue().getCreatedAt().toIDString())}deleteByKey(e,t){const n=this.nodeMapByKey.get(e);if(n!=null&&!!n.remove(t))return n.getValue()}has(e){const t=this.nodeMapByKey.get(e);return t==null?!1:!t.isRemoved()}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){const t=this.nodeMapByKey.get(e);if(!(!t||t.isRemoved()))return t}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}}class Oe extends hn{constructor(e,t){super(e),this.memberNodes=t}static create(e,t){if(!t)return new Oe(e,rt.create());const n=rt.create();for(const[i,u]of Object.entries(t))n.set(i,u.deepcopy(),u.getCreatedAt());return new Oe(e,n)}subPathOf(e){return this.memberNodes.subPathOf(e)}purge(e){this.memberNodes.purge(e)}set(e,t,n){return this.memberNodes.set(e,t,n)}delete(e,t){return this.memberNodes.delete(e,t)}deleteByKey(e,t){return this.memberNodes.deleteByKey(e,t)}get(e){const t=this.memberNodes.get(e);return t==null?void 0:t.getValue()}getByID(e){const t=this.memberNodes.getByID(e);return t==null?void 0:t.getValue()}has(e){return this.memberNodes.has(e)}toJSON(){const e=[];for(const[t,n]of this)e.push(`"${Be(t)}":${n.toJSON()}`);return`{${e.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const e={};for(const[t,n]of this){const{id:i,value:u,type:c}=n.toJSForTest();e[t]={key:t,id:i,value:u,type:c}}return{id:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_OBJECT"}}getKeys(){const e=Array();for(const[t]of this)e.push(t);return e}toSortedJSON(){var e;const t=Array();for(const[i]of this)t.push(i);const n=[];for(const i of t.sort()){const u=(e=this.memberNodes.get(i))===null||e===void 0?void 0:e.getValue();n.push(`"${Be(i)}":${u.toSortedJSON()}`)}return`{${n.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){const e=Oe.create(this.getCreatedAt());for(const t of this.memberNodes)e.memberNodes.set(t.getStrKey(),t.getValue().deepcopy(),this.getPositionedAt());return e.remove(this.getRemovedAt()),e}getDescendants(e){for(const t of this.memberNodes){const n=t.getValue();if(e(n,this))return;n instanceof hn&&n.getDescendants(e)}}*[Symbol.iterator](){const e=new Set;for(const t of this.memberNodes)e.has(t.getStrKey())||(e.add(t.getStrKey()),t.isRemoved()||(yield[t.getStrKey(),t.getValue()]))}}var _e;(function(s){s.Local="local",s.Remote="remote",s.UndoRedo="undoredo"})(_e||(_e={}));class Me{constructor(e,t){this.parentCreatedAt=e,this.executedAt=t}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw new Error("executedAt has not been set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}}class bt{constructor(e){this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}}class st{constructor(e){this.root=e}get length(){return this.root?this.root.getWeight():0}find(e){if(!this.root||e<0)return[void 0,0];let t=this.root;for(;;)if(t.hasLeft()&&e<=t.getLeftWeight())t=t.getLeft();else if(t.hasRight()&&t.getLeftWeight()+t.getLength()<e)e-=t.getLeftWeight()+t.getLength(),t=t.getRight();else{e-=t.getLeftWeight();break}return e>t.getLength()&&p.fatal(`out of index range: pos: ${e} > node.length: ${t.getLength()}`),[t,e]}indexOf(e){if(!e||e!==this.root&&!e.hasLinks())return-1;let t=0,n=e,i;for(;n;)(!i||i===n.getRight())&&(t+=n.getLength()+(n.hasLeft()?n.getLeftWeight():0)),i=n,n=n.getParent();return t-e.getLength()}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,t){return e?(this.splayNode(e),this.root=t,t.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(t),t.setLeft(e),e.setParent(t),e.setRight(),this.updateWeight(e),this.updateWeight(t),t):(this.root=t,t)}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(!!e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);const t=new st(e.getLeft());t.root&&t.root.setParent();const n=new st(e.getRight());if(n.root&&n.root.setParent(),t.root){const i=t.getRightmost();t.splayNode(i),t.root.setRight(n.root),n.root&&n.root.setParent(t.root),this.root=t.root}else this.root=n.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,t){if(!t){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(t),t.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){const t=[];this.traversePostorder(e.getRight(),t);for(const n of t)n.initWeight();this.updateTreeWeight(e)}toTestString(){const e=[];return this.traverseInorder(this.root,e),e.map(t=>`[${t.getWeight()},${t.getLength()}]${t.getValue()||""}`).join("")}checkWeight(){const e=[];this.traverseInorder(this.root,e);for(const t of e)if(t.getWeight()!=t.getLength()+t.getLeftWeight()+t.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,t){!e||(this.traverseInorder(e.getLeft(),t),t.push(e),this.traverseInorder(e.getRight(),t))}traversePostorder(e,t){!e||(this.traversePostorder(e.getLeft(),t),this.traversePostorder(e.getRight(),t),t.push(e))}rotateLeft(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setRight(e.getLeft()),t.hasRight()&&t.getRight().setParent(t),e.setLeft(t),e.getLeft().setParent(e),this.updateWeight(t),this.updateWeight(e)}rotateRight(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setLeft(e.getRight()),t.hasLeft()&&t.getLeft().setParent(t),e.setRight(t),e.getRight().setParent(e),this.updateWeight(t),this.updateWeight(e)}isLeftChild(e){return e&&e.hasParent()?e.getParent().getLeft()===e:!1}isRightChild(e){return e&&e.hasParent()?e.getParent().getRight()===e:!1}}var se;(function(s){s[s.Null=0]="Null",s[s.Boolean=1]="Boolean",s[s.Integer=2]="Integer",s[s.Long=3]="Long",s[s.Double=4]="Double",s[s.String=5]="String",s[s.Bytes=6]="Bytes",s[s.Date=7]="Date"})(se||(se={}));class xe extends ct{constructor(e,t){super(t),this.valueType=xe.getPrimitiveType(e),this.value=e===void 0?null:e}static of(e,t){return new xe(e,t)}static valueFromBytes(e,t){switch(e){case se.Null:return null;case se.Boolean:return!!t[0];case se.Integer:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case se.Double:{const n=new DataView(t.buffer);return t.forEach(function(i,u){n.setUint8(u,i)}),n.getFloat64(0,!0)}case se.String:return new TextDecoder("utf-8").decode(t);case se.Long:return et.fromBytesLE(Array.from(t));case se.Bytes:return t;case se.Date:return new Date(et.fromBytesLE(Array.from(t),!0).toNumber());default:throw new me(de.Unimplemented,`unimplemented type: ${e}`)}}toJSON(){return this.valueType===se.String?`"${Be(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{id:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){const e=xe.of(this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e.setRemovedAt(this.getRemovedAt()),e}getType(){return this.valueType}static getPrimitiveType(e){switch(typeof e){case"undefined":return se.Null;case"boolean":return se.Boolean;case"number":return this.isInteger(e)?se.Integer:se.Double;case"string":return se.String;case"object":if(e===null)return se.Null;if(e instanceof et)return se.Long;if(e instanceof Uint8Array)return se.Bytes;if(e instanceof Date)return se.Date}}static isSupport(e){return xe.getPrimitiveType(e)!==void 0}static isInteger(e){return e%1===0}isNumericType(){const e=this.valueType;return e===se.Integer||e===se.Long||e===se.Double}getValue(){return this.value}toBytes(){switch(this.valueType){case se.Null:return new Uint8Array;case se.Boolean:return this.value?new Uint8Array([1]):new Uint8Array([0]);case se.Integer:{const e=this.value;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}case se.Double:{const e=this.value,t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),t}case se.String:return new TextEncoder().encode(this.value);case se.Long:{const t=this.value.toBytesLE();return Uint8Array.from(t)}case se.Bytes:return this.value;case se.Date:{const e=this.value,t=et.fromNumber(e.getTime(),!0).toBytesLE();return Uint8Array.from(t)}default:throw new me(de.Unimplemented,`unimplemented type: ${this.valueType}`)}}}class zn extends bt{constructor(e){super(e),this.value=e}static createAfter(e,t){const n=new zn(t),i=e.next;return e.next=n,n.prev=e,n.next=i,i&&(i.prev=n),n}remove(e){return this.value.remove(e)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}}class Jn{constructor(){const e=xe.of(0,ut);e.setRemovedAt(ut),this.dummyHead=new zn(e),this.last=this.dummyHead,this.nodeMapByIndex=new st,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new Jn}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,t){let n=this.nodeMapByCreatedAt.get(e.toIDString());for(n||p.fatal(`cant find the given node: ${e.toIDString()}`);n.getNext()&&n.getNext().getPositionedAt().after(t);)n=n.getNext();return n}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,t,n=t.getCreatedAt()){const i=this.findNextBeforeExecutedAt(e,n),u=zn.createAfter(i,t);i===this.last&&(this.last=u),this.nodeMapByIndex.insertAfter(i,u),this.nodeMapByCreatedAt.set(u.getCreatedAt().toIDString(),u)}moveAfter(e,t,n){const i=this.nodeMapByCreatedAt.get(e.toIDString());i||p.fatal(`cant find the given node: ${e.toIDString()}`);const u=this.nodeMapByCreatedAt.get(t.toIDString());u||p.fatal(`cant find the given node: ${t.toIDString()}`),i!==u&&(!u.getValue().getMovedAt()||n.after(u.getValue().getMovedAt()))&&(this.release(u),this.insertAfter(i.getCreatedAt(),u.getValue(),n),u.getValue().setMovedAt(n))}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(!!t)return String(this.nodeMapByIndex.indexOf(t))}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());t||p.fatal(`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`),this.release(t)}getByIndex(e){if(e>=this.length)return;const[t,n]=this.nodeMapByIndex.find(e);let i=t;if(e===0&&t===this.dummyHead||n>0)do i&&(i=i.getNext());while(i&&i.isRemoved());return i}getPrevCreatedAt(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());do t=t.getPrev();while(this.dummyHead!==t&&t.isRemoved());return t.getValue().getCreatedAt()}delete(e,t){const n=this.nodeMapByCreatedAt.get(e.toIDString()),i=n.isRemoved();return n.remove(t)&&!i&&this.nodeMapByIndex.splayNode(n),n.getValue()}deleteByIndex(e,t){const n=this.getByIndex(e);if(!!n)return n.remove(t)&&this.nodeMapByIndex.splayNode(n),n.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){const e=[];for(const t of this){const n=`${t.getCreatedAt().toIDString()}:${t.getValue().toJSON()}`;t.isRemoved()?e.push(`{${n}}`):e.push(`[${n}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}}class St extends hn{constructor(e,t){super(e),this.elements=t}static create(e,t){if(!t)return new St(e,Jn.create());const n=Jn.create();for(const i of t)n.insertAfter(n.getLastCreatedAt(),i.deepcopy());return new St(e,n)}subPathOf(e){return this.elements.subPathOf(e)}purge(e){this.elements.purge(e)}insertAfter(e,t){this.elements.insertAfter(e,t)}moveAfter(e,t,n){this.elements.moveAfter(e,t,n)}get(e){const t=this.elements.getByIndex(e);return t==null?void 0:t.getValue()}getByID(e){const t=this.elements.getByID(e);return t==null?void 0:t.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(e){return this.elements.getPrevCreatedAt(e)}delete(e,t){return this.elements.delete(e,t)}deleteByIndex(e,t){return this.elements.deleteByIndex(e,t)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(const e of this.elements)e.isRemoved()||(yield e.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(e){for(const t of this.elements){const n=t.getValue();if(e(n,this))return;n instanceof hn&&n.getDescendants(e)}}toJSON(){const e=[];for(const t of this)e.push(t.toJSON());return`[${e.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const e={};for(let t=0;t<this.length;t++){const{id:n,value:i,type:u}=this.get(t).toJSForTest();e[t]={key:String(t),id:n,value:i,type:u}}return{id:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){const e=St.create(this.getCreatedAt());for(const t of this.elements)e.elements.insertAfter(e.getLastCreatedAt(),t.getValue().deepcopy());return e.remove(this.getRemovedAt()),e}}class mn extends Me{constructor(e,t,n){super(e,n),this.createdAt=t}static create(e,t,n){return new mn(e,t,n)}execute(e,t){var n;const i=e.findByCreatedAt(this.getParentCreatedAt());if(i||p.fatal(`fail to find ${this.getParentCreatedAt()}`),i instanceof hn||p.fatal(`only object and array can execute remove: ${i}`),t===_e.UndoRedo){let k=i.getByID(this.createdAt);for(;k;){if(k.getRemovedAt())return;k=(n=e.findElementPairByCreatedAt(k.getCreatedAt()))===null||n===void 0?void 0:n.parent}}const u=i.subPathOf(this.createdAt),c=this.toReverseOperation(i),d=i.delete(this.createdAt,this.getExecutedAt());return e.registerRemovedElement(d),{opInfos:i instanceof St?[{type:"remove",path:e.createPath(this.getParentCreatedAt()),index:Number(u)}]:[{type:"remove",path:e.createPath(this.getParentCreatedAt()),key:u}],reverseOp:c}}toReverseOperation(e){if(e instanceof Oe){const t=e.subPathOf(this.createdAt);if(t!==void 0){const n=e.get(t);if(n!==void 0)return wn.create(t,n.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}}class wn extends Me{constructor(e,t,n,i){super(n,i),this.key=e,this.value=t}static create(e,t,n,i){return new wn(e,t,n,i)}execute(e,t){var n;const i=e.findByCreatedAt(this.getParentCreatedAt());if(i||p.fatal(`fail to find ${this.getParentCreatedAt()}`),i instanceof Oe||p.fatal("fail to execute, only object can execute set"),t===_e.UndoRedo){let k=i;for(;k;){if(k.getRemovedAt())return;k=(n=e.findElementPairByCreatedAt(k.getCreatedAt()))===null||n===void 0?void 0:n.parent}}const u=i.get(this.key),c=this.toReverseOperation(u),d=this.value.deepcopy(),v=i.set(this.key,d,this.getExecutedAt());return t===_e.UndoRedo&&e.findByCreatedAt(d.getCreatedAt())&&e.deregisterElement(d),e.registerElement(d,i),v&&e.registerRemovedElement(v),{opInfos:[{type:"set",path:e.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:c}}toReverseOperation(e){let t=mn.create(this.getParentCreatedAt(),this.value.getCreatedAt());return e!==void 0&&!e.isRemoved()&&(t=wn.create(this.key,e.deepcopy(),this.getParentCreatedAt())),t}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}}class Fn extends Me{constructor(e,t,n,i){super(e,i),this.prevCreatedAt=t,this.value=n}static create(e,t,n,i){return new Fn(e,t,n,i)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||p.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof St||p.fatal("fail to execute, only array can execute add");const n=t,i=this.value.deepcopy();return n.insertAfter(this.prevCreatedAt,i),e.registerElement(i,n),{opInfos:[{type:"add",path:e.createPath(this.getParentCreatedAt()),index:Number(n.subPathOf(this.getEffectedCreatedAt()))}]}}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}}class gn extends Me{constructor(e,t,n,i){super(e,i),this.prevCreatedAt=t,this.createdAt=n}static create(e,t,n,i){return new gn(e,t,n,i)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||p.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof St||p.fatal("fail to execute, only array can execute move");const n=t,i=Number(n.subPathOf(this.createdAt));n.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());const u=Number(n.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:e.createPath(this.getParentCreatedAt()),index:u,previousIndex:i}]}}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}}class Xn{constructor(e,t,n){this.key=e,this.value=t,this.updatedAt=n}static of(e,t,n){return new Xn(e,t,n)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}}class jt{constructor(){this.nodeMapByKey=new Map}static create(){return new jt}set(e,t,n){const i=this.nodeMapByKey.get(e);if(i===void 0||n.after(i.getUpdatedAt())){const u=Xn.of(e,t,n);this.nodeMapByKey.set(e,u)}}has(e){return this.nodeMapByKey.has(e)}get(e){if(!!this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){const e=new jt;for(const[,t]of this.nodeMapByKey)e.set(t.getKey(),t.getValue(),t.getUpdatedAt());return e}toJSON(){const e=[];for(const[t,n]of this.nodeMapByKey)e.push(`"${Be(t)}":"${Be(n.getValue())}"`);return`{${e.join(",")}}`}toXML(){return this.size()?` ${[...this.nodeMapByKey].map(([e,t])=>`${e}="${JSON.parse(t.getValue())}"`).join(" ")}`:""}size(){return this.nodeMapByKey.size}toObject(){const e={};for(const[t,n]of this.nodeMapByKey)e[t]=n.getValue();return e}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}}var It;(function(s){s.Content="content",s.Style="style"})(It||(It={}));class kt{constructor(e){this.attributes=jt.create(),this.content=e}static create(e){return new kt(e)}get length(){return this.content.length}substring(e,t){const n=new kt(this.content.substring(e,t));return n.attributes=this.attributes.deepcopy(),n}setAttr(e,t,n){this.attributes.set(e,t,n)}getAttrs(){return this.attributes}toString(){return this.content}toJSON(){const e=Be(this.content),t=this.attributes.toObject(),n=[];for(const[i,u]of Object.entries(t)){const c=JSON.parse(u),d=typeof c=="string"?`"${Be(i)}":"${Be(c)}"`:`"${Be(i)}":${String(c)}`;n.push(d)}return n.sort(),n.length===0?`{"val":"${e}"}`:`{"attrs":{${n.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}}class Ge extends Nt{constructor(e,t){super(t),this.rgaTreeSplit=e}static create(e,t){return new Ge(e,t)}edit(e,t,n,i,u){const c=t?kt.create(t):void 0;if(c&&i)for(const[Q,J]of Object.entries(i))c.setAttr(Q,J,n);const[d,v,k]=this.rgaTreeSplit.edit(e,n,c,u),z=k.map(Q=>({...Q,value:Q.value?{attributes:We(Q.value.getAttributes()),content:Q.value.getContent()}:{attributes:void 0,content:""},type:It.Content}));return[v,z,[d,d]]}setStyle(e,t,n,i){const[,u]=this.rgaTreeSplit.findNodeWithSplit(e[1],n),[,c]=this.rgaTreeSplit.findNodeWithSplit(e[0],n),d=[],v=this.rgaTreeSplit.findBetween(c,u),k=new Map,z=[];for(const Q of v){const J=Q.getCreatedAt().getActorID(),ie=i!=null&&i.size?i.has(J)?i.get(J):ut:gt;if(Q.canStyle(n,ie)){const he=k.get(J),ge=Q.getCreatedAt();(!he||ge.after(he))&&k.set(J,ge),z.push(Q)}}for(const Q of z){if(Q.isRemoved())continue;const[J,ie]=this.rgaTreeSplit.findIndexesFromRange(Q.createPosRange());d.push({type:It.Style,actor:n.getActorID(),from:J,to:ie,value:{attributes:We(t)}});for(const[he,ge]of Object.entries(t))Q.getValue().setAttr(he,ge,n)}return[k,d]}indexRangeToPosRange(e,t){const n=this.rgaTreeSplit.indexToPos(e);return e===t?[n,n]:[n,this.rgaTreeSplit.indexToPos(t)]}get length(){return this.rgaTreeSplit.length}checkWeight(){return this.rgaTreeSplit.checkWeight()}toJSON(){const e=[];for(const t of this.rgaTreeSplit)t.isRemoved()||e.push(t.getValue().toJSON());return`[${e.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{id:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){const e=[];for(const t of this.rgaTreeSplit)if(!t.isRemoved()){const n=t.getValue();e.push({attributes:We(n.getAttributes()),content:n.getContent()})}return e}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}getRemovedNodesLen(){return this.rgaTreeSplit.getRemovedNodesLen()}purgeRemovedNodesBefore(e){return this.rgaTreeSplit.purgeRemovedNodesBefore(e)}deepcopy(){const e=new Ge(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return e.remove(this.getRemovedAt()),e}findIndexesFromRange(e){return this.rgaTreeSplit.findIndexesFromRange(e)}}class pn extends Me{constructor(e,t,n,i,u,c,d){super(e,d),this.fromPos=t,this.toPos=n,this.maxCreatedAtMapByActor=i,this.content=u,this.attributes=c}static create(e,t,n,i,u,c,d){return new pn(e,t,n,i,u,c,d)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||p.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof Ge||p.fatal("fail to execute, only Text can execute edit");const n=t,[,i]=n.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),this.maxCreatedAtMapByActor);return this.fromPos.equals(this.toPos)||e.registerElementHasRemovedNodes(n),{opInfos:i.map(({from:u,to:c,value:d})=>({type:"edit",from:u,to:c,value:d,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),n=this.toPos.toTestString(),i=this.content;return`${e}.EDIT(${t},${n},${i})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}class yt extends Me{constructor(e,t,n,i,u,c){super(e,c),this.fromPos=t,this.toPos=n,this.maxCreatedAtMapByActor=i,this.attributes=u}static create(e,t,n,i,u,c){return new yt(e,t,n,i,u,c)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||p.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof Ge||p.fatal("fail to execute, only Text can execute edit");const n=t,[,i]=n.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),this.maxCreatedAtMapByActor);return{opInfos:i.map(({from:u,to:c,value:d})=>({type:"style",from:u,to:c,value:d,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),n=this.toPos.toTestString(),i=this.attributes;return`${e}.STYL(${t},${n},${JSON.stringify(i)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}const Lt=2,Bt="root",tt="text";function At(s,e){let t=0;const n=s.children;for(let i=0;i<e;i++){const u=n[i];!u||u.isRemoved||(t+=u.paddedSize)}return t}class An{constructor(e,t=[]){if(this.type=e,this.size=0,this._children=t,this.isText&&this._children.length>0)throw new Error(`Text node cannot have children: ${this.type}`)}updateAncestorsSize(){let e=this.parent;const t=this.isRemoved?-1:1;for(;e;)e.size+=this.paddedSize*t,e=e.parent}get isText(){return this.type===tt}get paddedSize(){return this.size+(this.isText?0:Lt)}isAncestorOf(e){return On(this,e)}get nextSibling(){const e=this.parent.findOffset(this),t=this.parent.children[e+1];if(t)return t}splitText(e,t){if(e===0||e===this.size)return;const n=this.value.slice(0,e),i=this.value.slice(e);if(!i.length)return;this.value=n;const u=this.cloneText(e+t);return u.value=i,this.parent.insertAfterInternal(u,this),u}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.some(e=>e.isText)}append(...e){if(this.isText)throw new Error("Text node cannot have children");this._children.push(...e);for(const t of e)t.parent=this,t.updateAncestorsSize()}prepend(...e){if(this.isText)throw new Error("Text node cannot have children");this._children.unshift(...e);for(const t of e)t.parent=this,t.isRemoved||t.updateAncestorsSize()}insertBefore(e,t){if(this.isText)throw new Error("Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new Error("child not found");this.insertAtInternal(e,n),e.updateAncestorsSize()}insertAfter(e,t){if(this.isText)throw new Error("Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new Error("child not found");this.insertAtInternal(e,n+1),e.updateAncestorsSize()}insertAt(e,t){if(this.isText)throw new Error("Text node cannot have children");this.insertAtInternal(e,t),e.updateAncestorsSize()}removeChild(e){if(this.isText)throw new Error("Text node cannot have children");const t=this._children.indexOf(e);if(t===-1)throw new Error("child not found");this._children.splice(t,1),e.parent=void 0}splitElement(e,t){const n=this.cloneElement(t);this.parent.insertAfterInternal(n,this),n.updateAncestorsSize();const i=this.children.slice(0,e),u=this.children.slice(e);this._children=i,n._children=u,this.size=this._children.reduce((c,d)=>c+d.paddedSize,0),n.size=n._children.reduce((c,d)=>c+d.paddedSize,0);for(const c of n._children)c.parent=n;return n}insertAfterInternal(e,t){if(this.isText)throw new Error("Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new Error("child not found");this.insertAtInternal(e,n+1)}insertAtInternal(e,t){if(this.isText)throw new Error("Text node cannot have children");this._children.splice(t,0,e),e.parent=this}findOffset(e){if(this.isText)throw new Error("Text node cannot have children");if(e.isRemoved){const t=this._children.indexOf(e);return this.allChildren.splice(0,t).filter(i=>!i.isRemoved).length}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw new Error("Text node cannot have children");let t=e;for(;t;){const n=this._children.indexOf(t);if(n!==-1)return n;t=t.parent}return-1}}function On(s,e){if(s===e)return!1;for(;e.parent;){if(e.parent===s)return!0;e=e.parent}return!1}var be;(function(s){s.Start="Start",s.End="End",s.Text="Text"})(be||(be={}));function qt(s,e,t,n){if(e>t)throw new Error(`from is greater than to: ${e} > ${t}`);if(e>s.size)throw new Error(`from is out of range: ${e} > ${s.size}`);if(t>s.size)throw new Error(`to is out of range: ${t} > ${s.size}`);if(e===t)return;let i=0;for(const u of s.children){if(e-u.paddedSize<i&&i<t){const c=u.isText?e-i:e-i-1,d=u.isText?t-i:t-i-1,v=!u.isText&&c<0,k=!u.isText&&d>u.size;(u.isText||v)&&n([u,u.isText?be.Text:be.Start],k),qt(u,Math.max(0,c),Math.min(d,u.size),n),k&&n([u,be.End],k)}i+=u.paddedSize}}function nt(s,e,t=0){for(const n of s.children)nt(n,e,t+1);e(s,t)}function Yt(s,e,t=0){for(const n of s._children)Yt(n,e,t+1);e(s,t)}function Mt(s,e,t=!0){if(e>s.size)throw new Error(`index is out of range: ${e} > ${s.size}`);if(s.isText)return{node:s,offset:e};let n=0,i=0;for(const u of s.children){if(t&&u.isText&&u.size>=e-i)return Mt(u,e-i,t);if(e===i)return{node:s,offset:n};if(!t&&u.paddedSize===e-i)return{node:s,offset:n+1};if(u.paddedSize>e-i)return Mt(u,e-i-1,t);i+=u.paddedSize,n+=1}return{node:s,offset:n}}function Kt(s){return s.isText||s.children.length===0?s:Kt(s.children[0])}function a(s,e){if(s.size<e)throw new Error("unacceptable path");for(let t=0;t<s.children.length;t++){const n=s.children[t];if(n.size<e)e-=n.size;else{s=n;break}}return{node:s,offset:e}}class r{constructor(e){this.root=e}tokensBetween(e,t,n){qt(this.root,e,t,n)}traverse(e){nt(this.root,e,0)}traverseAll(e){Yt(this.root,e,0)}findTreePos(e,t=!0){return Mt(this.root,e,t)}treePosToPath(e){const t=[];let n=e.node;if(n.isText){const i=n.parent.findOffset(n);if(i===-1)throw new Error("invalid treePos");const u=At(n.parent,i);n=n.parent,t.push(u+e.offset)}else t.push(e.offset);for(;n.parent;){const i=n.parent.findOffset(n);if(i===-1)throw new Error("invalid treePos");t.push(i),n=n.parent}return t.reverse()}pathToIndex(e){const t=this.pathToTreePos(e);return this.indexOf(t)}pathToTreePos(e){if(!e.length)throw new Error("unacceptable path");let t=this.root;for(let n=0;n<e.length-1;n++){const i=e[n];if(t=t.children[i],!t)throw new Error("unacceptable path")}if(t.hasTextChild())return a(t,e[e.length-1]);if(t.children.length<e[e.length-1])throw new Error("unacceptable path");return{node:t,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.size}findPostorderRight(e){const{node:t,offset:n}=e;if(t.isText){if(t.size===n){const i=t.nextSibling;return i||t.parent}return t}return t.children.length===n?t:Kt(t.children[n])}indexOf(e){let{node:t}=e;const{offset:n}=e;let i=0,u=1;if(t.isText){i+=n;const c=t.parent,d=c.findOffset(t);if(d===-1)throw new Error("invalid pos");i+=At(c,d),t=t.parent}else i+=At(t,n);for(;t!=null&&t.parent;){const c=t.parent,d=c.findOffset(t);if(d===-1)throw new Error("invalid pos");i+=At(c,d),u++,t=t.parent}return i+u-1}indexToPath(e){const t=this.findTreePos(e);return this.treePosToPath(t)}}const o=(s,e)=>s===e?0:s<e?-1:1;class h{constructor(e,t,n){this.key=e,this.value=t,this.isRed=n}}class g{constructor(e){this.stack=[],this.traverseInorder(e)}traverseInorder(e){!e||(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}}class E{constructor(e){this.comparator=typeof e<"u"?e:o,this.counter=0}put(e,t){return this.root=this.putInternal(e,t,this.root),this.root.isRed=!1,t}get(e){const t=this.getInternal(e,this.root);return t?t.value:void 0}remove(e){!this.isRed(this.root.left)&&!this.isRed(this.root.right)&&(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new g(this.root)}values(){const e=[];for(const t of this.getIterator().stack)e.push(t.value);return e}floorEntry(e){let t=this.root;for(;t;){const n=this.comparator(e,t.key);if(n>0)if(t.right)t.right.parent=t,t=t.right;else return t;else if(n<0)if(t.left)t.left.parent=t,t=t.left;else{let i=t.parent,u=t;for(;i&&u===i.left;)u=i,i=i.parent;return i}else return t}}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return this.counter===0}getInternal(e,t){for(;t;){const n=this.comparator(e,t.key);if(n===0)return t;n<0?t=t.left:n>0&&(t=t.right)}}putInternal(e,t,n){if(!n)return this.counter+=1,new h(e,t,!0);const i=this.comparator(e,n.key);return i<0?n.left=this.putInternal(e,t,n.left):i>0?n.right=this.putInternal(e,t,n.right):n.value=t,this.isRed(n.right)&&!this.isRed(n.left)&&(n=this.rotateLeft(n)),this.isRed(n.left)&&this.isRed(n.left.left)&&(n=this.rotateRight(n)),this.isRed(n.left)&&this.isRed(n.right)&&this.flipColors(n),n}removeInternal(e,t){if(this.comparator(t,e.key)<0)!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),this.comparator(t,e.key)===0&&!e.right){this.counter-=1;return}if(!this.isRed(e.right)&&!this.isRed(e.right.left)&&(e=this.moveRedRight(e)),this.comparator(t,e.key)===0){this.counter-=1;const n=this.min(e.right);e.value=n.value,e.key=n.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,t)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(!!e.left)return!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.isRed=t.left.isRed,t.left.isRed=!0,t}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.isRed=t.right.isRed,t.right.isRed=!0,t}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}}var b;(function(s){s.Content="content",s.Style="style"})(b||(b={}));class M{constructor(e,t){this.parentID=e,this.leftSiblingID=t}static of(e,t){return new M(e,t)}static fromTreePos(e){const{offset:t}=e;let{node:n}=e,i;return n.isText?(n.parent.children[0]===n&&t===0?i=n.parent:i=n,n=n.parent):t===0?i=n:i=n.children[t-1],M.of(n.id,A.of(i.getCreatedAt(),i.getOffset()+t))}getParentID(){return this.parentID}static fromStruct(e){return M.of(A.of(Pe.fromStruct(e.parentID.createdAt),e.parentID.offset),A.of(Pe.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodes(e){const t=this.getParentID(),n=this.getLeftSiblingID(),i=e.findFloorNode(t);let u=e.findFloorNode(n);if(!i||!u)throw new Error(`cannot find node at ${this}`);return!n.equals(t)&&n.getOffset()>0&&n.getOffset()===u.id.getOffset()&&u.insPrevID&&(u=e.findFloorNode(u.insPrevID)),[i,u]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}}class A{constructor(e,t){this.createdAt=e,this.offset=t}static of(e,t){return new A(e,t)}static fromStruct(e){return A.of(Pe.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,t)=>{const n=e.getCreatedAt().compare(t.getCreatedAt());return n!==0?n:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}class K extends An{constructor(e,t,n,i,u){super(t),this._value="",this.id=e,this.removedAt=u,i&&(this.attrs=i),typeof n=="string"?this.value=n:Array.isArray(n)&&(this._children=n)}static create(e,t,n,i){return new K(e,t,n,i)}deepcopy(){var e;const t=new K(this.id,this.type);return t.removedAt=this.removedAt,t._value=this._value,t.size=this.size,t.attrs=(e=this.attrs)===null||e===void 0?void 0:e.deepcopy(),t._children=this._children.map(n=>{const i=n.deepcopy();return i.parent=t,i}),t}get value(){if(!this.isText)throw new Error(`cannot get value of element node: ${this.type}`);return this._value}set value(e){if(!this.isText)throw new Error(`cannot set value of element node: ${this.type}`);this._value=e,this.size=e.length}get isRemoved(){return!!this.removedAt}remove(e){const t=!this.removedAt;(!this.removedAt||this.removedAt.compare(e)>0)&&(this.removedAt=e),t&&(this.parent.removedAt?this.parent.size-=this.paddedSize:this.updateAncestorsSize())}cloneText(e){return new K(A.of(this.id.getCreatedAt(),e),this.type,void 0,void 0,this.removedAt)}cloneElement(e){return new K(A.of(e(),0),this.type,void 0,void 0,this.removedAt)}split(e,t,n){const i=this.isText?this.splitText(t,this.id.getOffset()):this.splitElement(t,n);if(i){if(i.insPrevID=this.id,this.insNextID){const u=e.findFloorNode(this.insNextID);u.insPrevID=i.id,i.insNextID=this.insNextID}this.insNextID=i.id,e.registerNode(i)}return i}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}}function Z(s){var e;if(s.isText){const t=s;return{type:t.type,value:t.value}}return{type:s.type,children:s.children.map(Z),attributes:s.attrs?We((e=s.attrs)===null||e===void 0?void 0:e.toObject()):void 0}}function ce(s){var e;return s.isText?s.value:`<${s.type}${((e=s.attrs)===null||e===void 0?void 0:e.toXML())||""}>${s.children.map(t=>ce(t)).join("")}</${s.type}>`}function De(s){if(s.isText){const e=s;return{type:e.type,value:e.value,size:e.size,isRemoved:e.isRemoved}}return{type:s.type,children:s.children.map(De),size:s.size,isRemoved:s.isRemoved}}class fe extends Nt{constructor(e,t){super(t),this.indexTree=new r(e),this.nodeMapByID=new E(A.createComparator()),this.removedNodeMap=new Map,this.indexTree.traverse(n=>{this.nodeMapByID.put(n.id,n)})}static create(e,t){return new fe(e,t)}findFloorNode(e){const t=this.nodeMapByID.floorEntry(e);if(!(!t||!t.key.getCreatedAt().equals(e.getCreatedAt())))return t.value}registerNode(e){this.nodeMapByID.put(e.id,e)}findNodesAndSplitText(e,t){const[n,i]=e.toTreeNodes(this);let u=i;const c=n===u,d=u.parent&&!c?u.parent:n;u.isText&&u.split(this,e.getLeftSiblingID().getOffset()-u.id.getOffset());const v=d.allChildren,k=c?0:v.indexOf(u)+1;for(let z=k;z<v.length;z++){const Q=v[z];if(!Q.id.getCreatedAt().after(t))break;u=Q}return[d,u]}style(e,t,n){const[i,u]=this.findNodesAndSplitText(e[0],n),[c,d]=this.findNodesAndSplitText(e[1],n),v=[];return v.push({type:b.Style,from:this.toIndex(i,u),to:this.toIndex(c,d),fromPath:this.toPath(i,u),toPath:this.toPath(c,d),actor:n.getActorID(),value:t?We(t):void 0}),this.traverseInPosRange(i,u,c,d,([k])=>{if(!k.isRemoved&&!k.isText&&t){k.attrs||(k.attrs=new jt);for(const[z,Q]of Object.entries(t))k.attrs.set(z,Q,n)}}),v}edit(e,t,n,i,u,c){const[d,v]=this.findNodesAndSplitText(e[0],i),[k,z]=this.findNodesAndSplitText(e[1],i),Q=this.toIndex(d,v),J=this.toPath(d,v),ie=[],he=[],ge=[],ke=new Map;this.traverseInPosRange(d,v,k,z,([Te,Ve],Ue)=>{if(Ve===be.Start&&!Ue)for(const rr of Te.children)ge.push(rr);const Qe=Te.getCreatedAt().getActorID(),jn=c?c.has(Qe)?c.get(Qe):ut:gt;if(Te.canDelete(i,jn)||ie.includes(Te.parent)){const rr=ke.get(Qe),hr=Te.getCreatedAt();(!rr||hr.after(rr))&&ke.set(Qe,hr),(Ve===be.Text||Ve===be.Start)&&ie.push(Te),he.push([Te,Ve])}});const lt=this.makeDeletionChanges(he,i);for(const Te of ie)Te.remove(i),Te.isRemoved&&this.removedNodeMap.set(Te.id.toIDString(),Te);for(const Te of ge)Te.removedAt||d.append(Te);if(n>0){let Te=0,Ve=d,Ue=v;for(;Te<n;)Ve.split(this,Ve.findOffset(Ue)+1,u),Ue=Ve,Ve=Ve.parent,Te++;lt.push({type:b.Content,from:Q,to:Q,fromPath:J,toPath:J,actor:i.getActorID()})}if(t!=null&&t.length){const Te=[];let Ve=v;for(const Ue of t)Ve===d?d.insertAt(Ue,0):d.insertAfter(Ue,Ve),Ve=Ue,Yt(Ue,Qe=>{d.isRemoved&&(Qe.remove(i),this.removedNodeMap.set(Qe.id.toIDString(),Qe)),this.nodeMapByID.put(Qe.id,Qe)}),Ue.isRemoved||Te.push(Ue);if(Te.length){const Ue=Te.map(Qe=>Z(Qe));lt.length&&lt[lt.length-1].from===Q?lt[lt.length-1].value=Ue:lt.push({type:b.Content,from:Q,to:Q,fromPath:J,toPath:J,actor:i.getActorID(),value:Ue})}}return[lt,ke]}editT(e,t,n,i,u){const c=this.findPos(e[0]),d=this.findPos(e[1]);this.edit([c,d],t,n,i,u)}move(e,t,n){throw new Error(`not implemented: ${e}, ${t}, ${n}`)}purgeRemovedNodesBefore(e){var t;const n=new Set;let i=0;for(const[,u]of this.removedNodeMap)u.removedAt&&e.compare(u.removedAt)>=0&&(n.add(u),i++);for(const u of n)(t=u.parent)===null||t===void 0||t.removeChild(u),this.nodeMapByID.remove(u.id),this.purge(u),this.removedNodeMap.delete(u.id.toIDString());return i}purge(e){const t=e.insPrevID,n=e.insNextID;if(t){const i=this.findFloorNode(t);i.insNextID=n}if(n){const i=this.findFloorNode(n);i.insPrevID=t}e.insPrevID=void 0,e.insNextID=void 0}findPos(e,t=!0){const n=this.indexTree.findTreePos(e,t);return M.fromTreePos(n)}getRemovedNodesLen(){return this.removedNodeMap.size}pathToPosRange(e){const t=this.pathToIndex(e);return[this.findPos(t),this.findPos(t+1)]}pathToPos(e){const t=this.indexTree.pathToIndex(e);return this.findPos(t)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getIndexTree(){return this.indexTree}toXML(){return ce(this.indexTree.getRoot())}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{id:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}getRootTreeNode(){return Z(this.indexTree.getRoot())}toTestTreeNode(){return De(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){const e=this.getRoot();return new fe(e.deepcopy(),this.getCreatedAt())}toPath(e,t){const n=this.toTreePos(e,t);return n?this.indexTree.treePosToPath(n):[]}toIndex(e,t){const n=this.toTreePos(e,t);return n?this.indexTree.indexOf(n):-1}indexToPath(e){return this.indexTree.indexToPath(e)}pathToIndex(e){return this.indexTree.pathToIndex(e)}indexRangeToPosRange(e){const t=this.findPos(e[0]);return e[0]===e[1]?[t,t]:[t,this.findPos(e[1])]}indexRangeToPosStructRange(e){const[t,n]=e,i=this.findPos(t);return t===n?[i.toStruct(),i.toStruct()]:[i.toStruct(),this.findPos(n).toStruct()]}posRangeToPathRange(e,t){const[n,i]=this.findNodesAndSplitText(e[0],t),[u,c]=this.findNodesAndSplitText(e[1],t);return[this.toPath(n,i),this.toPath(u,c)]}posRangeToIndexRange(e,t){const[n,i]=this.findNodesAndSplitText(e[0],t),[u,c]=this.findNodesAndSplitText(e[1],t);return[this.toIndex(n,i),this.toIndex(u,c)]}traverseInPosRange(e,t,n,i,u){const c=this.toIndex(e,t),d=this.toIndex(n,i);return this.indexTree.tokensBetween(c,d,u)}toTreePos(e,t){if(!e||!t)return;if(e.isRemoved){let i;for(;e.isRemoved;)i=e,e=i.parent;const u=e.findOffset(i);return{node:e,offset:u}}if(e===t)return{node:e,offset:0};let n=e.findOffset(t);if(!t.isRemoved){if(t.isText)return{node:t,offset:t.paddedSize};n++}return{node:e,offset:n}}makeDeletionChanges(e,t){const n=[],i=[];let u=null,c=null;for(let d=0;d<e.length;d++){const v=e[d],k=e[d+1];u||(u=v),c=v;const z=this.findRightToken(v);(!z||!k||z[0]!==k[0]||z[1]!==k[1])&&(i.push([u,c]),u=null,c=null)}for(const d of i){const[v,k]=d,[z,Q]=this.findLeftToken(v),[J,ie]=k,he=Q===be.Start?z:z.parent,ge=ie===be.Start?J:J.parent,ke=this.toIndex(he,z),lt=this.toIndex(ge,J);ke<lt&&(n.length>0&&ke===n[n.length-1].to?(n[n.length-1].to=lt,n[n.length-1].toPath=this.toPath(ge,J)):n.push({type:b.Content,from:ke,to:lt,fromPath:this.toPath(he,z),toPath:this.toPath(ge,J),actor:t.getActorID()}))}return n}findRightToken([e,t]){if(t===be.Start){const d=e.allChildren;return d.length>0?[d[0],d[0].isText?be.Text:be.Start]:[e,be.End]}const n=e.parent,i=n.allChildren,u=i.indexOf(e);if(n&&u===i.length-1)return[n,be.End];const c=i[u+1];return[c,c.isText?be.Text:be.Start]}findLeftToken([e,t]){if(t===be.End){const d=e.allChildren;if(d.length>0){const v=d[d.length-1];return[v,v.isText?be.Text:be.End]}return[e,be.Start]}const n=e.parent,i=n.allChildren,u=i.indexOf(e);if(n&&u===0)return[n,be.Start];const c=i[u-1];return[c,c.isText?be.Text:be.End]}}class it extends Me{constructor(e,t,n,i,u,c,d){super(e,d),this.fromPos=t,this.toPos=n,this.contents=i,this.splitLevel=u,this.maxCreatedAtMapByActor=c}static create(e,t,n,i,u,c,d){return new it(e,t,n,i,u,c,d)}execute(e){var t;const n=e.findByCreatedAt(this.getParentCreatedAt());n||p.fatal(`fail to find ${this.getParentCreatedAt()}`),n instanceof fe||p.fatal("fail to execute, only Tree can execute edit");const i=this.getExecutedAt(),u=n,[c]=u.edit([this.fromPos,this.toPos],(t=this.contents)===null||t===void 0?void 0:t.map(d=>d.deepcopy()),this.splitLevel,i,(()=>{let d=i.getDelimiter();return this.contents!==void 0&&(d+=this.contents.length),()=>Pe.of(i.getLamport(),++d,i.getActorID())})(),this.maxCreatedAtMapByActor);return this.fromPos.equals(this.toPos)||e.registerElementHasRemovedNodes(u),{opInfos:c.map(({from:d,to:v,value:k,splitLevel:z,fromPath:Q,toPath:J})=>({type:"tree-edit",path:e.createPath(this.getParentCreatedAt()),from:d,to:v,value:k,splitLevel:z,fromPath:Q,toPath:J}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,n=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`,i=this.contents;return`${e}.EDIT(${t},${n},${i==null?void 0:i.join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}class Wt{constructor(e,t,n){this.clientSeq=e,this.lamport=t,this.actor=n}static of(e,t,n){return new Wt(e,t,n)}next(){return new Wt(this.clientSeq+1,this.lamport.add(1),this.actor)}syncLamport(e){return e.greaterThan(this.lamport)?new Wt(this.clientSeq,e,this.actor):new Wt(this.clientSeq,this.lamport.add(1),this.actor)}createTimeTicket(e){return Pe.of(this.lamport,e,this.actor)}setActor(e){return new Wt(this.clientSeq,this.lamport,e)}getClientSeq(){return this.clientSeq}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}toTestString(){return this.actor?`${this.lamport.toString()}:${this.actor.substring(22,24)}:${this.clientSeq}`:`${this.lamport.toString()}:nil:${this.clientSeq}`}}const Pr=new Wt(0,et.fromInt(0,!0),pr);class Un{constructor({id:e,operations:t,presenceChange:n,message:i}){this.id=e,this.operations=t||[],this.presenceChange=n,this.message=i}static create({id:e,operations:t,presenceChange:n,message:i}){return new Un({id:e,operations:t,presenceChange:n,message:i})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(const t of this.operations)t.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return this.presenceChange!==void 0}getPresenceChange(){return this.presenceChange}execute(e,t,n){const i=[],u=[];for(const c of this.operations){const d=c.execute(e,n);if(!d)continue;const{opInfos:v,reverseOp:k}=d;i.push(...v),k&&u.unshift(k)}return this.presenceChange&&(this.presenceChange.type===Vt.Put?t.set(this.id.getActorID(),rn(this.presenceChange.presence)):t.delete(this.id.getActorID())),{opInfos:i,reverseOps:u}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}}class yr{constructor(e,t,n,i,u,c){this.documentKey=e,this.checkpoint=t,this.isRemoved=n,this.changes=i,this.snapshot=u,this.minSyncedTicket=c}static create(e,t,n,i,u,c){return new yr(e,t,n,i,u,c)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getMinSyncedTicket(){return this.minSyncedTicket}}class Hn{constructor(e,t){this.serverSeq=e,this.clientSeq=t}static of(e,t){return new Hn(e,t)}increaseClientSeq(e){return e===0?this:new Hn(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;const t=this.serverSeq.greaterThan(e.serverSeq)?this.serverSeq:e.serverSeq,n=Math.max(this.clientSeq,e.clientSeq);return Hn.of(t,n)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq.equals(e.serverSeq)}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}}const ms=new Hn(et.fromInt(0,!0),0);class yn{constructor(e,t){this.createdAt=e,this.offset=t}static of(e,t){return new yn(e,t)}static fromStruct(e){return yn.of(Pe.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}hasSameCreatedAt(e){return this.createdAt.compare(e.createdAt)===0}split(e){return new yn(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}const gs=yn.of(ut,0);class ln{constructor(e,t){this.id=e,this.relativeOffset=t}static of(e,t){return new ln(e,t)}static fromStruct(e){const t=yn.fromStruct(e.id);return ln.of(t,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return yn.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return this.id.equals(e.id)?this.relativeOffset===e.relativeOffset:!1}}class Pn extends bt{constructor(e,t,n){super(t),this.id=e,this.removedAt=n}static create(e,t){return new Pn(e,t)}static createComparator(){return(e,t)=>{const n=e.getCreatedAt().compare(t.getCreatedAt());return n!==0?n:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(e){this.prev=e,e&&(e.next=this)}setNext(e){this.next=e,e&&(e.prev=this)}setInsPrev(e){this.insPrev=e,e&&(e.insNext=this)}setInsNext(e){this.insNext=e,e&&(e.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(e){return new Pn(this.id.split(e),this.splitValue(e),this.removedAt)}canDelete(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}canStyle(e,t){return!this.getCreatedAt().after(t)&&(!this.removedAt||e.after(this.removedAt))}remove(e){this.removedAt=e}createPosRange(){return[ln.of(this.id,0),ln.of(this.id,this.getLength())]}deepcopy(){return new Pn(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(e){const t=this.value;return this.value=t.substring(0,e),t.substring(e,t.length)}}class Zn{constructor(){this.head=Pn.create(gs),this.treeByIndex=new st,this.treeByID=new E(Pn.createComparator()),this.removedNodeMap=new Map,this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new Zn}edit(e,t,n,i){const[u,c]=this.findNodeWithSplit(e[1],t),[d,v]=this.findNodeWithSplit(e[0],t),k=this.findBetween(v,c),[z,Q,J]=this.deleteNodes(k,t,i),ie=c?c.getID():u.getID();let he=ln.of(ie,0);if(n){const ge=this.posToIndex(d.createPosRange()[1],!0),ke=this.insertAfter(d,Pn.create(yn.of(t,0),n));z.length&&z[z.length-1].from===ge?z[z.length-1].value=n:z.push({actor:t.getActorID(),from:ge,to:ge,value:n}),he=ln.of(ke.getID(),ke.getContentLength())}for(const[ge,ke]of J)this.removedNodeMap.set(ge,ke);return[he,Q,z]}indexToPos(e){const[t,n]=this.treeByIndex.find(e),i=t;return ln.of(i.getID(),n)}findIndexesFromRange(e){const[t,n]=e;return[this.posToIndex(t,!1),this.posToIndex(n,!0)]}posToIndex(e,t){const n=e.getAbsoluteID(),i=t?this.findFloorNodePreferToLeft(n):this.findFloorNode(n);i||p.fatal(`the node of the given id should be found: ${n.toTestString()}`);const u=this.treeByIndex.indexOf(i),c=i.isRemoved()?0:n.getOffset()-i.getID().getOffset();return u+c}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}checkWeight(){return this.treeByIndex.checkWeight()}toString(){const e=[];for(const t of this)t.isRemoved()||e.push(t.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){const e=new Zn;let t=this.head.getNext(),n=e.head,i;for(;t;){if(i=e.insertAfter(n,t.deepcopy()),t.hasInsPrev()){const u=e.findNode(t.getInsPrevID());i.setInsPrev(u)}n=i,t=t.getNext()}return e}toTestString(){const e=[];let t=this.head;for(;t;)t.isRemoved()?e.push(`{${t.toTestString()}}`):e.push(`[${t.toTestString()}]`),t=t.getNext();return e.join("")}insertAfter(e,t){const n=e.getNext();return t.setPrev(e),n&&n.setPrev(t),this.treeByID.put(t.getID(),t),this.treeByIndex.insertAfter(e,t),t}findNodeWithSplit(e,t){const n=e.getAbsoluteID();let i=this.findFloorNodePreferToLeft(n);const u=n.getOffset()-i.getID().getOffset();for(this.splitNode(i,u);i.hasNext()&&i.getNext().getCreatedAt().after(t);)i=i.getNext();return[i,i.getNext()]}findFloorNodePreferToLeft(e){let t=this.findFloorNode(e);if(t||p.fatal(`the node of the given id should be found: ${e.toTestString()}`),e.getOffset()>0&&t.getID().getOffset()==e.getOffset()){if(!t.hasInsPrev())return t;t=t.getInsPrev()}return t}findFloorNode(e){const t=this.treeByID.floorEntry(e);if(!!t&&!(!t.key.equals(e)&&!t.key.hasSameCreatedAt(e)))return t.value}findBetween(e,t){const n=[];let i=e;for(;i&&i!==t;)n.push(i),i=i.getNext();return n}splitNode(e,t){if(t>e.getContentLength()&&p.fatal("offset should be less than or equal to length"),t===0)return e;if(t===e.getContentLength())return e.getNext();const n=e.split(t);this.treeByIndex.updateWeight(n),this.insertAfter(e,n);const i=e.getInsNext();return i&&i.setInsPrev(n),n.setInsPrev(e),n}deleteNodes(e,t,n){if(!e.length)return[[],new Map,new Map];const[i,u]=this.filterNodes(e,t,n),c=new Map,d=new Map,v=this.makeChanges(u,t);for(const k of i){const z=k.getCreatedAt().getActorID();(!c.has(z)||k.getID().getCreatedAt().after(c.get(z)))&&c.set(z,k.getID().getCreatedAt()),d.set(k.getID().toIDString(),k),k.remove(t)}return this.deleteIndexNodes(u),[v,c,d]}filterNodes(e,t,n){const i=!!n,u=[],c=[],[d,v]=this.findEdgesOfCandidates(e);c.push(d);for(const k of e){const z=k.getCreatedAt().getActorID(),Q=i?n.has(z)?n.get(z):ut:gt;k.canDelete(t,Q)?u.push(k):c.push(k)}return c.push(v),[u,c]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,t){const n=[];let i,u;for(let c=0;c<e.length-1;c++){const d=e[c],v=e[c+1];d.getNext()!=v&&([i]=this.findIndexesFromRange(d.getNext().createPosRange()),v?[,u]=this.findIndexesFromRange(v.getPrev().createPosRange()):u=this.treeByIndex.length,i<u&&n.push({actor:t.getActorID(),from:i,to:u}))}return n.reverse()}deleteIndexNodes(e){for(let t=0;t<e.length-1;t++){const n=e[t],i=e[t+1];n.getNext()!=i&&this.treeByIndex.deleteRange(n,i)}}getRemovedNodesLen(){return this.removedNodeMap.size}purgeRemovedNodesBefore(e){let t=0;for(const[,n]of this.removedNodeMap)n.getRemovedAt()&&e.compare(n.getRemovedAt())>=0&&(this.treeByIndex.delete(n),this.purge(n),this.treeByID.remove(n.getID()),this.removedNodeMap.delete(n.getID().toIDString()),t++);return t}purge(e){const t=e.getPrev(),n=e.getNext(),i=e.getInsPrev(),u=e.getInsNext();t&&t.setNext(n),n&&n.setPrev(t),e.setPrev(void 0),e.setNext(void 0),i&&i.setInsNext(u),u&&u.setInsPrev(i),e.setInsPrev(void 0),e.setInsNext(void 0)}}const $r=s=>s<0?Math.ceil(s):Math.floor(s);var ze;(function(s){s[s.IntegerCnt=0]="IntegerCnt",s[s.LongCnt=1]="LongCnt"})(ze||(ze={}));class Gt extends ct{constructor(e,t,n){switch(super(n),this.valueType=e,e){case ze.IntegerCnt:typeof t=="number"?t>Math.pow(2,31)-1||t<-Math.pow(2,31)?this.value=et.fromNumber(t).toInt():this.value=$r(t):this.value=t.toInt();break;case ze.LongCnt:typeof t=="number"?this.value=et.fromNumber(t):this.value=t;break;default:throw new me(de.Unimplemented,`unimplemented type: ${e}`)}}static create(e,t,n){return new Gt(e,t,n)}static valueFromBytes(e,t){switch(e){case ze.IntegerCnt:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case ze.LongCnt:return et.fromBytesLE(Array.from(t));default:throw new me(de.Unimplemented,`unimplemented type: ${e}`)}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{id:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){const e=Gt.create(this.valueType,this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e}getType(){return this.valueType}static getCounterType(e){switch(typeof e){case"object":return e instanceof et?ze.LongCnt:void 0;case"number":return e>Math.pow(2,31)-1||e<-Math.pow(2,31)?ze.LongCnt:ze.IntegerCnt;default:return}}static isSupport(e){return!!Gt.getCounterType(e)}static isInteger(e){return e%1===0}isNumericType(){const e=this.valueType;return e===ze.IntegerCnt||e===ze.LongCnt}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case ze.IntegerCnt:{const e=this.value;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}case ze.LongCnt:{const t=this.value.toBytesLE();return Uint8Array.from(t)}default:throw new me(de.Unimplemented,`unimplemented type: ${this.valueType}`)}}increase(e){function t(n){if(!n.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof n.getValue()}`)}return t(this),t(e),this.valueType===ze.LongCnt?this.value=this.value.add(e.getValue()):e.getType()===se.Long?this.value=this.value+e.getValue().toInt():this.value=et.fromNumber(this.value+$r(e.getValue())).toInt(),this}}class Qn extends Me{constructor(e,t,n){super(e,n),this.value=t}static create(e,t,n){return new Qn(e,t,n)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||p.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof Gt||p.fatal("fail to execute, only Counter can execute increase");const n=t,i=this.value.deepcopy();return n.increase(i),{opInfos:[{type:"increase",path:e.createPath(this.getParentCreatedAt()),value:i.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){const e=this.value.deepcopy(),n=e.getType()===se.Long?e.getValue().multiply(-1):e.getValue()*-1;return Qn.create(this.getParentCreatedAt(),xe.of(n,e.getCreatedAt()))}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}}class er extends Me{constructor(e,t,n,i,u){super(e,u),this.fromPos=t,this.toPos=n,this.attributes=i}static create(e,t,n,i,u){return new er(e,t,n,i,u)}execute(e){const t=e.findByCreatedAt(this.getParentCreatedAt());t||p.fatal(`fail to find ${this.getParentCreatedAt()}`),t instanceof fe||p.fatal("fail to execute, only Tree can execute edit");const n={};return[...this.attributes].forEach(([c,d])=>n[c]=d),{opInfos:t.style([this.fromPos,this.toPos],n,this.getExecutedAt()).map(({from:c,to:d,value:v,fromPath:k})=>({type:"tree-style",from:c,to:d,value:v,fromPath:k,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,n=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${e}.STYLE(${t},${n},${Object.entries(this.attributes||{}).map(([i,u])=>`${i}:"${u}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}}function ps(s){const e=new F.Presence,t=e.data;for(const[n,i]of Object.entries(s))t[n]=JSON.stringify(i);return e}function ys(s){if(s.type===Vt.Put)return new F.PresenceChange({type:F.PresenceChange_ChangeType.PUT,presence:ps(s.presence)});if(s.type===Vt.Clear)return new F.PresenceChange({type:F.PresenceChange_ChangeType.CLEAR});throw new me(de.Unimplemented,"unimplemented type")}function Ts(s){return new F.Checkpoint({serverSeq:s.getServerSeqAsString(),clientSeq:s.getClientSeq()})}function vs(s){return new F.ChangeID({clientSeq:s.getClientSeq(),lamport:s.getLamportAsString(),actorId:Br(s.getActorID())})}function oe(s){if(!!s)return new F.TimeTicket({lamport:s.getLamportAsString(),delimiter:s.getDelimiter(),actorId:Br(s.getActorID())})}function Vr(s){switch(s){case se.Null:return F.ValueType.NULL;case se.Boolean:return F.ValueType.BOOLEAN;case se.Integer:return F.ValueType.INTEGER;case se.Long:return F.ValueType.LONG;case se.Double:return F.ValueType.DOUBLE;case se.String:return F.ValueType.STRING;case se.Bytes:return F.ValueType.BYTES;case se.Date:return F.ValueType.DATE;default:throw new me(de.Unsupported,`unsupported type: ${s}`)}}function jr(s){switch(s){case ze.IntegerCnt:return F.ValueType.INTEGER_CNT;case ze.LongCnt:return F.ValueType.LONG_CNT;default:throw new me(de.Unsupported,`unsupported type: ${s}`)}}function Dr(s){if(s instanceof Oe)return new F.JSONElementSimple({type:F.ValueType.JSON_OBJECT,createdAt:oe(s.getCreatedAt()),value:ts(s)});if(s instanceof St)return new F.JSONElementSimple({type:F.ValueType.JSON_ARRAY,createdAt:oe(s.getCreatedAt()),value:Gs(s)});if(s instanceof Ge)return new F.JSONElementSimple({type:F.ValueType.TEXT,createdAt:oe(s.getCreatedAt())});if(s instanceof xe)return new F.JSONElementSimple({type:Vr(s.getType()),createdAt:oe(s.getCreatedAt()),value:s.toBytes()});if(s instanceof Gt)return new F.JSONElementSimple({type:jr(s.getType()),createdAt:oe(s.getCreatedAt()),value:s.toBytes()});if(s instanceof fe)return new F.JSONElementSimple({type:F.ValueType.TREE,createdAt:oe(s.getCreatedAt()),value:Xs(s)});throw new me(de.Unimplemented,"unimplemented element")}function ws(s){return new F.TextNodeID({createdAt:oe(s.getCreatedAt()),offset:s.getOffset()})}function Tr(s){return new F.TextNodePos({createdAt:oe(s.getID().getCreatedAt()),offset:s.getID().getOffset(),relativeOffset:s.getRelativeOffset()})}function vr(s){return new F.TreePos({parentId:cr(s.getParentID()),leftSiblingId:cr(s.getLeftSiblingID())})}function cr(s){return new F.TreeNodeID({createdAt:oe(s.getCreatedAt()),offset:s.getOffset()})}function Es(s){const e=new F.Operation;if(s instanceof wn){const t=s,n=new F.Operation_Set;n.parentCreatedAt=oe(t.getParentCreatedAt()),n.key=t.getKey(),n.value=Dr(t.getValue()),n.executedAt=oe(t.getExecutedAt()),e.body.case="set",e.body.value=n}else if(s instanceof Fn){const t=s,n=new F.Operation_Add;n.parentCreatedAt=oe(t.getParentCreatedAt()),n.prevCreatedAt=oe(t.getPrevCreatedAt()),n.value=Dr(t.getValue()),n.executedAt=oe(t.getExecutedAt()),e.body.case="add",e.body.value=n}else if(s instanceof gn){const t=s,n=new F.Operation_Move;n.parentCreatedAt=oe(t.getParentCreatedAt()),n.prevCreatedAt=oe(t.getPrevCreatedAt()),n.createdAt=oe(t.getCreatedAt()),n.executedAt=oe(t.getExecutedAt()),e.body.case="move",e.body.value=n}else if(s instanceof mn){const t=s,n=new F.Operation_Remove;n.parentCreatedAt=oe(t.getParentCreatedAt()),n.createdAt=oe(t.getCreatedAt()),n.executedAt=oe(t.getExecutedAt()),e.body.case="remove",e.body.value=n}else if(s instanceof pn){const t=s,n=new F.Operation_Edit;n.parentCreatedAt=oe(t.getParentCreatedAt()),n.from=Tr(t.getFromPos()),n.to=Tr(t.getToPos());const i=n.createdAtMapByActor;for(const[c,d]of t.getMaxCreatedAtMapByActor())i[c]=oe(d);n.content=t.getContent();const u=n.attributes;for(const[c,d]of t.getAttributes())u[c]=d;n.executedAt=oe(t.getExecutedAt()),e.body.case="edit",e.body.value=n}else if(s instanceof yt){const t=s,n=new F.Operation_Style;n.parentCreatedAt=oe(t.getParentCreatedAt()),n.from=Tr(t.getFromPos()),n.to=Tr(t.getToPos());const i=n.createdAtMapByActor;for(const[c,d]of t.getMaxCreatedAtMapByActor())i[c]=oe(d);const u=n.attributes;for(const[c,d]of t.getAttributes())u[c]=d;n.executedAt=oe(t.getExecutedAt()),e.body.case="style",e.body.value=n}else if(s instanceof Qn){const t=s,n=new F.Operation_Increase;n.parentCreatedAt=oe(t.getParentCreatedAt()),n.value=Dr(t.getValue()),n.executedAt=oe(t.getExecutedAt()),e.body.case="increase",e.body.value=n}else if(s instanceof it){const t=s,n=new F.Operation_TreeEdit,i=n.createdAtMapByActor;for(const[u,c]of t.getMaxCreatedAtMapByActor())i[u]=oe(c);n.parentCreatedAt=oe(t.getParentCreatedAt()),n.from=vr(t.getFromPos()),n.to=vr(t.getToPos()),n.contents=Os(t.getContents()),n.splitLevel=t.getSplitLevel(),n.executedAt=oe(t.getExecutedAt()),e.body.case="treeEdit",e.body.value=n}else if(s instanceof er){const t=s,n=new F.Operation_TreeStyle;n.parentCreatedAt=oe(t.getParentCreatedAt()),n.from=vr(t.getFromPos()),n.to=vr(t.getToPos());const i=n.attributes;for(const[u,c]of t.getAttributes())i[u]=c;n.executedAt=oe(t.getExecutedAt()),e.body.case="treeStyle",e.body.value=n}else throw new me(de.Unimplemented,"unimplemented operation");return e}function Ns(s){const e=[];for(const t of s)e.push(Es(t));return e}function bs(s){const e=new F.Change({id:vs(s.getID()),message:s.getMessage()});return s.hasOperations()&&(e.operations=Ns(s.getOperations())),s.hasPresenceChange()&&(e.presenceChange=ys(s.getPresenceChange())),e}function Ss(s){const e=[];for(const t of s)e.push(bs(t));return e}function Is(s){const e=[];for(const t of s)e.push(new F.RHTNode({key:t.getStrKey(),element:Cr(t.getValue())}));return e}function ks(s){const e=[];for(const t of s)e.push(new F.RGANode({element:Cr(t.getValue())}));return e}function As(s){const e=[];for(const t of s){const n=new F.TextNode;n.id=ws(t.getID()),n.value=t.getValue().getContent(),n.removedAt=oe(t.getRemovedAt());const i=n.attributes,u=t.getValue().getAttrs();for(const c of u){const d=new F.NodeAttr;d.value=c.getValue(),d.updatedAt=oe(c.getUpdatedAt()),i[c.getKey()]=d}e.push(n)}return e}function Os(s){const e=[];if(!s||!s.length)return e;for(const t of s)e.push(new F.TreeNodes({content:qr(t)}));return e}function qr(s){if(!s)return[];const e=[];return nt(s,(t,n)=>{const i=new F.TreeNode({id:cr(t.id),type:t.type,removedAt:oe(t.removedAt),depth:n});if(t.isText&&(i.value=t.value),t.insPrevID&&(i.insPrevId=cr(t.insPrevID)),t.insNextID&&(i.insNextId=cr(t.insNextID)),t.attrs)for(const u of t.attrs)i.attributes[u.getKey()]=new F.NodeAttr({value:u.getValue(),updatedAt:oe(u.getUpdatedAt())});e.push(i)}),e}function Ps(s){const e=new F.JSONElement;return e.body.case="jsonObject",e.body.value=new F.JSONElement_JSONObject({nodes:Is(s.getRHT()),createdAt:oe(s.getCreatedAt()),movedAt:oe(s.getMovedAt()),removedAt:oe(s.getRemovedAt())}),e}function Yr(s){const e=new F.JSONElement;return e.body.case="jsonArray",e.body.value=new F.JSONElement_JSONArray({nodes:ks(s.getElements()),createdAt:oe(s.getCreatedAt()),movedAt:oe(s.getMovedAt()),removedAt:oe(s.getRemovedAt())}),e}function Ds(s){const e=new F.JSONElement;return e.body.case="primitive",e.body.value=new F.JSONElement_Primitive({type:Vr(s.getType()),value:s.toBytes(),createdAt:oe(s.getCreatedAt()),movedAt:oe(s.getMovedAt()),removedAt:oe(s.getRemovedAt())}),e}function Cs(s){const e=new F.JSONElement;return e.body.case="text",e.body.value=new F.JSONElement_Text({nodes:As(s.getRGATreeSplit()),createdAt:oe(s.getCreatedAt()),movedAt:oe(s.getMovedAt()),removedAt:oe(s.getRemovedAt())}),e}function Rs(s){const e=new F.JSONElement;return e.body.case="counter",e.body.value=new F.JSONElement_Counter({type:jr(s.getType()),value:s.toBytes(),createdAt:oe(s.getCreatedAt()),movedAt:oe(s.getMovedAt()),removedAt:oe(s.getRemovedAt())}),e}function Kr(s){const e=new F.JSONElement;return e.body.case="tree",e.body.value=new F.JSONElement_Tree({nodes:qr(s.getRoot()),createdAt:oe(s.getCreatedAt()),movedAt:oe(s.getMovedAt()),removedAt:oe(s.getRemovedAt())}),e}function Cr(s){if(s instanceof Oe)return Ps(s);if(s instanceof St)return Yr(s);if(s instanceof xe)return Ds(s);if(s instanceof Ge)return Cs(s);if(s instanceof Gt)return Rs(s);if(s instanceof fe)return Kr(s);throw new me(de.Unimplemented,"unimplemented element")}function _s(s){return new F.ChangePack({documentKey:s.getDocumentKey(),checkpoint:Ts(s.getCheckpoint()),isRemoved:s.getIsRemoved(),changes:Ss(s.getChanges()),snapshot:s.getSnapshot(),minSyncedTicket:oe(s.getMinSyncedTicket())})}function xs(s){return Wt.of(s.clientSeq,et.fromString(s.lamport,!0),Lr(s.actorId))}function ae(s){if(!!s)return Pe.of(et.fromString(s.lamport,!0),s.delimiter,Lr(s.actorId))}function Rr(s){const e={};return Object.entries(s.data).forEach(([t,n])=>{e[t]=JSON.parse(n)}),e}function Ls(s){const e=s.type;if(e===F.PresenceChange_ChangeType.PUT){const t=Rr(s.presence);return{type:Vt.Put,presence:t}}if(e===F.PresenceChange_ChangeType.CLEAR)return{type:Vt.Clear};throw new me(de.Unsupported,`unsupported type: ${e}`)}function Bs(s){const e=new Map;return Object.entries(s).forEach(([t,n])=>{e.set(t,Rr(n))}),e}function Wr(s){switch(s){case F.ValueType.NULL:return se.Null;case F.ValueType.BOOLEAN:return se.Boolean;case F.ValueType.INTEGER:return se.Integer;case F.ValueType.LONG:return se.Long;case F.ValueType.DOUBLE:return se.Double;case F.ValueType.STRING:return se.String;case F.ValueType.BYTES:return se.Bytes;case F.ValueType.DATE:return se.Date}throw new me(de.Unimplemented,`unimplemented value type: ${s}`)}function wr(s){switch(s){case F.ValueType.INTEGER_CNT:return ze.IntegerCnt;case F.ValueType.LONG_CNT:return ze.LongCnt}throw new me(de.Unimplemented,`unimplemented value type: ${s}`)}function _r(s){switch(s.type){case F.ValueType.JSON_OBJECT:return s.value?es(s.value):Oe.create(ae(s.createdAt));case F.ValueType.JSON_ARRAY:return s.value?Ws(s.value):St.create(ae(s.createdAt));case F.ValueType.TEXT:return Ge.create(Zn.create(),ae(s.createdAt));case F.ValueType.TREE:return zs(s.value);case F.ValueType.NULL:case F.ValueType.BOOLEAN:case F.ValueType.INTEGER:case F.ValueType.LONG:case F.ValueType.DOUBLE:case F.ValueType.STRING:case F.ValueType.BYTES:case F.ValueType.DATE:return xe.of(xe.valueFromBytes(Wr(s.type),s.value),ae(s.createdAt));case F.ValueType.INTEGER_CNT:case F.ValueType.LONG_CNT:return Gt.create(wr(s.type),Gt.valueFromBytes(wr(s.type),s.value),ae(s.createdAt))}}function Er(s){return ln.of(yn.of(ae(s.createdAt),s.offset),s.relativeOffset)}function Gr(s){return yn.of(ae(s.createdAt),s.offset)}function Ms(s){const e=kt.create(s.value);Object.entries(s.attributes).forEach(([n,i])=>{e.setAttr(n,i.value,ae(i.updatedAt))});const t=Pn.create(Gr(s.id),e);return t.remove(ae(s.removedAt)),t}function Nr(s){return M.of(lr(s.parentId),lr(s.leftSiblingId))}function lr(s){return A.of(ae(s.createdAt),s.offset)}function Js(s){if(!s.length)return;const e=[];return s.forEach(t=>{const n=zr(t.content);e.push(n)}),e}function zr(s){if(s.length===0)return;const e=[];for(const n of s)e.push(Fs(n));const t=e[e.length-1];for(let n=e.length-2;n>=0;n--){let i;for(let u=n+1;u<e.length;u++)if(s[n].depth-1===s[u].depth){i=e[u];break}i.prepend(e[n])}return fe.create(t,ut).getRoot()}function Fs(s){const e=lr(s.id),t=K.create(e,s.type);if(t.isText)t.value=s.value;else{const n=jt.create();Object.entries(s.attributes).forEach(([i,u])=>{n.set(i,u.value,ae(u.updatedAt))}),t.attrs=n}return s.insPrevId&&(t.insPrevID=lr(s.insPrevId)),s.insPrevId&&(t.insNextID=lr(s.insNextId)),t.removedAt=ae(s.removedAt),t}function Us(s){const e=[];for(const t of s){let n;if(t.body.case==="set"){const i=t.body.value;n=wn.create(i.key,_r(i.value),ae(i.parentCreatedAt),ae(i.executedAt))}else if(t.body.case==="add"){const i=t.body.value;n=Fn.create(ae(i.parentCreatedAt),ae(i.prevCreatedAt),_r(i.value),ae(i.executedAt))}else if(t.body.case==="move"){const i=t.body.value;n=gn.create(ae(i.parentCreatedAt),ae(i.prevCreatedAt),ae(i.createdAt),ae(i.executedAt))}else if(t.body.case==="remove"){const i=t.body.value;n=mn.create(ae(i.parentCreatedAt),ae(i.createdAt),ae(i.executedAt))}else if(t.body.case==="edit"){const i=t.body.value,u=new Map;Object.entries(i.createdAtMapByActor).forEach(([d,v])=>{u.set(d,ae(v))});const c=new Map;Object.entries(i.attributes).forEach(([d,v])=>{c.set(d,v)}),n=pn.create(ae(i.parentCreatedAt),Er(i.from),Er(i.to),u,i.content,c,ae(i.executedAt))}else if(t.body.case==="style"){const i=t.body.value,u=new Map;Object.entries(i.createdAtMapByActor).forEach(([d,v])=>{u.set(d,ae(v))});const c=new Map;Object.entries(i.attributes).forEach(([d,v])=>{c.set(d,v)}),n=yt.create(ae(i.parentCreatedAt),Er(i.from),Er(i.to),u,c,ae(i.executedAt))}else{if(t.body.case==="select")continue;if(t.body.case==="increase"){const i=t.body.value;n=Qn.create(ae(i.parentCreatedAt),_r(i.value),ae(i.executedAt))}else if(t.body.case==="treeEdit"){const i=t.body.value,u=new Map;Object.entries(i.createdAtMapByActor).forEach(([c,d])=>{u.set(c,ae(d))}),n=it.create(ae(i.parentCreatedAt),Nr(i.from),Nr(i.to),Js(i.contents),i.splitLevel,u,ae(i.executedAt))}else if(t.body.case==="treeStyle"){const i=t.body.value,u=new Map;Object.entries(i.attributes).forEach(([c,d])=>{u.set(c,d)}),n=er.create(ae(i.parentCreatedAt),Nr(i.from),Nr(i.to),u,ae(i.executedAt))}else throw new me(de.Unimplemented,"unimplemented operation")}e.push(n)}return e}function Xr(s){const e=[];for(const t of s)e.push(Un.create({id:xs(t.id),operations:Us(t.operations),presenceChange:t.presenceChange?Ls(t.presenceChange):void 0,message:t.message}));return e}function $s(s){return Hn.of(et.fromString(s.serverSeq,!0),s.clientSeq)}function Vs(s){return yr.create(s.documentKey,$s(s.checkpoint),s.isRemoved,Xr(s.changes),s.snapshot,ae(s.minSyncedTicket))}function Hr(s){const e=new rt;for(const n of s.nodes){const i=xr(n.element);e.set(n.key,i,i.getPositionedAt())}const t=new Oe(ae(s.createdAt),e);return t.setMovedAt(ae(s.movedAt)),t.setRemovedAt(ae(s.removedAt)),t}function Zr(s){const e=new Jn;for(const n of s.nodes)e.insert(xr(n.element));const t=new St(ae(s.createdAt),e);return t.setMovedAt(ae(s.movedAt)),t.setRemovedAt(ae(s.removedAt)),t}function js(s){const e=xe.of(xe.valueFromBytes(Wr(s.type),s.value),ae(s.createdAt));return e.setMovedAt(ae(s.movedAt)),e.setRemovedAt(ae(s.removedAt)),e}function qs(s){const e=new Zn;let t=e.getHead();for(const i of s.nodes){const u=e.insertAfter(t,Ms(i));i.insPrevId&&u.setInsPrev(e.findNode(Gr(i.insPrevId))),t=u}const n=new Ge(e,ae(s.createdAt));return n.setMovedAt(ae(s.movedAt)),n.setRemovedAt(ae(s.removedAt)),n}function Ys(s){const e=Gt.create(wr(s.type),Gt.valueFromBytes(wr(s.type),s.value),ae(s.createdAt));return e.setMovedAt(ae(s.movedAt)),e.setRemovedAt(ae(s.removedAt)),e}function Qr(s){const e=zr(s.nodes);return fe.create(e,ae(s.createdAt))}function xr(s){if(s.body.case==="jsonObject")return Hr(s.body.value);if(s.body.case==="jsonArray")return Zr(s.body.value);if(s.body.case==="primitive")return js(s.body.value);if(s.body.case==="text")return qs(s.body.value);if(s.body.case==="counter")return Ys(s.body.value);if(s.body.case==="tree")return Qr(s.body.value);throw new me(de.Unimplemented,"unimplemented element")}function Ks(s){if(!s)return{root:Oe.create(ut),presences:new Map};const e=F.Snapshot.fromBinary(s);return{root:xr(e.root),presences:Bs(e.presences)}}function es(s){if(!s)throw new Error("bytes is empty");const e=F.JSONElement.fromBinary(s);return Hr(e.body.value)}function ts(s){return Cr(s).toBinary()}function Ws(s){if(!s)throw new Error("bytes is empty");const e=F.JSONElement.fromBinary(s);return Zr(e.body.value)}function Gs(s){return Yr(s).toBinary()}function zs(s){if(!s)throw new Error("bytes is empty");const e=F.JSONElement.fromBinary(s);return Qr(e.body.value)}function Xs(s){return Kr(s).toBinary()}function Hs(s){return s?Array.from(s).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function Lr(s){return Hs(s)}function Zs(s){return new Uint8Array(s.match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Br(s){return Zs(s)}const Tn={fromPresence:Rr,toChangePack:_s,fromChangePack:Vs,fromChanges:Xr,objectToBytes:ts,bytesToObject:es,bytesToSnapshot:Ks,toHexString:Lr,toUint8Array:Br};class Qs{constructor(e,t,n,i){this.reconnectStreamDelay=e,this.doc=t,this.docID=n,this.isRealtimeSync=i,this.syncMode=En.PushPull,this.remoteChangeEventReceived=!1}changeRealtimeSync(e){return this.isRealtimeSync===e?!1:e?(this.isRealtimeSync=!0,!0):(this.cancelWatchStream(),this.isRealtimeSync=!1,!0)}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.isRealtimeSync&&(this.doc.hasLocalChanges()||this.remoteChangeEventReceived)}async runWatchLoop(e){const t=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.watchLoopTimerID=setTimeout(t,this.reconnectStreamDelay)})}catch{}};await t()}cancelWatchStream(){this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}}class tr{constructor(e,t,n,i){this.id=e,this.delimiter=Gn,this.root=t,this.operations=[],this.previousPresence=rn(n),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=i}static create(e,t,n,i){return new tr(e,t,n,i)}push(e){this.operations.push(e)}registerElement(e,t){this.root.registerElement(e,t)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerElementHasRemovedNodes(e){this.root.registerElementHasRemovedNodes(e)}getChange(){return Un.create({id:this.id,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}hasChange(){return this.operations.length>0||this.presenceChange!==void 0}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,t){for(const n of Object.keys(e))t!=null&&t.addToHistory?this.reversePresenceKeys.add(n):this.reversePresenceKeys.delete(n)}getReversePresence(){if(this.reversePresenceKeys.size===0)return;const e={};for(const t of this.reversePresenceKeys)e[t]=this.previousPresence[t];return e}issueTimeTicket(){return this.delimiter+=1,this.id.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.id.createTimeTicket(this.delimiter)}}class fr{constructor(e){this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.removedElementSetByCreatedAt=new Set,this.elementHasRemovedNodesSetByCreatedAt=new Set,this.opsForTest=[],this.registerElement(e,void 0)}static create(){return new fr(Oe.create(ut))}findByCreatedAt(e){const t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!!t)return t.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!t)return[];const n=[];for(;t.parent;){const i=t.element.getCreatedAt(),u=t.parent.subPathOf(i);u===void 0&&p.fatal(`cant find the given element: ${i.toIDString()}`),n.unshift(u),t=this.elementPairMapByCreatedAt.get(t.parent.getCreatedAt().toIDString())}return n.unshift("$"),n}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,t){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),e instanceof hn&&e.getDescendants((n,i)=>(this.registerElement(n,i),!1))}deregisterElement(e){let t=0;const n=i=>{const u=i.getCreatedAt().toIDString();this.elementPairMapByCreatedAt.delete(u),this.removedElementSetByCreatedAt.delete(u),t++};return n(e),e instanceof hn&&e.getDescendants(i=>(n(i),!1)),t}registerRemovedElement(e){this.removedElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerElementHasRemovedNodes(e){this.elementHasRemovedNodesSetByCreatedAt.add(e.getCreatedAt().toIDString())}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getRemovedElementSetSize(){return this.removedElementSetByCreatedAt.size}getObject(){return this.rootObject}getGarbageLen(){let e=0;const t=new Set;for(const n of this.removedElementSetByCreatedAt){t.add(n);const i=this.elementPairMapByCreatedAt.get(n);i.element instanceof hn&&i.element.getDescendants(u=>(t.add(u.getCreatedAt().toIDString()),!1))}e+=t.size;for(const n of this.elementHasRemovedNodesSetByCreatedAt){const u=this.elementPairMapByCreatedAt.get(n).element;e+=u.getRemovedNodesLen()}return e}deepcopy(){return new fr(this.rootObject.deepcopy())}garbageCollect(e){let t=0;for(const n of this.removedElementSetByCreatedAt){const i=this.elementPairMapByCreatedAt.get(n);i.element.getRemovedAt()&&e.compare(i.element.getRemovedAt())>=0&&(i.parent.purge(i.element),t+=this.deregisterElement(i.element))}for(const n of this.elementHasRemovedNodesSetByCreatedAt){const u=this.elementPairMapByCreatedAt.get(n).element,c=u.purgeRemovedNodesBefore(e);c>0&&this.elementHasRemovedNodesSetByCreatedAt.delete(u.getCreatedAt().toIDString()),t+=c}return t}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}}function ns(s,e){const t=new dr(s);return new Proxy(e,t.getHandlers())}class dr{constructor(e){this.context=e,this.handlers={set:(t,n,i)=>(p.isEnabled(re.Trivial)&&p.trivial(`obj[${n}]=${JSON.stringify(i)}`),dr.setInternal(e,t,n,i),!0),get:(t,n)=>(p.isEnabled(re.Trivial)&&p.trivial(`obj[${n}]`),n==="getID"?()=>t.getCreatedAt():n==="toJSON"||n==="toString"?()=>t.toJSON():n==="toJS"?()=>t.toJS():n==="toJSForTest"?()=>t.toJSForTest():$n(e,t.get(n))),ownKeys:t=>t.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(t,n)=>(p.isEnabled(re.Trivial)&&p.trivial(`obj[${n}]`),dr.deleteInternal(e,t,n),!0)}}static setInternal(e,t,n,i){if(n.includes("."))throw new me(de.InvalidObjectKey,"key must not contain the '.'.");const u=e.issueTimeTicket(),c=kr(e,i,u),d=t.set(n,c,u);e.registerElement(c,t),d&&e.registerRemovedElement(d),e.push(wn.create(n,c.deepcopy(),t.getCreatedAt(),u))}static buildObjectMembers(e,t){const n={};for(const[i,u]of Object.entries(t)){if(i.includes("."))throw new me(de.InvalidObjectKey,"key must not contain the '.'.");const c=e.issueTimeTicket(),d=kr(e,u,c);n[i]=d}return n}static deleteInternal(e,t,n){const i=e.issueTimeTicket(),u=t.deleteByKey(n,i);!u||(e.push(mn.create(t.getCreatedAt(),u.getCreatedAt(),i)),e.registerRemovedElement(u))}getHandlers(){return this.handlers}}function ei(s,e){const t=new $e(s,e);return new Proxy(e,t.getHandlers())}function ti(s){return typeof s=="string"||s instanceof String?!isNaN(s):!1}function ni(s){return["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(s)}class $e{constructor(e,t){this.context=e,this.array=t,this.handlers={get:(n,i,u)=>i==="getID"?()=>n.getCreatedAt():i==="getElementByID"?c=>{const d=n.getByID(c);if(!(!d||d.isRemoved()))return Dn(e,d)}:i==="getElementByIndex"?c=>{const d=n.get(c);return Dn(e,d)}:i==="getLast"?()=>Dn(e,n.getLast()):i==="deleteByID"?c=>{const d=$e.deleteInternalByID(e,n,c);return Dn(e,d)}:i==="insertAfter"?(c,d)=>{const v=$e.insertAfterInternal(e,n,c,d);return Dn(e,v)}:i==="insertBefore"?(c,d)=>{const v=$e.insertBeforeInternal(e,n,c,d);return Dn(e,v)}:i==="moveBefore"?(c,d)=>{$e.moveBeforeInternal(e,n,c,d)}:i==="moveAfter"?(c,d)=>{$e.moveAfterInternal(e,n,c,d)}:i==="moveFront"?c=>{$e.moveFrontInternal(e,n,c)}:i==="moveLast"?c=>{$e.moveLastInternal(e,n,c)}:ti(i)?$n(e,n.get(Number(i))):i==="push"?c=>$e.pushInternal(e,n,c):i==="splice"?(c,d,...v)=>$e.splice(e,n,c,d,...v):i==="length"?n.length:typeof i=="symbol"&&i===Symbol.iterator?$e.iteratorInternal.bind(this,e,n):i==="includes"?(c,d)=>$e.includes(e,n,c,d):i==="indexOf"?(c,d)=>$e.indexOf(e,n,c,d):i==="lastIndexOf"?(c,d)=>$e.lastIndexOf(e,n,c,d):i==="toTestString"?()=>$e.toTestString(n):typeof i=="string"&&ni(i)?(...c)=>{const d=Array.from(n).map(v=>$n(e,v));return Array.prototype[i].apply(d,c)}:Reflect.get(n,i,u),deleteProperty:(n,i)=>(p.isEnabled(re.Trivial)&&p.trivial(`array[${i}]`),$e.deleteInternalByIndex(e,n,Number.parseInt(i)),!0)}}static*iteratorInternal(e,t){for(const n of t)yield Dn(e,n)}static buildArrayElements(e,t){const n=[];for(const i of t){const u=e.issueTimeTicket(),c=kr(e,i,u);n.push(c)}return n}static pushInternal(e,t,n){return $e.insertAfterInternal(e,t,t.getLastCreatedAt(),n),t.length}static moveBeforeInternal(e,t,n,i){const u=e.issueTimeTicket(),c=t.getPrevCreatedAt(n);t.moveAfter(c,i,u),e.push(gn.create(t.getCreatedAt(),c,i,u))}static moveAfterInternal(e,t,n,i){const u=e.issueTimeTicket();t.moveAfter(n,i,u),e.push(gn.create(t.getCreatedAt(),n,i,u))}static moveFrontInternal(e,t,n){const i=e.issueTimeTicket(),u=t.getHead();t.moveAfter(u.getCreatedAt(),n,i),e.push(gn.create(t.getCreatedAt(),u.getCreatedAt(),n,i))}static moveLastInternal(e,t,n){const i=e.issueTimeTicket(),u=t.getLastCreatedAt();t.moveAfter(u,n,i),e.push(gn.create(t.getCreatedAt(),u,n,i))}static insertAfterInternal(e,t,n,i){const u=e.issueTimeTicket(),c=kr(e,i,u);return t.insertAfter(n,c),e.registerElement(c,t),e.push(Fn.create(t.getCreatedAt(),n,c.deepcopy(),u)),c}static insertBeforeInternal(e,t,n,i){return $e.insertAfterInternal(e,t,t.getPrevCreatedAt(n),i)}static deleteInternalByIndex(e,t,n){const i=e.issueTimeTicket(),u=t.deleteByIndex(n,i);if(!!u)return e.push(mn.create(t.getCreatedAt(),u.getCreatedAt(),i)),e.registerRemovedElement(u),u}static deleteInternalByID(e,t,n){const i=e.issueTimeTicket(),u=t.delete(n,i);return e.push(mn.create(t.getCreatedAt(),u.getCreatedAt(),i)),e.registerRemovedElement(u),u}static splice(e,t,n,i,...u){const c=t.length,d=n>=0?Math.min(n,c):Math.max(c+n,0),v=i===void 0?c:i<0?d:Math.min(d+i,c),k=[];for(let z=d;z<v;z++){const Q=$e.deleteInternalByIndex(e,t,d);if(Q){const J=Q.deepcopy();J.setRemovedAt(),k.push($n(e,J))}}if(u){let z=d===0?t.getHead().getID():t.get(d-1).getID();for(const Q of u)z=$e.insertAfterInternal(e,t,z,Q).getID()}return k}static includes(e,t,n,i){var u;const c=t.length,d=i===void 0?0:i<0?Math.max(i+c,0):i;if(d>=c)return!1;if(xe.isSupport(n))return Array.from(t).map(k=>$n(e,k)).includes(n,d);for(let v=d;v<c;v++)if(((u=t.get(v))===null||u===void 0?void 0:u.getID())===n.getID())return!0;return!1}static indexOf(e,t,n,i){var u;const c=t.length,d=i===void 0?0:i<0?Math.max(i+c,0):i;if(d>=c)return-1;if(xe.isSupport(n))return Array.from(t).map(k=>$n(e,k)).indexOf(n,d);for(let v=d;v<c;v++)if(((u=t.get(v))===null||u===void 0?void 0:u.getID())===n.getID())return v;return-1}static lastIndexOf(e,t,n,i){var u;const c=t.length,d=i===void 0||i>=c?c-1:i<0?i+c:i;if(d<0)return-1;if(xe.isSupport(n))return Array.from(t).map(k=>$n(e,k)).lastIndexOf(n,d);for(let v=d;v>0;v--)if(((u=t.get(v))===null||u===void 0?void 0:u.getID())===n.getID())return v;return-1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}}class br{constructor(e,t){this.context=e,this.text=t}initialize(e,t){this.context=e,this.text=t}getID(){return this.text.getID()}edit(e,t,n,i){if(!this.context||!this.text){p.fatal("it is not initialized yet");return}if(e>t){p.fatal("from should be less than or equal to to");return}const u=this.text.indexRangeToPosRange(e,t);p.isEnabled(re.Debug)&&p.debug(`EDIT: f:${e}->${u[0].toTestString()}, t:${t}->${u[1].toTestString()} c:${n}`);const c=i?at(i):void 0,d=this.context.issueTimeTicket(),[v,,k]=this.text.edit(u,n,d,c);return this.context.push(new pn(this.text.getCreatedAt(),u[0],u[1],v,n,c?new Map(Object.entries(c)):new Map,d)),u[0].equals(u[1])||this.context.registerElementHasRemovedNodes(this.text),this.text.findIndexesFromRange(k)}delete(e,t){return this.edit(e,t,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,t,n){if(!this.context||!this.text)return p.fatal("it is not initialized yet"),!1;if(e>t)return p.fatal("from should be less than or equal to to"),!1;const i=this.text.indexRangeToPosRange(e,t);p.isEnabled(re.Debug)&&p.debug(`STYL: f:${e}->${i[0].toTestString()}, t:${t}->${i[1].toTestString()} a:${JSON.stringify(n)}`);const u=at(n),c=this.context.issueTimeTicket(),[d]=this.text.setStyle(i,u,c);return this.context.push(new yt(this.text.getCreatedAt(),i[0],i[1],d,new Map(Object.entries(u)),c)),!0}indexRangeToPosRange(e){if(!this.context||!this.text){p.fatal("it is not initialized yet");return}const t=this.text.indexRangeToPosRange(e[0],e[1]);return[t[0].toStruct(),t[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text){p.fatal("it is not initialized yet");return}const t=this.text.findIndexesFromRange([ln.fromStruct(e[0]),ln.fromStruct(e[1])]);return[t[0],t[1]]}toTestString(){if(!this.context||!this.text){p.fatal("it is not initialized yet");return}return this.text.toTestString()}values(){if(!this.context||!this.text){p.fatal("it is not initialized yet");return}return this.text.values()}get length(){return this.text.length}checkWeight(){return this.text.checkWeight()}toString(){return!this.context||!this.text?(p.fatal("it is not initialized yet"),""):this.text.toString()}createRangeForTest(e,t){if(!this.context||!this.text){p.fatal("it is not initialized yet");return}return this.text.indexRangeToPosRange(e,t)}}class Sr{constructor(e,t){this.valueType=e,this.value=t}initialize(e,t){this.valueType=t.getValueType(),this.context=e,this.counter=t,this.value=t.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter){p.fatal("it is not initialized yet");return}const t=this.context.issueTimeTicket(),n=xe.of(e,t);if(!n.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof n.getValue()}`);return this.counter.increase(n),this.context.push(Qn.create(this.counter.getCreatedAt(),n,t)),this}}function Mr(s,e,t){const{type:n}=s,i=t.issueTimeTicket();if(n===tt){rs(s);const{value:u}=s,c=K.create(A.of(i,0),n,u);e.append(c)}else{const{children:u=[]}=s;let{attributes:c}=s,d;if(typeof c=="object"&&!gr(c)){c=at(c),d=new jt;for(const[k,z]of Object.entries(c))d.set(k,z,i)}const v=K.create(A.of(i,0),n,void 0,d);e.append(v);for(const k of u)Mr(k,v,t)}}function ri(s,e){const{type:t}=e,n=s.issueTimeTicket();let i;if(e.type===tt){const{value:u}=e;i=K.create(A.of(n,0),t,u)}else if(e){const{children:u=[]}=e;let{attributes:c}=e,d;if(typeof c=="object"&&!gr(c)){c=at(c),d=new jt;for(const[v,k]of Object.entries(c))d.set(v,k,n)}i=K.create(A.of(s.issueTimeTicket(),0),t,void 0,d);for(const v of u)Mr(v,i,s)}return i}function rs(s){if(!s.value.length)throw new Error("text node cannot have empty value");return!0}function ss(s){if(!s.length)return!0;if(s[0].type===tt)for(const t of s){const{type:n}=t;if(n!==tt)throw new Error("element node and text node cannot be passed together");rs(t)}else for(const t of s){const{type:n}=t;if(n===tt)throw new Error("element node and text node cannot be passed together")}return!0}class Ir{constructor(e){this.initialRoot=e}initialize(e,t){this.context=e,this.tree=t}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return K.create(A.of(e.issueTimeTicket(),0),Bt);const t=K.create(A.of(e.issueTimeTicket(),0),this.initialRoot.type);for(const n of this.initialRoot.children)Mr(n,t,e);return t}getSize(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.getSize()}getIndexTree(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.getIndexTree()}styleByPath(e,t){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(!e.length)throw new Error("path should not be empty");const[n,i]=this.tree.pathToPosRange(e),u=this.context.issueTimeTicket(),c=t?at(t):void 0;this.tree.style([n,i],c,u),this.context.push(er.create(this.tree.getCreatedAt(),n,i,c?new Map(Object.entries(c)):new Map,u))}style(e,t,n){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e>t)throw new Error("from should be less than or equal to to");const i=this.tree.findPos(e),u=this.tree.findPos(t),c=this.context.issueTimeTicket(),d=n?at(n):void 0;this.tree.style([i,u],d,c),this.context.push(er.create(this.tree.getCreatedAt(),i,u,d?new Map(Object.entries(d)):new Map,c))}editInternal(e,t,n,i=0){var u;if(n.length!==0&&n[0]&&(ss(n),n[0].type!==tt))for(const k of n){const{children:z=[]}=k;ss(z)}const c=this.context.getLastTimeTicket();let d=new Array;if(((u=n[0])===null||u===void 0?void 0:u.type)===tt){let k="";for(const z of n){const{value:Q}=z;k+=Q}d.push(K.create(A.of(this.context.issueTimeTicket(),0),tt,k))}else d=n.map(k=>k&&ri(this.context,k)).filter(k=>k);const[,v]=this.tree.edit([e,t],d.length?d.map(k=>k==null?void 0:k.deepcopy()):void 0,i,c,()=>this.context.issueTimeTicket());return this.context.push(it.create(this.tree.getCreatedAt(),e,t,d.length?d:void 0,i,v,c)),e.equals(t)||this.context.registerElementHasRemovedNodes(this.tree),!0}editByPath(e,t,n,i=0){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e.length!==t.length)throw new Error("path length should be equal");if(!e.length||!t.length)throw new Error("path should not be empty");const u=this.tree.pathToPos(e),c=this.tree.pathToPos(t);return this.editInternal(u,c,n?[n]:[],i)}editBulkByPath(e,t,n,i=0){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e.length!==t.length)throw new Error("path length should be equal");if(!e.length||!t.length)throw new Error("path should not be empty");const u=this.tree.pathToPos(e),c=this.tree.pathToPos(t);return this.editInternal(u,c,n,i)}edit(e,t,n,i=0){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e>t)throw new Error("from should be less than or equal to to");const u=this.tree.findPos(e),c=this.tree.findPos(t);return this.editInternal(u,c,n?[n]:[],i)}editBulk(e,t,n,i=0){if(!this.context||!this.tree)throw new Error("it is not initialized yet");if(e>t)throw new Error("from should be less than or equal to to");const u=this.tree.findPos(e),c=this.tree.findPos(t);return this.editInternal(u,c,n,i)}toXML(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.toJSON()}getRootTreeNode(){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw new Error("it is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree){p.fatal("it is not initialized yet");return}const t=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],n=this.tree.indexRangeToPosRange(t);return[n[0].toStruct(),n[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree){p.fatal("it is not initialized yet");return}return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree){p.fatal("it is not initialized yet");return}const t=[M.fromStruct(e[0]),M.fromStruct(e[1])];return this.tree.posRangeToIndexRange(t,this.context.getLastTimeTicket())}posRangeToPathRange(e){if(!this.context||!this.tree){p.fatal("it is not initialized yet");return}const t=[M.fromStruct(e[0]),M.fromStruct(e[1])];return this.tree.posRangeToPathRange(t,this.context.getLastTimeTicket())}}function is(s,e){return ns(s,e)}function Dn(s,e){if(e){if(e instanceof xe)return e;if(e instanceof Oe)return ns(s,e);if(e instanceof St)return ei(s,e);if(e instanceof Ge)return new br(s,e);if(e instanceof Gt){const t=new Sr(ze.IntegerCnt,0);return t.initialize(s,e),t}else if(e instanceof fe){const t=new Ir;return t.initialize(s,e),t}}else return;throw new TypeError(`Unsupported type of element: ${typeof e}`)}function $n(s,e){const t=Dn(s,e);return t instanceof xe?t.getValue():t}function kr(s,e,t){let n;if(xe.isSupport(e))n=xe.of(e,t);else if(Array.isArray(e))n=St.create(t,$e.buildArrayElements(s,e));else if(typeof e=="object")e instanceof br?(n=Ge.create(Zn.create(),t),e.initialize(s,n)):e instanceof Sr?(n=Gt.create(e.getValueType(),e.getValue(),t),e.initialize(s,n)):e instanceof Ir?(n=fe.create(e.buildRoot(s),t),e.initialize(s,n)):n=Oe.create(t,dr.buildObjectMembers(s,e));else throw new TypeError(`Unsupported type of value: ${typeof e}`);return n}const os=50;class si{constructor(){this.undoStack=[],this.redoStack=[]}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=os&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=os&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}}var an;(function(s){s.Detached="detached",s.Attached="attached",s.Removed="removed"})(an||(an={}));var pe;(function(s){s.Snapshot="snapshot",s.LocalChange="local-change",s.RemoteChange="remote-change",s.Initialized="initialized",s.Watched="watched",s.Unwatched="unwatched",s.PresenceChanged="presence-changed"})(pe||(pe={}));class as{constructor(e,t){this.opts=t||{},this.key=e,this.status=an.Detached,this.root=fr.create(),this.changeID=Pr,this.checkpoint=ms,this.localChanges=[],this.eventStream=x(n=>{this.eventStreamObserver=n}),this.onlineClients=new Set,this.presences=new Map,this.isUpdating=!1,this.internalHistory=new si,this.history={canUndo:this.canUndo.bind(this),canRedo:this.canRedo.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this)}}update(e,t){if(this.getStatus()===an.Removed)throw new me(de.DocumentRemoved,`${this.key} is removed`);this.ensureClone();const n=this.changeID.getActorID(),i=tr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(n)||{},t);try{const u=is(i,this.clone.root.getObject());this.presences.has(n)||this.clone.presences.set(n,{}),this.isUpdating=!0,e(u,new Wn(i,this.clone.presences.get(n)))}catch(u){throw this.clone=void 0,p.error(u),u}finally{this.isUpdating=!1}if(i.hasChange()){p.isEnabled(re.Trivial)&&p.trivial(`trying to update a local change: ${this.toJSON()}`);const u=i.getChange(),{opInfos:c,reverseOps:d}=u.execute(this.root,this.presences,_e.Local),v=i.getReversePresence();v&&d.push({type:"presence",value:v}),this.localChanges.push(u),d.length>0&&this.internalHistory.pushUndo(d),c.length>0&&this.internalHistory.clearRedo(),this.changeID=u.getID(),c.length>0&&this.publish({type:pe.LocalChange,value:{message:u.getMessage()||"",operations:c,actor:n}}),u.hasPresenceChange()&&this.publish({type:pe.PresenceChanged,value:{clientID:n,presence:this.getPresence(n)}}),p.isEnabled(re.Trivial)&&p.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(e,t,n,i){if(typeof e=="string"){if(typeof t!="function")throw new Error("Second argument must be a callback function");if(e==="presence"){const d=t;return this.eventStream.subscribe(v=>{v.type!==pe.Initialized&&v.type!==pe.Watched&&v.type!==pe.Unwatched&&v.type!==pe.PresenceChanged||d(v)},n,i)}if(e==="my-presence"){const d=t;return this.eventStream.subscribe(v=>{v.type!==pe.Initialized&&v.type!==pe.Watched&&v.type!==pe.Unwatched&&v.type!==pe.PresenceChanged||v.type!==pe.Initialized&&v.value.clientID!==this.changeID.getActorID()||d(v)},n,i)}if(e==="others"){const d=t;return this.eventStream.subscribe(v=>{v.type!==pe.Watched&&v.type!==pe.Unwatched&&v.type!==pe.PresenceChanged||v.value.clientID!==this.changeID.getActorID()&&d(v)},n,i)}const u=e,c=t;return this.eventStream.subscribe(d=>{if(d.type===pe.Initialized||d.type===pe.Watched||d.type===pe.Unwatched||d.type===pe.PresenceChanged)return;if(d.type===pe.Snapshot){u==="$"&&c(d);return}const{message:v,operations:k,actor:z}=d.value,Q=[];for(const J of k)this.isSameElementOrChildOf(J.path,u)&&Q.push(J);Q.length&&c({type:d.type,value:{message:v,operations:Q,actor:z}})},n,i)}if(typeof e=="function"){const u=e,c=t,d=n;return this.eventStream.subscribe(v=>{v.type===pe.Initialized||v.type===pe.Watched||v.type===pe.Unwatched||v.type===pe.PresenceChanged||u(v)},c,d)}throw new Error(`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}isSameElementOrChildOf(e,t){if(t===e)return!0;const n=e.split(".");return t.split(".").every((u,c)=>u===n[c])}applyChangePack(e){for(e.hasSnapshot()?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getSnapshot()):e.hasChanges()&&this.applyChanges(e.getChanges());this.localChanges.length&&!(this.localChanges[0].getID().getClientSeq()>e.getCheckpoint().getClientSeq());)this.localChanges.shift();this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),this.garbageCollect(e.getMinSyncedTicket()),e.getIsRemoved()&&this.setStatus(an.Removed),p.isEnabled(re.Trivial)&&p.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:rn(this.presences)})}createChangePack(){const e=Array.from(this.localChanges),t=this.checkpoint.increaseClientSeq(e.length);return yr.create(this.key,t,!1,e)}setActor(e){for(const t of this.localChanges)t.setActor(e);this.changeID=this.changeID.setActor(e)}getKey(){return this.key}setStatus(e){this.status=e}getStatus(){return this.status}getCloneRoot(){if(!!this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();const e=tr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return is(e,this.clone.root.getObject())}getOpsForTest(){return this.root.opsForTest}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}applySnapshot(e,t){const{root:n,presences:i}=Tn.bytesToSnapshot(t);this.root=new fr(n),this.presences=i,this.changeID=this.changeID.syncLamport(e),this.clone=void 0,this.publish({type:pe.Snapshot,value:t})}applyChanges(e){p.isEnabled(re.Debug)&&p.debug(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getRemovedElementSetSize()}`),p.isEnabled(re.Trivial)&&p.trivial(e.map(t=>`${t.getID().toTestString()}	${t.toTestString()}`).join(`
`)),this.ensureClone();for(const t of e){t.execute(this.clone.root,this.clone.presences,_e.Remote);let n;const i=t.getID().getActorID();if(t.hasPresenceChange()&&this.onlineClients.has(i)){const c=t.getPresenceChange();switch(c.type){case Vt.Put:n={type:this.presences.has(i)?pe.PresenceChanged:pe.Watched,value:{clientID:i,presence:c.presence}};break;case Vt.Clear:n={type:pe.Unwatched,value:{clientID:i,presence:this.getPresence(i)}},this.removeOnlineClient(i);break}}const{opInfos:u}=t.execute(this.root,this.presences,_e.Remote);u.length>0&&this.publish({type:pe.RemoteChange,value:{actor:i,message:t.getMessage()||"",operations:u}}),n&&this.publish(n),this.changeID=this.changeID.syncLamport(t.getID().getLamport())}p.isEnabled(re.Debug)&&p.debug(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getRemovedElementSetSize()}`)}getValueByPath(e){if(!e.startsWith("$"))throw new me(de.InvalidArgument,'path must start with "$"');const t=e.split(".");t.shift();let n=this.getRoot();for(const i of t)if(n=n[i],n===void 0)return;return n}setOnlineClients(e){this.onlineClients=e}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if(this.status!==an.Attached)return{};const e=this.presences.get(this.changeID.getActorID());return rn(e)}getPresence(e){if(!this.onlineClients.has(e))return;const t=this.presences.get(e);return t?rn(t):void 0}getPresenceForTest(e){const t=this.presences.get(e);return t?rn(t):void 0}getPresences(){const e=[];for(const t of this.onlineClients)this.presences.has(t)&&e.push({clientID:t,presence:rn(this.presences.get(t))});return e}canUndo(){return this.internalHistory.hasUndo()&&!this.isUpdating}canRedo(){return this.internalHistory.hasRedo()&&!this.isUpdating}undo(){if(this.isUpdating)throw new Error("Undo is not allowed during an update");const e=this.internalHistory.popUndo();if(e===void 0)throw new Error("There is no operation to be undone");this.ensureClone();const t=tr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const v of e){if(!(v instanceof Me)){new Wn(t,rn(this.clone.presences.get(this.changeID.getActorID()))).set(v.value,{addToHistory:!0});continue}const k=t.issueTimeTicket();v.setExecutedAt(k),t.push(v)}const n=t.getChange();n.execute(this.clone.root,this.clone.presences,_e.UndoRedo);const{opInfos:i,reverseOps:u}=n.execute(this.root,this.presences,_e.UndoRedo),c=t.getReversePresence();if(c&&u.push({type:"presence",value:c}),u.length>0&&this.internalHistory.pushRedo(u),!n.hasPresenceChange()&&i.length===0)return;this.localChanges.push(n),this.changeID=n.getID();const d=this.changeID.getActorID();i.length>0&&this.publish({type:pe.LocalChange,value:{message:n.getMessage()||"",operations:i,actor:d}}),n.hasPresenceChange()&&this.publish({type:pe.PresenceChanged,value:{clientID:d,presence:this.getPresence(d)}})}redo(){if(this.isUpdating)throw new Error("Redo is not allowed during an update");const e=this.internalHistory.popRedo();if(e===void 0)throw new Error("There is no operation to be redone");this.ensureClone();const t=tr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const v of e){if(!(v instanceof Me)){new Wn(t,rn(this.clone.presences.get(this.changeID.getActorID()))).set(v.value,{addToHistory:!0});continue}const k=t.issueTimeTicket();v.setExecutedAt(k),t.push(v)}const n=t.getChange();n.execute(this.clone.root,this.clone.presences,_e.UndoRedo);const{opInfos:i,reverseOps:u}=n.execute(this.root,this.presences,_e.UndoRedo),c=t.getReversePresence();if(c&&u.push({type:"presence",value:c}),u.length>0&&this.internalHistory.pushUndo(u),!n.hasPresenceChange()&&i.length===0)return;this.localChanges.push(n),this.changeID=n.getID();const d=this.changeID.getActorID();i.length>0&&this.publish({type:pe.LocalChange,value:{message:n.getMessage()||"",operations:i,actor:d}}),n.hasPresenceChange()&&this.publish({type:pe.PresenceChanged,value:{clientID:d,presence:this.getPresence(d)}})}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}}function ii(s,e){return t=>async n=>(s&&n.header.set("x-api-key",s),e&&n.header.set("authorization",e),await t(n))}const us=JSON.parse('{"u2":"yorkie-js-sdk","i8":"0.4.12"}');function oi(){return s=>async e=>(e.header.set("x-yorkie-user-agent",us.u2+"/"+us.i8),await s(e))}var En;(function(s){s.PushPull="pushpull",s.PushOnly="pushonly"})(En||(En={}));var Cn;(function(s){s.Deactivated="deactivated",s.Activated="activated"})(Cn||(Cn={}));var Vn;(function(s){s.Connected="connected",s.Disconnected="disconnected"})(Vn||(Vn={}));var nr;(function(s){s.Synced="synced",s.SyncFailed="sync-failed"})(nr||(nr={}));var zt;(function(s){s.StatusChanged="status-changed",s.DocumentChanged="document-changed",s.StreamConnectionStatusChanged="stream-connection-status-changed",s.DocumentSynced="document-synced"})(zt||(zt={}));const Ar={syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3};class cs{constructor(e,t){t=t||Ar,this.key=t.key?t.key:l(),this.status=Cn.Deactivated,this.attachmentMap=new Map,this.apiKey=t.apiKey||"",this.syncLoopDuration=t.syncLoopDuration||Ar.syncLoopDuration,this.reconnectStreamDelay=t.reconnectStreamDelay||Ar.reconnectStreamDelay,this.retrySyncLoopDelay=t.retrySyncLoopDelay||Ar.retrySyncLoopDelay,this.rpcClient=P(Bn.V,Ln({baseUrl:e,interceptors:[ii(t.apiKey,t.token),oi()]})),this.eventStream=x(n=>{this.eventStreamObserver=n})}activate(){return this.isActive()?Promise.resolve():this.rpcClient.activateClient({clientKey:this.key},{headers:{"x-shard-key":this.apiKey}}).then(e=>{this.id=e.clientId,this.status=Cn.Activated,this.runSyncLoop(),this.eventStreamObserver.next({type:zt.StatusChanged,value:this.status}),p.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`)}).catch(e=>{throw p.error(`[AC] c:"${this.getKey()}" err :`,e),e})}deactivate(){if(this.status===Cn.Deactivated)return Promise.resolve();for(const[e]of this.attachmentMap)this.detachInternal(e);return this.rpcClient.deactivateClient({clientId:this.id},{headers:{"x-shard-key":this.apiKey}}).then(()=>{this.status=Cn.Deactivated,this.eventStreamObserver.next({type:zt.StatusChanged,value:this.status}),p.info(`[DC] c"${this.getKey()}" deactivated`)}).catch(e=>{throw p.error(`[DC] c:"${this.getKey()}" err :`,e),e})}attach(e,t={}){var n;if(!this.isActive())throw new me(de.ClientNotActive,`${this.key} is not active`);if(e.getStatus()!==an.Detached)throw new me(de.DocumentNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((u,c)=>c.set(t.initialPresence||{}));const i=(n=t.isRealtimeSync)!==null&&n!==void 0?n:!0;return this.rpcClient.attachDocument({clientId:this.id,changePack:Tn.toChangePack(e.createChangePack())},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(async u=>{const c=Tn.fromChangePack(u.changePack);return e.applyChangePack(c),e.getStatus()===an.Removed||(e.setStatus(an.Attached),this.attachmentMap.set(e.getKey(),new Qs(this.reconnectStreamDelay,e,u.documentId,i)),i&&await this.runWatchLoop(e.getKey()),p.info(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`)),e}).catch(u=>{throw p.error(`[AD] c:"${this.getKey()}" err :`,u),u})}detach(e,t={}){var n;if(!this.isActive())throw new me(de.ClientNotActive,`${this.key} is not active`);const i=this.attachmentMap.get(e.getKey());if(!i)throw new me(de.DocumentNotAttached,`${e.getKey()} is not attached`);return e.update((u,c)=>c.clear()),this.rpcClient.detachDocument({clientId:this.id,documentId:i.docID,changePack:Tn.toChangePack(e.createChangePack()),removeIfNotAttached:(n=t.removeIfNotAttached)!==null&&n!==void 0?n:!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(u=>{const c=Tn.fromChangePack(u.changePack);return e.applyChangePack(c),e.getStatus()!==an.Removed&&e.setStatus(an.Detached),this.detachInternal(e.getKey()),p.info(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}).catch(u=>{throw p.error(`[DD] c:"${this.getKey()}" err :`,u),u})}pause(e){if(!this.isActive())throw new me(de.ClientNotActive,`${this.key} is not active`);return this.changeRealtimeSync(e,!1)}resume(e){if(!this.isActive())throw new me(de.ClientNotActive,`${this.key} is not active`);return this.changeRealtimeSync(e,!0)}pauseRemoteChanges(e){if(!this.isActive())throw new me(de.ClientNotActive,`${this.key} is not active`);const t=this.attachmentMap.get(e.getKey());if(!t)throw new me(de.DocumentNotAttached,`${e.getKey()} is not attached`);t.changeSyncMode(En.PushOnly)}resumeRemoteChanges(e){if(!this.isActive())throw new me(de.ClientNotActive,`${this.key} is not active`);const t=this.attachmentMap.get(e.getKey());if(!t)throw new me(de.DocumentNotAttached,`${e.getKey()} is not attached`);t.changeSyncMode(En.PushPull),t.remoteChangeEventReceived=!0}async changeRealtimeSync(e,t){const n=this.attachmentMap.get(e.getKey());if(!n)throw new me(de.DocumentNotAttached,`${e.getKey()} is not attached`);return n.changeRealtimeSync(t)?t?(n.remoteChangeEventReceived=!0,await this.runWatchLoop(e.getKey()),e):(this.eventStreamObserver.next({type:zt.StreamConnectionStatusChanged,value:Vn.Disconnected}),p.debug(`[WD] c:"${this.getKey()}" unwatches`),e):e}sync(e,t=En.PushPull){if(!this.isActive())throw new me(de.ClientNotActive,`${this.key} is not active`);const n=[];if(e){const i=this.attachmentMap.get(e.getKey());if(!i)throw new me(de.DocumentNotAttached,`${e.getKey()} is not attached`);n.push(this.syncInternal(i,t))}else this.attachmentMap.forEach(i=>{n.push(this.syncInternal(i,i.syncMode))});return Promise.all(n).catch(i=>{throw this.eventStreamObserver.next({type:zt.DocumentSynced,value:nr.SyncFailed}),i})}remove(e){if(!this.isActive())throw new me(de.ClientNotActive,`${this.key} is not active`);const t=this.attachmentMap.get(e.getKey());if(!t)throw new me(de.DocumentNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);const n=Tn.toChangePack(e.createChangePack());return n.isRemoved=!0,this.rpcClient.removeDocument({clientId:this.id,documentId:t.docID,changePack:n},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}).then(i=>{const u=Tn.fromChangePack(i.changePack);e.applyChangePack(u),this.detachInternal(e.getKey()),p.info(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}).catch(i=>{throw p.error(`[RD] c:"${this.getKey()}" err :`,i),i})}subscribe(e,t,n){return this.eventStream.subscribe(e,t,n)}getID(){return this.id}getKey(){return this.key}isActive(){return this.status===Cn.Activated}getStatus(){return this.status}runSyncLoop(){const e=()=>{if(!this.isActive()){p.debug(`[SL] c:"${this.getKey()}" exit sync loop`);return}const t=[];for(const[,n]of this.attachmentMap)n.needRealtimeSync()&&(n.remoteChangeEventReceived=!1,t.push(this.syncInternal(n,n.syncMode)));Promise.all(t).then(()=>setTimeout(e,this.syncLoopDuration)).catch(n=>{p.error(`[SL] c:"${this.getKey()}" sync failed:`,n),this.eventStreamObserver.next({type:zt.DocumentSynced,value:nr.SyncFailed}),setTimeout(e,this.retrySyncLoopDelay)})};p.debug(`[SL] c:"${this.getKey()}" run sync loop`),e()}async runWatchLoop(e){const t=this.attachmentMap.get(e);if(!t)throw new me(de.DocumentNotAttached,`${e} is not attached`);return t.runWatchLoop(n=>{if(!this.isActive())return Promise.reject(new me(de.ClientNotActive,`${this.key} is not active`));const i=new AbortController,u=this.rpcClient.watchDocument({clientId:this.id,documentId:t.docID},{headers:{"x-shard-key":`${this.apiKey}/${e}`},signal:i.signal});return this.eventStreamObserver.next({type:zt.StreamConnectionStatusChanged,value:Vn.Connected}),p.info(`[WD] c:"${this.getKey()}" watches d:"${e}"`),new Promise((c,d)=>{(async()=>{try{for await(const k of u)this.handleWatchDocumentsResponse(t,k),k.body.case==="initialization"&&c([u,i])}catch(k){this.eventStreamObserver.next({type:zt.StreamConnectionStatusChanged,value:Vn.Disconnected}),p.debug(`[WD] c:"${this.getKey()}" unwatches`),n(),d(k)}})()})})}handleWatchDocumentsResponse(e,t){const n=e.doc.getKey();if(t.body.case==="initialization"){const i=t.body.value.clientIds,u=new Set;for(const c of i)u.add(c);e.doc.setOnlineClients(u),e.doc.publish({type:pe.Initialized,value:e.doc.getPresences()});return}else if(t.body.case==="event"){const i=t.body.value,u=i.type,c=i.publisher;switch(u){case F.DocEventType.DOCUMENT_CHANGED:e.remoteChangeEventReceived=!0,this.eventStreamObserver.next({type:zt.DocumentChanged,value:[n]});break;case F.DocEventType.DOCUMENT_WATCHED:e.doc.addOnlineClient(c),e.doc.hasPresence(c)&&e.doc.publish({type:pe.Watched,value:{clientID:c,presence:e.doc.getPresence(c)}});break;case F.DocEventType.DOCUMENT_UNWATCHED:{const d=e.doc.getPresence(c);e.doc.removeOnlineClient(c),d&&e.doc.publish({type:pe.Unwatched,value:{clientID:c,presence:d}});break}}}}detachInternal(e){const t=this.attachmentMap.get(e);!t||(t.cancelWatchStream(),p.debug(`[WD] c:"${this.getKey()}" unwatches`),this.eventStreamObserver.next({type:zt.StreamConnectionStatusChanged,value:Vn.Disconnected}),this.attachmentMap.delete(e))}syncInternal(e,t){const{doc:n,docID:i}=e,u=n.createChangePack();return this.rpcClient.pushPullChanges({clientId:this.id,documentId:i,changePack:Tn.toChangePack(u),pushOnly:t===En.PushOnly},{headers:{"x-shard-key":`${this.apiKey}/${n.getKey()}`}}).then(c=>{const d=Tn.fromChangePack(c.changePack);if(d.hasChanges()&&t===En.PushOnly)return n;n.applyChangePack(d),this.eventStreamObserver.next({type:zt.DocumentSynced,value:nr.Synced}),n.getStatus()===an.Removed&&this.detachInternal(n.getKey());const v=n.getKey(),k=d.getChangeSize();return p.info(`[PP] c:"${this.getKey()}" sync d:"${v}", push:${u.getChangeSize()} pull:${k} cp:${d.getCheckpoint().toTestString()}`),n}).catch(c=>{throw p.error(`[PP] c:"${this.getKey()}" err :`,c),c})}}const ai={Client:cs,Document:as,Primitive:xe,Text:br,Counter:Sr,Tree:Ir,IntType:ze.IntegerCnt,LongType:ze.LongCnt}})(),Xe})())})(Ur);const fs=fi(Ur.exports),ds=["Ali","Beatriz","Charles","Diya","Eric","Fatima","Gabriel","Hanna","Johnson","Perry","Parker","Kelly"],di=()=>{const Je=Math.floor(Math.random()*ds.length);return ds[Je]},hs=["red","yellow","orange","green","blue","purple"],hi=()=>{const Je=Math.floor(Math.random()*hs.length);return hs[Je]};async function mi(){const Je=new fs.Client("https://api.yorkie.dev",{apiKey:"cedaovjuioqlk4pjqn6g"});await Je.activate();const Ot=new fs.Document("profile-stack");Ot.subscribe("presence",Xt=>{Xt.type!==Ur.exports.DocEventType.PresenceChanged&&gi(Ot.getPresences(),Je.getID())}),await Je.attach(Ot,{initialPresence:{name:di(),color:hi()}}),window.addEventListener("beforeunload",()=>{Je.deactivate()})}const Jr=4,Fr=(Je,Ot,Xt)=>{const Pt=document.createElement("div");return Pt.className="peer",Xt==="main"?Pt.innerHTML=`
    <div class="profile">
      <img src="./images/profile-${Ot}.svg" alt="profile" class="profile-img"/>
    </div>
    <div class="name speech-bubbles">${Je}</div>
  `:Xt==="more"&&(Pt.innerHTML=`
    <img src="./images/profile-${Ot}.svg" alt="profile" class="profile-img"/>
    <span class="name">${Je}</span>
  `),Pt},gi=(Je,Ot)=>{const Xt=Je.filter(({clientID:l,presence:D})=>l!==Ot&&D.name&&D.color),Pt=Xt.length+1,Ee=Pt>Jr,Xe=document.getElementById("peerList");Xe.innerHTML="";const re=document.createElement("div");re.className="peer-more-list speech-bubbles";const C=Je.find(({clientID:l})=>l===Ot).presence,p=Fr(`${C.name} (me)`,C.color,"main");if(p.classList.add("me"),Xe.appendChild(p),Xt.forEach((l,D)=>{const{name:m,color:x}=l.presence;if(D<Jr-1){const L=Fr(m,x,"main");Xe.appendChild(L);return}const N=Fr(m,x,"more");re.appendChild(N)}),Ee){const l=document.createElement("div");l.className="peer more",l.innerHTML=`
      <div class="profile">
      +${Pt-Jr}
      </div>
    `,l.appendChild(re),Xe.appendChild(l)}};mi();
